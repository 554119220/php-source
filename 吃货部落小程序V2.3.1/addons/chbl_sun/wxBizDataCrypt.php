<?php
 include_once "\x65\162\162\x6f\162\103\157\x64\145\x2e\160\x68\160"; class WXBizDataCrypt { private $appid; private $sessionKey; public function __construct($appid, $sessionKey) { $this->sessionKey = $sessionKey; $this->appid = $appid; } public function decryptData($encryptedData, $iv, &$data) { goto ADWLW; bQfnY: $aesIV = base64_decode($iv); goto Px_kl; SjPTU: $data = $result; goto G0LbR; Zd6Bc: return ErrorCode::$IllegalBuffer; goto QuaFH; Izl_4: $aesKey = base64_decode($this->sessionKey); goto MlB1A; BpS_5: OufeT: goto Izl_4; G0LbR: return ErrorCode::$OK; goto xLJja; Px_kl: $aesCipher = base64_decode($encryptedData); goto Q8OGd; tTOgO: gXTUP: goto bQfnY; MlB1A: if (!(strlen($iv) != 24)) { goto gXTUP; } goto zQVJQ; U5ZUv: CrshO: goto Xb57x; ADWLW: if (!(strlen($this->sessionKey) != 24)) { goto OufeT; } goto FxbwQ; QmRve: return ErrorCode::$IllegalBuffer; goto U5ZUv; QuaFH: krRU2: goto SjPTU; gX_Zx: if (!($dataObj == NULL)) { goto CrshO; } goto QmRve; zQVJQ: return ErrorCode::$IllegalIv; goto tTOgO; Q8OGd: $result = openssl_decrypt($aesCipher, "\x41\105\x53\x2d\61\62\x38\55\x43\x42\x43", $aesKey, 1, $aesIV); goto u7Yrk; FxbwQ: return ErrorCode::$IllegalAesKey; goto BpS_5; Xb57x: if (!($dataObj->watermark->appid != $this->appid)) { goto krRU2; } goto Zd6Bc; u7Yrk: $dataObj = json_decode($result); goto gX_Zx; xLJja: } }