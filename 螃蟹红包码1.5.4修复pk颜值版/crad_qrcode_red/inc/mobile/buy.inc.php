<?php
 goto hMEpL; mjlRP: if (!(empty($qrcode) || empty($qrcode["\x6f\x70\145\x6e\x69\144"]) || $qrcode["\x6f\x70\x65\156\151\x64"] != $openid || $qrcode["\x75\x6e\x69\141\x63\151\x64"] != $uniacid)) { goto D6VMM; } goto JnIWt; d3FCw: if (!empty($times)) { goto zxKUY; } goto zNVMB; I1MR6: if (!empty($openid)) { goto ydZeJ; } goto lgDR2; ZpS7C: CqFa1: goto sZazu; pgQYq: bEEF9: goto CW11e; QdFE4: $wechat_config["\x73\151\x67\156\153\x65\171"] = $kjSetting["\x73\150\153\x65\x79"]; goto kiHrv; m7d2O: $cfg = $this->module["\x63\x6f\x6e\x66\151\x67"]["\141\x70\151"]; goto EMg6v; E1_b5: $wechat_config["\163\151\x67\156\153\145\x79"] = $cfg["\x70\141\163\x73\x77\157\162\144"]; goto lvBC3; Ov9GB: $wechat_config["\x61\x70\160\151\144"] = $kjSetting["\x61\160\x70\151\144"]; goto xXEKo; P73TO: $userinfo = mc_oauth_userinfo(); goto cEv9N; hMEpL: defined("\111\116\x5f\x49\x41") or exit("\101\x63\143\145\163\163\x20\x44\145\156\151\x65\x64"); goto BYNBe; HC1Y2: $this->show_error("\345\217\x82\346\225\xb0\351\224\x99\350\257\257", "\145\162\x72\157\x72", $error_url); goto wswcW; r7vJz: $openid = $_W["\x6f\160\145\156\151\x64"]; goto HsM0z; FRgP4: $kjSetting = $this->findKJsetting(); goto Ov9GB; EMg6v: $now_url = $_SERVER["\110\124\x54\x50\137\110\117\123\x54"]; goto HxnQX; wYcib: $aid = intval($_GPC["\x61\x69\144"]); goto qHsfn; Rjtfv: $qrcode = pdo_fetch("\x53\x45\114\105\x43\124\40\x69\144\x2c\157\160\x65\x6e\x69\x64\54\x75\x6e\x69\141\x63\151\x64\x20\x46\x52\x4f\x4d\x20" . tablename(TABLE_QRCODE) . "\x20\127\x48\105\122\x45\40\x61\151\144\40\75\40\72\141\x69\x64\40\101\116\104\40\165\165\x69\144\x20\75\40\72\x75\x75\x69\144", array("\72\141\x69\144" => $aid, "\x3a\165\165\x69\144" => $uuid)); goto mjlRP; NubuZ: foreach ($activity["\142\165\x79\x5f\x72\x75\x6c\x65\163"] as $value) { goto uS4jI; nzkyT: hW_Pp: goto tPQnS; tPQnS: jLlNa: goto B6Cog; SEeJ8: $money = round($value["\x67\141\155\x65\137\x6d\x6f\x6e\x65\x79"] * 100); goto nzkyT; uS4jI: if (!(intval($value["\147\141\155\145\137\x74\151\155\x65\x73"]) == $times)) { goto hW_Pp; } goto SEeJ8; B6Cog: } goto Ii7XB; uSH2c: $wechat_config["\151\x70"] = $cfg["\151\x70"]; goto BEk8Q; I4QYC: if (!($activity["\160\x61\164\164\x65\162\x6e"] != 11)) { goto f2Kpx; } goto HC1Y2; BYNBe: global $_GPC, $_W; goto dO9uG; etIkd: Sy3Ar: goto Sb6Xx; Ro0_H: exit; goto Gx0Eb; HxnQX: if (!($cfg["\x73\x69\x74\145\137\x64\x6f\x6d\141\x69\x6e"] && $cfg["\x6a\x75\x6d\x70\x5f\144\157\x6d\141\x69\x6e"] && strpos($cfg["\x73\151\x74\145\137\144\157\x6d\x61\151\156"], $now_url) === false)) { goto pZa7i; } goto Pq_E0; pQ1pz: $wechat_config["\155\163\147\x61\160\x70\x69\x64"] = $cfg["\x6d\x73\x67\x61\160\x70\151\x64"]; goto pgQYq; jD6Li: zxKUY: goto m7d2O; c040p: $uniacid = $_W["\165\156\151\x61\x63\x69\144"]; goto wYcib; eFrg4: function wechat_parameters($params, $wechat) { goto vVFt5; aoZXk: $package["\x74\x72\141\x64\x65\x5f\164\x79\160\x65"] = "\x4a\123\101\x50\x49"; goto CdOki; vVFt5: global $_W; goto fi0oG; id1jZ: $package["\x73\x69\147\156"] = strtoupper(md5($string1)); goto fdOur; hx8_z: ksort($wOpt, SORT_STRING); goto x3qjb; aQGMh: $package["\156\157\164\151\146\x79\x5f\165\x72\x6c"] = $_W["\x73\x69\164\x65\162\157\x6f\x74"] . "\141\x64\144\157\x6e\163\x2f\x63\162\141\x64\137\161\162\x63\157\x64\145\x5f\x72\x65\144\x2f\x6e\157\x74\x69\146\171\x5f\142\x75\171\x2e\160\x68\160"; goto aoZXk; aYbX9: return $wOpt; goto ZoLbP; e_veA: return $response; goto bpquu; s9goO: $response = ihttp_request("\150\164\164\160\163\72\57\57\141\x70\151\56\155\x63\x68\x2e\167\x65\x69\x78\151\x6e\x2e\161\161\56\x63\157\155\57\160\141\x79\x2f\x75\156\151\x66\x69\x65\x64\x6f\x72\x64\145\x72", $dat); goto Gg0T4; zVBlZ: $xml = @isimplexml_load_string($response["\x63\157\156\x74\x65\156\x74"], "\x53\x69\x6d\160\x6c\145\x58\115\x4c\x45\154\145\x6d\145\x6e\x74", LIBXML_NOCDATA); goto iP8zh; wV4CM: $package = array(); goto olCnR; bpquu: QuG56: goto zVBlZ; iphQ6: $wOpt["\x70\141\143\153\141\147\x65"] = "\x70\162\x65\160\x61\171\x5f\151\x64\75" . $prepayid; goto jMqH6; Nfj4W: KSkPG: goto B1st0; hnrq9: $wOpt["\x6e\157\x6e\x63\145\123\164\x72"] = random(8); goto iphQ6; IBK8v: $string1 .= "\x6b\x65\x79\x3d{$wechat["\163\x69\147\156\x6b\145\x79"]}"; goto id1jZ; M3Zhj: $package["\x73\x75\142\x5f\157\160\145\x6e\151\144"] = $package["\x6f\160\145\x6e\x69\144"]; goto WjzA7; Ncux9: O4TY9: goto unfJq; Mvmar: Xcaxa: goto KQAxe; flqTd: $package["\x6f\x75\164\x5f\164\x72\141\x64\145\x5f\156\157"] = $params["\165\156\x69\157\156\164\x69\144"]; goto ne80s; OR0W5: $wOpt["\141\160\160\x49\144"] = $wechat["\141\x70\x70\151\144"]; goto JzJGP; olCnR: $package["\x61\x70\x70\x69\x64"] = $wechat["\x61\160\x70\x69\x64"]; goto vWtnb; HLyEV: if (!$wechat["\x6d\163\x67\x61\160\160\x69\x64"]) { goto N_TBN; } goto jCobP; DgJKr: $package["\163\160\142\151\154\x6c\137\143\162\x65\x61\164\145\137\x69\160"] = $wechat["\x69\x70"] ? $wechat["\151\160"] : CLIENT_IP; goto YjExL; QyeMV: bjtr7: goto IBK8v; AuQGB: if (empty($wechat["\x73\x75\x62\x5f\155\x63\x68\137\151\144"])) { goto Xcaxa; } goto HLyEV; B1st0: if (!(strval($xml->result_code) == "\x46\101\111\x4c")) { goto Rg3sB; } goto n9LJK; x3qjb: foreach ($wOpt as $key => $v) { $string .= "{$key}\x3d{$v}\x26"; dx7u_: } goto Ncux9; WjzA7: unset($package["\157\160\x65\x6e\151\144"]); goto a3sUp; e5MJa: foreach ($package as $key => $v) { goto Z43L5; ZQiIi: XZdwh: goto F0v6G; F0v6G: $string1 .= "{$key}\75{$v}\x26"; goto NeeQd; IEze9: goto QeQTj; goto ZQiIi; NeeQd: QeQTj: goto fzJcB; Z43L5: if (!empty($v)) { goto XZdwh; } goto IEze9; fzJcB: } goto QyeMV; fi0oG: load()->func("\143\x6f\155\x6d\x75\x6e\151\143\141\x74\x69\x6f\x6e"); goto UNIyR; CdOki: $package["\x6f\x70\x65\156\151\144"] = empty($params["\165\163\x65\162"]) ? $_W["\x66\x61\x6e\163"]["\146\x72\157\x6d\137\165\163\145\x72"] : $params["\165\163\145\x72"]; goto AuQGB; jhS5j: $package["\x74\x69\x6d\x65\137\145\170\x70\151\162\145"] = date("\131\155\144\110\x69\x73", TIMESTAMP + 600); goto aQGMh; lbVdQ: $package["\142\x6f\144\171"] = cutstr($params["\x74\151\164\154\145"], 26); goto wCRCz; a3sUp: N_TBN: goto UrH5l; stW9f: $wOpt["\x70\x61\x79\123\151\x67\156"] = strtoupper(md5($string)); goto aYbX9; nH967: Rg3sB: goto EXmQW; EXmQW: $prepayid = $xml->prepay_id; goto OR0W5; wCRCz: $package["\x61\164\164\141\x63\x68"] = $_W["\165\x6e\151\141\x63\151\x64"]; goto flqTd; iP8zh: if (!(strval($xml->return_code) == "\106\x41\111\114")) { goto KSkPG; } goto txcld; n9LJK: return error(-1, strval($xml->err_code) . "\72\40" . strval($xml->err_code_des)); goto nH967; yTAIu: $package["\x6e\x6f\156\143\x65\x5f\163\x74\162"] = random(8); goto lbVdQ; jMqH6: $wOpt["\x73\x69\x67\156\124\x79\160\x65"] = "\x4d\104\65"; goto hx8_z; UNIyR: $wOpt = array(); goto wV4CM; Gg0T4: if (!is_error($response)) { goto QuG56; } goto e_veA; JzJGP: $wOpt["\164\151\155\x65\x53\x74\x61\x6d\160"] = strval(TIMESTAMP); goto hnrq9; ne80s: $package["\164\157\x74\141\154\x5f\x66\145\145"] = $params["\x66\x65\145"]; goto DgJKr; KQAxe: ksort($package, SORT_STRING); goto W0Aik; W0Aik: $string1 = ''; goto e5MJa; UrH5l: $package["\x73\x75\142\x5f\155\143\x68\137\151\144"] = $wechat["\x73\165\x62\137\155\x63\x68\137\x69\144"]; goto Mvmar; jCobP: $package["\x73\165\142\137\141\x70\x70\151\144"] = $wechat["\155\x73\x67\x61\160\160\x69\144"]; goto M3Zhj; txcld: return error(-1, strval($xml->return_msg)); goto Nfj4W; unfJq: $string .= "\153\x65\171\x3d{$wechat["\x73\151\147\156\x6b\145\x79"]}"; goto stW9f; fdOur: $dat = array2xml($package); goto s9goO; YjExL: $package["\x74\151\155\x65\137\x73\164\141\x72\164"] = date("\x59\155\x64\110\x69\x73", TIMESTAMP); goto jhS5j; vWtnb: $package["\155\x63\x68\137\x69\144"] = $wechat["\155\x63\x68\x69\144"]; goto yTAIu; ZoLbP: } goto r7vJz; bjbB3: if (!empty($money)) { goto Q6W7z; } goto y8pX8; Sb6Xx: pdo_update(TABLE_ORDER, $data_order, array("\x69\144" => $order_pay["\151\144"])); goto LNELe; VEzq1: $data_order["\x61\x69\144"] = $aid; goto sRHH7; mvINt: include $this->template("\x62\x75\171"); goto ZxDEc; Pq_E0: $jump_url = $cfg["\x73\151\164\145\x5f\x64\x6f\155\141\x69\156"] . "\x2f\x61\160\x70\57\151\156\144\145\x78\56\x70\x68\x70\x3f\151\75" . $uniacid . "\46\x63\75\145\x6e\164\x72\x79\46\x6d\75\x63\162\141\144\x5f\161\162\143\157\x64\x65\x5f\x72\145\x64\46\x64\157\x3d\142\165\x79\x26\141\x69\144\75" . $aid . "\46\165\x75\x69\144\75" . $uuid . "\x26\x74\x69\155\145\x73\x3d" . $times; goto tHU1m; wswcW: f2Kpx: goto DhUD0; JnIWt: $this->show_error("\xe4\xba\214\xe7\xbb\xb4\xe7\xa0\x81\xe6\x95\xb0\346\x8d\256\xe9\x94\231\350\257\257", "\145\162\x72\x6f\162", $error_url); goto HNlt3; Z4sHU: $data_order["\x6d\x6f\156\145\x79"] = $money / 100; goto WZkgQ; cEv9N: $openid = $userinfo["\157\160\x65\x6e\x69\x64"] ? $userinfo["\x6f\160\x65\x6e\x69\x64"] : $_SESSION["\x6f\141\x75\x74\150\x5f\x6f\x70\145\x6e\x69\144"]; goto iXkgd; n3jYw: $times = intval($_GPC["\x74\x69\x6d\x65\x73"]); goto KtShW; DhUD0: $activity["\142\x75\171\x5f\x72\x75\154\145\x73"] = $activity["\x62\x75\171\137\x72\165\x6c\x65\163"] ? json_decode($activity["\x62\165\x79\137\162\165\x6c\145\163"], true) : array(); goto pHrId; Ww0Nt: $data_order["\x74\151\144"] = $qrcode["\x69\144"]; goto CozTr; CozTr: $data_order["\164\x69\x6d\145\163"] = $times; goto WoqHD; YuPvf: ydZeJ: goto NwEto; lRwZN: $params = array("\x66\145\145" => $money, "\165\163\x65\162" => $openid, "\x74\x69\164\154\145" => urldecode("\350\264\xad\xe4\271\xb0\346\xb8\270\xe6\x88\217\346\xac\xa1\xe6\225\260"), "\165\156\x69\x6f\156\x74\151\144" => $data_order["\x6f\x72\x64\x65\162\x5f\x6e\157"]); goto za5r7; tHU1m: header("\114\157\143\x61\164\151\157\x6e\x3a{$jump_url}"); goto Ro0_H; mQnUD: $wechat_config["\x73\x6c\x5f\160\141\x79"] = $cfg["\x73\x6c\137\160\141\x79"]; goto uSH2c; Gx0Eb: pZa7i: goto OWpwb; BEk8Q: H_9Md: goto Hz2NG; za5r7: if (!($cfg["\141\x70\x70\151\144"] && $cfg["\155\143\x68\x69\144"] && $cfg["\x70\141\x73\163\x77\157\162\144"])) { goto H_9Md; } goto OePUZ; Ii7XB: RLmIu: goto bjbB3; WZkgQ: $data_order["\157\x70\x65\x6e\151\144"] = $openid; goto zIEhi; sZazu: $jsApiParameters = json_encode($jsApiParameters); goto mvINt; NwEto: $activity = pdo_fetch("\x53\x45\114\105\x43\124\x20\x2a\40\x46\x52\x4f\x4d\x20" . tablename(TABLE_ACTIVITY) . "\40\x57\x48\x45\x52\x45\x20\40\x69\144\40\75\40\x3a\x61\x69\144", array("\72\141\x69\144" => $aid)); goto Rjtfv; ozVny: if (!is_error($jsApiParameters)) { goto CqFa1; } goto LYI1O; FCCT8: if ($order_pay) { goto Sy3Ar; } goto UU0Fk; IDH97: $data_order["\x73\164\x61\x74\x75\163"] = 0; goto VEzq1; OWpwb: ini_set("\144\141\x74\x65\56\x74\x69\x6d\145\x7a\x6f\x6e\145", "\101\163\x69\x61\x2f\x53\x68\x61\156\147\x68\x61\x69"); goto eFrg4; Xotfu: OPrOJ: goto tW0to; CW11e: TrEhu: goto mQnUD; LYI1O: $this->show_error("\350\x8e\267\xe5\x8f\x96\346\224\257\344\xbb\x98\xe9\x85\x8d\347\xbd\xae\xe5\x8f\202\346\x95\xb0\345\244\261\350\264\xa5\72" . $jsApiParameters["\x6d\x65\x73\163\x61\x67\x65"], "\145\x72\162\x6f\x72", $error_url); goto ZpS7C; y8pX8: $this->show_error("\351\207\221\xe9\xa2\235\xe9\224\x99\xe8\257\xaf", "\145\x72\x72\157\162", $error_url); goto oYEVr; oYEVr: Q6W7z: goto Z4sHU; iTysZ: if ($cfg["\x73\x75\x62\x5f\155\143\x68\x5f\151\x64"]) { goto OPrOJ; } goto FRgP4; HNlt3: D6VMM: goto I4QYC; iXkgd: Z3E7p: goto I1MR6; xXEKo: $wechat_config["\x6d\x63\x68\151\x64"] = $kjSetting["\155\x63\150\151\x64"]; goto QdFE4; zNVMB: $this->show_error("\345\x8f\x82\346\x95\260\xe9\224\x99\xe8\257\257", "\x65\162\162\x6f\162", $error_url); goto jD6Li; UU0Fk: pdo_insert(TABLE_ORDER, $data_order); goto ezgOY; qHsfn: $uuid = trim($_GPC["\165\165\x69\144"]); goto n3jYw; lgDR2: $this->show_error("\x4f\160\x65\x6e\x49\x64\345\x8f\x82\346\x95\xb0\xe9\224\231\xe8\xaf\257", "\x65\162\162\x6f\162", $error_url); goto YuPvf; zIEhi: $data_order["\x75\156\x69\141\143\x69\144"] = $uniacid; goto IDH97; HsM0z: if (!empty($openid)) { goto Z3E7p; } goto P73TO; OePUZ: $wechat_config["\141\x70\x70\x69\144"] = $cfg["\x61\x70\x70\151\x64"]; goto Olylv; KLaw4: $order_pay = pdo_fetch("\x53\105\114\x45\103\124\40\x69\144\x20\106\122\x4f\x4d\x20" . tablename(TABLE_ORDER) . "\40\x57\x48\x45\122\x45\40\40\x74\151\144\x20\75\x20\72\164\151\144\40\x41\x4e\x44\x20\x6f\x70\145\156\x69\144\x3d\40\x3a\157\160\x65\156\151\144\40\101\x4e\104\x20\163\164\x61\164\x75\x73\74\61", array("\72\x74\x69\x64" => $qrcode["\x69\144"], "\72\x6f\160\x65\156\151\144" => $openid)); goto FCCT8; ezgOY: goto qXIXL; goto etIkd; tV0Q8: $this->show_error("\346\xb4\273\345\212\xa8\346\234\xaa\xe5\274\200\345\x90\257\xe6\xad\244\xe5\x8a\237\xe8\x83\xbd", "\145\x72\x72\x6f\x72", $error_url); goto CHFqe; CHFqe: BLW88: goto NubuZ; LNELe: qXIXL: goto lRwZN; Hz2NG: $jsApiParameters = wechat_parameters($params, $wechat_config); goto ozVny; Olylv: $wechat_config["\155\x63\150\151\x64"] = $cfg["\155\143\150\x69\x64"]; goto E1_b5; tW0to: $wechat_config["\163\x75\x62\x5f\155\143\x68\x5f\x69\x64"] = $cfg["\163\165\142\137\x6d\143\150\x5f\x69\144"]; goto pQ1pz; WoqHD: $data_order["\x63\162\145\141\164\x65\x74\x69\155\145"] = time(); goto Hdqzc; kiHrv: goto bEEF9; goto Xotfu; dO9uG: error_reporting(0); goto c040p; pHrId: if (!(empty($activity["\x62\165\171\x5f\x74\x69\x6d\x65\x73"]) || empty($activity["\142\165\171\x5f\162\165\x6c\x65\163"]))) { goto BLW88; } goto tV0Q8; KtShW: $error_url = $_W["\x73\x69\x74\x65\x72\157\x6f\164"] . "\141\x70\160\x2f\151\x6e\144\x65\170\x2e\x70\x68\160\x3f\151\x3d" . $uniacid . "\46\143\x3d\145\x6e\164\162\x79\x26\x6d\75\x63\x72\x61\144\x5f\x71\x72\x63\x6f\144\x65\x5f\162\x65\144\x26\144\157\75\x69\x6e\144\x65\x78\x26\x61\x69\144\75" . $aid . "\46\165\165\x69\144\x3d" . $uuid; goto d3FCw; sRHH7: $data_order["\x73\x69\144"] = $activity["\163\151\144"]; goto Ww0Nt; lvBC3: if (!$cfg["\163\154\x5f\160\x61\x79"]) { goto TrEhu; } goto iTysZ; Hdqzc: $data_order["\157\x72\144\x65\x72\137\x6e\x6f"] = date("\131\155\x64") . substr(implode(NULL, array_map("\x6f\x72\144", str_split(substr(uniqid(), 7, 13), 1))), 0, 8); goto KLaw4; ZxDEc: exit;