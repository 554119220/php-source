<?php
 goto L6G2k; fEAPB: $code = trim($_GPC["\145\156\143\162\x79\160\x74\137\x63\x6f\144\145"]); goto OcgPe; j9dk9: $this->show_error("\157\x70\x65\x6e\x69\144\xe4\270\272\347\251\xba\xef\274\214\351\x85\x8d\xe7\xbd\xae\351\224\x99\xe8\257\257\xe6\x88\x96\345\x9c\xa8\xe9\x9d\236\345\xbe\256\344\xbf\xa1\xe6\265\217\350\xa7\210\345\x99\xa8\xe4\xb8\xad\xe6\x89\x93\345\xbc\x80", "\145\x72\162\x6f\x72", $jump_url_error); goto fvq22; fvq22: giUuI: goto A1_W9; juMWk: $this->show_error("\347\xb3\xbb\xe7\273\x9f\351\x94\231\xe8\257\257", "\x65\162\162\x6f\162", $jump_url_error); goto r6pR5; A1_W9: if (!empty($uniacid)) { goto caEpU; } goto VhOmU; dHGui: if (!$coupon_list) { goto S0SyA; } goto mUa6Z; iuKjF: $coupon_list_notuse = array(); goto gPCWm; OcgPe: $card_id = trim($_GPC["\143\141\162\x64\x5f\x69\144"]); goto yiZTW; Bw3fS: if (!$coupon_type) { goto Dq6AC; } goto mVmRL; qnng2: $shop = pdo_fetch("\x53\105\114\105\x43\x54\x20\x2a\x20\106\x52\117\x4d\40" . tablename(TABLE_SHOP) . "\40\x57\x48\105\x52\105\40\x69\144\40\x3d\40\72\163\x68\157\x70\151\x64", array("\72\x73\x68\157\x70\x69\x64" => $shopid)); goto Iok_C; l4nXi: load()->classs("\x63\157\x75\160\157\x6e"); goto oTQm0; QHVgX: if (!empty($openid)) { goto giUuI; } goto j9dk9; Qvvb1: if (!$code) { goto yUnWo; } goto Zu60v; K3Dr6: P5_r5: goto bzkcM; pCzmG: if (!$shopid) { goto p8fjB; } goto vE5b1; vE5b1: $where = "\x20\101\116\x44\40\x73\150\x6f\160\151\144\75\47{$shopid}\x27"; goto qnng2; r6pR5: miTZt: goto McTmC; VhOmU: $this->show_error("\xe5\x8f\x82\xe6\225\260\xe9\224\231\350\257\xaf", "\x65\162\162\157\162", $jump_url_error); goto ngAGm; DIOj4: yUN1e: goto NyTDo; L6G2k: defined("\x49\x4e\x5f\111\101") or exit("\101\x63\x63\145\x73\163\40\x44\x65\156\x69\x65\x64"); goto nBS1M; wVJm3: $this->show_error("\xe9\x97\250\xe5\272\227\xe6\225\260\xe6\x8d\xae\351\x94\x99\xe8\257\257", "\145\x72\162\157\x72", $jump_url_error); goto DIOj4; NyTDo: p8fjB: goto Mr6vg; mVmRL: $where = "\40\101\x4e\x44\40\x63\x6f\165\x70\157\x6e\137\x74\x79\x70\145\75\47{$coupon_type}\x27"; goto D4qYQ; McTmC: $code = $coupon->DecryptCode(array("\x65\x6e\x63\x72\171\160\x74\137\143\x6f\x64\x65" => $code)); goto hJyWA; NL_VO: $uniacid = $_W["\165\x6e\151\141\x63\151\144"]; goto daKih; bzkcM: $this->domain_get(); goto QHVgX; A1mpQ: yUnWo: goto D73pu; qpVzm: foreach ($coupon_list as &$coupon_row) { goto SYOfA; puZU3: goto jmDyM; goto kKt3u; Y0W0v: zc3ZA: goto Ag7p7; yT7vk: $coupon_row["\143\157\165\160\x6f\156\137\x63\x6f\x6e\x74\145\156\164"] = json_decode($coupon_row["\143\157\x75\160\x6f\x6e\137\143\157\x6e\x74\x65\x6e\x74"], true); goto rLqFQ; wwqOc: if ($coupon_row["\145\x78\160\151\x72\x61\164\x69\157\156"] == 1) { goto lTnRN; } goto cHOFu; pLFIJ: $coupon_row["\x73\x74\x61\x74\165\x73"] = 2; goto odxws; cHOFu: $coupon_list_notuse[] = $coupon_row; goto Z0pBI; FDbKm: if ($coupon_row["\143\157\x6e\x73\165\x6d\145\x5f\143\157\x64\x65"] && empty($coupon_row["\x63\157\156\x73\x75\x6d\x65\137\x74\x79\x70\x65"])) { goto AdaSA; } goto QIJ6y; pu_GJ: if ($coupon_row["\x63\x6f\156\x73\x75\155\x65\137\164\x79\160\145"] == 1) { goto hjwxh; } goto K2fnm; odxws: wZIQh: goto ZXu5Q; JHOaJ: $expiration = json_decode($coupon_row["\x63\x6f\165\x70\157\x6e\137\x76\141\x6c\151\x64\x69\x74\171"], true); goto jMDGg; s3ZYd: $coupon_row["\165\163\x65\x74\x69\155\x65"] = date("\x59\55\x6d\x2d\144\40\x48\x3a\x69", $coupon_row["\x75\x73\145\x74\x69\155\145"]); goto tvEon; He6y4: goto TcNsH; goto fBelV; rLqFQ: i1Y8M: goto ymgJD; vrZwi: Pet1M: goto HZVV7; jl6pw: $coupon_row["\163\164\x61\x72\x74\137\145\x78\x70\151\x72\141\164\151\157\156"] = date("\131\55\155\55\144", strtotime(date("\x59\x2d\155\55\144", $coupon_row["\143\x72\x65\x61\164\x65\164\x69\x6d\x65"])) + $expiration["\x64\x65\141\x64\154\151\156\x65"] * 86400); goto wJUMP; gZvfs: if (!$coupon_row["\143\157\x75\x70\157\156\137\143\157\156\x74\x65\x6e\x74"]) { goto i1Y8M; } goto yT7vk; fBelV: MPcGI: goto Hi0va; bLZeH: goto MRxm2; goto h3It3; VknQr: etIoq: goto s3ZYd; wJUMP: $coupon_row["\x65\x6e\x64\137\x65\x78\160\x69\162\x61\164\x69\157\x6e"] = date("\x59\55\x6d\x2d\144", strtotime(date("\x59\x2d\155\55\144", $coupon_row["\143\x72\145\141\164\145\x74\151\x6d\x65"])) + ($expiration["\144\x65\141\144\x6c\x69\x6e\145"] + $expiration["\x6c\x69\x6d\151\164"]) * 86400); goto He6y4; GuR9L: hjwxh: goto SU1cx; h3It3: AdaSA: goto XMbVa; SU1cx: $consume_url = $_W["\163\151\164\145\162\x6f\157\164"] . "\x61\x70\x70\57\151\x6e\x64\x65\170\56\160\x68\160\77\x69\x3d" . $uniacid . "\46\x63\75\145\x6e\164\x72\x79\46\x6d\75\x63\162\141\x64\x5f\161\x72\143\x6f\x64\145\x5f\162\x65\144\46\x64\x6f\x3d\x61\x63\x74\x69\166\x69\164\171\x5f\143\x6f\x75\x70\x6f\156\46\141\x69\x64\x3d" . $coupon_row["\141\151\144"] . "\46\151\x64\x3d" . $coupon_row["\151\x64"] . "\x26\x73\150\157\160\151\144\75" . $coupon_row["\x73\150\157\x70\x69\144"] . "\46\164\x6f\153\x65\x6e\x3d" . $this->get_shoptoken($uniacid, $coupon_row["\x73\x68\x6f\160\x69\144"]); goto VeW6A; jMDGg: if (!($expiration["\164\151\x6d\145\x5f\164\x79\160\145"] == 1 && time() > strtotime($expiration["\x65\x6e\144"]) || $expiration["\x74\x69\155\145\137\164\171\160\145"] == 2 && time() > strtotime(date("\x59\x2d\155\x2d\144", $coupon_row["\x63\162\145\x61\x74\145\164\x69\155\x65"])) + ($expiration["\x64\x65\141\x64\154\x69\x6e\145"] + $expiration["\x6c\x69\x6d\151\x74"]) * 86400)) { goto wZIQh; } goto OXwwK; Hi0va: $coupon_row["\x73\x74\141\x72\x74\x5f\145\x78\160\151\x72\x61\x74\x69\157\156"] = $expiration["\163\164\141\x72\x74"]; goto cI5jB; cI5jB: $coupon_row["\x65\x6e\x64\x5f\145\x78\160\151\x72\141\x74\x69\157\156"] = $expiration["\x65\156\x64"]; goto uvTIp; zpnbp: lTnRN: goto s0m5H; s0m5H: if (!($coupon_row["\x65\156\x64\137\x65\x78\160\x69\x72\141\164\x69\x6f\x6e"] && $_W["\164\x69\x6d\145\x73\164\141\x6d\160"] - strtotime($expiration["\145\156\144\137\x65\170\x70\x69\162\x61\x74\x69\157\156"]) > 2592000)) { goto NOFlq; } goto puZU3; tvEon: $coupon_list_use[] = $coupon_row; goto vrZwi; K2fnm: $coupon_row["\x63\x6f\x6e\x73\x75\x6d\145\x5f\165\x72\154"] = ''; goto o3UnR; Pa_mO: YMwAR: goto hQbmA; HZVV7: jmDyM: goto sbAva; Yld3J: goto Ub7DR; goto Pa_mO; HOvax: z1w3d: goto gZvfs; Z0pBI: goto zc3ZA; goto zpnbp; kKt3u: NOFlq: goto Jx0nl; VeW6A: $coupon_row["\143\x6f\x6e\163\165\x6d\145\x5f\165\162\154"] = $_W["\163\x69\x74\x65\x72\157\x6f\x74"] . "\141\x70\x70\57\151\x6e\144\x65\170\56\x70\x68\160\x3f\x69\75" . $uniacid . "\x26\x63\x3d\145\156\164\x72\x79\x26\155\75\143\x72\x61\x64\137\x71\162\x63\x6f\144\145\137\162\x65\144\46\x64\x6f\75\161\162\x26\x75\162\154\x3d" . base64_encode($consume_url); goto upd6C; jojmF: MRxm2: goto jxP4k; uvTIp: TcNsH: goto HOvax; Ag7p7: goto Pet1M; goto VknQr; nGlE0: $coupon_row["\163\150\157\x70\x5f\151\x6e\x66\157"] = pdo_fetch("\123\x45\x4c\105\103\x54\x20\x2a\x20\106\x52\117\115\40" . tablename(TABLE_SHOP) . "\x20\127\x48\x45\x52\105\x20\x69\x64\40\75\x20\72\x73\x68\157\160\151\x64", array("\72\163\150\157\160\151\x64" => $coupon_row["\163\150\157\160\x69\144"])); goto Yld3J; OXwwK: $coupon_row["\x65\170\x70\151\162\x61\x74\151\157\156"] = 1; goto pLFIJ; HURre: Ub7DR: goto pu_GJ; hQbmA: $coupon_row["\163\150\157\x70\x5f\151\156\146\157"] = $shop; goto HURre; jxP4k: if ($coupon_row["\163\x74\x61\x74\x75\163"] == 3) { goto etIoq; } goto wwqOc; ymgJD: if ($shopid) { goto YMwAR; } goto nGlE0; SYOfA: if (!$coupon_row["\x63\x6f\x75\x70\x6f\156\x5f\x76\141\154\151\144\151\x74\171"]) { goto z1w3d; } goto JHOaJ; XMbVa: $coupon_row["\x63\157\156\163\165\155\x65\137\143\x6f\144\x65"] = 1; goto jojmF; QIJ6y: $coupon_row["\143\157\156\163\x75\x6d\145\x5f\143\x6f\144\145"] = ''; goto bLZeH; ZXu5Q: if ($expiration["\164\151\155\145\x5f\x74\x79\x70\145"] == 1) { goto MPcGI; } goto jl6pw; Jx0nl: $coupon_list_expiration[] = $coupon_row; goto Y0W0v; o3UnR: goto GEAOB; goto GuR9L; upd6C: GEAOB: goto FDbKm; sbAva: } goto X5uer; yYFge: S0SyA: goto P3spx; DaCB4: error_reporting(0); goto NL_VO; daKih: $shopid = intval($_GPC["\163\150\157\160\x69\x64"]); goto zqEJq; D4qYQ: Dq6AC: goto fEAPB; oTQm0: $coupon = new coupon(); goto QeNEY; H4NOz: $cfg = $this->module["\x63\x6f\x6e\x66\151\x67"]["\141\160\x69"]; goto DwM8C; zqEJq: $openid = $_W["\157\160\x65\156\151\x64"]; goto H4NOz; Zu60v: $where = "\40\x41\x4e\104\40\143\x61\162\144\137\151\144\x3d\47{$card_id}\47\40\x41\x4e\x44\x20\143\157\144\145\x3d\47{$code}\47"; goto A1mpQ; Iok_C: if (!empty($shop)) { goto yUN1e; } goto wVJm3; gPCWm: $coupon_list_expiration = array(); goto qpVzm; rpIZc: $jump_url_error = $cfg["\152\165\155\160\x5f\x75\x72\x6c"]; goto K3Dr6; X5uer: bVEKu: goto yYFge; D73pu: MtU4F: goto CFQai; QeNEY: if (!is_null($coupon)) { goto miTZt; } goto juMWk; hJyWA: $code = $code["\x63\x6f\x64\145"]; goto Qvvb1; ngAGm: caEpU: goto pCzmG; Mr6vg: $coupon_type = intval($_GPC["\143\x6f\165\160\x6f\156\x5f\x74\x79\160\x65"]); goto Bw3fS; CFQai: $coupon_list = pdo_fetchall("\x53\x45\x4c\x45\x43\x54\40\x2a\x20\40\x46\x52\x4f\115\x20" . tablename(TABLE_COUPON) . "\x20\x57\110\105\x52\x45\40\x6f\160\145\x6e\151\x64\40\x3d\x20\47{$openid}\x27\x20{$where}\40\117\122\104\x45\122\40\102\x59\x20\x69\144\x20\x44\105\x53\103"); goto dHGui; yiZTW: if (!($code && $card_id)) { goto MtU4F; } goto l4nXi; nBS1M: global $_GPC, $_W; goto DaCB4; mUa6Z: $coupon_list_use = array(); goto iuKjF; DwM8C: if (!$cfg["\152\165\x6d\160\137\x75\x72\x6c"]) { goto P5_r5; } goto rpIZc; P3spx: include $this->template("\x6d\171");