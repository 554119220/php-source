<import src="../common/common.wxml"></import>
<import src="../../../wxParse/wxParse.wxml"></import>
<import src="../common/common.wxml"></import>
<view class="body" style="background-color:#f7f7f7; color:#333;">
    <template is="official" data="{{config:config}}"></template>
    <view class="edCont1" style="background-color:#fff">
        <image mode="widthFix" src="{{list.bimg}}"></image>
        <view class="h1">{{list.name}}</view>
        <view class="h2 flex-display flex-alignC">
            <view class="flex-flex1">人数：
        <text class="sp1" style="color:{{theme.color}};">{{list.member}}</text>
            </view>
            <view class="flex-flex1">费用：
        <text class="sp1" style="color:{{theme.color}};">{{list.new_price}}</text>
            </view>
            <view>已报名：
        <text class="sp1" style="color:{{theme.color}};">{{list.is_member}}</text>
            </view>
        </view>
    </view>
    <view class="edCont2 flex-display flex-alignC" style="background-color:#fff">
        <view bindtap="changeTab" class="navBox {{index==tabCurr?'curr':''}} flex-flex1" id="{{index}}" style="color:{{index==tabCurr?theme.color:''}};border-color:{{index==tabCurr?theme.color:''}};" wx:for="{{tab}}" wx:key="{{index}}">{{item}}</view>
    </view>
    <view class="edCont3" hidden="{{tabCurr!=0}}" style="background-color:#fff">
        <view class="listBox flex-display flex-alignC">
            <view class="name">活动时间：</view>
            <view class="text flex-flex1">{{list.active_start}}~{{list.active_end}}</view>
        </view>
        <view class="listBox flex-display flex-alignC">
            <view class="name">报名时间：</view>
            <view class="text flex-flex1">{{list.sign_start}}~{{list.sign_end}}</view>
        </view>
        <view class="listBox flex-display flex-alignC" wx:if="{{list.mobile}}">
            <view class="name">咨询电话：</view>
            <view class="text flex-flex1">{{list.mobile}}</view>
            <view bindtap="callFunc" class="btn">
                <image src="../../images/phone2.png"></image>
            </view>
        </view>
        <view class="listBox flex-display flex-alignC" wx:if="{{list.address}}">
            <view class="name">活动地址：</view>
            <view class="text flex-flex1">{{list.address}}</view>
            <view bindtap="mapFunc" class="btn" wx:if="{{list.latitude&&list.longitude}}">
                <image src="{{theme.icon[5]}}"></image>
            </view>
        </view>
    </view>
    <view class="edCont4" hidden="{{tabCurr!=0||!list.content}}" style="background-color:#fff">
        <view class="title flex-display flex-alignC" style="background-color:#fff">
            <view class="border" style="background:{{theme.color}};"></view>
            <view class="flex-flex1"></view>
            <view class="cl" style="border-bottom-color:{{theme.color}};"></view>
            <view class="text" style="background:{{theme.color}};">活动介绍</view>
            <view class="cr" style="border-top-color:{{theme.color}};"></view>
            <view class="flex-flex1"></view>
        </view>
        <view class="edit" style="background-color:#fff">
            <template is="wxParse" data="{{wxParseData:article.nodes}}"></template>
        </view>
    </view>
    <view class="edCont5" hidden="{{tabCurr!=1}}" style="background-color:#fff">
        <view class="listBox flex-display flex-alignC" wx:for="{{order}}" wx:key="unique">
            <image mode="aspectFill" src="{{item.avatar}}"></image>
            <view class="text flex-flex1">
                <view class="h1">{{item.nick}}</view>
                <view class="p flex-display flex-alignC">
                    <view class="flex-flex1">{{item.createtime}}</view>
                    <view>人数：
              <text class="sp1" style="color:{{theme.color}};">{{item.member}}人</text>
                    </view>
                </view>
            </view>
        </view>
    </view>
    <view class="bottomBlank2"></view>
    <view class="buyBlock flex-display flex-alignC" style="background-color:#fff">
        <navigator class="navBox" openType="reLaunch" url="../index/index">
            <image src="../../images/bottom_icon01.png"></image>
        </navigator>
        <view bindtap="callFunc" class="navBox" wx:if="{{list.mobile}}">
            <image src="../../images/phone.png"></image>
        </view>
        <view bindtap="showPay" class="btn bg2 flex-flex1" style="background:{{theme.color}};" wx:if="{{list.end==1}}">立即报名</view>
        <view class="btn bg2 flex-flex1" style="background:#ddd;" wx:if="{{list.end==-1}}">已结束</view>
        <view class="btn bg2 flex-flex1" style="background:#ddd;" wx:if="{{list.end==2}}">未开始</view>
    </view>
    <form reportSubmit bindsubmit="submit" class="payBlock" style="background-color:#fff" wx:if="{{showPay}}">
        <view class="blank">
            <view class="title">
                <text>项目信息</text>
                <view class="border" style="background-color:{{theme.color}};"></view>
                <image bindtap="closePay" class="closeBtn" src="../../images/close.png"></image>
            </view>
            <view class="inputBlock flex-display flex-alignC">
                <view class="name">您的姓名：</view>
                <view class="input flex-flex1">
                    <input bindinput="input" data-name="name" placeholder="点击填写或点击右边的图标" placeholderStyle="color:#DDDDDD;" type="text" value="{{namevalue}}"></input>
                </view>
                <view bindtap="getname" class="btn">
                    <image src="{{theme.icon[6]}}"></image>
                </view>
            </view>
            <view class="inputBlock flex-display flex-alignC">
                <view class="name">联系电话：</view>
                <view class="input flex-flex1">
                    <input bindinput="input" data-name="mobile" placeholder="点击填写或点击右边的图标" placeholderStyle="color:#DDDDDD;" type="number" value="{{phonevalue}}"></input>
                </view>
                <view bindtap="getphone" class="btn">
                    <image src="{{theme.icon[7]}}"></image>
                </view>
            </view>
            <view class="inputBlock flex-display flex-alignC">
                <view class="name">活动费用：</view>
                <view class="input flex-flex1">¥{{list.price}}</view>
                <view class="btn"></view>
            </view>
            <view class="inputBlock flex-display flex-alignC">
                <view class="name">报名人数：</view>
                <view class="input flex-flex1">
                    <input bindinput="input" data-name="numbervalue" placeholder="输入报名人数" placeholderStyle="color:#DDDDDD;" type="number" value="{{numbervalue}}"></input>
                </view>
                <view class="btn"></view>
            </view>
            <view class="inputBlock flex-display flex-alignC">
                <view class="name">应付金额：</view>
                <view class="input sp1 flex-flex1" style="color:{{theme.color}};">￥{{filters.toFix(list.price*numbervalue)}}</view>
                <view class="btn"></view>
            </view>
            <view class="inputBlock flex-display flex-alignC">
                <view class="name">预约时间：</view>
                <picker bindchange="bindDateChange" class="flex-flex1" end="{{list.end_time}}" mode="date" start="{{list.start_time}}" value="{{plan_date}}">
                    <view class="picker">{{plan_date}}</view>
                </picker>
                <view class="btn"></view>
            </view>
        </view>
        <button class="submitBtn" formType="submit" style="background-color:{{theme.color}};">支付报名</button>
    </form>
    <template is="getuserinfo" data="{{shadow:shadow,get_userinfo:get_userinfo,app_step1:app_step1,app_step2:app_step2,config:config}}"></template>
</view>
<wxs module="filters" src="../common/common.wxs" />