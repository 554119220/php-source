<?php
 goto bMiyj; AjF5X: include_once "\145\x72\162\157\x72\x43\157\144\x65\56\160\150\x70"; goto YOymD; bMiyj: include_once "\160\153\x63\163\67\105\x6e\x63\157\x64\x65\162\x2e\x70\x68\160"; goto AjF5X; YOymD: class WXBizDataCrypt { private $appid; private $sessionKey; public function WXBizDataCrypt($appid, $sessionKey) { $this->sessionKey = $sessionKey; $this->appid = $appid; } public function decryptData($encryptedData, $iv, &$data) { goto aazbI; aazbI: if (!(strlen($this->sessionKey) != 24)) { goto r26SY; } goto EKUb2; Ts5hF: $dataObj = json_decode($result[1]); goto kf60o; zkpUL: UQzXv: goto Rf9fz; UtQjk: r26SY: goto O60Bc; M7cHc: return ErrorCode::$IllegalBuffer; goto Bvseq; kf60o: if (!($dataObj == NULL)) { goto oAsyR; } goto LBsW8; PbEeu: return $result[0]; goto ozk4l; ozk4l: JtvIY: goto Ts5hF; KwveE: if (!(strlen($iv) != 24)) { goto UQzXv; } goto Fhr6r; YdldW: if (!($result[0] != 0)) { goto JtvIY; } goto PbEeu; Bvseq: WjJU3: goto Ahdzq; dSXab: $result = $pc->decrypt($aesCipher, $aesIV); goto YdldW; CKOJk: $aesCipher = base64_decode($encryptedData); goto f3agn; O60Bc: $aesKey = base64_decode($this->sessionKey); goto KwveE; f3agn: $pc = new Prpcrypt($aesKey); goto dSXab; LBsW8: return ErrorCode::$IllegalBuffer; goto Kk6DJ; Ahdzq: $data = $result[1]; goto hVVlA; Rf9fz: $aesIV = base64_decode($iv); goto CKOJk; hVVlA: return ErrorCode::$OK; goto eVHf6; EKUb2: return ErrorCode::$IllegalAesKey; goto UtQjk; dg70x: if (!($dataObj->watermark->appid != $this->appid)) { goto WjJU3; } goto M7cHc; Fhr6r: return ErrorCode::$IllegalIv; goto zkpUL; Kk6DJ: oAsyR: goto dg70x; eVHf6: } }