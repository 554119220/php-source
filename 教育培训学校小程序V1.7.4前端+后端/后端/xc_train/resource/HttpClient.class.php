<?php
 class HttpClient { var $host; var $port; var $path; var $method; var $postdata = ''; var $cookies = array(); var $referer; var $accept = "\164\145\x78\164\x2f\170\155\x6c\54\x61\x70\x70\154\x69\143\141\164\151\x6f\156\57\x78\x6d\x6c\x2c\141\x70\x70\154\x69\x63\141\164\x69\157\x6e\57\x78\x68\164\x6d\x6c\x2b\x78\155\154\54\x74\145\x78\164\x2f\x68\164\x6d\x6c\x2c\164\x65\170\x74\x2f\x70\x6c\141\151\x6e\x2c\x69\155\141\x67\x65\x2f\x70\x6e\147\x2c\x69\155\x61\x67\x65\x2f\x6a\160\145\147\x2c\x69\155\x61\147\145\x2f\147\151\x66\54\52\x2f\x2a"; var $accept_encoding = "\x67\x7a\x69\x70"; var $accept_language = "\145\x6e\x2d\165\x73"; var $user_agent = "\111\156\143\x75\x74\x69\157\x20\110\x74\164\x70\103\x6c\x69\x65\156\164\40\x76\60\56\x39"; var $timeout = 20; var $use_gzip = true; var $persist_cookies = true; var $persist_referers = true; var $debug = false; var $handle_redirects = true; var $max_redirects = 5; var $headers_only = false; var $username; var $password; var $status; var $headers = array(); var $content = ''; var $errormsg; var $redirect_count = 0; var $cookie_host = ''; function __construct($host, $port = 80) { $this->host = $host; $this->port = $port; } function get($path, $data = false) { goto P9EJT; P5A9i: gWCZ6: goto BR1t5; BR1t5: return $this->doRequest(); goto h_tL6; zCEk_: if (!$data) { goto gWCZ6; } goto aQET3; MYQCO: $this->method = "\107\x45\x54"; goto zCEk_; P9EJT: $this->path = $path; goto MYQCO; aQET3: $this->path .= "\x3f" . $this->buildQueryString($data); goto P5A9i; h_tL6: } function post($path, $data) { goto IzHWB; JJMtO: $this->method = "\x50\117\x53\124"; goto KfBaU; IzHWB: $this->path = $path; goto JJMtO; KfBaU: $this->postdata = $this->buildQueryString($data); goto dwyvP; dwyvP: return $this->doRequest(); goto nqQfe; nqQfe: } function buildQueryString($data) { goto LSQW3; EIhSD: if (is_array($data)) { goto xpFro; } goto y7tPp; Wlp4c: goto AE9oX; goto Bf0BV; OZ6hT: return $querystring; goto qsgoH; LSQW3: $querystring = ''; goto EIhSD; SPgHZ: $querystring = substr($querystring, 0, -1); goto CfJLs; CfJLs: AE9oX: goto OZ6hT; Bf0BV: xpFro: goto sSGML; y7tPp: $querystring = $data; goto Wlp4c; sSGML: foreach ($data as $key => $val) { goto vVqDD; mcmIe: foreach ($val as $val2) { $querystring .= urlencode($key) . "\x3d" . urlencode($val2) . "\x26"; CchNX: } goto QZlym; QZlym: UdU9t: goto EVaIi; oxLIX: TZ8U7: goto ncbiY; EVaIi: CbcTx: goto oxLIX; vVqDD: if (is_array($val)) { goto CvjQo; } goto lSGuH; oD4IY: goto CbcTx; goto Si9UR; Si9UR: CvjQo: goto mcmIe; lSGuH: $querystring .= urlencode($key) . "\75" . urlencode($val) . "\46"; goto oD4IY; ncbiY: } goto Ejg7s; Ejg7s: GB_Nj: goto SPgHZ; qsgoH: } function doRequest() { goto Mw_eC; EU8FM: $this->headers[$key] = array($this->headers[$key], $val); goto LgfgR; GqXTt: return false; goto hYTlN; PMWqF: goto FL1V2; goto TUat3; pUwQu: if (!$inHeaders) { goto y3R6_; } goto jpLq2; HvKG6: $url = parse_url($location . $uri); goto EA3uw; rUBWY: socket_set_timeout($fp, $this->timeout); goto Rbwte; ECsnb: $this->errormsg = "\123\x74\141\x74\165\x73\40\143\157\144\x65\x20\154\x69\x6e\145\x20\151\156\x76\141\154\x69\x64\x3a\x20" . htmlentities($line); goto Vk9kg; qnQQ2: if (!(isset($this->headers["\x63\157\x6e\x74\x65\x6e\164\x2d\x65\156\x63\157\x64\151\x6e\x67"]) && $this->headers["\143\157\156\x74\x65\156\164\55\x65\x6e\143\157\144\151\x6e\x67"] == "\147\172\x69\x70")) { goto cCRdm; } goto lMFI8; Gc4D0: $this->debug("\x50\x65\162\163\151\x73\164\151\156\x67\x20\162\x65\x66\x65\162\145\162\72\x20" . $this->getRequestURL()); goto WoklD; wJgDZ: if (!$atStart) { goto WzPXH; } goto iAcR6; VB5IU: return false; goto j09UM; EN2Fd: $status_string = $m[3]; goto dirSn; vgmQ5: goto FL1V2; goto Akb5z; iH8y6: EA_Pb: goto XB62M; n_C_c: $this->content = substr($this->content, 10); goto MA3fi; Dkf1N: $atStart = true; goto mqnZy; pUvdf: myrKi: goto cL3rt; FVDH_: foreach ($cookies as $cookie) { goto CI9Ss; She4n: $this->cookies[$m[1]] = $m[2]; goto AjoLH; CI9Ss: if (!preg_match("\x2f\50\133\x5e\75\135\x2b\x29\x3d\50\x5b\x5e\x3b\135\53\x29\73\x2f", $cookie, $m)) { goto YKn2H; } goto She4n; ohDfo: SnNGU: goto bdnG7; AjoLH: YKn2H: goto ohDfo; bdnG7: } goto pUvdf; lq9QQ: switch ($errno) { case -3: $this->errormsg = "\x53\157\143\x6b\x65\164\40\x63\162\145\x61\x74\151\157\156\40\x66\x61\151\154\145\144\40\x28\55\63\x29"; case -4: $this->errormsg = "\104\x4e\x53\x20\x6c\157\x6f\153\165\x70\x20\x66\141\151\x6c\x75\162\145\40\50\55\x34\51"; case -5: $this->errormsg = "\x43\x6f\x6e\x6e\145\143\x74\x69\157\x6e\x20\162\x65\x66\165\163\x65\x64\x20\x6f\x72\x20\164\x69\155\x65\x64\40\x6f\165\x74\x20\50\55\x35\x29"; default: goto ifIWj; IXUGy: $this->debug($this->errormsg); goto zIbbP; aKDuj: $this->errormsg .= "\x20" . $errstr; goto IXUGy; ifIWj: $this->errormsg = "\x43\157\156\x6e\145\x63\x74\151\x6f\x6e\x20\146\141\151\154\145\x64\x20\x28" . $errno . "\x29"; goto aKDuj; zIbbP: } goto QVVvY; FOitY: goto FL1V2; goto pdLlo; s1Jth: $this->headers[$key][] = $val; goto zc3OW; pdLlo: mitRQ: goto pF01u; j09UM: Ztg5u: goto SZt6E; h_mef: if (!(++$this->redirect_count >= $this->max_redirects)) { goto VhoRz; } goto xrRpj; F_q_F: $inHeaders = false; goto f_o3Y; P5yWq: if (!$this->persist_referers) { goto d1b2T; } goto Gc4D0; oB8Oc: $this->content = ''; goto IJWeI; dirSn: $this->debug(trim($line)); goto vgmQ5; GBPiD: $val = trim($m[2]); goto ThcbC; iuSfZ: G_dIf: goto GqXTt; cWGg_: $this->debug($this->errormsg); goto pyw4x; z469S: $cookies = $this->headers["\163\145\x74\55\143\157\x6f\153\151\145"]; goto cTQvs; iuF0B: goto FL1V2; goto StFwp; kFOOy: $this->debug("\x52\x65\x71\x75\145\x73\x74", $request); goto LvM6k; ivXUG: $location = isset($this->headers["\154\157\x63\141\x74\151\x6f\156"]) ? $this->headers["\154\157\143\x61\x74\151\x6f\x6e"] : ''; goto ckJ31; RLo7O: fclose($fp); goto qnQQ2; cTQvs: if (is_array($cookies)) { goto zMisp; } goto tS_VI; Rbwte: $request = $this->buildRequest(); goto kFOOy; Mw_eC: if ($fp = @fsockopen($this->host, $this->port, $errno, $errstr, $this->timeout)) { goto n43JK; } goto lq9QQ; UvRWU: r2BSy: goto P5yWq; pF01u: $key = strtolower(trim($m[1])); goto GBPiD; WEajK: if (preg_match("\57\x28\133\136\x3a\x5d\x2b\x29\72\134\163\x2a\x28\x2e\x2a\x29\57", $line, $m)) { goto mitRQ; } goto FOitY; j3kow: goto FL1V2; goto LiVGA; E8_x5: if (!$this->handle_redirects) { goto EA_Pb; } goto h_mef; iAcR6: $atStart = false; goto XLdcD; CIQyy: if (!($this->persist_cookies && isset($this->headers["\163\145\x74\55\143\157\157\x6b\x69\145"]) && $this->host == $this->cookie_host)) { goto r2BSy; } goto z469S; MptYe: $this->status = $m[2]; goto EN2Fd; ckJ31: $uri = isset($this->headers["\x75\x72\x69"]) ? $this->headers["\165\162\151"] : ''; goto j9KYT; IJWeI: $this->errormsg = ''; goto qtQDj; G35BO: $this->content .= $line; goto PMWqF; TUat3: kunWM: goto RLo7O; ykn8z: $this->headers[$key] = $val; goto ehjTE; BLuYV: if (is_array($this->headers[$key])) { goto HJNCm; } goto EU8FM; ikrpy: goto kunWM; goto l1di2; K53Pl: if (!$this->headers_only) { goto rf8U0; } goto ikrpy; v1Lza: $line = fgets($fp, 4096); goto wJgDZ; pyw4x: $this->redirect_count = 0; goto gv9lh; f_o3Y: $this->debug("\x52\x65\x63\145\x69\166\x65\x64\40\x48\x65\141\144\145\x72\x73", $this->headers); goto K53Pl; x46Cq: KzXfV: goto iH8y6; LvM6k: fwrite($fp, $request); goto G4N9r; j9KYT: if (!($location || $uri)) { goto KzXfV; } goto HvKG6; XB62M: return true; goto dECLQ; HFsOw: HJNCm: goto s1Jth; mqnZy: FL1V2: goto Fi4GS; l1di2: rf8U0: goto j3kow; gv9lh: return false; goto gL842; qtQDj: $inHeaders = true; goto Dkf1N; zc3OW: XSG7q: goto ipGY1; lMFI8: $this->debug("\103\157\x6e\164\x65\x6e\164\40\151\163\x20\x67\x7a\x69\160\40\x65\x6e\x63\x6f\x64\145\x64\x2c\x20\x75\x6e\x7a\151\x70\160\151\x6e\147\x20\151\164"); goto n_C_c; Vk9kg: $this->debug($this->errormsg); goto VB5IU; ThcbC: if (isset($this->headers[$key])) { goto sptLC; } goto ykn8z; UGTjI: zMisp: goto FVDH_; ipGY1: kpmxO: goto iuF0B; QVVvY: fyuYp: goto iuSfZ; XLdcD: if (preg_match("\x2f\110\124\124\x50\x5c\57\50\x5c\144\x5c\56\134\144\51\x5c\163\x2a\x28\134\144\53\x29\134\x73\x2a\50\x2e\52\51\x2f", $line, $m)) { goto Ztg5u; } goto ECsnb; tS_VI: $cookies = array($cookies); goto UGTjI; MA3fi: $this->content = gzinflate($this->content); goto ph0bx; p61Cx: sptLC: goto BLuYV; SZt6E: $http_version = $m[1]; goto MptYe; ph0bx: cCRdm: goto CIQyy; Fi4GS: if (feof($fp)) { goto kunWM; } goto v1Lza; LiVGA: qp91c: goto WEajK; ehjTE: goto kpmxO; goto p61Cx; EA3uw: return $this->get($url["\x70\141\x74\150"]); goto x46Cq; hYTlN: n43JK: goto rUBWY; StFwp: y3R6_: goto G35BO; jpLq2: if (!(trim($line) == '')) { goto qp91c; } goto F_q_F; rjTXd: d1b2T: goto E8_x5; WoklD: $this->referer = $this->getRequestURL(); goto rjTXd; Akb5z: WzPXH: goto pUwQu; G4N9r: $this->headers = array(); goto oB8Oc; cL3rt: $this->cookie_host = $this->host; goto UvRWU; LgfgR: goto XSG7q; goto HFsOw; gL842: VhoRz: goto ivXUG; xrRpj: $this->errormsg = "\x4e\x75\x6d\x62\x65\162\40\x6f\x66\40\162\x65\x64\151\162\145\143\x74\x73\40\x65\x78\143\x65\145\x64\x65\144\x20\x6d\x61\170\x69\x6d\x75\x6d\40\x28" . $this->max_redirects . "\x29"; goto cWGg_; dECLQ: } function buildRequest() { goto DJ8O8; RvcEs: $cookie = "\x43\157\157\153\151\145\x3a\x20"; goto EywEq; u0DwY: if (!($this->username && $this->password)) { goto FKS1A; } goto fHVwn; AtLSE: kuTzG: goto lmz9H; qjGRB: $headers[] = "\110\157\x73\164\72\x20{$this->host}"; goto KRdIE; RtWzB: FKS1A: goto XRzKU; EywEq: foreach ($this->cookies as $key => $value) { $cookie .= "{$key}\75{$value}\x3b\x20"; Fw6nw: } goto CuAlf; KRdIE: $headers[] = "\125\163\145\162\55\101\147\x65\156\164\72\40{$this->user_agent}"; goto LTDqO; liUF_: $request = implode("\15\xa", $headers) . "\xd\xa\15\xa" . $this->postdata; goto APdRi; S0AXp: $headers[] = "\x43\157\x6e\x74\x65\156\164\55\114\x65\156\147\164\150\72\40" . strlen($this->postdata); goto MHKuI; EvheG: $headers[] = "\122\x65\x66\x65\x72\x65\x72\72\40{$this->referer}"; goto gVeei; ZgIlP: $headers[] = "\103\157\156\164\145\156\x74\x2d\124\x79\x70\145\72\40\141\160\160\x6c\151\143\x61\164\x69\157\156\57\x78\x2d\x77\x77\167\x2d\146\157\162\x6d\55\165\x72\154\145\156\x63\x6f\144\145\144"; goto S0AXp; LXls0: if (!$this->use_gzip) { goto kuTzG; } goto ApYSV; fHVwn: $headers[] = "\101\165\164\x68\x6f\162\151\172\x61\x74\151\x6f\x6e\72\x20\102\101\123\x49\103\40" . base64_encode($this->username . "\72" . $this->password); goto RtWzB; qbPQC: s_lnN: goto u0DwY; HSI2k: if (!$this->cookies) { goto s_lnN; } goto RvcEs; a_7Ag: if (!$this->referer) { goto FTL2Y; } goto EvheG; XRzKU: if (!$this->postdata) { goto ZIPjR; } goto ZgIlP; LTDqO: $headers[] = "\x41\143\x63\x65\x70\164\72\40{$this->accept}"; goto LXls0; Dk31t: $headers[] = $cookie; goto qbPQC; ApYSV: $headers[] = "\x41\x63\143\145\x70\164\x2d\145\x6e\143\x6f\144\151\156\x67\72\40{$this->accept_encoding}"; goto AtLSE; z4MPE: $headers[] = "{$this->method}\40{$this->path}\x20\x48\x54\x54\x50\x2f\61\56\60"; goto qjGRB; MHKuI: ZIPjR: goto liUF_; lmz9H: $headers[] = "\101\143\x63\x65\x70\164\x2d\154\141\x6e\x67\165\x61\x67\145\72\40{$this->accept_language}"; goto a_7Ag; CuAlf: UUEzF: goto Dk31t; gVeei: FTL2Y: goto HSI2k; DJ8O8: $headers = array(); goto z4MPE; APdRi: return $request; goto HjJiL; HjJiL: } function getStatus() { return $this->status; } function getContent() { return $this->content; } function getHeaders() { return $this->headers; } function getHeader($header) { goto K60QX; t2_nh: goto QwBxx; goto GqMof; GqMof: rN6QF: goto muIVk; Ae_0P: if (isset($this->headers[$header])) { goto rN6QF; } goto AN4Ru; AN4Ru: return false; goto t2_nh; K60QX: $header = strtolower($header); goto Ae_0P; c3x0f: QwBxx: goto S_s4D; muIVk: return $this->headers[$header]; goto c3x0f; S_s4D: } function getError() { return $this->errormsg; } function getCookies() { return $this->cookies; } function getRequestURL() { goto hrOh9; hrOh9: $url = "\150\x74\x74\x70\x3a\x2f\x2f" . $this->host; goto ZRYdh; ZRYdh: if (!($this->port != 80)) { goto Ppuqi; } goto rDcJd; qvyUN: $url .= $this->path; goto LUk0U; rDcJd: $url .= "\72" . $this->port; goto cNUrv; cNUrv: Ppuqi: goto qvyUN; LUk0U: return $url; goto gVqDN; gVqDN: } function setUserAgent($string) { $this->user_agent = $string; } function setAuthorization($username, $password) { $this->username = $username; $this->password = $password; } function setCookies($array) { $this->cookies = $array; } function useGzip($boolean) { $this->use_gzip = $boolean; } function setPersistCookies($boolean) { $this->persist_cookies = $boolean; } function setPersistReferers($boolean) { $this->persist_referers = $boolean; } function setHandleRedirects($boolean) { $this->handle_redirects = $boolean; } function setMaxRedirects($num) { $this->max_redirects = $num; } function setHeadersOnly($boolean) { $this->headers_only = $boolean; } function setDebug($boolean) { $this->debug = $boolean; } function quickGet($url) { goto GW75n; ZGfoC: return false; goto FzCI4; IgnEL: LjyRi: goto UPB_P; GW75n: $bits = parse_url($url); goto n6wg6; UPB_P: $client = new HttpClient($host, $port); goto BSZfc; HiDBn: return $client->getContent(); goto Ic71h; BSZfc: if (!$client->get($path)) { goto L4SKk; } goto HiDBn; LAfvf: if (!isset($bits["\x71\x75\145\x72\171"])) { goto LjyRi; } goto X872L; yDIyr: L4SKk: goto ZGfoC; pZ__n: $path = isset($bits["\x70\141\164\150"]) ? $bits["\x70\x61\x74\150"] : "\57"; goto LAfvf; X872L: $path .= "\77" . $bits["\x71\165\x65\162\171"]; goto IgnEL; FzCI4: dNe1e: goto CME93; XiTPg: $port = isset($bits["\x70\x6f\x72\164"]) ? $bits["\x70\x6f\x72\164"] : 80; goto pZ__n; Ic71h: goto dNe1e; goto yDIyr; n6wg6: $host = $bits["\x68\x6f\x73\x74"]; goto XiTPg; CME93: } function quickPost($url, $data) { goto zz2ii; MRsde: oQ6Ul: goto qmccz; t703Z: goto r2Mxc; goto MRsde; MVtRG: $host = $bits["\150\x6f\163\164"]; goto sTKfl; qmccz: return false; goto f1SvH; nESDH: $client = new HttpClient($host, $port); goto rT6BB; f1SvH: r2Mxc: goto JQF_h; TQ_B7: return $client->getContent(); goto t703Z; rT6BB: if (!$client->post($path, $data)) { goto oQ6Ul; } goto TQ_B7; zz2ii: $bits = parse_url($url); goto MVtRG; PRjdh: $path = isset($bits["\x70\141\x74\150"]) ? $bits["\x70\141\x74\x68"] : "\x2f"; goto nESDH; sTKfl: $port = isset($bits["\160\157\x72\x74"]) ? $bits["\x70\157\162\164"] : 80; goto PRjdh; JQF_h: } function debug($msg, $object = false) { goto XXNKc; Q_SuW: print "\x3c\144\151\166\x20\x73\x74\x79\154\x65\x3d\x22\142\x6f\162\144\145\x72\72\40\x31\160\x78\40\x73\x6f\154\x69\144\40\162\145\x64\73\x20\160\141\144\x64\151\156\x67\72\40\60\x2e\65\145\155\73\40\x6d\x61\162\147\151\156\x3a\x20\x30\x2e\65\x65\155\73\42\76\74\x73\x74\x72\157\156\147\76\110\164\x74\x70\103\x6c\x69\145\x6e\164\x20\104\145\142\x75\147\x3a\x3c\57\163\164\x72\157\156\x67\x3e\x20" . $msg; goto kJfan; STRcD: print_r($object); goto ht4Db; Hfl2A: B2IvN: goto E6Mxj; E6Mxj: print "\74\57\x64\151\166\76"; goto HG6KS; vei5T: print "\74\160\x72\x65\x3e" . $content . "\74\x2f\160\x72\145\76"; goto Hfl2A; ht4Db: $content = htmlentities(ob_get_contents()); goto EcVh3; EcVh3: ob_end_clean(); goto vei5T; kJfan: if (!$object) { goto B2IvN; } goto gpFv4; gpFv4: ob_start(); goto STRcD; HG6KS: CVMsa: goto aCZLi; XXNKc: if (!$this->debug) { goto CVMsa; } goto Q_SuW; aCZLi: } }