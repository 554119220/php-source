<?php
 class SignatureHelper { public function request($accessKeyId, $accessKeySecret, $domain, $params, $security = false) { goto RvwMS; dYd1R: $url = ($security ? "\150\x74\x74\160\163" : "\150\x74\164\160") . "\x3a\x2f\57{$domain}\57\77\x53\151\147\156\141\164\x75\x72\145\75{$signature}{$sortedQueryStringTmp}"; goto JbEWH; xUjVc: $stringToSign = "\x47\x45\x54\x26\x25\62\106\46" . $this->encode(substr($sortedQueryStringTmp, 1)); goto rmeIL; Jio2Y: $signature = $this->encode($sign); goto dYd1R; sLig3: ksort($apiParams); goto DCgAk; QdD_P: K2qD3: goto xUjVc; rmeIL: $sign = base64_encode(hash_hmac("\x73\150\141\x31", $stringToSign, $accessKeySecret . "\x26", true)); goto Jio2Y; JbEWH: try { $content = $this->fetchContent($url); return json_decode($content); } catch (\Exception $e) { return false; } goto OwhYO; RvwMS: $apiParams = array_merge(array("\x53\x69\x67\x6e\x61\x74\x75\162\x65\x4d\x65\164\x68\157\144" => "\x48\115\101\x43\x2d\123\110\x41\61", "\123\151\147\156\141\x74\x75\x72\x65\116\x6f\x6e\x63\x65" => uniqid(mt_rand(0, 0xffff), true), "\x53\x69\147\x6e\141\x74\x75\x72\145\126\x65\x72\x73\151\x6f\x6e" => "\61\56\60", "\x41\143\143\145\x73\163\x4b\145\171\x49\x64" => $accessKeyId, "\x54\151\155\x65\x73\x74\141\x6d\x70" => gmdate("\x59\x2d\155\x2d\144\x5c\124\110\72\151\72\163\x5c\x5a"), "\x46\157\162\x6d\141\164" => "\112\123\117\x4e"), $params); goto sLig3; h6rjJ: foreach ($apiParams as $key => $value) { $sortedQueryStringTmp .= "\46" . $this->encode($key) . "\75" . $this->encode($value); uyZ17: } goto QdD_P; DCgAk: $sortedQueryStringTmp = ''; goto h6rjJ; OwhYO: } private function encode($str) { goto GTaiv; oWAgD: return $res; goto yDKH0; mebBO: $res = preg_replace("\57\x5c\x2b\x2f", "\45\x32\x30", $res); goto VB0Rr; VB0Rr: $res = preg_replace("\x2f\134\x2a\x2f", "\x25\62\x41", $res); goto xokGm; GTaiv: $res = urlencode($str); goto mebBO; xokGm: $res = preg_replace("\x2f\45\67\x45\57", "\176", $res); goto oWAgD; yDKH0: } private function fetchContent($url) { goto Gdns4; d9N_n: curl_setopt($ch, CURLOPT_URL, $url); goto CzDhE; UOLpi: return $rtn; goto SAzRv; yu6la: FfWnp: goto n8IxR; cAtMt: if (!(substr($url, 0, 5) == "\x68\x74\164\x70\x73")) { goto FfWnp; } goto YVfSk; n8IxR: $rtn = curl_exec($ch); goto bR1Qz; TWTLi: trigger_error("\x5b\x43\x55\x52\114\137" . curl_errno($ch) . "\x5d\72\40" . curl_error($ch), E_USER_ERROR); goto u7pMN; RCoh0: curl_close($ch); goto UOLpi; YVfSk: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto wnRel; Ubh5O: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto NqW8a; CzDhE: curl_setopt($ch, CURLOPT_TIMEOUT, 5); goto Ubh5O; Gdns4: $ch = curl_init(); goto d9N_n; NqW8a: curl_setopt($ch, CURLOPT_HTTPHEADER, array("\x78\x2d\163\144\153\55\143\x6c\151\145\x6e\x74" => "\x70\x68\160\57\x32\56\x30\56\60")); goto cAtMt; bR1Qz: if (!($rtn === false)) { goto Bkqja; } goto TWTLi; wnRel: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); goto yu6la; u7pMN: Bkqja: goto RCoh0; SAzRv: } }