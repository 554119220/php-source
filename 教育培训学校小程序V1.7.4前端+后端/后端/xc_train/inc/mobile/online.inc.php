<?php
 goto h2pCx; fcnlU: if (!$config) { goto math6; } goto hGjLO; QVFcH: $token = ''; goto RZgrT; Bpwia: load()->func("\154\157\x67\x67\151\x6e\147"); goto K_TwG; RTBga: $token = $config["\143\x6f\156\164\x65\156\164"]["\164\157\153\145\x6e"]; goto sWKXd; RZgrT: $config = pdo_get("\x78\x63\137\x74\x72\x61\x69\x6e\x5f\x63\157\x6e\x66\151\x67", array("\x78\153\x65\171" => "\157\156\154\151\x6e\x65", "\165\x6e\151\x61\143\x69\144" => $uniacid)); goto fcnlU; sjrd7: math6: goto ZWSGv; sWKXd: Qfa03: goto sjrd7; P5Tge: if (!(!empty($config["\143\157\x6e\x74\x65\x6e\164"]) && !empty($config["\x63\157\156\164\x65\156\x74"]["\164\x6f\153\x65\156"]))) { goto Qfa03; } goto RTBga; hGjLO: $config["\x63\157\156\164\x65\x6e\x74"] = json_decode($config["\143\157\156\x74\x65\156\164"], true); goto P5Tge; K_TwG: class Online { public $token, $uniacid; public function __construct($token, $uniacid, $appid) { goto rFIOH; rT54A: $this->appid = $appid; goto t3ld2; SxRNv: $this->uniacid = $uniacid; goto rT54A; rFIOH: $this->token = $token; goto SxRNv; t3ld2: } public function check_server() { goto JLcnQ; MnpP3: goto urzht; goto Cqw09; xWE7V: urzht: goto uaGh3; hp4QP: $this->responseMsg(); goto MnpP3; Cqw09: jp8_m: goto UD9C9; UD9C9: $this->valid(); goto xWE7V; JLcnQ: if (isset($_GET["\145\143\150\157\x73\x74\162"])) { goto jp8_m; } goto hp4QP; uaGh3: } public function valid() { goto UkGod; NHMdZ: echo $echoStr; goto h80JN; t892S: goto rcJYA; goto bXeHM; oGxID: echo $echoStr . "\53\53\53" . $this->token; goto QPbA5; m1WXh: if ($this->checkSignature()) { goto fOHcK; } goto oGxID; o7z0p: header("\143\157\156\164\145\156\x74\55\x74\x79\x70\145\x3a\x74\x65\170\164"); goto NHMdZ; bXeHM: fOHcK: goto o7z0p; h80JN: exit; goto cHtZ2; cHtZ2: rcJYA: goto Rmxkh; UkGod: $echoStr = $_GET["\145\143\150\x6f\x73\164\162"]; goto m1WXh; QPbA5: exit; goto t892S; Rmxkh: } private function checkSignature() { goto m2YdI; jmtyu: $tmpStr = implode($tmpArr); goto wvrX4; KzqGy: return true; goto PoyuU; PoyuU: Q2ssk: goto feJlx; K7uNd: return false; goto zSKJn; wvrX4: $tmpStr = sha1($tmpStr); goto E15Sk; jw09B: $timestamp = $_GET["\x74\x69\155\145\163\164\141\155\160"]; goto MuvX3; zSKJn: goto Q2ssk; goto ZDvZS; MuvX3: $nonce = $_GET["\156\x6f\x6e\143\x65"]; goto fI4Lo; mradP: sort($tmpArr, SORT_STRING); goto jmtyu; m2YdI: $signature = $_GET["\163\x69\147\x6e\x61\x74\x75\162\x65"]; goto jw09B; E15Sk: if ($tmpStr == $signature) { goto Z_z8p; } goto K7uNd; ZDvZS: Z_z8p: goto KzqGy; KfDKJ: $tmpArr = array($token, $timestamp, $nonce); goto mradP; fI4Lo: $token = $this->token; goto KfDKJ; feJlx: } public function responseMsg() { goto RW4Q0; jhKzs: mDUGj: goto bAYsY; RW4Q0: $postStr = $GLOBALS["\x48\124\124\x50\137\122\x41\127\x5f\x50\x4f\123\124\x5f\104\x41\124\101"]; goto t3y05; DTXaX: echo ''; goto caTrm; abOh9: goto O26CM; goto Raq4v; ly1Ms: goto O26CM; goto jhKzs; QRw_G: $data["\164\171\x70\145"] = 1; goto wOaAE; Fh5_w: exit; goto o8hj8; RHB_Y: qiUqR: goto og1V1; caTrm: exit; goto j20Sh; kV6I3: $data["\165\156\x69\x61\x63\151\x64"] = $this->uniacid; goto dGNNv; GUKDL: goto O26CM; goto D61fp; QXrtP: $this->checkOnline($data); goto ly1Ms; l94to: $data["\x6f\160\x65\x6e\151\144"] = $postArr["\x46\162\157\x6d\125\x73\145\x72\x4e\141\155\145"]; goto dVZRH; bAYsY: O26CM: goto pwLve; t3y05: if (!empty($postStr) && is_string($postStr)) { goto qiUqR; } goto DTXaX; QCMnu: if (!empty($postArr["\x4d\x73\x67\x54\171\x70\145"]) && $postArr["\115\x73\147\124\x79\x70\145"] == "\x69\155\x61\147\145") { goto iWBuw; } goto DWTw3; j20Sh: goto G7uSM; goto RHB_Y; risFr: $data["\x75\x6e\151\x61\143\x69\144"] = $this->uniacid; goto l94to; wOaAE: $data["\143\157\x6e\164\145\156\164"] = base64_encode($postArr["\103\x6f\156\x74\x65\156\164"]); goto PWqmX; dGNNv: $data["\157\160\145\x6e\x69\144"] = $postArr["\x46\x72\x6f\x6d\x55\x73\x65\162\x4e\x61\x6d\145"]; goto QRw_G; pwLve: echo "\163\x75\143\x63\x65\x73\x73"; goto Fh5_w; Raq4v: km3LK: goto kV6I3; b9X2i: if (!empty($postArr["\x4d\163\147\x54\x79\160\145"]) && $postArr["\x4d\163\x67\124\x79\x70\145"] == "\164\145\x78\164") { goto km3LK; } goto QCMnu; o8hj8: G7uSM: goto d3oTv; DWTw3: if ($postArr["\x4d\163\147\124\171\160\145"] == "\145\x76\x65\156\164" && $postArr["\x45\166\145\156\x74"] == "\165\x73\x65\x72\137\145\156\x74\x65\x72\137\164\x65\155\160\x73\x65\x73\163\151\157\156") { goto mDUGj; } goto abOh9; Z8C9J: $data["\143\x6f\156\164\145\x6e\164"] = $postArr["\x50\x69\x63\125\162\x6c"]; goto QXrtP; og1V1: $postArr = json_decode($postStr, true); goto b9X2i; PWqmX: $this->checkOnline($data); goto GUKDL; D61fp: iWBuw: goto risFr; dVZRH: $data["\164\x79\x70\145"] = 2; goto Z8C9J; d3oTv: } public function checkOnline($data) { goto sv5yA; Gz3vu: $data["\160\x69\144"] = pdo_insertid(); goto r81Yn; GmuWa: goto Ao1KI; goto xiHvG; hMsej: gVhPq: goto RfkPY; GY6Vy: $prev = pdo_getall("\x78\x63\x5f\x74\162\141\151\x6e\137\x6f\x6e\x6c\151\156\145\137\x6c\x6f\147", array("\x75\x6e\x69\141\143\x69\144" => $data["\x75\156\x69\141\x63\151\x64"], "\x70\x69\144" => $data["\160\151\144"], "\x64\x75\164\x79" => 2), array(), '', "\x63\x72\145\141\164\145\x74\151\x6d\x65\40\x44\105\123\103\54\151\x64\40\x44\105\123\103", array(1, 5)); goto kWWfv; vxQeW: $this->sendMon($data); goto hMsej; sKx2R: if ($online) { goto vaTeN; } goto eUg0R; Mw0as: $data["\160\x69\x64"] = $online["\151\144"]; goto qfHMi; hdFbZ: $config = pdo_get("\x78\x63\x5f\164\162\141\151\x6e\137\x63\x6f\156\x66\151\147", array("\170\153\145\x79" => "\x6f\x6e\154\x69\156\x65", "\165\156\x69\x61\x63\151\x64" => $this->uniacid)); goto zhvWf; sv5yA: $online = pdo_get("\x78\x63\137\164\x72\x61\x69\x6e\137\x6f\156\x6c\151\156\x65", array("\x75\x6e\x69\x61\143\x69\x64" => $data["\x75\156\x69\x61\x63\x69\x64"], "\x6f\160\x65\156\151\144" => $data["\157\x70\x65\156\151\144"])); goto sKx2R; pz6FK: $sql = "\125\120\104\101\x54\105\x20" . tablename("\x78\x63\137\x74\162\x61\151\x6e\137\x6f\x6e\x6c\x69\156\x65") . "\x20\x53\105\x54\x20\x6d\x65\155\x62\145\162\x3d\155\x65\155\142\145\162\x2b\x31\x2c\165\160\144\x61\x74\x65\x74\151\x6d\145\x3d\72\x74\x69\x6d\145\163\54\x74\171\x70\x65\x3d\72\x74\x79\160\145\54\x63\x6f\156\164\x65\x6e\164\75\72\x63\x6f\x6e\164\x65\156\x74\40\x57\110\x45\122\x45\x20\x69\144\75\72\x69\144\40\x41\116\104\x20\x75\x6e\151\141\x63\x69\x64\75\72\165\156\151\141\143\x69\x64"; goto Uwmd6; ksegV: if (!(time() - strtotime($prev[0]["\x63\x72\x65\x61\x74\145\164\x69\x6d\x65"]) >= intval($config["\143\157\156\x74\x65\x6e\x74"]["\152\151\141\156\147\x65"]))) { goto gVhPq; } goto vxQeW; zhvWf: if (!$config) { goto SAsZX; } goto Rodz4; kWWfv: if ($prev) { goto s9Fzl; } goto JG9Yb; r81Yn: pdo_insert("\x78\143\137\164\162\141\151\x6e\137\x6f\x6e\154\x69\x6e\145\x5f\154\157\x67", $data); goto CRz12; Rodz4: $config["\143\x6f\x6e\164\x65\x6e\x74"] = json_decode($config["\x63\157\x6e\x74\145\156\164"], true); goto Lps3u; hzZXX: riR2z: goto S4UMd; K4N0K: x9Zsm: goto dOHw3; Lps3u: if (empty($config["\x63\157\x6e\164\145\156\x74"]["\x6a\151\x61\156\147\145"])) { goto egB1F; } goto ksegV; xiHvG: s9Fzl: goto hdFbZ; RfkPY: egB1F: goto QUsVS; dOHw3: goto riR2z; goto j66jm; JG9Yb: $this->sendMon($data); goto GmuWa; U54Ou: Ao1KI: goto UDLQx; YwEFP: if (!$request) { goto mrNhm; } goto pz6FK; QUsVS: SAsZX: goto U54Ou; UDLQx: mrNhm: goto hzZXX; BETRI: if (!$request) { goto x9Zsm; } goto Gz3vu; Uwmd6: pdo_query($sql, array("\x3a\164\151\x6d\145\163" => date("\131\x2d\155\55\x64\40\x48\72\x69\72\163"), "\x3a\x69\x64" => $online["\x69\x64"], "\x3a\x75\156\151\141\x63\151\x64" => $data["\165\x6e\x69\x61\x63\x69\x64"], "\x3a\164\171\x70\145" => $data["\x74\171\160\x65"], "\72\x63\x6f\x6e\164\145\x6e\x74" => $data["\143\x6f\x6e\x74\145\x6e\164"])); goto GY6Vy; qfHMi: $request = pdo_insert("\x78\143\137\x74\x72\141\151\156\137\x6f\156\154\x69\156\x65\x5f\x6c\x6f\147", $data); goto YwEFP; CRz12: $this->sendMon($data); goto K4N0K; eUg0R: $request = pdo_insert("\170\x63\137\x74\162\141\151\x6e\x5f\157\156\x6c\x69\156\x65", array("\x75\x6e\x69\x61\x63\151\144" => $data["\x75\x6e\151\x61\x63\151\144"], "\x6f\160\145\x6e\151\144" => $data["\x6f\x70\145\x6e\x69\144"], "\x6d\145\155\142\x65\162" => 1, "\165\160\x64\141\x74\x65\x74\151\155\145" => date("\131\x2d\155\55\x64\x20\x48\x3a\x69\x3a\x73"), "\x74\171\x70\145" => $data["\164\171\x70\x65"], "\143\157\156\164\145\x6e\164" => $data["\x63\157\x6e\x74\145\156\164"])); goto BETRI; j66jm: vaTeN: goto Mw0as; S4UMd: } public function sendMon($data) { goto HDIIC; gVEeI: h9Qwe: goto zNrfL; geMtH: $accessurl = $web["\143\x6f\156\x74\x65\x6e\x74"]["\x78\143\155\145\163\163\x61\147\145"] . "\x26\x6f\x70\75\163\x65\156\x64\166\62"; goto EBtLr; rk1Np: $config = pdo_get("\170\143\137\164\162\141\x69\x6e\x5f\143\157\x6e\x66\x69\x67", array("\170\x6b\145\x79" => "\157\156\x6c\x69\156\x65", "\x75\156\x69\141\143\151\x64" => $this->uniacid)); goto o9CbN; IZdqu: $postFields = json_encode($data, JSON_UNESCAPED_UNICODE); goto Ly8T4; d_CCd: W39w0: goto fWMow; q8d7E: $web = pdo_get("\170\x63\x5f\x74\x72\x61\x69\x6e\137\143\x6f\156\x66\151\x67", array("\170\x6b\x65\171" => "\x77\x65\142", "\x75\156\x69\141\x63\151\x64" => $data["\165\156\x69\x61\143\x69\x64"])); goto m2ZQM; Z1wDb: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto waOea; yzgiu: curl_setopt($ch, CURLOPT_URL, $url); goto Jc_Ro; HDIIC: $templateParam = array("\167\x65\142\x6e\x61\x6d\x65\x78" => "\xe6\227\xa0", "\156\x69\x63\153" => "\xe6\227\240", "\143\157\x6e\x74\145\156\x74" => "\xe6\x97\xa0", "\x61\x70\x70\151\144" => $this->appid, "\160\141\x67\x65" => "\170\x63\137\x74\x72\x61\151\x6e\x2f\160\141\x67\x65\x73\57\142\x61\163\145\57\142\x61\163\x65\x3f\46\x73\150\141\x72\145\x3d\x2e\56\x2f\x6f\156\154\151\x6e\x65\x2f\151\x6e\x64\x65\x78"); goto rk1Np; scQ1m: curl_setopt($ch, CURLOPT_POSTFIELDS, $postFields); goto C5Fm3; fWMow: $web = pdo_get("\170\143\x5f\x74\x72\141\x69\156\x5f\x63\x6f\156\146\x69\147", array("\170\x6b\x65\x79" => "\167\x65\142", "\165\156\x69\x61\143\151\x64" => $this->uniacid)); goto Z_Lqf; sxjpa: if (!($data["\x74\171\160\145"] == 2)) { goto WAG9C; } goto npZzb; Ypf0M: if (!($userinfo && !empty($userinfo["\156\x69\143\153"]))) { goto gImDk; } goto P14Me; KGKQG: jX23g: goto YZtat; RJfHs: $account_api = WeAccount::create(); goto XE6Df; npZzb: $templateParam["\143\x6f\156\x74\x65\x6e\x74"] = "\345\233\276\xe7\x89\207"; goto kWvTr; waOea: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE); goto mtvff; q5yzp: W0nZp: goto geMtH; o9CbN: if (!$config) { goto h9Qwe; } goto OAbKI; fEZTo: diBV1: goto ICnhq; WHzdv: curl_close($ch); goto C43cR; yQnmF: $templateParam["\167\x65\142\x6e\x61\x6d\145\170"] = $web["\143\157\156\164\145\x6e\164"]["\164\151\x74\x6c\x65"]; goto KGKQG; YZtat: ZuhEr: goto FQesv; OAbKI: $config["\x63\x6f\x6e\164\145\x6e\x74"] = json_decode($config["\143\x6f\x6e\164\145\156\164"], true); goto ijFj3; t98od: gImDk: goto eZj3Z; EBtLr: $template = $config["\x63\x6f\156\x74\x65\x6e\164"]["\x78\143"]; goto jjP2K; C5Fm3: $pdata = curl_exec($ch); goto WHzdv; C43cR: Kkfb_: goto YJXJB; Z_Lqf: if (!$web) { goto ZuhEr; } goto MzfgE; Z6U76: $web["\x63\157\x6e\x74\145\x6e\x74"] = json_decode($web["\143\x6f\156\x74\x65\156\x74"], true); goto q5yzp; vpHFg: if (!($config["\143\157\x6e\164\145\x6e\164"]["\162\x65\x70\x6c\171\137\x73\164\x61\x74\165\x73"] == 1 && !empty($config["\143\157\156\164\x65\x6e\x74"]["\x72\x65\x70\154\171\137\143\157\x6e\x74\x65\156\164"]))) { goto Kkfb_; } goto RJfHs; PLFcW: if (!(!empty($web["\x63\157\156\x74\x65\x6e\x74"]) && !empty($web["\x63\x6f\x6e\x74\x65\156\x74"]["\x74\x69\164\154\x65"]))) { goto jX23g; } goto yQnmF; Ly8T4: $ch = curl_init(); goto yzgiu; qv2Mh: $openids = $config["\143\x6f\156\164\145\x6e\x74"]["\165\163\145\x72\154\151\163\164"]; goto s0rrk; YJXJB: zD5yw: goto gVEeI; Jc_Ro: curl_setopt($ch, CURLOPT_HEADER, 0); goto Z1wDb; kWvTr: WAG9C: goto pRu_1; julos: curl_setopt($ch, CURLOPT_POST, true); goto scQ1m; P14Me: $templateParam["\x6e\x69\143\153"] = base64_decode($userinfo["\x6e\151\143\x6b"]); goto t98od; jjP2K: $template["\144\141\164\141"] = $config["\143\x6f\x6e\164\x65\156\164"]["\x64\141\x74\141"]; goto qv2Mh; S3S3Z: $data = array("\164\x6f\165\x73\x65\162" => $data["\x6f\160\x65\x6e\x69\144"], "\x6d\163\x67\164\x79\x70\x65" => "\x74\145\x78\164", "\x74\145\170\x74" => array("\x63\157\x6e\x74\x65\156\x74" => $config["\143\x6f\156\x74\x65\156\x74"]["\162\145\x70\154\171\137\x63\x6f\x6e\x74\145\156\x74"])); goto IZdqu; s0rrk: $sendopenid = array(); goto GCKcO; C32RS: $templateParam["\x63\157\x6e\x74\x65\x6e\164"] = base64_decode($data["\143\x6f\156\164\145\156\164"]); goto fEZTo; mtvff: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE); goto julos; GCKcO: foreach ($openids as $itemopenis) { $sendopenid[] = $itemopenis["\157\160\145\156\x69\x64"]; hUyFl: } goto d_CCd; pcRPG: $url = "\x68\x74\164\x70\163\72\x2f\57\x61\160\x69\x2e\x77\145\151\x78\x69\x6e\x2e\x71\x71\56\143\x6f\x6d\57\x63\147\151\x2d\x62\151\x6e\x2f\x6d\145\163\x73\x61\x67\145\x2f\x63\165\x73\164\x6f\x6d\57\163\x65\156\144\77\141\143\143\145\163\163\x5f\x74\157\x6b\x65\156\75" . $token; goto S3S3Z; f2tq2: K9A1B: goto C32RS; FQesv: $userinfo = pdo_get("\170\x63\137\x74\x72\x61\x69\x6e\x5f\165\163\x65\162\151\x6e\x66\157", array("\x75\x6e\x69\141\143\x69\x64" => $this->uniacid, "\x6f\x70\x65\156\x69\144" => $data["\157\160\x65\156\x69\x64"])); goto Ypf0M; MzfgE: $web["\143\x6f\156\x74\x65\156\x74"] = json_decode($web["\143\157\x6e\x74\x65\x6e\x74"], true); goto PLFcW; eZj3Z: if ($data["\x74\x79\x70\145"] == 1) { goto K9A1B; } goto sxjpa; m2ZQM: if (!$web) { goto W0nZp; } goto Z6U76; pRu_1: goto diBV1; goto f2tq2; ICnhq: momessv2($accessurl, $template, $sendopenid, $templateParam); goto vpHFg; XE6Df: $token = $account_api->getAccessToken(); goto pcRPG; ijFj3: if (empty($config["\x63\157\156\164\145\156\164"])) { goto zD5yw; } goto q8d7E; zNrfL: } } goto QVFcH; ZWSGv: $online = new Online($token, $uniacid, $_W["\141\143\x63\157\x75\x6e\x74"]["\x6b\x65\171"]); goto ryrQk; wNpw7: $uniacid = $_W["\x75\x6e\151\141\x63\x69\x64"]; goto Bpwia; h2pCx: global $_W, $_GPC; goto wNpw7; ryrQk: $online->check_server();