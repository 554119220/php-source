(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-mainPages-login-login"],{"19f8":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,"uni-page-body[data-v-c12f6b9e]{background:#fff;font-size:%?32?%}.container[data-v-c12f6b9e]{padding:0 %?60?%}.wechatapp[data-v-c12f6b9e]{padding:15% 0 10%;border-bottom:%?1?% solid #e3e3e3;margin-bottom:%?45?%;text-align:center}.wechatapp .header[data-v-c12f6b9e]{margin:0 auto}.wechatapp .header .app-name[data-v-c12f6b9e]{margin-top:%?30?%}.wechatapp .header uni-image[data-v-c12f6b9e]{width:%?100?%;height:%?100?%;margin:0 auto;display:block;-webkit-border-radius:50%;border-radius:50%;border:2px solid #fff;-webkit-box-shadow:1px 0 5px rgba(50,50,50,.3);box-shadow:1px 0 5px rgba(50,50,50,.3);background-size:100% 100%}.auth-title[data-v-c12f6b9e]{color:#585858;font-size:%?28?%;margin-bottom:%?40?%}.auth-subtitle[data-v-c12f6b9e]{color:#999;margin-bottom:%?72?%;font-size:%?22?%}.login-btn[data-v-c12f6b9e]{border:none;height:%?80?%;line-height:%?80?%;background:#ffd940;color:#333;font-size:10pt;-webkit-border-radius:%?6?%;border-radius:%?6?%}.login-btn[data-v-c12f6b9e]:after{display:none}.login-btn.button-hover[data-v-c12f6b9e]{-webkit-box-shadow:inset 0 %?5?% %?30?% rgba(0,0,0,.15);box-shadow:inset 0 %?5?% %?30?% rgba(0,0,0,.15)}body.?%PAGE?%[data-v-c12f6b9e]{background:#fff}",""])},"47a1":function(e,t,n){"use strict";n.r(t);var a=n("e1ca"),o=n("77ac");for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n("9edf");var r=n("2877"),u=Object(r["a"])(o["default"],a["a"],a["b"],!1,null,"c12f6b9e",null);t["default"]=u.exports},"77ac":function(e,t,n){"use strict";n.r(t);var a=n("8deb"),o=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,function(){return a[e]})}(i);t["default"]=o.a},"829d":function(e,t,n){var a=n("19f8");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var o=n("4f06").default;o("7f07b4d3",a,!0,{sourceMap:!1,shadowMode:!1})},"8deb":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("6c98"));function o(e){return e&&e.__esModule?e:{default:e}}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){r(e,t,n[t])})}return e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u={data:function(){return{}},components:{},computed:{},onLoad:function(e){},onShow:function(){},mounted:function(){},methods:{authorLogin:function(e){var t=this,n=t.$store.state.clientType;if("2"===n&&"getUserInfo:ok"!==e.detail.errMsg)return a.default.showError("登录失败,请重试"),!1;uni.getProvider({service:"oauth",success:function(n){t.userLogin(n.provider[0],e.detail)}})},getLoginData:function(e,t){return new Promise(function(n,a){t.iv&&t.encryptedData?n(t):uni.getUserInfo({provider:e,withCredentials:!0,complete:function(t){console.log(t),t.iv||"alipay"===e?(!t.encryptedData&&t.data&&(t.encryptedData=t.data),n(t)):a()}})})},userLogin:function(e,t){var n=this,o=n.$store.state.clientType,i={};uni.showLoading({title:"正在登录"}),uni.login({provider:e,scopes:"auth_user",success:function(r){i.code=r.code,n.getLoginData(e,t).then(function(e){"7"!==o&&(i=Object.assign(i,{user_info:e.rawData||"",encrypted_data:e.encryptedData,iv:e.iv,signature:e.signature||""})),"7"===o&&(i=Object.assign(i,{nickName:e.userInfo.nickName||"",avatarUrl:e.userInfo.avatarUrl})),n.getUserInfo(i)}).catch(function(){"9"===o?uni.showModal({title:"登录失败",content:"请点击确定允许授权后,重新登录",success:function(e){e.confirm&&uni.openSetting({success:function(e){e.authSetting["scope.userInfo"]&&a.default.showError("授权成功,请重新登录")}})}}):a.default.showError("登录失败,请重试")})}})},getUserInfo:function(e){var t=this;a.default._post_form("user/login",i({},e,{referee_id:t.$store.state.refereeId}),function(e){t.$store.commit("userInfo",e.data.status),uni.setStorageSync("token",e.data.token),uni.setStorageSync("user_id",e.data.user_id),t.globalSaveRefereeId&&a.default.saveRefereeQuest(),t.$store.commit("iswrite",e.data.status.status),t.navigateBack()},!1,function(){uni.hideLoading()})},navigateBack:function(){var e=getCurrentPages(),t=e[e.length-2],n=uni.getStorageSync("currentPage").options;t.onLoad(n),uni.navigateBack(),uni.removeStorageSync("currentPage")}}};t.default=u},"9edf":function(e,t,n){"use strict";var a=n("829d"),o=n.n(a);o.a},e1ca:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"container"},[n("v-uni-view",{staticClass:"wechatapp"},[n("v-uni-view",{staticClass:"header"},[n("v-uni-image",{attrs:{src:e.appLogo}}),n("v-uni-view",{staticClass:"app-name t-c f-26 col-3"},[e._v(e._s(e.appName))])],1)],1),n("v-uni-view",{staticClass:"auth-title"},[e._v("申请获取以下权限:")]),n("v-uni-view",{staticClass:"auth-subtitle"},[e._v("• 获得你的公开信息（昵称、头像等）")]),n("v-uni-button",{staticClass:"login-btn",on:{click:function(t){t=e.$handleEvent(t),e.authorLogin(t)}}},[e._v("授权登录")])],1)},o=[];n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o})}}]);