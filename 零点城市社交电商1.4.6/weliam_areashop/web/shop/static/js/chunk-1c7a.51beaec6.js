(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1c7a"],{"/6To":function(t,e,a){},"5PuH":function(t,e,a){"use strict";var o=a("ryhr");a.n(o).a},BdN4:function(t,e,a){"use strict";var o=a("/6To");a.n(o).a},GILk:function(t,e,a){"use strict";a.r(e);var o=a("XYSW"),l=a("vooH"),r=a("slWK"),i=a("UC6z"),s={mixins:i.a.getters("ChooseCoupon"),initData:{model:"display"}},n=a("7Qib"),c={mixins:[s.mixins,i.a.getters("Table")],props:{defaultConfig:{type:Object,default:function(){return s}}},components:{couponRender:{template:'<span><slot name="title"></slot><span class="text-danger"><slot name="price"></slot></span><slot name="tail"></slot></span>'}},data:function(){return{coupon_price:{10:{textRule:"满",textPrev:"减免",textLast:"元"},20:{textRule:"满",textPrev:"打",textLast:"折"},30:{textRule:"满",textPrev:"减免",textLast:"元"},40:{textRule:"满",textPrev:"范围内随机",textLast:"元"}},defaultProps:{children:"child",label:"name"},displayData:[],menuData:[{couponType:"0",name:"全部",child:[]},{couponType:"10",name:"满减券",child:[]},{couponType:"20",name:"折扣券",child:[]},{couponType:"30",name:"运费券",child:[]},{couponType:"40",name:"随机券",child:[]}],currentRow:[],closable:!0,dialogTableVisible:!1,tableFormatData:{current:"userTable",userTable:{key:"userTable",api:{getList:r.l},tableData:[],files:{couponType:0,name:"",ids:[],checkall:"0",category_id:""},pagination:{page:1,list_rows:10,pagesizes:[10,20,50],total:0}}}}},computed:{},methods:{hasDisabled:function(t,e){var a=!1,o=this.config.disabled;return Array.isArray(o)&&o.length>0&&o.map(function(e){var o=e.reverse?t[""+e.label]!==e.value:t[""+e.label]===e.value;return o&&(a=!0),!o}),!a},deleteTable:function(t){this.displayData.splice(t.$index,1),this.currentRow.splice(t.$index,1)},toggleSelection:function(t,e){var a=this;t?t.forEach(function(t){a.$refs.multipleTable.toggleRowSelection(t)}):this.$refs.multipleTable.clearSelection(),this.displayData.splice(e.$index,1),this.currentRow.splice(e.$index,1)},selectChange:function(t,e){if(this.currentRow.includes(e.coupon_id)){var a=this.displayData.findIndex(function(t){return t.coupon_id===e.coupon_id});this.displayData.splice(a,1)}else this.displayData.push(e);this.currentRow=Object(n.tooggleArray)(this.currentRow,e.coupon_id)},selectAll:function(t){var e=this;t.length>0?t.map(function(t,a){e.currentRow.includes(t.coupon_id)||(e.currentRow.push(t.coupon_id),e.displayData.push(t))}):(this.displayData=[],this.currentRow=[])},toggle:function(){this.dialogTableVisible=!this.dialogTableVisible},saveChoose:function(){this.toggle(),this.output()},handleNodeClick:function(t){this.tableFormatData.userTable.files.couponType=t.couponType,this.filesSerch()},clearData:function(){"display"===this.config.model&&(this.$refs.multipleTable.clearSelection(),this.currentRow=[],this.displayData=[])},output:function(){"[object Function]"===Object.prototype.toString.call(this.changeEvt)&&this.changeEvt({currentRow:this.currentRow,displayData:this.displayData,key:"ChooseCoupon"},this.updateConfig.bindKey)}}},u=(a("BdN4"),a("KHd+")),m=Object(u.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"choose-userlist"},[a("el-dialog",{attrs:{"custom-class":"wlm-form-dialog dialog-table",visible:t.dialogTableVisible,width:"45%"},on:{"update:visible":function(e){t.dialogTableVisible=e},close:t.clearData}},[a("div",{staticClass:"wlm-dialog-fixheader"},[a("span",{staticClass:"wlm-dialog-inlenr"},[t._v("选择商品")])]),t._v(" "),a("div",{staticClass:"wlm-table-content"},[a("div",{staticClass:"wlm-dialog-main"},[a("div",{staticClass:"flex-row"},[a("el-scrollbar",[a("div",{staticClass:"goods-menu"},[a("el-tree",{attrs:{data:t.menuData,props:t.defaultProps,accordion:""},on:{"node-click":t.handleNodeClick}})],1)]),t._v(" "),a("el-scrollbar",{staticStyle:{width:"100%",height:"520px","max-height":"520px"}},[a("div",{staticClass:"goods-list-box"},[a("div",{staticClass:"goods-serch"},[a("el-input",{attrs:{placeholder:"搜索优惠券名称"},model:{value:t.tableFormatData.userTable.files.name,callback:function(e){t.$set(t.tableFormatData.userTable.files,"name",e)},expression:"tableFormatData.userTable.files.name"}}),a("i",{staticClass:"el-icon-search pos-col-center",on:{click:t.filesSerch}})],1),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableFormatData.userTable.tableData},on:{"select-all":t.selectAll,select:t.selectChange}},[a("el-table-column",{attrs:{selectable:t.hasDisabled,type:"selection",width:"30"}}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"优惠券名称",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"满足条件",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[a("couponRender",[e.row.coupon_type?a("template",{slot:"title"},[t._v("\r\n                                                        "+t._s((0===e.row.rule?""+t.coupon_price[""+e.row.coupon_type].textRule+e.row.rule_min_money+"元":"")+" "+t.coupon_price[""+e.row.coupon_type].textPrev)+"\r\n                                                    ")]):t._e(),t._v(" "),a("template",{slot:"price"},[t._v("\r\n                                                        "+t._s(40===e.row.coupon_type?e.row.min+" - "+e.row.max:20===e.row.coupon_type?e.row.discount:e.row.reduce_price)+"\r\n                                                    ")]),t._v(" "),e.row.coupon_type?a("template",{slot:"tail"},[t._v("\r\n                                                        "+t._s(t.coupon_price[""+e.row.coupon_type].textLast)+"\r\n                                                    ")]):t._e()],2)],1),t._v(" "),a("div",{staticClass:"wlm-table-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("couponRender",[e.row.coupon_type?a("template",{slot:"title"},[t._v("\r\n                                                        "+t._s((0===e.row.rule?""+t.coupon_price[""+e.row.coupon_type].textRule+e.row.rule_min_money+"元":"")+" "+t.coupon_price[""+e.row.coupon_type].textPrev)+"\r\n                                                    ")]):t._e(),t._v(" "),a("template",{slot:"price"},[t._v("\r\n                                                        "+t._s(40===e.row.coupon_type?e.row.min+" - "+e.row.max:20===e.row.coupon_type?e.row.discount:e.row.reduce_price)+"\r\n                                                    ")]),t._v(" "),e.row.coupon_type?a("template",{slot:"tail"},[t._v("\r\n                                                        "+t._s(t.coupon_price[""+e.row.coupon_type].textLast)+"\r\n                                                    ")]):t._e()],2)],1)])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"总数/已领取",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.total_num+"/"+e.row.receive_num))])]}}])})],1)],1)])],1)])]),t._v(" "),a("div",{staticClass:"pagination-content flex-row flex-justify-b flex-align-c"},[a("el-row",{staticClass:"pagination-btns"}),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"20px","margin-bottom":"20px","margin-right":"25px"},attrs:{disabled:!t.hasTableData,"current-page":t.tableFormatData.userTable.pagination.page,"page-sizes":t.tableFormatData.userTable.pagination.pagesizes,"page-size":t.tableFormatData.userTable.pagination.list_rows,layout:"total, sizes, prev, pager, next, jumper",total:t.hasTableData.length>0?t.tableFormatData.userTable.pagination.total:0},on:{"size-change":t.listPageChange,"current-change":t.listPageChange,"update:currentPage":function(e){t.$set(t.tableFormatData.userTable.pagination,"page",e)},"update:pageSize":function(e){t.$set(t.tableFormatData.userTable.pagination,"list_rows",e)}}})],1),t._v(" "),a("div",{staticClass:"wlm-dialog-fixfooter"},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:t.toggle}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.saveChoose}},[t._v("确 定")])],1)])])],1)},[],!1,null,"d2641cc8",null);m.options.__file="index.vue";var p=m.exports,f=a("YU0t"),d=a("Y/SO"),_={mixins:[i.a.getters("Form")],name:"ManagementUserAdd",components:{ChooseFiles:o.a,ChooseCategories:f.a,ueditor:d.a,ChooseGoods:l.a,ChooseCoupon:p,couponRender:{template:'<span><slot name="title"></slot><span class="text-danger"><slot name="price"></slot></span><slot name="tail"></slot></span>'}},directives:{},created:function(){var t=this;this.$nextTick(function(){Object(r.B)().then(function(e){var a=e.data.data,o=void 0===a?[]:a;t.categoryData=o})})},data:function(){return{ueditorList:[],categoryData:[],defaultMsg:"",currentRow:[],couponCurrentRow:[],chooseCategoriesConfig:{type:["chooseCategories"],initList:[],disabled:[{label:"status",value:1,reverse:!0},{label:"get_limit_type",value:1,reverse:!0}],choose_type:"coupon"},chooseGoodsConfig:{type:["chooseGoods"],model:"normal",initList:[]},chooseCouponConfig:{type:["chooseCoupon"],model:"display",disabled:[{label:"status",value:1,reverse:!0},{label:"get_limit_type",value:1,reverse:!0}],initList:[]},chooseLogoConfig:{type:["image"],model:"normal",uploadConfig:{limit:1,isMore:!1,model:"normal"},initList:[],file_type:"image",bindKey:{key:"image_first",model:"img"}},chooseQrConfig:{type:["image"],model:"normal",uploadConfig:{limit:1,isMore:!1,model:"normal"},initList:[],file_type:"image",bindKey:{key:"image_second",model:"img"}},formFormatData:{key:["platform","orther"],api:{editForm:{api:r.d,params:{always:!0}},submitForm:r.e},formData:{is_open:"1",image_first:[],image_second:[],number:"",cost:"",content:"",is_cdkey:"2",coupon_count:"1",is_buy:"2",goods:[],coupon:[]},rules:{}}}},mounted:function(){},methods:{serverInfoChange:function(t){this.defaultMsg=t},formFormatCallBack:function(t,e,a){if("editForm"===e){var o=t.content;this.defaultMsg=o}},saveForm:function(){this.formFormatData.formData.content=this.defaultMsg,this.formFormatSubmit()},filtersChange:function(t){var e=this;this.currentRow=t.currentRow,t.displayData.map(function(t){-1===e.formFormatData.formData.goods.findIndex(function(e){return""+e.goods_id==""+t.goods_id})&&e.formFormatData.formData.goods.push({goods_id:t.goods_id,goods_name:t.goods_name,img:t.image[0].file_path})})},filtersCouponChange:function(t){var e=this,a=t.currentRow,o=t.displayData;this.couponCurrentRow=a,o.map(function(t){var a=e.formFormatData.formData.coupon.findIndex(function(e){return""+e.coupon_id==""+t.coupon_id});-1===a&&e.formFormatData.formData.coupon.push({coupon_type:t.coupon_type,name:t.name,total_num:t.total_num,receive_num:t.receive_num,coupon_id:t.coupon_id,coupon_number:t.coupon_number})})},goodsToogle:function(){this.$refs.chooseGoods.currentRow=this.currentRow,this.$refs.chooseGoods.toggle()},couponToogle:function(){this.$refs.chooseCoupon.currentRow=this.couponCurrentRow,this.$refs.chooseCoupon.toggle()},deleteTable:function(t){this.formFormatData.formData.goods.splice(t.$index,1),this.currentRow.splice(t.$index,1)},toggleSelection:function(t){this.formFormatData.formData.coupon.splice(t.$index,1),this.currentRow.splice(t.$index,1)}}},g=(a("5PuH"),Object(u.a)(_,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"vip-setting views-container"},[a("div",{staticClass:"wlm-form"},[a("div",{staticClass:"wlm-form-header"},[t._v("平台信息")]),t._v(" "),a("div",{staticClass:"wlm-form-content"},[a("el-form",{ref:"platform",staticClass:"retail-form",attrs:{model:t.formFormatData.formData,rules:t.formFormatData.rules,size:"small","label-width":"180px","label-position":"right"}},[a("el-form-item",{attrs:{label:"是否开启会员卡"}},[a("el-radio-group",{model:{value:t.formFormatData.formData.is_open,callback:function(e){t.$set(t.formFormatData.formData,"is_open",e)},expression:"formFormatData.formData.is_open"}},[a("el-radio",{attrs:{label:"1"}},[t._v("开启")]),t._v(" "),a("el-radio",{attrs:{label:"2"}},[t._v("关闭")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"开通前背景"}},[a("choose-files",{ref:"chooseFilesBefore",attrs:{config:t.chooseLogoConfig,changeEvt:t.formFormatFiltersChange}}),t._v(" "),t.formFormatData.formData.image_first[0]?a("div",{staticClass:"images-loader img-center",style:{"background-image":"url("+t.formFormatData.formData.image_first[0].file_path+")"}},[a("i",{staticClass:"el-icon-close",on:{click:function(e){t.formFormatData.formData.image_first=[]}}})]):a("div",{staticClass:"flex-row flex-align-c flex-justify-c wlm-update-load",on:{click:function(e){t.$refs.chooseFilesBefore.toggle()}}},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),a("el-form-item",{attrs:{label:"开通后背景"}},[a("choose-files",{ref:"chooseFilesAfter",attrs:{config:t.chooseQrConfig,changeEvt:t.formFormatFiltersChange}}),t._v(" "),t.formFormatData.formData.image_second[0]?a("div",{staticClass:"images-loader img-center",style:{"background-image":"url("+t.formFormatData.formData.image_second[0].file_path+")"}},[a("i",{staticClass:"el-icon-close",on:{click:function(e){t.formFormatData.formData.image_second=[]}}})]):a("div",{staticClass:"flex-row flex-align-c flex-justify-c wlm-update-load",on:{click:function(e){t.$refs.chooseFilesAfter.toggle()}}},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),a("el-form-item",{attrs:{label:"虚拟人数"}},[a("el-input",{attrs:{width:"50"},nativeOn:{input:function(e){t.clearNativeReg(t.formFormatData.formData,"number")}},model:{value:t.formFormatData.formData.number,callback:function(e){t.$set(t.formFormatData.formData,"number","string"==typeof e?e.trim():e)},expression:"formFormatData.formData.number"}},[a("template",{slot:"append"},[t._v("人")])],2),t._v(" "),a("div",{staticClass:"form-help"},[t._v("虚拟人数在用户端展示,用户营造气氛,刺激用户开通会员 "),a("el-button",{attrs:{type:"text"}},[t._v("查看模板")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"虚拟成本"}},[a("el-input",{attrs:{width:"50"},nativeOn:{input:function(e){t.clearNativeReg(t.formFormatData.formData,"cost")}},model:{value:t.formFormatData.formData.cost,callback:function(e){t.$set(t.formFormatData.formData,"cost",e)},expression:"formFormatData.formData.cost"}},[a("template",{slot:"append"},[t._v("元")])],2),t._v(" "),a("div",{staticClass:"form-help"},[t._v("虚拟成本在用户端展示,用户营造气氛,刺激用户开通会员 "),a("el-button",{attrs:{type:"text"}},[t._v("查看模板")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"会员特权"}},[a("ueditor",{ref:"by_know",attrs:{ueditorChange:t.serverInfoChange,ueditorList:t.ueditorList,bindIndex:1,defaultMsg:t.defaultMsg,config:{initialFrameWidth:null,initialFrameHeight:350}}}),t._v(" "),a("div",{staticClass:"form-help"},[t._v("平台服务协议内容我们已为您初始化一套模版，请根据您的需要进行修改使用。原文模版点此下载："),a("el-button",{attrs:{type:"text"}},[t._v("查看模板")])],1)],1)],1)],1)]),t._v(" "),a("div",{staticClass:"wlm-form"},[a("div",{staticClass:"wlm-form-header"},[t._v("其他设置")]),t._v(" "),a("div",{staticClass:"wlm-form-content"},[a("el-form",{ref:"orther",staticClass:"retail-form",attrs:{model:t.formFormatData.formData,rules:t.formFormatData.rules,size:"small","label-width":"180px","label-position":"right"}},[a("el-form-item",{attrs:{label:"是否开启激活码"}},[a("el-radio-group",{model:{value:t.formFormatData.formData.is_cdkey,callback:function(e){t.$set(t.formFormatData.formData,"is_cdkey",e)},expression:"formFormatData.formData.is_cdkey"}},[a("el-radio",{attrs:{label:"1"}},[t._v("开启")]),t._v(" "),a("el-radio",{attrs:{label:"2"}},[t._v("关闭")])],1),t._v(" "),a("div",{staticClass:"form-help"},[t._v("开启激活码后，用户端才展示兑换激活码入口")])],1),t._v(" "),a("el-form-item",{attrs:{label:"会员专属优惠券"}},[a("el-button",{staticStyle:{display:"block",margin:"12px 0"},attrs:{type:"primary"},on:{click:t.couponToogle}},[t._v("添加优惠券")]),t._v(" "),a("choose-coupon",{ref:"chooseCoupon",attrs:{config:t.chooseCouponConfig,changeEvt:t.filtersCouponChange}}),t._v(" "),""!=t.formFormatData.formData.coupon?a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.formFormatData.formData.coupon}},[a("el-table-column",{attrs:{prop:"date",label:"优惠券名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"剩余库存"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(""+(e.row.total_num-e.row.receive_num)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"优惠券个数"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"coupon-num-input"},[a("el-input-number",{staticClass:"coupon-num-input",attrs:{controls:!1,size:"small",min:0,max:Number(e.row.total_num)-Number(e.row.receive_num)},model:{value:e.row.coupon_number,callback:function(a){t.$set(e.row,"coupon_number",a)},expression:"scope.row.coupon_number"}})],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"operation-group"},[a("el-button",{staticClass:"wlm-text",attrs:{type:"text"},on:{click:function(a){t.toggleSelection(e)}}},[t._v("删除")])],1)]}}])})],1):t._e()],1),t._v(" "),a("el-form-item",{attrs:{label:"优惠券领取个数"}},[a("el-radio-group",{model:{value:t.formFormatData.formData.coupon_count,callback:function(e){t.$set(t.formFormatData.formData,"coupon_count",e)},expression:"formFormatData.formData.coupon_count"}},[a("el-radio",{attrs:{label:"1"}},[t._v("1个")]),t._v(" "),a("el-radio",{attrs:{label:"2"}},[t._v("2个")]),t._v(" "),a("el-radio",{attrs:{label:"3"}},[t._v("3个")]),t._v(" "),a("el-radio",{attrs:{label:"all"}},[t._v("不限")])],1),t._v(" "),a("div",{staticClass:"form-help"},[t._v("用户开通会员后，所领取的不同优惠券个数")])],1),t._v(" "),a("el-form-item",{attrs:{label:"购买商品为会员"}},[a("el-radio-group",{model:{value:t.formFormatData.formData.is_buy,callback:function(e){t.$set(t.formFormatData.formData,"is_buy",e)},expression:"formFormatData.formData.is_buy"}},[a("el-radio",{attrs:{label:"1"}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:"2"}},[t._v("否")])],1),t._v(" "),a("choose-goods",{ref:"chooseGoods",attrs:{config:t.chooseGoodsConfig,changeEvt:t.filtersChange}}),t._v(" "),"1"==t.formFormatData.formData.is_buy?a("el-button",{attrs:{type:"primary"},on:{click:t.goodsToogle}},[t._v("添加商品")]):t._e(),t._v(" "),a("div",{staticClass:"form-help",staticStyle:{"margin-bottom":"10px"}},[t._v("用户购买指定的商品后，自动成为相应会员")]),t._v(" "),""!=t.formFormatData.formData.goods&&"1"==t.formFormatData.formData.is_buy?a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.formFormatData.formData.goods}},[a("el-table-column",{attrs:{prop:"date",label:"商品"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"flex-row"},[e.row.img?a("img",{staticClass:"logo",attrs:{src:e.row.img}}):t._e(),t._v(" "),a("div",{staticClass:"inner-text flex-row flex-align-c"},[a("p",[t._v(t._s(e.row.goods_name))])])])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"选择会员卡"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.row.card_id,callback:function(a){t.$set(e.row,"card_id",a)},expression:"scope.row.card_id"}},t._l(t.categoryData,function(t){return a("el-option",{key:t.card_id,attrs:{label:t.card_title,value:""+t.card_id}})}))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"operation-group"},[a("el-button",{staticClass:"wlm-text",attrs:{type:"text"},on:{click:function(a){t.deleteTable(e)}}},[t._v("删除")])],1)]}}])})],1):t._e()],1)],1)],1)]),t._v(" "),a("div",{staticClass:"wlm-fixed-btn flex-row flex-align-c flex-justify-c"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.saveForm}},[t._v("保存")])],1)])},[],!1,null,"caf08dd8",null));g.options.__file="vipSetting.vue";e.default=g.exports},ryhr:function(t,e,a){}}]);