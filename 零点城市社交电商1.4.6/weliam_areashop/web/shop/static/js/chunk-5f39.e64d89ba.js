(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5f39"],{FWIq:function(t,e,a){"use strict";a.r(e);var r=a("m1cH"),n=a.n(r),i=a("slWK"),o=a("UC6z"),l={mixins:o.a.getters("ExportFileIn"),initData:{title:"导入文件",desinfo:"请先导出数据，填好信息，再导入文件即可。",message:{empty:"请先选择要导入的数据文件，格式是csv格式的。",noEmpty:"导入前请先确定文件内是否已填写信息，并且需要一 一对应。否则可能导致数据出错！！！"}}},s={data:function(){return{certfileList:[],multiple:!1,title:"",accept:".csv",uplistIsEmpty:!1,csvloadTableVisible:!1}},mixins:[l.mixins],props:{changeEvt:Function,defaultConfig:{type:Object,default:function(){return l}}},watch:{},computed:{pathUrl:function(){return"/uploadFile"}},mounted:function(){},methods:{toggle:function(){this.certfileList=[],this.csvloadTableVisible=!this.csvloadTableVisible},certRemove:function(t,e){this.certfileList=[]},certbeforeRemove:function(t,e){return this.$confirm("确定移除 "+t.name+"？")},certhandleExceed:function(t,e){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")},certchange:function(t,e){this.certfileList.push(t),this.uplistIsEmpty=e.length>0},certsuccess:function(t,e){0===t.errno?(this.dialogTableVisible=!1,this.clearFiles(),this.loading=!0,this.getTabChangeLitsData("order")):this.$message.error("上传失败，请重试")},importfxxData:function(){var t=this,e=this.uplistIsEmpty,a=this.updateConfig;this.$confirm(""+(e?a.message.noEmpty:a.message.empty),"提示信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=t.config.api;if(e){var a=new FormData;t.certfileList.map(function(t,e){a.append("file",t.raw)}),e(a).then(function(e){var a=e.data,r=a.code,n=a.msg;1===r?(t.$message.success("导入成功"),t.output()):t.$message.error(n),t.toggle()}).catch(function(){t.toggle()})}}).catch(function(){t.$message({type:"warning",message:"已取消"})})},output:function(){"[object Function]"===Object.prototype.toString.call(this.changeEvt)&&this.changeEvt()}}},c=(a("XONK"),a("KHd+")),u=Object(c.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"export-modelbox"},[a("el-dialog",{attrs:{title:"导入文件",width:"40%",visible:t.csvloadTableVisible,"modal-append-to-body":!1},on:{"update:visible":function(e){t.csvloadTableVisible=e}}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-tag",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{type:"warning"}},[t._v(t._s(t.config.desinfo)+" "),t._t("export")],2)],1),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-upload",{ref:"uploadcsv",staticClass:"upload-demo input-with-select fin-min-width",attrs:{action:t.pathUrl,"on-remove":t.certRemove,"before-remove":t.certbeforeRemove,"on-change":t.certchange,multiple:t.multiple,accept:t.accept,"auto-upload":!1,limit:1,"on-success":t.certsuccess,"on-exceed":t.certhandleExceed,"file-list":t.certfileList}},[a("el-input",{staticClass:"upload-file",attrs:{placeholder:"",readonly:"",size:"small"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t._v(" "),a("el-button",{staticStyle:{display:"inline-block","border-radius":"0 4px 4px 0","margin-left":"-5px"},attrs:{size:"small",type:"success",plain:""}},[t._v("点击上传")])],1)],1),t._v(" "),a("el-col",{staticClass:"flex-row flex-align-c flex-justify-c",attrs:{span:24}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.importfxxData}},[t._v("确定")]),t._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(e){t.csvloadTableVisible=!1}}},[t._v("取消")])],1)],1)],1)],1)},[],!1,null,"56fa9904",null);u.options.__file="index.vue";var d=u.exports,f=a("hxQk"),m=a("fGEp"),p={mixins:[o.a.getters("Table"),o.a.getters("Form")],name:"VipUserList",components:{ChooseUser:f.a,ExportFileIn:d},directives:{exceldown:m.a},created:function(){var t=this;this.$nextTick(function(){Object(i.F)().then(function(e){var a=e.data.data,r=void 0===a?[]:a;t.categoryData=r})})},data:function(){return{exportFileInApi:i.C,dialogTableVisible:!1,selecStoreData:[],categoryData:[],blogTitle:"",initChooseUser:{closable:!0,saveList:[]},formFormatData:{key:"user",model:{noCreateEdit:!1,bindDialog:"dialogTableVisible"},api:{editForm:{api:i.v,params:{id:""}},submitForm:i.E},formData:{card_id:"",card_mode:"1",mid:""},rules:{}},tableFormatData:{current:"userTable",userTable:{key:"userTable",model:{bindDialog:"dialogTableVisible"},api:{getList:i.z},tableData:[],files:{card_number:"",card_mode:"",title:"",ids:[],checkall:"0",Recycle:"1"},change:{card_cancel:{key:"card_cancel",api:i.g}},pagination:{page:1,list_rows:10,pagesizes:[10,20,50],total:0}}}}},methods:{formFormatCallBack:function(t,e,a){if("editForm"===e){var r=a.data.data,n=r.user_id,i=r.user.nickName,o=void 0===i?"":i;this.initChooseUser.saveList=[{user_id:n,nickName:o}],this.formFormatData.formData.mid=n}},saveDialogForm:function(){this.initChooseUser.saveList=[],this.resetDialogFormData({card_id:"",mid:"",card_mode:"1"})},userChange:function(t){var e=[].concat(n()(t))[0].user_id;this.formFormatData.formData.mid=e}}},b=Object(c.a)(p,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"vip--user-list views-container"},[a("export-file-in",{ref:"exportFileIn",attrs:{config:{title:"导入会员信息",desinfo:"请先导出会员数据, 填好信息, 再导入文件即可。",api:t.exportFileInApi},changeEvt:t.filesSerch}},[a("el-button",{directives:[{name:"exceldown",rawName:"v-exceldown",value:{path:"addons/weliam_areashop/web/doc/会员导入.csv",isBase:!1},expression:"{path:'addons/weliam_areashop/web/doc/会员导入.csv', isBase: false}"}],attrs:{slot:"export",size:"mini",type:"text"},slot:"export"},[t._v("下载会员模板")])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogTableVisible,"custom-class":"reset-pwd wlm-form-dialog dialog-table"},on:{close:t.saveDialogForm,"update:visible":function(e){t.dialogTableVisible=e}}},[t.dialogTableVisible?a("div",{staticClass:"wlm-form"},[a("div",{staticClass:"wlm-form-header wlm-dialog-fixheader"},[a("span",{staticClass:"wlm-dialog-inlenr"},[t._v(t._s((t.formFormatData.api.editForm.params.id?"编辑":"添加")+"会员"))])]),t._v(" "),a("el-scrollbar",{attrs:{"wrap-class":"scrollbar-wrapper"}},[a("div",{staticClass:"wlm-form-content"},[a("div",{staticClass:"wlm-dialog-main"},[a("div",{staticClass:"wlm-dialog-content"},[a("el-form",{ref:"user",staticClass:"retail-form",attrs:{model:t.formFormatData.formData,rules:t.formFormatData.rules,size:"small","label-width":"120px","label-position":"right"}},[a("el-form-item",{attrs:{label:"用户"}},[a("chooseUser",{ref:"chooseUser",attrs:{config:t.initChooseUser,changeEvt:t.userChange}})],1),t._v(" "),a("el-form-item",{attrs:{label:"会员卡名称"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.formFormatData.formData.card_id,callback:function(e){t.$set(t.formFormatData.formData,"card_id",e)},expression:"formFormatData.formData.card_id"}},t._l(t.categoryData,function(t){return a("el-option",{key:t.card_id,attrs:{label:t.card_title,value:t.card_id}})}))],1)],1)],1)])])])],1):t._e(),t._v(" "),a("footer",{staticClass:"flex-row flex-align-c flex-justify-c wlm-dialog-fixfooter"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.formFormatSubmit}},[t._v("保存")])],1)]),t._v(" "),a("div",{staticClass:"wlm-table"},[a("div",{staticClass:"wlm-table-hearder-btn"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.dialogTableVisible=!0,t.initChooseUser.closable=!0}}},[t._v("添加会员")])],1),t._v(" "),a("div",{staticClass:"wlm-table-header"},[a("el-form",{staticClass:"retail-form",attrs:{model:t.tableFormatData.userTable.files,size:"small","label-width":"95px","label-position":"right"}},[a("el-form-item",{staticClass:"filter",attrs:{label:""}},[a("el-form-item",{attrs:{label:"会员："}},[a("el-input",{staticStyle:{width:"160px"},attrs:{placeholder:"请输入会员昵称或id"},model:{value:t.tableFormatData.userTable.files.title,callback:function(e){t.$set(t.tableFormatData.userTable.files,"title",e)},expression:"tableFormatData.userTable.files.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"会员卡号："}},[a("el-input",{staticStyle:{width:"160px"},attrs:{placeholder:"请输入会员卡号"},model:{value:t.tableFormatData.userTable.files.card_number,callback:function(e){t.$set(t.tableFormatData.userTable.files,"card_number",e)},expression:"tableFormatData.userTable.files.card_number"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开卡方式："}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.tableFormatData.userTable.files.card_mode,callback:function(e){t.$set(t.tableFormatData.userTable.files,"card_mode",e)},expression:"tableFormatData.userTable.files.card_mode"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{attrs:{label:"平台添加",value:1}}),t._v(" "),a("el-option",{attrs:{label:"用户购买",value:2}}),t._v(" "),a("el-option",{attrs:{label:"激活码兑换",value:3}}),t._v(" "),a("el-option",{attrs:{label:"购买商品",value:4}})],1)],1)],1),t._v(" "),a("el-form-item",{staticClass:"filter-btns",attrs:{label:""}},[a("el-button",{attrs:{type:"primary"},on:{click:t.filesSerch}},[t._v("筛选")]),t._v(" "),a("el-button",{attrs:{plain:""},on:{click:function(e){t.$refs.exportFileIn.toggle()}}},[t._v("导入会员")]),t._v(" "),a("el-button",{directives:[{name:"exceldown",rawName:"v-exceldown",value:{path:"outputMember&",query:{}},expression:"{path:'outputMember&',query: {}}"}],attrs:{plain:"",icon:"document","data-query":JSON.stringify(t.tableFormatData.userTable.files)}},[t._v(t._s(t.$t("excel.export"))+"会员")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:t.filesEmpty}},[t._v("清空筛选条件")])],1)],1)],1),t._v(" "),a("div",{staticClass:"wlm-table-content"},[a("el-table",{ref:t.tableFormatData.userTable.key,staticStyle:{width:"100%"},attrs:{data:t.tableFormatData.userTable.tableData},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"date",label:"会员",align:"left","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.user?a("div",{staticClass:"wlm-table-logos"},[a("img",{staticClass:"logo",attrs:{src:e.row.user.avatarUrl}}),t._v(" "),a("div",{staticClass:"inner-text"},[a("p",[t._v(t._s(e.row.user.nickName))]),t._v(" "),a("span",[t._v("ID:"+t._s(e.row.user_id))])])]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"会员卡号",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.card_number))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"开卡方式",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.card_mode?a("p",[t._v("平台添加")]):t._e(),t._v(" "),"2"==e.row.card_mode?a("p",[t._v("用户购买")]):t._e(),t._v(" "),"3"==e.row.card_mode?a("p",[t._v("激活码兑换")]):t._e(),t._v(" "),"4"==e.row.card_mode?a("p",[t._v("购买商品")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"到期时间",align:"center","min-width":"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("parseTime")(e.row.card_end_time,"{y}-{m}-{d} {h}:{i}:{s}")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"消费次数",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.card_buy_times))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"消费金额",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[a("span",{staticClass:"orders-red"},[t._v("￥")]),a("span",[t._v(t._s(e.row.card_money))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"成为时间",align:"center","min-width":"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.create_time))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"是否注销",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":2},on:{change:function(a){t.changeTableItem({id:e.row.card_user_id,card_cancel:e.row.card_cancel},t.tableFormatData.userTable.change.card_cancel,{isWarning:1===e.row.card_cancel,warning:"确定注销吗？",cancel:{msg:"已取消注销",val:{scope:e,cancelStatus:{key:"card_cancel",val:2}}}})}},model:{value:e.row.card_cancel,callback:function(a){t.$set(e.row,"card_cancel",a)},expression:"scope.row.card_cancel"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"operation-group"},[a("router-link",{staticClass:"wlm-text",attrs:{tag:"span",to:{path:"/user/managementUserEdit",query:{user_id:e.row.user_id}}}},[a("el-button",{attrs:{type:"text"}},[t._v("查看")])],1)],1)]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-content flex-row flex-justify-e flex-align-c"},[a("el-pagination",{attrs:{disabled:!t.hasTableData,"current-page":t.tableFormatData.userTable.pagination.page,"page-sizes":t.tableFormatData.userTable.pagination.pagesizes,"page-size":t.tableFormatData.userTable.pagination.list_rows,layout:"total, sizes, prev, pager, next, jumper",total:t.hasTableData?t.tableFormatData.userTable.pagination.total:0},on:{"size-change":t.listPageChange,"current-change":t.listPageChange,"update:currentPage":function(e){t.$set(t.tableFormatData.userTable.pagination,"page",e)},"update:pageSize":function(e){t.$set(t.tableFormatData.userTable.pagination,"list_rows",e)}}})],1)],1)])],1)},[],!1,null,null,null);b.options.__file="vipUserList.vue";e.default=b.exports},JVmo:function(t,e,a){},XONK:function(t,e,a){"use strict";var r=a("JVmo");a.n(r).a},fGEp:function(t,e,a){"use strict";var r=a("P2sY"),n=a.n(r),i=a("Qyje"),o=a.n(i),l=a("p46w"),s=a.n(l),c={bind:function(t,e,a){var r=n()({},e.value),i=r.path,l=r.isBase,c=void 0===l||l,u=r.query,d=""+(c&&s.a.get("BASE_API")||location.protocol+"//"+location.hostname+"/")+i;t.addEventListener("click",function(e){var a=t.dataset.query;u&&a&&n()(u,JSON.parse(a)),location.href=u?""+d+o.a.stringify(u):""+d},!1)}},u=function(t){t.directive("exceldown",c)};window.Vue&&(window.exceldown=c,Vue.use(u)),c.install=u;e.a=c},slWK:function(t,e,a){"use strict";a.d(e,"k",function(){return o}),a.d(e,"m",function(){return l}),a.d(e,"i",function(){return s}),a.d(e,"j",function(){return c}),a.d(e,"n",function(){return u}),a.d(e,"I",function(){return d}),a.d(e,"H",function(){return f}),a.d(e,"J",function(){return m}),a.d(e,"K",function(){return p}),a.d(e,"l",function(){return b}),a.d(e,"b",function(){return g}),a.d(e,"d",function(){return v}),a.d(e,"B",function(){return h}),a.d(e,"r",function(){return _}),a.d(e,"w",function(){return y}),a.d(e,"A",function(){return w}),a.d(e,"D",function(){return x}),a.d(e,"p",function(){return D}),a.d(e,"t",function(){return C}),a.d(e,"f",function(){return F}),a.d(e,"e",function(){return j}),a.d(e,"h",function(){return T}),a.d(e,"F",function(){return O}),a.d(e,"z",function(){return k}),a.d(e,"E",function(){return S}),a.d(e,"g",function(){return E}),a.d(e,"v",function(){return z}),a.d(e,"a",function(){return L}),a.d(e,"G",function(){return V}),a.d(e,"C",function(){return $}),a.d(e,"u",function(){return I}),a.d(e,"o",function(){return U}),a.d(e,"s",function(){return G}),a.d(e,"c",function(){return K}),a.d(e,"y",function(){return N}),a.d(e,"q",function(){return q}),a.d(e,"x",function(){return A});var r=a("t3Un"),n=a("Qyje"),i=a.n(n);function o(t){return Object(r.a)({url:"/couponEditOrAdd",method:"post",data:i.a.stringify(t)})}function l(t){return Object(r.a)({url:"/couponList",method:"post",data:i.a.stringify(t)})}function s(t){return Object(r.a)({url:"/couponDelete",method:"post",data:i.a.stringify(t)})}function c(t){return Object(r.a)({url:"/couponDetail",method:"post",data:i.a.stringify(t)})}function u(t){return Object(r.a)({url:"/couponOp",method:"post",data:i.a.stringify(t)})}function d(t){return Object(r.a)({url:"/smsSave",method:"post",data:i.a.stringify(t)})}function f(t){return Object(r.a)({url:"/smsGet",method:"post",data:i.a.stringify(t)})}function m(t){return Object(r.a)({url:"/smsTplGet",method:"post",data:i.a.stringify(t)})}function p(t){return Object(r.a)({url:"/smsTplSave",method:"post",data:i.a.stringify(t)})}function b(t){return Object(r.a)({url:"/couponInfo",method:"post",data:i.a.stringify(t)})}function g(t){return Object(r.a)({url:"/ReceiveInfoList",method:"post",data:i.a.stringify(t)})}function v(t){return Object(r.a)({url:"/addSpike",method:"post",data:i.a.stringify(t)})}function h(t){return Object(r.a)({url:"/getSpikeList",method:"post",data:i.a.stringify(t)})}function _(t){return Object(r.a)({url:"/delSpikeList",method:"post",data:i.a.stringify(t)})}function y(t){return Object(r.a)({url:"/getEditData",method:"post",data:i.a.stringify(t)})}function w(t){return Object(r.a)({url:"/getMemberCard",method:"post",data:i.a.stringify(t)})}function x(t){return Object(r.a)({url:"/memberAddEdit",method:"post",data:i.a.stringify(t)})}function D(t){return Object(r.a)({url:"/delDataCard",method:"post",data:i.a.stringify(t)})}function C(t){return Object(r.a)({url:"/getCardData",method:"post",data:i.a.stringify(t)})}function F(t){return Object(r.a)({url:"/cardSave",method:"post",data:i.a.stringify(t)})}function j(t){return Object(r.a)({url:"/cardGet",method:"post",data:i.a.stringify(t)})}function T(t){return Object(r.a)({url:"/changeCardSell",method:"post",data:i.a.stringify(t)})}function O(t){return Object(r.a)({url:"/selectedCard",method:"post",data:i.a.stringify(t)})}function k(t){return Object(r.a)({url:"/getMember",method:"post",data:i.a.stringify(t)})}function S(t){return Object(r.a)({url:"/memberUserAddEdit",method:"post",data:i.a.stringify(t)})}function E(t){return Object(r.a)({url:"/changeCancel",method:"post",data:i.a.stringify(t)})}function z(t){return Object(r.a)({url:"/getDataMemberFind",method:"post",data:i.a.stringify(t)})}function L(t){return Object(r.a)({url:"/MemberGoodsStatus",method:"post",data:i.a.stringify(t)})}function V(t){return Object(r.a)({url:"/setMemberGoodsPrice",method:"post",data:i.a.stringify(t)})}function $(t){return Object(r.a)({url:"/importMember",method:"post",data:t})}function I(t){return Object(r.a)({url:"/getCdKeyInfo",method:"post",data:i.a.stringify(t)})}function U(t){return Object(r.a)({url:"/createdCdKey",method:"post",data:i.a.stringify(t)})}function G(t){return Object(r.a)({url:"/destoryCdKey",method:"post",data:i.a.stringify(t)})}function K(t){return Object(r.a)({url:"/addGroups",method:"post",data:i.a.stringify(t)})}function N(t){return Object(r.a)({url:"/getGroupsList",method:"post",data:i.a.stringify(t)})}function q(t){return Object(r.a)({url:"/delGroups",method:"post",data:i.a.stringify(t)})}function A(t){return Object(r.a)({url:"/getGroupsData",method:"post",data:i.a.stringify(t)})}}}]);