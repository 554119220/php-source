<?php
 namespace app\boguan\model; class UserCoupon extends BaseModel { public static function checkCoupon() { goto ctfUr; oTGhM: foreach ($coupon as $k => $v) { goto pOkIh; BQVOj: hTllj: goto rifKG; rifKG: fJnco: goto Wj0ew; GgjVa: if (!($v["\145\x6e\x64\x5f\164\151\x6d\x65"] < time() || empty($result))) { goto hTllj; } goto X3fSn; pOkIh: $result = Coupon::get($v["\x63\x6f\165\x70\157\156\137\x69\x64"]); goto GgjVa; X3fSn: self::updateUserCoupon($v["\x69\x64"], 0); goto BQVOj; Wj0ew: } goto Gikwk; Gikwk: EL9k1: goto bs_ho; ctfUr: $coupon = self::where(["\165\x6e\151\141\x63\x69\144" => session("\x75\x6e\x69\x61\x63\x69\144")])->select(); goto oTGhM; bs_ho: } private function updateUserCoupon($couponId, $status) { goto vixxu; vixxu: $data = ["\151\144" => $couponId, "\x73\x74\141\164\x75\163" => $status, "\x75\x6e\x69\x61\x63\151\144" => session("\165\156\151\141\143\x69\144")]; goto tVVvl; tVVvl: $result = self::update($data); goto UulMO; UulMO: return $result ? true : false; goto AasZW; AasZW: } public static function countUserCoupon($uid) { goto zgNx_; zgNx_: self::checkCoupon(); goto zlY2g; zlY2g: $count = UserCoupon::where(["\165\156\x69\141\x63\x69\144" => session("\x75\x6e\x69\x61\x63\151\144"), "\x75\x73\145\162\137\151\144" => $uid, "\x69\x73\137\x75\163\x65" => 0, "\x73\x74\141\x74\165\163" => 1])->count(); goto RfroB; RfroB: return $count; goto bR6hx; bR6hx: } }