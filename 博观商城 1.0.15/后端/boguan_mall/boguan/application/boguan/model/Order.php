<?php
 namespace app\boguan\model; use app\api\model\UserShareMoney; class Order extends BaseModel { public function user() { return $this->hasOne("\125\163\145\x72", "\x69\144", "\165\x73\x65\x72\x5f\x69\x64")->field("\151\x64\54\156\151\143\x6b\156\x61\x6d\x65\x2c\x61\x76\141\164\x61\x72"); } public static function getBookOrderByUid($uid, $keyword) { $order = self::where(["\x75\163\x65\x72\x5f\151\x64" => $uid, "\x69\163\137\x62\157\x6f\x6b\151\156\147" => 1, "\x69\x73\x5f\160\x61\151\144\137\163\x75\x62" => 1, "\x69\x73\137\144\145\x6c\x65\x74\x65" => 0])->where("\x6f\162\x64\x65\x72\137\156\x6f", "\x6c\151\x6b\145", "\x25{$keyword}\45")->order("\143\162\145\141\x74\145\137\x74\x69\x6d\145", "\x64\x65\163\x63")->paginate(12, false, ["\161\x75\x65\x72\171" => ["\x69\144" => $uid, "\x6b\145\171\x77\157\x72\x64" => $keyword]]); return $order; } public static function countUserOrder($uid) { $count = self::where(["\165\156\x69\141\x63\151\x64" => session("\165\156\151\141\143\151\144"), "\x75\x73\145\x72\137\151\144" => $uid, "\x69\x73\x5f\143\141\x6e\143\x65\x6c" => 0, "\x69\163\137\x64\x65\154\x65\164\x65" => 0])->count(); return $count; } public static function userLatestOrder($uid) { $order = self::where(["\x75\x6e\x69\x61\143\x69\144" => session("\165\156\151\141\143\x69\x64"), "\x75\x73\145\162\137\x69\x64" => $uid, "\x69\163\x5f\x63\141\156\x63\145\154" => 0, "\x69\163\x5f\x64\x65\154\x65\164\145" => 0])->where("\163\x74\x61\x74\165\163", "\76", 0)->where("\x73\x74\x61\x74\165\163", "\x3c\75", 3)->order("\x69\x64", "\144\x65\163\x63")->limit(1)->find(); return $order; } public static function userPay($uid, $type = "\144") { goto rGAOa; xnCTN: Y3CMf: goto pBGNX; AkfKn: $sum = self::where(["\x75\156\x69\x61\143\151\x64" => session("\165\156\151\x61\143\151\x64"), "\165\x73\145\x72\137\x69\144" => $uid, "\151\x73\x5f\x63\x61\x6e\143\145\x6c" => 0, "\151\163\x5f\x64\145\154\x65\164\x65" => 0])->where("\x73\164\x61\x74\165\x73", "\76", 0)->where("\x73\x74\141\x74\165\x73", "\74\75", 3)->whereTime("\160\x61\171\x5f\164\151\155\x65", $type)->sum("\157\137\141\x6d\157\165\x6e\x74"); goto wOAg6; C6lHU: YuxkQ: goto ffQQ_; wOAg6: goto Y3CMf; goto C6lHU; pBGNX: return $sum; goto feXFx; rGAOa: if ($type == "\x61\x6c\x6c") { goto YuxkQ; } goto AkfKn; ffQQ_: $sum = self::where(["\165\156\151\x61\143\x69\144" => session("\x75\156\x69\141\x63\x69\144"), "\x75\x73\145\x72\x5f\x69\144" => $uid, "\151\163\x5f\x63\141\156\x63\145\x6c" => 0, "\x69\163\x5f\144\145\154\x65\x74\x65" => 0])->where("\163\x74\x61\x74\165\163", "\x3e", 0)->where("\163\x74\x61\x74\165\163", "\74\x3d", 3)->sum("\157\x5f\x61\155\x6f\165\156\x74"); goto xnCTN; feXFx: } public function getSnapInfoAttr($value) { goto U1UVs; U1UVs: if (!empty($value)) { goto MXNzm; } goto I8qMt; u5iWC: MXNzm: goto lemxl; I8qMt: return null; goto u5iWC; lemxl: return json_decode($value, true); goto aKy2P; aKy2P: } public function getUserInfoAttr($value) { goto Nx8bY; PMZzR: return null; goto K9gNV; Nx8bY: if (!empty($value)) { goto r_fie; } goto PMZzR; BqI9t: return json_decode($value, true); goto KUYlZ; K9gNV: r_fie: goto BqI9t; KUYlZ: } public function getPickInfoAttr($value) { goto Nck4E; U2p5l: return json_decode($value, true); goto dsvBd; Ayp_q: ASYCW: goto U2p5l; RSKnY: return null; goto Ayp_q; Nck4E: if (!empty($value)) { goto ASYCW; } goto RSKnY; dsvBd: } public static function getWaitSendOrder() { $order = self::where(["\165\156\151\141\x63\x69\x64" => session("\x75\156\151\141\x63\x69\144"), "\151\163\137\143\141\156\143\x65\x6c" => 0, "\x69\x73\x5f\x64\x65\x6c\145\164\x65" => 0, "\x73\164\141\164\165\x73" => 1, "\x69\x73\137\x73\x65\156\144" => 0])->order("\143\162\x65\x61\164\x65\137\164\x69\x6d\145", "\144\x65\163\x63")->select(); return $order; } public static function getPaidOrder() { goto wOPKU; qpNW3: return $order; goto zmUEa; wOPKU: $where = "\x75\156\x69\141\143\151\144\40\x3d\x20" . session("\x75\156\x69\x61\143\151\x64") . "\x20\141\x6e\144\x20\x73\x74\x61\164\165\x73\40\x3e\x30\x20\x61\x6e\x64\x20\163\x74\141\x74\165\x73\x20\74\x3d\x20\x33\40\x61\156\x64\40\x69\163\x5f\143\x61\156\x63\x65\x6c\40\x3d\x30\x20\x61\x6e\144\40\151\163\137\144\145\154\145\164\x65\x20\75\x20\60"; goto ZgY0U; rZfxt: $order = self::query($query); goto qpNW3; ZgY0U: $query = "\x53\105\114\105\x43\124\x20\x69\x64\54\165\x73\x65\162\x5f\151\x64\54\123\125\x4d\50\157\x5f\x61\x6d\157\165\x6e\164\x29\40\141\163\40\164\x6f\164\141\x6c\40\x46\122\x4f\x4d\x20\x60\x62\x67\137\x6f\162\144\x65\x72\140\x20\167\150\145\x72\x65\40{$where}\40\107\122\x4f\x55\120\x20\142\x79\x20\165\163\x65\162\x5f\151\144\x20\x6f\162\x64\145\162\x20\x42\x59\x20\x74\x6f\x74\x61\154\40\x64\x65\x73\143"; goto rZfxt; zmUEa: } public static function sumUserPaid($uid) { goto OrtKo; j3dbo: return $sum; goto gqsAd; OrtKo: $where = "\163\x74\141\164\x75\x73\x20\x3d\40\61\40\157\x72\x20\x73\164\141\x74\x75\x73\40\75\40\62\40\157\162\40\163\164\141\x74\x75\x73\40\75\x20\x33"; goto oMOXs; oMOXs: $sum = self::where(["\165\156\151\x61\143\x69\x64" => session("\x75\156\x69\141\143\151\144"), "\151\x73\x5f\x63\141\156\143\145\154" => 0, "\151\163\137\144\x65\154\x65\x74\x65" => 0, "\x75\163\x65\x72\x5f\x69\x64" => $uid])->where($where)->sum("\x6f\x5f\x61\155\x6f\x75\156\x74"); goto j3dbo; gqsAd: } public static function shareOrder($where, $setWhere) { goto YqReL; aw5_r: return ["\157\162\x64\145\x72" => $order, "\160\141\147\145" => $page]; goto ipw0Z; v5WFN: $page = $order->render(); goto aw5_r; YqReL: $order = self::with("\x75\163\145\162")->where(["\x75\x6e\x69\x61\x63\151\x64" => session("\165\156\x69\141\x63\x69\144"), "\151\163\137\143\x61\x6e\143\x65\154" => 0, "\151\x73\x5f\144\145\154\145\164\145" => 0])->where($where)->order("\143\x72\145\141\164\x65\137\x74\151\x6d\145", "\x64\x65\163\x63")->paginate(12, false, ["\161\165\x65\162\171" => $setWhere]); goto v5WFN; ipw0Z: } public static function countClerkOrder($uid) { goto tfuc2; FBQK0: return ["\x63\x6f\165\x6e\x74" => $count, "\163\x75\x6d" => $sum]; goto ydPZe; q3CId: $sum = self::where(["\x75\x6e\151\141\x63\151\x64" => session("\x75\x6e\x69\141\x63\151\144"), "\x63\x6c\145\162\153\137\x69\144" => $uid])->sum("\157\137\141\x6d\157\165\156\164"); goto FBQK0; tfuc2: $count = self::where(["\x75\156\x69\141\143\x69\144" => session("\165\x6e\x69\141\143\151\144"), "\143\154\145\162\x6b\137\x69\x64" => $uid])->count(); goto q3CId; ydPZe: } }