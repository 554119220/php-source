<?php
 namespace app\boguan\controller\platform; use app\boguan\controller\Platform; use app\boguan\model\IntegralDetail; use app\boguan\model\User as UserModel; use app\boguan\model\UserCoupon; use think\Request; use app\boguan\model\Order as OrderModel; use app\boguan\model\UserCoupon as UserCouponModel; use app\boguan\model\Vip as VipModel; class User extends Platform { public function __construct(Request $request = null) { parent::__construct($request); } public function index() { goto ranYV; LFSNW: $this->assign(["\x75\x73\145\x72" => $user, "\x70\x61\147\x65" => $page]); goto bFQcN; I0iQg: tdwkn: goto id1Ih; a8Jb1: $where["\x6e\x69\x63\x6b\156\141\x6d\x65\x7c\x70\150\x6f\x6e\145"] = ["\x6c\151\x6b\x65", "\45{$keyword}\45"]; goto T3hZZ; Of1E7: $setWhere = ["\153\145\x79\167\157\162\x64" => $keyword]; goto UB9YI; bFQcN: return $this->fetch(); goto dJbZA; id1Ih: $page = $user->render(); goto LFSNW; UB9YI: $user = UserModel::with("\x76\151\x70")->where("\141\166\141\164\x61\162", "\x3c\x3e", '')->where($where)->order("\x69\x64", "\x64\x65\x73\143")->paginate(12, false, ["\161\165\145\x72\171" => $setWhere]); goto NALlP; ranYV: $keyword = input("\x6b\145\171\167\x6f\x72\x64"); goto a8Jb1; T3hZZ: $where["\165\156\x69\141\x63\x69\x64"] = $this->uniacid; goto Of1E7; NALlP: foreach ($user as $key => $value) { goto qb_lC; Ymm8G: P3SUE: goto sTGMR; qb_lC: $user[$key]["\157\x72\144\x65\162\x5f\x63\x6f\x75\x6e\164"] = OrderModel::countUserOrder($value["\151\x64"]); goto lef_4; lef_4: $user[$key]["\154\141\x74\145\163\x74\x5f\x6f\162\x64\145\x72"] = OrderModel::userLatestOrder($value["\x69\144"]); goto Ymm8G; sTGMR: } goto I0iQg; dJbZA: } public function edit() { goto jPFhy; z2WSk: edyE8: goto CAYn7; IXZ41: goto lVohm; goto z2WSk; Uybmf: dvULX: goto hBRM8; qHl1b: $user = UserModel::with("\x70\x61\x72\145\156\164")->find($id); goto oFTGx; S7YWF: $data["\166\151\x70\137\151\x64"] = $vipData[0]; goto Uybmf; PqZUY: u1oPI: goto DjV_c; ivhBc: return $this->fetch(); goto Sy9Cn; nQMQ0: if (!isset($vipData[0])) { goto dvULX; } goto S7YWF; hBRM8: if (!isset($vipData[1])) { goto OyEhx; } goto xIiGQ; a0WKf: OKZ1k: goto sEfxD; ABOyn: if ($result !== false) { goto edyE8; } goto GIFND; bYwMr: $userList = UserModel::where("\141\x76\141\164\141\162", "\74\x3e", '')->where("\165\156\x69\141\143\151\x64", $this->uniacid)->order("\x69\144", "\x64\145\x73\x63")->select(); goto fPQoJ; za8cv: OyEhx: goto znPve; GIFND: return json(["\155\x73\x67" => "\344\xbf\xae\346\224\271\345\xa4\xb1\xe8\xb4\xa5", "\145\x72\162\x6f\x72\x43\x6f\x64\145" => 0]); goto IXZ41; wyz5i: if (!request()->isAjax()) { goto OKZ1k; } goto pBK0c; KhTRT: $result = UserModel::update($data); goto ABOyn; jPFhy: $id = input("\151\x64"); goto qHl1b; oFTGx: $vip = VipModel::where(["\x75\156\x69\141\143\151\x64" => session("\165\x6e\x69\x61\143\151\x64"), "\163\164\x61\x74\165\163" => 1])->field("\151\x64\54\156\x61\x6d\x65\x2c\x73\164\141\164\x75\x73\x2c\x6c\145\x76\x65\x6c")->order("\151\156\164\145\147\x72\x61\154", "\141\x73\143")->select(); goto bYwMr; TRash: $vipData = explode("\x2c", $data["\x76\151\x70"]); goto nQMQ0; sEfxD: $this->assign(["\165\x73\145\162" => $user, "\x76\151\x70" => $vip, "\165\x73\x65\x72\111\156\x66\x6f" => $userInfo]); goto ivhBc; xIiGQ: $data["\154\145\166\145\154"] = $vipData[1]; goto za8cv; fPQoJ: $data = []; goto jSpXQ; DUTiX: lVohm: goto a0WKf; pBK0c: $data = input("\160\157\x73\x74\x2e\x64\x61\x74\141\x2f\141"); goto TRash; CAYn7: return json(["\x6d\x73\147" => "\xe4\xbf\256\346\224\xb9\346\x88\x90\xe5\212\237", "\x65\162\x72\157\162\103\157\144\145" => 1]); goto DUTiX; jSpXQ: foreach ($userList as $key => $value) { goto QWOES; StHtf: $data[0]["\156\141\155\145"] = "\346\x80\273\xe5\272\x97"; goto qi1IQ; QWOES: $data[0]["\x69\144"] = 0; goto StHtf; qi1IQ: $data[0]["\x69\155\147"] = WE7_PATH . "\x2f\160\x75\142\154\x69\x63\x2f\x62\x6f\147\x75\x61\156\x2f\x69\155\141\x67\x65\163\57\144\x65\146\141\x75\154\x74\137\155\145\156\56\152\160\x67"; goto GSSvq; GSSvq: $data[$key + 1]["\151\144"] = $value["\x69\144"]; goto HlPhh; yTgum: HU_iC: goto wDmY1; z3679: $data[$key + 1]["\x69\x6d\x67"] = $value["\x61\166\x61\x74\x61\162"]; goto yTgum; HlPhh: $data[$key + 1]["\x6e\x61\x6d\145"] = $value["\x6e\151\143\153\156\141\155\145"]; goto z3679; wDmY1: } goto PqZUY; DjV_c: $userInfo = json_encode($data, JSON_UNESCAPED_UNICODE); goto wyz5i; znPve: unset($data["\x76\x69\160"]); goto KhTRT; Sy9Cn: } public function detail() { goto sIPW1; UsmoP: $user = UserModel::with("\x76\x69\x70")->find($id); goto UnzTv; sIPW1: $id = input("\x69\144"); goto UsmoP; TS2y_: foreach ($integral as $k => $v) { goto cyBFV; WK7NC: $operator = "\347\xb3\xbb\347\273\237\xe8\247\xa6\xe5\217\221"; goto SQiXa; oyoy8: bUyrx: goto TyMvo; TyMvo: $name = "\xe7\256\241\347\x90\x86\345\x91\x98\346\223\215\xe4\275\234"; goto QXiN_; texQJ: $integral[$k]["\156\141\x6d\145"] = $name; goto TgC1S; cyBFV: if ($v["\x61\144\x6d\151\x6e"] != '') { goto dQt03; } goto WK7NC; XGyj0: if ($v["\x6b\151\156\x64"] == 2) { goto v1JwJ; } goto OEX6j; TgC1S: eREKn: goto NfrN4; OEX6j: $name = "\xe6\xaf\x8f\xe6\210\x90\344\272\xa4\x4e\345\205\203\xe5\x90\216"; goto u6Ch9; GuhuB: $name = "\xe7\xa7\xaf\345\210\x86\xe5\x85\221\xe6\215\xa2\346\223\215\344\xbd\x9c"; goto LsBCQ; LsBCQ: t2ELS: goto LjDtH; Qt37C: if ($v["\153\x69\x6e\144"] == 1) { goto bUyrx; } goto XGyj0; VuiZF: $integral[$k]["\x74\x69\155\145"] = $v["\143\162\x65\141\x74\145\x5f\x74\x69\155\x65"]; goto texQJ; qe31E: gHdRI: goto Qt37C; u6Ch9: goto t2ELS; goto oyoy8; SQiXa: goto gHdRI; goto Y8mS3; UNfj0: $operator = $v["\x61\x64\155\151\156"]["\x6e\141\155\145"]; goto qe31E; QXiN_: goto t2ELS; goto qA2hf; Y8mS3: dQt03: goto UNfj0; LjDtH: $integral[$k]["\x6f\x70\x65\x72\141\x74\x6f\162"] = $operator; goto VuiZF; qA2hf: v1JwJ: goto GuhuB; NfrN4: } goto hD23h; qfxpS: $order = OrderModel::where(["\165\156\x69\x61\x63\151\144" => $this->uniacid, "\x75\x73\x65\162\x5f\x69\144" => $id, "\x69\163\x5f\144\x65\x6c\145\x74\x65" => 0, "\151\x73\137\143\x61\156\143\145\x6c" => 0])->where($where)->field("\151\x64\x2c\x73\x6e\141\x70\137\156\x61\x6d\x65\54\157\162\x64\145\x72\137\x6e\157\54\x6f\137\x61\155\x6f\x75\x6e\164\x2c\160\141\171\x5f\x74\171\160\x65\x2c\x63\x72\145\141\164\x65\x5f\x74\151\155\145\54\157\x6c\x64\137\157\x72\x64\x65\162\x5f\x6e\157")->order("\160\141\171\137\x74\151\x6d\145", "\x64\145\163\x63")->select(); goto gaEMA; B7v61: $integral = IntegralDetail::getIntegralDetailByUser($id); goto I6NVQ; I6NVQ: $where = "\x73\164\141\164\165\163\40\76\x20\60\40\x61\x6e\x64\40\163\x74\141\x74\165\x73\x20\74\x3d\x20\x33"; goto qfxpS; hD23h: nBJ61: goto jK89h; sM0EI: $user["\x74\157\164\141\154"] = OrderModel::userPay($id, "\141\x6c\x6c"); goto PXBhb; gaEMA: $orderList = []; goto sOnMT; qFvEH: return $this->fetch(); goto xplVB; jK89h: $this->assign(["\x75\163\145\162" => $user, "\x69\156\x74\145\x67\162\141\154" => json_encode($integral, JSON_UNESCAPED_UNICODE), "\x6f\162\x64\145\x72\114\151\x73\x74" => json_encode($orderList, JSON_UNESCAPED_UNICODE)]); goto qFvEH; I_rjh: $user["\167\x65\145\x6b"] = OrderModel::userPay($id, "\167"); goto sM0EI; UnzTv: $user["\x74\x6f\x64\x61\x79"] = OrderModel::userPay($id, "\144"); goto I_rjh; PXBhb: $user["\x63\157\165\x70\157\x6e"] = UserCouponModel::countUserCoupon($id); goto B7v61; sOnMT: foreach ($order as $key => $value) { goto WXmPI; NYfcY: $payType = "\xe4\xbd\231\351\242\x9d\xe6\x94\257\xe4\xbb\230"; goto jPfyk; TsyEA: if ($value["\x70\x61\x79\x5f\164\x79\160\145"] == 2) { goto maLEy; } goto jRC8g; RrE6S: goto pM0pX; goto EZJ5_; WXmPI: if ($value["\x70\x61\171\137\164\171\x70\x65"] == 1) { goto Ohfzu; } goto TsyEA; bHObN: Ohfzu: goto jMi9T; oA0xa: D5tny: goto aMPf0; m6cHj: $orderList[$key] = ["\x69\x64" => $value["\x69\144"], "\160\x61\171\x77\141\x79" => "\xe5\276\xae\xe4\xbf\xa1\xe6\x94\257\xe4\xbb\x98", "\156\141\155\x65" => $value["\163\156\x61\x70\137\156\141\x6d\x65"], "\160\x72\x69\143\x65" => $value["\157\x5f\x61\x6d\x6f\x75\156\164"], "\164\151\155\145" => $value["\143\x72\145\141\164\145\137\164\151\x6d\x65"], "\154\x69\156\x6b" => url("\142\x6f\x67\165\141\156\57\x70\x6c\x61\164\146\x6f\x72\155\x2e\x6f\x72\144\x65\162\57\151\156\144\145\x78") . "\77\x74\171\160\145\x3d\x31\x26\153\145\x79\167\157\162\x64\75" . $value["\157\x6c\x64\x5f\x6f\162\144\145\x72\137\156\x6f"]]; goto oA0xa; jMi9T: $payType = "\xe5\276\256\344\277\241\xe6\x94\xaf\344\273\x98"; goto RrE6S; jRC8g: goto pM0pX; goto bHObN; EZJ5_: maLEy: goto NYfcY; jPfyk: pM0pX: goto m6cHj; aMPf0: } goto tUhFy; tUhFy: Rwidv: goto TS2y_; xplVB: } public function recharge() { goto p3OY3; AE3in: kRRgM: goto qR8Vz; CdMGs: goto oORC3; goto kb9TJ; cq1JZ: $user->total_money = $user->total_money + $data["\x76\x61\154\x75\x65"]; goto gyag9; p3OY3: if (!request()->isAjax()) { goto Q7C2h; } goto JclKf; tvOgD: $result = $user->save(); goto plFAj; fi9BN: goto FcYEv; goto L13c7; plFAj: vU302: goto Mm5iN; gLpEC: DQlTJ: goto IaISI; F1jz8: if ($data["\x74\171\x70\145"] == 1) { goto myKL2; } goto de_tz; Mm5iN: if ($result !== false) { goto YUjhF; } goto nLyGu; lqt9N: Kumwh: goto VUn7L; ru2Ug: return json(["\155\163\x67" => "\xe7\x94\xa8\346\x88\267\346\266\210\350\264\xb9\351\207\221\351\242\x9d\xe4\xb8\215\xe8\xb6\263", "\x65\162\162\157\162\x43\157\x64\x65" => 0]); goto KYbg1; m_qEa: goto Kumwh; goto DUmbx; Dvqp2: YOs5d: goto NWf_N; lwbKL: FcYEv: goto tvOgD; nxNEt: if (!($data["\x76\x61\154\x75\x65"] > $user->integral)) { goto YOs5d; } goto Kkz_Z; R85AR: goto vU302; goto AE3in; IaISI: $user = UserModel::get($data["\x69\x64"]); goto c11Dl; NWf_N: $user->integral = $user->integral - $data["\x76\141\154\165\x65"]; goto fi9BN; qR8Vz: if ($data["\x74\x79\x70\x65"] == 1) { goto hEnyX; } goto nxNEt; gyag9: oORC3: goto bxMt8; nLyGu: return json(["\155\x73\x67" => "\xe4\277\256\xe6\x94\xb9\345\xa4\xb1\350\xb4\xa5", "\x65\x72\x72\x6f\x72\103\157\144\145" => 0]); goto m_qEa; L13c7: hEnyX: goto NS8Og; JclKf: $data = json_decode(input("\144\x61\x74\141"), true); goto rzMvP; rzMvP: if (!($data["\x69\144"] == '')) { goto DQlTJ; } goto gS917; kb9TJ: myKL2: goto cq1JZ; gS917: return json(["\x6d\163\147" => "\347\224\xa8\346\x88\267\xe4\xb8\215\xe5\xad\230\xe5\234\250", "\145\x72\162\x6f\x72\x43\157\x64\145" => 0]); goto gLpEC; bxMt8: $result = $user->save(); goto R85AR; z01DA: return json(["\x6d\x73\x67" => "\344\277\256\xe6\224\xb9\346\210\x90\xe5\x8a\x9f", "\x65\x72\162\157\x72\103\x6f\144\x65" => 1]); goto lqt9N; c11Dl: if ($data["\153\x69\x6e\x64"] == 1) { goto kRRgM; } goto F1jz8; de_tz: if (!($data["\166\x61\x6c\165\x65"] > $user->total_money)) { goto uh0YB; } goto ru2Ug; KYbg1: uh0YB: goto wrnoS; rGD9k: return $this->fetch(); goto MoV2d; wrnoS: $user->total_money = $user->total_money - $data["\x76\x61\x6c\x75\x65"]; goto CdMGs; DUmbx: YUjhF: goto z01DA; VUn7L: Q7C2h: goto rGD9k; Kkz_Z: return json(["\155\x73\147" => "\347\x94\250\xe6\x88\xb7\xe7\247\257\345\x88\206\344\xb8\215\350\xb6\xb3", "\x65\x72\x72\x6f\x72\103\157\144\145" => 0]); goto Dvqp2; NS8Og: $user->integral = $user->integral + $data["\166\141\154\165\145"]; goto lwbKL; MoV2d: } public function clerk() { goto SYwIe; YFosJ: $where["\156\151\x63\153\x6e\141\x6d\145"] = ["\x6c\x69\153\x65", "\45{$keyword}\45"]; goto V76h9; GR7qS: $page = $user->render(); goto Vt_Tt; ijmzR: return $this->fetch(); goto hFFeK; kkRxM: $setWhere = ["\153\x65\171\x77\x6f\162\x64" => $keyword]; goto gqvQq; V76h9: $where["\165\x6e\151\x61\x63\x69\144"] = $this->uniacid; goto uO7AW; SYwIe: $keyword = input("\153\145\x79\167\x6f\162\144"); goto YFosJ; uO7AW: $where["\151\x73\137\143\x6c\145\x72\153"] = 1; goto kkRxM; kVLyD: auLdh: goto GR7qS; hEu2J: foreach ($user as $key => $value) { goto E5lPw; SAiWa: YX411: goto Eow3I; E5lPw: $clerkData = OrderModel::countClerkOrder($value["\151\x64"]); goto TTeS3; TTeS3: $user[$key]["\x63\154\145\162\153\x5f\157\x72\x64\x65\162"] = $clerkData["\143\157\x75\x6e\x74"]; goto Zc3GG; Zc3GG: $user[$key]["\143\x6c\145\162\x6b\137\141\x6d\x6f\165\x6e\x74"] = $clerkData["\163\165\155"]; goto SAiWa; Eow3I: } goto kVLyD; gqvQq: $user = UserModel::where("\141\x76\141\x74\x61\162", "\x3c\x3e", '')->where($where)->order("\x63\x6c\145\162\x6b\137\164\x69\155\x65", "\x64\145\x73\x63")->paginate(12, false, ["\x71\x75\x65\162\x79" => $setWhere]); goto hEu2J; Vt_Tt: $this->assign(["\143\154\145\x72\x6b" => $user, "\160\141\147\x65" => $page]); goto ijmzR; hFFeK: } public function postClerk() { goto R_NUp; ePadn: return json(["\x6d\x73\x67" => "\xe6\223\215\xe4\275\x9c\346\x88\220\xe5\x8a\237", "\x65\x72\162\x6f\x72\103\x6f\x64\145" => 1]); goto kHWvR; CHuuJ: $result = UserModel::update($data); goto u1r0G; qCNOL: return json(["\x6d\x73\x67" => "\xe6\223\215\344\xbd\x9c\xe5\xa4\261\xe8\xb4\xa5", "\x65\162\162\x6f\162\x43\157\144\x65" => 0]); goto i043j; mMx8n: zaUYu: goto JLpz_; z4kKo: if (!($user["\151\x73\137\143\x6c\145\162\153"] == 0)) { goto Nguer; } goto jMFZN; SdjnA: DgKPl: goto ePadn; f6_lc: $user = UserModel::get($id); goto mSKye; pSszq: return $this->fetch(); goto UWIyW; jMFZN: $data["\143\x6c\x65\162\x6b\x5f\x74\x69\x6d\145"] = time(); goto kURph; u1r0G: if ($result !== false) { goto DgKPl; } goto qCNOL; kURph: Nguer: goto vWOiJ; bCx0O: oytG7: goto Oa2wU; txqrI: $data = input("\x70\157\x73\164\56\144\141\164\x61\x2f\x61"); goto BZqjk; M7mbM: if (!\request()->isAjax()) { goto oytG7; } goto txqrI; ekc5x: foreach ($userData as $key => $value) { goto ajTAS; HWlW8: $data[$key]["\x69\x6d\x67"] = $value["\x61\x76\141\x74\x61\162"]; goto QQzyc; QQzyc: GLpLL: goto q3mpH; ajTAS: $data[$key]["\x69\x64"] = $value["\151\x64"]; goto FYqX2; FYqX2: $data[$key]["\156\x61\155\x65"] = $value["\156\151\x63\153\156\141\155\145"]; goto HWlW8; q3mpH: } goto mMx8n; R_NUp: $id = input("\x69\x64"); goto f6_lc; JLpz_: $userInfo = json_encode($data, JSON_UNESCAPED_UNICODE); goto M7mbM; E5YSN: return json(["\155\x73\x67" => "\xe8\xaf\xb7\xe9\200\x89\xe6\x8b\251\xe5\xbe\256\xe4\277\xa1\347\x94\xa8\xe6\x88\267", "\x65\x72\162\157\x72\x43\157\144\x65" => 0]); goto fLVNl; gerBd: $user = UserModel::get($data["\x69\x64"]); goto z4kKo; Oa2wU: $this->assign(["\x75\x73\145\162\x49\156\x66\x6f" => $userInfo, "\x75\163\x65\162" => $user]); goto pSszq; vWOiJ: $data["\x69\163\137\143\154\145\162\x6b"] = 1; goto CHuuJ; kHWvR: m03uo: goto bCx0O; vd6na: $data = []; goto ekc5x; mSKye: $userData = UserModel::where(["\165\x6e\x69\141\x63\151\144" => session("\x75\x6e\x69\141\143\x69\144"), "\151\x73\137\x63\154\x65\162\153" => 0])->where("\141\x76\x61\164\x61\162", "\74\76", '')->order("\x63\162\x65\141\x74\x65\x5f\164\151\x6d\x65", "\144\x65\163\x63")->select(); goto vd6na; i043j: goto m03uo; goto SdjnA; fLVNl: uoONK: goto gerBd; BZqjk: if (!(!isset($data["\x69\x64"]) || $data["\x69\144"] == '')) { goto uoONK; } goto E5YSN; UWIyW: } public function cancelClerk() { goto OWjKW; f8XT2: H17Y5: goto mm7EO; j73zU: SAQLQ: goto cv2tJ; ahyjD: return json(["\155\163\x67" => "\xe8\xa7\243\xe9\x99\xa4\xe5\244\xb1\350\264\xa5", "\145\x72\162\x6f\162\x43\157\144\145" => 0]); goto t6CDD; AudWn: $user->clerk_time = null; goto gw6EW; NGoDf: if (!empty($user)) { goto H17Y5; } goto phpJ0; cv2tJ: return json(["\155\163\147" => "\xe8\xa7\243\351\231\244\346\x88\x90\xe5\212\237", "\x65\x72\162\x6f\x72\103\x6f\144\x65" => 1]); goto LUrTV; mm7EO: $user->is_clerk = 0; goto AudWn; LUrTV: xx2s3: goto GTIAm; zSFGb: $result = $user->save(); goto oHlqR; I4uIe: $id = input("\x69\x64"); goto CPXyP; OWjKW: if (!request()->isAjax()) { goto H91zz; } goto I4uIe; gw6EW: $user->clerk_remark = null; goto zSFGb; oHlqR: if ($result !== false) { goto SAQLQ; } goto ahyjD; CPXyP: $user = UserModel::get($id); goto NGoDf; GTIAm: H91zz: goto T11s7; phpJ0: return json(["\x6d\163\147" => "\xe7\224\xa8\346\210\xb7\344\270\x8d\xe5\xad\230\xe5\234\xa8", "\x65\x72\162\x6f\162\x43\x6f\144\x65" => 0]); goto f8XT2; t6CDD: goto xx2s3; goto j73zU; T11s7: } }