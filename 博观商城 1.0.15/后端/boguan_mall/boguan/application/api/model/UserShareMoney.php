<?php
 namespace app\api\model; use app\api\service\Token; class UserShareMoney extends BaseModel { public function user() { return $this->hasOne("\125\163\x65\x72", "\151\144", "\165\163\x65\x72\x5f\x69\144")->field("\151\144\x2c\x6e\151\x63\x6b\x6e\x61\155\x65\54\x61\166\x61\x74\141\162"); } public function parent() { return $this->hasOne("\125\163\x65\x72", "\151\144", "\x70\141\x72\145\156\x74\x5f\x69\x64")->field("\151\144\54\156\151\143\x6b\x6e\x61\155\145\x2c\141\166\x61\164\141\x72"); } public function calcShareMoney($orderId, $o_amount) { goto byRnZ; ffga4: $parentScale = $share["\146\x69\x72\163\164\x5f\163\143\x61\154\145"] / 100; goto M9BLR; hZE4i: if (!($thirdMoney < 0)) { goto o4lUV; } goto lXAXU; uX12Q: $parentShareMoney["\165\163\x65\x72\x5f\151\144"] = $uid; goto k2Jvy; ep2ga: $order->save(); goto jNsbn; ldVqB: $order->third_price = $third_price; goto lHX3p; TTAJH: if ($share["\163\143\141\154\x65\x5f\164\x79\160\145"] == 2) { goto Vo8aL; } goto khyGb; jD2ln: PR3vk: goto d3E17; NalTF: $secondMoney = doubleval(sprintf("\x25\56\62\x66", $o_amount * $grandParentScale)); goto s35Bk; ahC3r: FL_2k: goto Wwj4A; hVmmh: $great_grandParentShareMoney["\157\x72\x64\x65\162\x5f\151\144"] = $orderId; goto SU8Fm; G4KQT: UserShareMoney::create($great_grandParentShareMoney); goto msTDz; gF11x: $parentShareMoney["\157\x72\144\145\x72\137\151\x64"] = $orderId; goto GEk8Y; ws4Nr: $grandParent = User::where("\151\x64", "\x3d", $parent["\x70\141\162\145\x6e\x74\x5f\x69\144"])->find(); goto eksoV; fWELc: $thirdMoney = doubleval(sprintf("\x25\x2e\x32\x66", $share["\164\x68\151\162\144\x5f\x73\x63\141\154\145"])); goto I23JU; Vq1gY: $secondMoney = 0; goto BWetA; oNrzl: i9xjq: goto hZE4i; jNsbn: X801v: goto Nwyah; rZ0nt: $firstMoney = 0; goto dW24C; KS1Ap: $grandParentShareMoney["\x70\141\x72\x65\156\164\x5f\151\144"] = $grandParent["\151\144"]; goto h8TsX; byRnZ: $uid = Token::getCurrentUid(); goto pcp94; YaQz6: $great_grandParentShareMoney["\163\157\165\x72\143\145"] = 3; goto hVmmh; mBxCo: $great_grandParent = User::where("\x69\x64", "\75", $grandParent["\160\141\x72\145\x6e\x74\x5f\151\x64"])->find(); goto afjN9; tSB5g: $grandParentShareMoney["\165\156\151\x61\143\151\x64"] = session("\x75\156\151\x61\143\151\x64"); goto JRxZw; kgGFe: goto oH8t5; goto uPACG; okGnp: $secondMoney = doubleval(sprintf("\x25\56\62\x66", $share["\x73\x65\x63\157\x6e\144\x5f\163\143\141\x6c\145"])); goto kgGFe; P0oPd: $parentShareMoney["\x73\x6f\165\x72\143\x65"] = 1; goto gF11x; CTdMZ: $order = Order::get($orderId); goto R4bIf; s35Bk: oH8t5: goto q0Ocy; R3CAj: ep2DN: goto VuPRJ; mdMSJ: mutfs: goto ws4Nr; kHy9_: if (!($share["\163\145\x63\157\156\144\137\163\x63\x61\x6c\x65"] != null && $share["\154\145\x76\x65\154"] == 3)) { goto f43Rx; } goto lKCWv; pcp94: $share = ShareSetting::where("\165\x6e\x69\141\x63\151\x64", session("\x75\156\151\x61\143\151\144"))->find(); goto FnhUu; q0Ocy: if (!($secondMoney < 0)) { goto TFnUa; } goto Vq1gY; d3E17: $great_grandParentScale = $share["\164\150\151\x72\144\x5f\163\x63\x61\154\x65"] / 100; goto MGPhE; cVMYh: $parent = User::where("\x69\x64", "\75", $user["\160\x61\162\145\x6e\164\x5f\x69\144"])->find(); goto Q63o2; ADZv_: return; goto sAH0S; I23JU: goto i9xjq; goto jD2ln; yst8d: $user = User::where("\151\144", "\75", $uid)->find(); goto cVMYh; h8TsX: $grandParentShareMoney["\x73\x6f\x75\x72\143\145"] = 2; goto ovZX9; Q63o2: if (!$parent) { goto kEDdT; } goto gM3yT; UbT4B: $great_grandParentShareMoney["\165\x6e\151\x61\x63\151\144"] = session("\165\x6e\x69\141\x63\x69\x64"); goto ntdxa; PhNgn: UserShareMoney::create($parentShareMoney); goto VHVht; khyGb: $firstMoney = doubleval(sprintf("\x25\56\62\x66", $share["\146\151\x72\x73\x74\x5f\163\x63\141\x6c\145"])); goto HVLvo; eksoV: if (!$grandParent) { goto lm2dE; } goto iYGSS; FnhUu: if (!(empty($share) || $share["\x73\167\x69\x74\143\x68"] == 0)) { goto YoClG; } goto ADZv_; b0YPF: o4lUV: goto UbT4B; dW24C: aCm0g: goto eSJdU; afjN9: if (!$grandParent) { goto FL_2k; } goto kHy9_; sAH0S: YoClG: goto CTdMZ; R4bIf: $first_price = $second_price = $third_price = 0; goto yst8d; eSJdU: $parentShareMoney["\x75\x6e\x69\141\x63\x69\x64"] = session("\165\156\x69\x61\143\151\x64"); goto uX12Q; lXAXU: $thirdMoney = 0; goto b0YPF; HVLvo: goto ep2DN; goto KVVCN; piTXo: $grandParentScale = $share["\x73\145\143\x6f\156\144\x5f\x73\143\141\154\x65"] / 100; goto NalTF; VuPRJ: if (!($firstMoney < 0)) { goto aCm0g; } goto rZ0nt; KVVCN: Vo8aL: goto ffga4; YxK_5: f43Rx: goto ahC3r; fR_Fz: $order->first_price = $first_price; goto s0bxp; SU8Fm: $great_grandParentShareMoney["\x6d\x6f\x6e\x65\171"] = $thirdMoney; goto G4KQT; JRxZw: $grandParentShareMoney["\x75\163\145\x72\x5f\x69\144"] = $uid; goto KS1Ap; ovZX9: $grandParentShareMoney["\x6f\x72\144\x65\162\137\151\144"] = $orderId; goto fMrOG; s0bxp: $order->save(); goto mdMSJ; M9BLR: $firstMoney = doubleval(sprintf("\x25\x2e\62\146", $o_amount * $parentScale)); goto R3CAj; GEk8Y: $parentShareMoney["\155\x6f\x6e\145\x79"] = $firstMoney; goto PhNgn; fMrOG: $grandParentShareMoney["\155\157\156\145\x79"] = $secondMoney; goto v8E1i; gM3yT: if (!($share["\146\x69\162\163\164\137\163\x63\x61\154\x65"] != null && $share["\x6c\x65\166\145\x6c"] >= 1)) { goto mutfs; } goto TTAJH; MGPhE: $thirdMoney = doubleval(sprintf("\x25\56\62\x66", $o_amount * $great_grandParentScale)); goto oNrzl; VHVht: $first_price = $parentShareMoney["\x6d\157\156\x65\171"]; goto fR_Fz; kcgUd: $order->second_price = $second_price; goto ep2ga; BWetA: TFnUa: goto tSB5g; msTDz: $third_price = $great_grandParentShareMoney["\155\157\156\145\x79"]; goto ldVqB; U4uLx: if ($share["\x73\x63\141\154\x65\x5f\x74\171\160\145"] == 2) { goto s9ehR; } goto okGnp; v8E1i: UserShareMoney::create($grandParentShareMoney); goto Euwfz; lHX3p: $order->save(); goto YxK_5; uPACG: s9ehR: goto piTXo; Euwfz: $second_price = $grandParentShareMoney["\155\157\x6e\x65\171"]; goto kcgUd; Nwyah: lm2dE: goto mBxCo; lKCWv: if ($share["\163\x63\x61\x6c\x65\x5f\164\x79\x70\x65"] == 2) { goto PR3vk; } goto fWELc; k2Jvy: $parentShareMoney["\160\x61\x72\x65\156\x74\137\x69\144"] = $parent["\151\x64"]; goto P0oPd; Wwj4A: kEDdT: goto FP5ja; hazvh: $great_grandParentShareMoney["\160\x61\162\x65\x6e\164\137\x69\144"] = $great_grandParent["\151\144"]; goto YaQz6; ntdxa: $great_grandParentShareMoney["\x75\163\145\x72\x5f\151\x64"] = $uid; goto hazvh; iYGSS: if (!($share["\x73\145\x63\157\x6e\x64\137\163\x63\141\154\x65"] != null && $share["\154\x65\x76\x65\x6c"] >= 2)) { goto X801v; } goto U4uLx; FP5ja: } public static function sumNotSettleShareMoney($uid) { $sum = self::where(["\165\x6e\151\141\x63\151\x64" => session("\165\156\x69\x61\x63\x69\x64"), "\x70\x61\162\x65\x6e\x74\x5f\151\144" => $uid, "\151\163\x5f\x73\145\x74\x74\x6c\x65" => 0, "\151\x73\x5f\x64\x65\x6c\x65\x74\x65" => 0])->sum("\x6d\157\x6e\x65\x79"); return $sum; } }