<?php
 namespace app\api\service; use app\api\model\PickPoint as PickPointModel; use app\api\model\Delivery as DeliveryModel; class TimeRange { private $otherDay; public function getPickPointDate($pickPointId) { goto eAd6P; eAd6P: $pickPoint = PickPointModel::where(["\165\x6e\151\141\x63\x69\144" => session("\x75\156\151\x61\x63\x69\144"), "\x73\x74\141\164\165\163" => 1])->find($pickPointId); goto qyKlT; o6lDP: $pickTime = json_decode($pickPoint["\160\151\x63\153\137\x74\151\x6d\x65"], true); goto ahm74; Jijyz: X9KW7: goto yvDEI; KjsCT: $time = array_values($time); goto ug9ae; ug9ae: foreach ($time as $key => $value) { goto I7VQD; bBaJR: $day[$key]["\167\145\x65\153"] = "\xe6\x98\x8e\xe5\244\251"; goto xLBqh; aQVfa: $day[$key]["\144\x61\x79"] = $date; goto KESwm; IjFGC: $day[$key]["\167\x65\145\x6b"] = "\xe5\220\216\xe5\244\251"; goto t1Nc_; b_H1g: $day[$key]["\x69\163\137\x64\x61\171\157\146\146"] = 1; goto ITu1o; xLBqh: goto ctjAa; goto jmMjE; GkNXA: $day[$key]["\167\x65\x65\153"] = $week; goto UDNz_; YLu_y: $week = whichWeek(strtotime($value)); goto Dsrx1; VhHUb: $day[$key]["\x74\x69\x6d\x65"] = []; goto b_H1g; IaoJC: unset($value); goto pgj3R; jmMjE: ppzVH: goto IjFGC; t1Nc_: ctjAa: goto aQVfa; IbDuw: if ($key == 1) { goto d8KUA; } goto PWb59; hKQRe: Iakbt: goto M6jim; Dsrx1: $date = date("\155\xe6\234\210\144\xe6\227\245", strtotime($value)); goto VhHUb; ITu1o: foreach ($pickTime as $k => $v) { goto eunKM; B8wix: goto oNZiq; goto K3xLV; t7Ikq: if ($pickPoint["\141\144\166\x61\156\x63\x65"] == 1 && $key < $pickPoint["\x61\x64\x76\x61\x6e\143\145\x5f\164\x69\x6d\x65"]) { goto m6zMa; } goto TUW2F; kIcUk: $day[$key]["\151\163\137\x64\141\171\157\146\146"] = 0; goto FFzr7; FFzr7: lOxOm: goto LzBk8; eunKM: $weeks = explode("\x2c", $v["\167\145\145\x6b"]); goto tNWgw; tNWgw: if (!(in_array($week, $weeks) && $key <= $pickPoint["\142\157\157\153\151\x6e\147\137\164\x69\x6d\x65"])) { goto lOxOm; } goto po8q1; po8q1: if ($key > 0) { goto RF9ki; } goto tz5k0; TUW2F: $this->otherDay = 1; goto B8wix; K3xLV: m6zMa: goto fWN72; tz5k0: $this->otherDay = 0; goto vFrEB; zv6bl: $day[$key]["\x74\x69\155\x65"] = self::getTimeZoom($pickPoint, $v["\163\x74\141\x72\x74\124\x69\155\x65"], $v["\145\x6e\x64\x54\151\x6d\145"]); goto kIcUk; eUIvw: SFCE8: goto zv6bl; LzBk8: BvcdF: goto aj2bt; vFrEB: goto SFCE8; goto NmH1r; NmH1r: RF9ki: goto t7Ikq; fWN72: $this->otherDay = 0; goto TamSP; TamSP: oNZiq: goto eUIvw; aj2bt: } goto HTamB; ibynh: if ($key == 0) { goto Iakbt; } goto IbDuw; PWb59: if ($key == 2) { goto ppzVH; } goto GkNXA; RVyIa: goto ctjAa; goto Fxx4Q; UDNz_: goto ctjAa; goto hKQRe; HTamB: QWJIS: goto ibynh; M6jim: $day[$key]["\167\145\145\x6b"] = "\344\273\212\xe5\xa4\xa9"; goto RVyIa; r8iNO: eca2Z: goto YLu_y; KESwm: UOiYc: goto Uu1rn; Fxx4Q: d8KUA: goto bBaJR; I7VQD: if (!($pickPoint["\141\144\x76\x61\156\143\145"] == 1 && $key < $pickPoint["\141\x64\x76\x61\x6e\143\x65\137\x74\x69\x6d\x65"])) { goto eca2Z; } goto IaoJC; pgj3R: goto UOiYc; goto r8iNO; Uu1rn: } goto QSIui; gKRMO: return ["\x6d\163\x67" => "\xe8\207\xaa\346\217\x90\xe7\x82\271\xe4\xbf\xa1\346\x81\257\xe6\234\252\351\x85\x8d\xe7\xbd\xae", "\145\162\x72\x6f\x72\103\x6f\144\x65" => 0]; goto Jijyz; eC0Qs: $day = []; goto KjsCT; guZdG: A2zNl: goto o6lDP; yvDEI: if (!($pickPoint["\151\163\137\160\151\x63\153"] == 0)) { goto A2zNl; } goto vCp9J; cp0nH: $data = ["\x64\141\x74\x61" => array_values($day), "\164\171\160\x65" => $pickPoint["\x74\171\x70\145"], "\x65\162\x72\157\x72\103\157\x64\x65" => 1]; goto gT9t_; gT9t_: return $data; goto vxszy; qyKlT: if (!empty($pickPoint)) { goto X9KW7; } goto gKRMO; vCp9J: return ["\x6d\x73\147" => "\xe8\xaf\xb7\345\260\xbd\345\277\253\xe5\x88\260\350\x87\252\346\217\x90\347\202\xb9\346\217\x90\350\264\xa7", "\145\x72\162\x6f\162\103\157\144\145" => 0]; goto guZdG; ahm74: $time = getDay(time(), $pickPoint["\142\157\157\x6b\x69\x6e\147\x5f\x74\151\155\x65"]); goto eC0Qs; QSIui: k32aJ: goto cp0nH; vxszy: } public function getDeliveryDate() { goto tXvCv; Xdeft: if (!($delivery["\151\x73\x5f\164\x69\x6d\151\156\x67"] == 0)) { goto ZQatx; } goto ANCtr; ANCtr: return ["\155\x73\147" => "\344\xb8\215\351\x9c\x80\xe8\246\201\351\x80\211\xe6\x8b\xa9\xe9\x80\x81\xe8\276\276\346\227\xb6\351\227\xb4", "\145\x72\x72\x6f\162\x43\157\x64\x65" => 0]; goto TIWeC; F8Cug: KRPsI: goto Xdeft; H_16e: if (!empty($delivery)) { goto KRPsI; } goto OdAvU; dcND3: $day = []; goto gKo77; fXZZC: $pickTime = json_decode($delivery["\x74\151\x6d\145"], true); goto e0W1h; OdAvU: return ["\x6d\163\x67" => "\xe9\205\x8d\xe9\200\x81\344\277\241\xe6\x81\257\xe6\x9c\xaa\xe9\205\x8d\xe7\275\256", "\145\x72\162\157\x72\103\x6f\144\145" => 0]; goto F8Cug; ZB5FM: foreach ($time as $key => $value) { goto ifNLC; o_5WS: if ($key == 2) { goto K3_80; } goto hLR2Y; OOmaw: $date = date("\x6d\346\x9c\210\x64\xe6\227\xa5", strtotime($value)); goto WN51E; ZfICk: EcHYa: goto VE8GJ; z_8nd: Ihgif: goto Uy5ta; mSBhN: K3_80: goto p8Co7; hLR2Y: $day[$key]["\x77\145\x65\153"] = $week; goto NWaKM; SRahY: $day[$key]["\151\163\x5f\144\141\171\157\146\x66"] = 1; goto CB3VF; NWaKM: goto D7h9w; goto z_8nd; YYqWn: $day[$key]["\167\x65\145\153"] = "\346\230\216\xe5\244\xa9"; goto Tcmqc; uNrLZ: jB2Fe: goto BlzjA; CB3VF: foreach ($pickTime as $k => $v) { goto GgvZC; c8o1I: if ($delivery["\x61\144\166\x61\x6e\x63\145"] == 1 && $key < $delivery["\141\144\x76\x61\156\x63\x65\137\x74\x69\155\145"]) { goto JOQmT; } goto Ci0OP; GgvZC: $weeks = explode("\x2c", $v["\x77\145\145\153"]); goto rR3xo; yE0j8: goto ziWvJ; goto g3w0R; Wp8Ym: $this->otherDay = 0; goto yE0j8; Pgi0v: ziWvJ: goto BksOX; Ci0OP: $this->otherDay = 1; goto x6Jho; x6Jho: goto eKd_a; goto G_BSm; V9CWW: SCWVu: goto NUHOR; g3w0R: rQ0B2: goto c8o1I; Gzb5N: if ($key > 0) { goto rQ0B2; } goto Wp8Ym; BksOX: $day[$key]["\164\151\155\145"] = self::getTimeZoom($delivery, $v["\163\164\141\162\164\x54\151\x6d\x65"], $v["\145\156\144\124\x69\x6d\x65"]); goto nuDuO; X_ZoV: eKd_a: goto Pgi0v; XBptp: $this->otherDay = 0; goto X_ZoV; rR3xo: if (!(in_array($week, $weeks) && $key <= $delivery["\x62\x6f\x6f\x6b\x69\156\147\x5f\164\x69\155\145"])) { goto PO0gB; } goto Gzb5N; nuDuO: $day[$key]["\151\x73\x5f\144\141\x79\157\x66\x66"] = 0; goto ojDjO; ojDjO: PO0gB: goto V9CWW; G_BSm: JOQmT: goto XBptp; NUHOR: } goto uNrLZ; ifNLC: if (!($delivery["\x61\x64\166\x61\156\x63\x65"] == 1 && $key < $delivery["\141\144\x76\141\x6e\x63\145\137\x74\x69\155\145"])) { goto L70WM; } goto DKZZU; DKZZU: unset($value); goto QbLb_; frIgm: if ($key == 1) { goto oVmvb; } goto o_5WS; WN51E: $day[$key]["\x74\x69\155\145"] = []; goto SRahY; IXVdt: oVmvb: goto YYqWn; QbLb_: goto EcHYa; goto W6RXW; iBb0e: $day[$key]["\144\x61\x79"] = $date; goto ZfICk; rnh4G: D7h9w: goto iBb0e; Tcmqc: goto D7h9w; goto mSBhN; p8Co7: $day[$key]["\x77\145\x65\x6b"] = "\345\220\x8e\345\244\xa9"; goto rnh4G; LmxCL: $week = whichWeek(strtotime($value)); goto OOmaw; yi5WR: goto D7h9w; goto IXVdt; Uy5ta: $day[$key]["\167\x65\x65\x6b"] = "\xe4\273\x8a\345\244\251"; goto yi5WR; W6RXW: L70WM: goto LmxCL; BlzjA: if ($key == 0) { goto Ihgif; } goto frIgm; VE8GJ: } goto X4y64; gKo77: $time = array_values($time); goto ZB5FM; TIWeC: ZQatx: goto fXZZC; ZVxjO: $data = ["\x64\x61\164\x61" => array_values($day), "\164\x79\x70\145" => $delivery["\164\x79\x70\x65"], "\x65\162\x72\157\162\x43\x6f\144\145" => 1]; goto oF7Mo; X4y64: KxvIr: goto ZVxjO; e0W1h: $time = getDay(time(), $delivery["\142\157\157\x6b\x69\x6e\x67\x5f\164\151\155\145"]); goto dcND3; oF7Mo: return $data; goto DvOuE; tXvCv: $delivery = DeliveryModel::where(["\x75\156\x69\141\143\151\x64" => session("\165\x6e\x69\141\143\x69\144")])->order("\x69\x64", "\144\x65\163\143")->find(); goto H_16e; DvOuE: } public function getTimeZoom($pickPoint, $startTime, $endTime) { goto fJFki; jU7Ag: if ($pickPoint["\x74\x79\160\145"] == 3) { goto PXbe4; } goto n1ZF9; Io0Ba: goto wMV4v; goto KwOay; TnC96: goto ArYPR; goto LtOEk; OiZUO: wMV4v: goto Y8UlE; GWFNY: $nightDayoff = 0; goto BVICh; LtOEk: PXbe4: goto MeaCt; Koa8C: if ($pickPoint["\x74\x79\x70\145"] <= 2) { goto TK3y8; } goto jU7Ag; KwOay: PAleC: goto JnG1O; n1ZF9: goto ArYPR; goto p7nsu; SfQtR: $morningDayoff = 0; goto yCS6F; BVICh: if ($nowTime > strtotime("\61\62\72\60\60") && $nowTime <= strtotime("\x31\x38\72\60\60") && $this->otherDay == 0) { goto PAleC; } goto HTrxI; JnG1O: $morningDayoff = 1; goto gSFo6; fJFki: $data = []; goto Koa8C; yCS6F: $afternoonDayoff = 0; goto GWFNY; TAxTW: $morningDayoff = 1; goto Do6qC; gSFo6: goto wMV4v; goto cFy19; p8k6x: $data = self::setTimeZoom($pickPoint, $startTime, $endTime); goto TnC96; p7nsu: TK3y8: goto p8k6x; MeaCt: $nowTime = time(); goto SfQtR; cFy19: p0rvq: goto TAxTW; HTrxI: if ($nowTime > strtotime("\x31\x38\x3a\60\60") && $this->otherDay == 0) { goto p0rvq; } goto Io0Ba; PBQuj: return $data; goto Lb2q0; Do6qC: $afternoonDayoff = 1; goto OiZUO; iI1C_: ArYPR: goto PBQuj; Y8UlE: $data = [["\151\x73\x5f\144\141\171\157\146\x66" => $morningDayoff, "\156\x61\x6d\145" => "\xe4\xb8\212\345\215\210"], ["\151\x73\x5f\144\141\171\157\x66\x66" => $afternoonDayoff, "\156\141\155\x65" => "\xe4\270\213\345\x8d\210"], ["\x69\163\x5f\x64\141\x79\157\146\146" => $nightDayoff, "\x6e\141\155\145" => "\xe6\x99\232\xe4\270\x8a"]]; goto iI1C_; Lb2q0: } public function setTimeZoom($pickPoint, $startTime, $endTime) { goto Utfgb; CQGu1: $tamp = 1800; goto ogait; ZotR1: $tamp = 3600; goto VExM3; Fofha: if ($pickPoint["\164\171\x70\145"] == 2) { goto oEQrQ; } goto prLBe; BK3tk: e3Eow: goto RpZXZ; Utfgb: $hour = floor((strtotime($endTime) - strtotime($startTime)) % 86400 / 3600); goto Fofha; XSQEF: $data = self::setTime($date, $pickPoint); goto GLk8t; iDvem: goto J7G9a; goto BK3tk; ogait: goto n41rD; goto umEH5; qEpIy: $i++; goto iDvem; VExM3: n41rD: goto VCskq; prLBe: $max = $hour * 2 + 2; goto CQGu1; GLk8t: return $data; goto aXLgA; RpZXZ: $date[$max] = $endTime; goto XSQEF; zem6k: J7G9a: goto iILfA; s35TE: wrY8S: goto qEpIy; iILfA: if (!($i <= $max)) { goto e3Eow; } goto UBX3Z; VCskq: $i = 0; goto zem6k; n9c10: $max = $hour + 1; goto ZotR1; umEH5: oEQrQ: goto n9c10; UBX3Z: $date[$i] = date("\x48\72\151", strtotime($startTime) + $tamp * $i); goto s35TE; aXLgA: } public function setTime($dateData, $pickPoint) { goto efTwG; XSv2G: unset($data["\x6e\151\x67\x68\164"][$nightMax - 1]); goto IVdF1; sZYky: gUBJu: goto HmUKD; a3OQj: $data["\x61\x66\x74\145\162\x6e\x6f\x6f\x6e"] = array_values($data["\x61\146\x74\x65\x72\156\157\x6f\x6e"]); goto IUeSE; Shx9n: $advance = $pickPoint["\141\x64\166\141\x6e\x63\x65\137\164\151\155\x65"] * 60; goto RWPSC; kgWnA: $nightMax = count($data["\x6e\x69\147\150\x74"]); goto BMlP2; TLq0u: $advance = $pickPoint["\141\x64\x76\141\156\x63\145\137\x74\x69\155\x65"] * 3600; goto midx2; ZJ7Wy: if ($pickPoint["\141\x64\166\141\156\143\x65"] == 2) { goto M02OQ; } goto Ltr_D; H4yNi: tDpgH: goto gw91S; Ltr_D: if ($pickPoint["\141\144\x76\x61\x6e\x63\145"] == 3) { goto RooQS; } goto MxEez; gw91S: $data = []; goto P4cKI; IUeSE: $data["\x6e\x69\147\x68\164"] = array_values($data["\x6e\151\147\x68\x74"]); goto s17uR; RWPSC: goto tDpgH; goto burr2; HmUKD: $data["\155\x6f\x72\x6e\151\156\x67"] = array_values($data["\x6d\x6f\x72\156\151\156\147"]); goto a3OQj; BF4rG: $advance = $pickPoint["\x61\x64\166\x61\156\x63\x65\x5f\164\x69\155\145"] * 86400; goto H4yNi; burr2: pkhEt: goto BF4rG; midx2: goto tDpgH; goto PTwWU; qiM3S: $advance = 0; goto qcoYn; efTwG: $otherDay = $this->otherDay; goto ZJ7Wy; W3zJp: M02OQ: goto TLq0u; BMlP2: unset($data["\155\x6f\162\x6e\x69\156\x67"][$morningMax - 1]); goto XSv2G; PTwWU: RooQS: goto Shx9n; P4cKI: foreach ($dateData as $key => $value) { goto W0_Ed; xJ6rj: if (strtotime(date("\110\72\x69", time())) > strtotime($dateData[$key + 1]) - $advance && $otherDay == 0) { goto c9SDX; } goto ng9aU; FURgk: $data["\156\151\147\x68\164"][$key]["\x64\x61\164\145"] = $dateData[$key] . "\55" . $dateData[$key + 1]; goto K13U4; kgC9x: jnWO7: goto P80ee; W0_Ed: if (strtotime($dateData[$key + 1]) < strtotime("\61\x32\72\60\60")) { goto cmQGH; } goto UZ3lj; P80ee: xL6Qw: goto XkuLs; b10qc: goto jnWO7; goto EbFB8; A6cpu: IPERe: goto XGLjM; HNW2P: goto A3lfy; goto ETRh9; ng9aU: $data["\x61\146\x74\x65\x72\x6e\157\x6f\x6e"][$key]["\x69\x73\x5f\x64\141\171\x6f\146\146"] = 0; goto b10qc; ETRh9: R1IM7: goto Fw3mG; yxV0j: goto xL6Qw; goto A6cpu; iglcR: if (strtotime(date("\x48\72\x69", time())) > strtotime($dateData[$key + 1]) - $advance && $otherDay == 0) { goto qzOMf; } goto cnOt7; OVoA9: cmQGH: goto YtfML; rt8A3: A3lfy: goto s0Evv; tywga: $data["\x6e\151\x67\150\x74"][$key]["\151\x73\x5f\x64\x61\171\157\x66\x66"] = 0; goto HNW2P; Fw3mG: $data["\x6e\x69\x67\x68\x74"][$key]["\151\x73\137\x64\141\171\x6f\x66\x66"] = 1; goto rt8A3; K13U4: if (strtotime(date("\110\72\x69", time())) > strtotime($dateData[$key + 1]) - $advance && $otherDay == 0) { goto R1IM7; } goto tywga; NAPyh: qzOMf: goto PNFF7; aUB_x: goto Z6C0p; goto NAPyh; cnOt7: $data["\155\x6f\162\x6e\x69\x6e\x67"][$key]["\x69\163\x5f\x64\141\x79\x6f\146\x66"] = 0; goto aUB_x; lEuUk: $data["\141\146\x74\x65\162\x6e\x6f\x6f\x6e"][$key]["\x69\x73\137\x64\x61\171\x6f\x66\146"] = 1; goto kgC9x; XGLjM: $data["\x61\146\164\x65\162\156\157\x6f\156"][$key]["\x64\141\x74\x65"] = $dateData[$key] . "\55" . $dateData[$key + 1]; goto xJ6rj; s0Evv: goto xL6Qw; goto OVoA9; UpjGP: Z6C0p: goto yxV0j; XkuLs: RVsv2: goto imwrV; YtfML: $data["\155\x6f\162\156\x69\x6e\147"][$key]["\144\x61\x74\145"] = $dateData[$key] . "\55" . $dateData[$key + 1]; goto iglcR; EbFB8: c9SDX: goto lEuUk; UZ3lj: if (strtotime($dateData[$key + 1]) >= strtotime("\61\62\x3a\60\x30") && strtotime($dateData[$key + 1]) < strtotime("\61\70\x3a\x30\60")) { goto IPERe; } goto FURgk; PNFF7: $data["\155\x6f\162\156\151\x6e\x67"][$key]["\x69\163\x5f\x64\141\x79\x6f\x66\146"] = 1; goto UpjGP; imwrV: } goto sZYky; MxEez: if ($pickPoint["\x61\144\x76\x61\156\x63\x65"] == 1) { goto pkhEt; } goto qiM3S; qcoYn: goto tDpgH; goto W3zJp; IVdF1: return $data; goto D_CKV; s17uR: $morningMax = count($data["\x6d\x6f\x72\156\151\156\147"]); goto kgWnA; D_CKV: } }