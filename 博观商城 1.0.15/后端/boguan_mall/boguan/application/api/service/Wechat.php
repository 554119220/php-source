<?php
 namespace app\api\service; use think\Log; use app\api\model\PlatformSettings; class Wechat { public function __construct() { } public static function refund($data) { goto VPoVh; SKpg0: $data["\157\x70\137\165\x73\x65\162\137\151\144"] = $platform["\155\x63\x68\x5f\x69\144"]; goto ZND6I; KR3Ll: $result = curl_post_raw($url, $xml, "\x50\x45\x4d"); goto luRUo; yVnyW: return $result; goto BaiK5; kQhFB: $url = "\x68\x74\164\x70\x73\x3a\x2f\57\x61\x70\151\x2e\155\143\x68\56\x77\x65\151\x78\x69\156\x2e\x71\161\56\143\x6f\155\57\163\x65\143\141\x70\151\x2f\160\141\171\x2f\162\145\146\165\x6e\x64"; goto KR3Ll; jcW06: $data["\156\x6f\156\143\x65\x5f\x73\x74\x72"] = md5(uniqid()); goto SKpg0; Lyi_w: $data["\x6d\143\x68\x5f\x69\x64"] = $platform["\155\143\x68\x5f\151\x64"]; goto jcW06; mFxa7: $xml = arrayToXml($data); goto kQhFB; ZND6I: $data["\x73\x69\x67\156"] = self::makeSign($data); goto mFxa7; luRUo: $result = xmlToArray($result); goto yVnyW; t_HEx: $data["\x61\160\x70\151\x64"] = $platform["\141\x70\160\x69\x64"]; goto Lyi_w; VPoVh: $platform = PlatformSettings::where("\165\x6e\x69\x61\143\151\x64", session("\x75\156\151\141\143\151\144"))->find(); goto t_HEx; BaiK5: } public static function GetTransfers($args) { goto Ssky_; muSzE: $result = xmlToArray($result); goto HIWDd; Ssky_: $platform = PlatformSettings::where("\x75\x6e\x69\x61\143\x69\x64", session("\165\x6e\151\x61\143\151\144"))->find(); goto kTHaj; pkSsr: $result = curl_post_raw($url, $xml, "\x50\105\115"); goto muSzE; uGuD_: $args["\143\x68\145\143\x6b\137\x6e\141\155\x65"] = "\116\x4f\x5f\x43\x48\105\103\113"; goto bx1Dw; hD4yP: $args["\x6d\143\x68\x69\x64"] = $platform["\155\143\x68\137\x69\144"]; goto vF076; yiYoU: $args["\163\151\x67\x6e"] = self::makeSign($args); goto nPU3S; ksa9D: $url = "\x68\164\164\x70\163\72\57\57\141\x70\x69\56\x6d\x63\x68\56\x77\x65\151\170\x69\x6e\x2e\161\161\x2e\143\157\x6d\x2f\x6d\x6d\x70\x61\171\x6d\x6b\164\164\162\141\x6e\163\x66\x65\162\163\57\x70\x72\x6f\155\157\x74\151\157\156\57\164\x72\x61\x6e\163\146\x65\x72\x73"; goto pkSsr; HIWDd: return $result; goto vgzJ4; vF076: $args["\156\157\156\x63\x65\x5f\163\164\x72"] = md5(uniqid()); goto uGuD_; nPU3S: $xml = arrayToXml($args); goto ksa9D; kTHaj: $args["\155\143\150\137\x61\160\160\151\144"] = $platform["\141\160\160\x69\x64"]; goto hD4yP; bx1Dw: $args["\163\160\142\x69\154\154\137\143\x72\x65\x61\164\145\x5f\151\160"] = "\61\x32\x37\56\x30\56\60\56\61"; goto yiYoU; vgzJ4: } public static function makeSign($args) { goto O5cAR; sEkJj: B5xhZ: goto ALd7K; aFObz: $result = strtoupper($string); goto oet_4; O5cAR: $platform = PlatformSettings::where("\x75\156\151\x61\x63\x69\x64", session("\165\x6e\x69\x61\x63\151\x64"))->find(); goto zczKN; icw5x: unset($args["\163\x69\147\x6e"]); goto sEkJj; oet_4: return $result; goto QG34j; xTAfM: $string = arrayToUrlParam($args, false); goto gaB0X; O9TXF: foreach ($args as $i => $arg) { goto UJVPp; LsTYK: unset($args[$i]); goto lg7EV; UJVPp: if (!($args === null || $arg === '')) { goto e11pF; } goto LsTYK; B7E5V: amElC: goto RuF7g; lg7EV: e11pF: goto B7E5V; RuF7g: } goto rbAuP; gaB0X: $string = $string . "\46\x6b\x65\x79\75" . $platform["\x6d\143\150\137\x6b\x65\x79"]; goto OHl4m; ALd7K: ksort($args); goto O9TXF; OHl4m: $string = md5($string); goto aFObz; rbAuP: bBbTa: goto xTAfM; zczKN: if (!isset($args["\163\x69\147\156"])) { goto B5xhZ; } goto icw5x; QG34j: } public static function createQrCode($data = '', $uid = '', $type = '') { goto XLOJG; fPNbj: if (is_dir(ROOT_PATH . $saveRoot)) { goto SaX_o; } goto JNMW2; lvJ5l: goto lmuLg; goto Vv7uG; Vv7uG: A2SOz: goto tqmFn; lZbL1: $qrCode = curl_post($url, $post); goto YmF0L; Hx1hN: goto lmuLg; goto opogz; JNMW2: mkdir(ROOT_PATH . $saveRoot, 0777, true); goto O5SEe; opogz: l8RP2: goto FixCI; OHCB_: $post = ["\163\x63\145\x6e\x65" => "\x70\x61\162\145\156\x74\111\144\75" . $uid . "\46\x69\144\75" . $data . "\46\x74\171\160\145\75" . $type, "\x70\x61\x67\x65" => $page]; goto lZbL1; FixCI: $page = MODEL . "\57\160\141\x67\x65\163\57\x48\157\x6d\x65\x2f\166\145\x72\151\146\151\143\x61\x74\x69\157\x6e\57\166\145\x72\x69\146\151\143\141\x74\151\x6f\x6e"; goto ORpco; tqmFn: $page = MODEL . "\57\x70\141\147\145\x73\x2f\110\157\x6d\145\x2f\147\x6f\x6f\144\163\x2f\x67\157\x6f\x64\x73"; goto Hx1hN; G8Oyn: if ($type == "\x70\x72\157\144\x75\x63\x74") { goto A2SOz; } goto jimEC; jimEC: if ($type == "\x63\154\x65\x72\153") { goto l8RP2; } goto lvJ5l; mVnLf: $page = ''; goto G8Oyn; SHGrO: $url = sprintf(config("\x73\x65\164\164\x69\156\147\x73\56\x71\x72\137\x63\157\x64\145\137\165\162\x6c"), $token); goto mVnLf; ORpco: lmuLg: goto OHCB_; eCNz8: $saveRoot = "\x70\x75\142\154\x69\143" . DS . "\163\164\141\x74\151\x63" . DS . "\x71\x72\143\157\144\x65" . DS . "\x73\164\157\162\x65\137" . session("\165\156\x69\x61\x63\151\144") . DS; goto fPNbj; XLOJG: header("\x63\157\x6e\x74\145\156\164\55\164\171\x70\145\x3a\151\x6d\141\x67\x65\x2f\152\x70\147"); goto WRtdV; ZMNY9: file_put_contents($saveRoot . $fileName, $qrCode); goto F2sgw; fp2gc: $token = $accessToken->get(); goto SHGrO; O5SEe: SaX_o: goto ZMNY9; F2sgw: return $fileName; goto xLTg1; WRtdV: $accessToken = new AccessToken(); goto fp2gc; YmF0L: $fileName = md5(uniqid()) . "\x2e\x70\156\x67"; goto eCNz8; xLTg1: } public static function addCartList($data) { goto OIA2F; PNSBd: return true; goto kuJ70; ZrBHH: $post = ["\165\163\145\x72\137\x6f\160\x65\x6e\137\151\x64" => $data["\x6f\160\x65\156\151\144"], "\163\153\165\x5f\160\162\x6f\x64\165\x63\x74\137\x6c\151\x73\164" => [["\x69\x74\x65\x6d\x5f\x63\x6f\144\x65" => $data["\x70\x72\157\x64\x75\143\x74\x49\x64"], "\x74\x69\164\x6c\145" => $data["\164\x69\164\x6c\x65"], "\144\145\163\x63" => $data["\x64\x65\163\143"], "\143\141\x74\x65\x67\x6f\x72\171\137\x6c\x69\x73\164" => '', "\151\x6d\x61\x67\145\x5f\x6c\151\x73\x74" => $data["\x74\150\x75\x6d\142"], "\163\162\x63\x5f\167\170\x61\x70\160\137\160\x61\164\150" => MODEL . "\57\x70\x61\147\145\163\x2f\110\x6f\155\145\x2f\147\x6f\157\144\x73\57\x67\x6f\x6f\144\163\x3f\147\x6f\157\144\x49\x64\x3d" . $data["\x70\x72\x6f\x64\x75\x63\x74\111\x64"], "\x61\164\164\162\x5f\x6c\151\163\x74" => [], "\166\145\x72\163\151\157\156" => "\61", "\x73\x6b\165\137\x69\x6e\x66\157" => ["\163\153\x75\137\x69\x64" => $data["\x61\x74\164\x72\137\151\x64\137\x6c\x69\163\164"], "\160\x72\x69\143\145" => floatval($data["\x70\162\x69\x63\x65"] * 100), "\157\162\151\147\x69\156\x61\154\137\x70\x72\151\x63\x65" => floatval($data["\157\x5f\160\162\151\x63\145"] * 100), "\x73\x74\141\164\x75\163" => 1, "\163\153\165\137\141\x74\164\162\x5f\154\151\163\x74" => $data["\x61\164\164\x72"], "\x76\145\x72\x73\151\157\x6e" => 1]]]]; goto gpEUq; mPhv7: $token = $accessToken->get(); goto KgtVU; gpEUq: $result = wx_curl_post($url, $post); goto PNSBd; KgtVU: $url = sprintf(config("\163\x65\164\164\x69\156\x67\x73\x2e\x61\x64\x64\137\143\141\162\164\137\x75\x72\154"), $token); goto ZrBHH; OIA2F: $accessToken = new AccessToken(); goto mPhv7; kuJ70: } public static function delCartList($data) { goto s0TRg; EuXLU: $post = ["\x75\x73\x65\162\x5f\x6f\x70\145\156\x5f\x69\x64" => $data["\x6f\x70\x65\156\151\x64"], "\163\x6b\165\137\x70\162\157\x64\165\x63\164\x5f\x6c\x69\163\x74" => [["\151\x74\x65\x6d\137\143\x6f\144\145" => $data["\x70\162\157\x64\x75\x63\164\137\151\144"], "\163\x6b\165\137\x69\144" => $data["\x61\x74\164\x72\137\x69\144\x5f\154\151\163\164"]]]]; goto HyQCi; s0TRg: $accessToken = new AccessToken(); goto KfCd3; HyQCi: $result = wx_curl_post($url, $post); goto Q51BU; Q51BU: return true; goto u9DPk; KfCd3: $token = $accessToken->get(); goto GeaQQ; GeaQQ: $url = sprintf(config("\163\145\x74\x74\151\156\x67\x73\56\144\145\x6c\x5f\143\141\x72\164\137\x75\162\154"), $token); goto EuXLU; u9DPk: } }