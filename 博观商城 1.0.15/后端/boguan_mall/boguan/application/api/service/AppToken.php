<?php
 namespace app\api\service; use app\api\model\ThirdApp; use app\lib\exception\TokenException; class AppToken extends Token { public function get($ac, $se) { goto hXl5s; ZrIsy: C8a48: goto Ls2Ih; XLEpP: IGOcS: goto uPl8a; gplrk: $token = $this->saveToCache($values); goto KaxuM; wWiMU: $uid = $app->id; goto Oz3LC; Y1LJR: goto C8a48; goto XLEpP; Oz3LC: $values = ["\x73\143\157\160\x65" => $scope, "\165\151\x64" => $uid]; goto gplrk; uPl8a: throw new TokenException(["\155\x73\147" => "\xe6\216\x88\346\x9d\x83\345\244\xb1\xe8\264\xa5", "\x65\162\x72\157\x72\103\157\x64\x65" => 10004]); goto ZrIsy; T6TE_: $scope = $app->scope; goto wWiMU; hXl5s: $app = ThirdApp::check($ac, $se); goto KLgHe; KLgHe: if (!$app) { goto IGOcS; } goto T6TE_; KaxuM: return $token; goto Y1LJR; Ls2Ih: } private function saveToCache($values) { goto ltV3j; RcoyU: $expire_in = config("\163\145\x74\x74\x69\156\147\x73\56\164\157\153\145\156\137\x65\x78\160\x69\162\x65\x5f\x69\156"); goto Mke9p; i4dfy: return $token; goto V3ISo; UMOzR: Tr32z: goto i4dfy; ltV3j: $token = self::generateToken(); goto RcoyU; Mke9p: $result = cache($token, json_encode($values), $expire_in); goto jPXuH; jPXuH: if ($result) { goto Tr32z; } goto m2MHl; m2MHl: throw new TokenException(["\155\163\147" => "\346\x9c\x8d\345\x8a\241\345\x99\xa8\347\xbc\223\xe5\255\230\xe5\274\202\345\270\270", "\x65\162\x72\157\x72\x43\x6f\x64\x65" => 10005]); goto UMOzR; V3ISo: } }