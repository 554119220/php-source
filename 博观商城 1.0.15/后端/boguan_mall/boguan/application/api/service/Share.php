<?php
 namespace app\api\service; use app\api\service\Token as TokenService; use app\api\model\User; use app\lib\exception\ShareException; use app\api\model\Order as OrderModel; use app\api\model\ShareSetting; use app\api\service\User as UserService; class Share { public static function bindParentById($parentId) { goto g0sx2; idKP0: throw new ShareException(["\x6d\x73\147" => "\xe8\xa6\201\347\xbb\221\xe5\xae\232\xe7\232\204\xe4\xb8\215\xe6\230\257\345\x88\x86\351\224\200\xe5\225\x86", "\x65\x72\162\143\x6f\144\x65" => 0]); goto A60fI; Lrkhw: $isBindMy = User::where(["\x69\x64" => $parentId, "\160\x61\162\145\x6e\164\x5f\151\x64" => $uid, "\x69\x73\137\x64\145\x6c\145\164\x65" => 0])->find(); goto kBgaI; aqIke: $res = self::check($uid, $parentId, 0); goto YJ2Pf; b90aq: YcIiU: goto p2zB8; jzDBL: $uid = TokenService::getCurrentUid(); goto G0B4c; YJ2Pf: if (!($res["\x63\x6f\x64\x65"] == 1)) { goto MHiww; } goto KbI7R; lR1gy: dO21m: goto aqIke; zzMye: $parent = User::where("\151\144", "\75", $parentId)->where("\x69\163\137\x64\145\x6c\145\x74\x65", "\x3d", "\60")->find(); goto nl7zD; QYoVt: if (!($parent["\151\163\137\x64\151\x73\x74\x72\151\142\x75\x74\157\162"] !== 1)) { goto OcgiA; } goto idKP0; un3pd: throw new ShareException(["\155\163\x67" => "\344\xb8\215\xe8\x83\275\xe7\273\221\xe5\256\x9a\xe8\x87\252\xe5\267\261\347\x9a\x84\344\270\x8b\xe7\xba\247"]); goto OEs7Y; eCLDA: $userData["\151\x64"] = $uid; goto jh0xG; L7_48: throw new ShareException(["\155\x73\x67" => "\345\xb7\xb2\347\xbb\x91\xe5\256\x9a\344\xba\x86\344\270\x8a\xe7\272\247"]); goto L7Csx; XN7cu: throw new ShareException(["\145\x72\162\x6f\x72\x43\x6f\x64\x65" => 400, "\155\163\x67" => "\347\275\x91\xe7\273\x9c\345\274\202\345\xb8\270"]); goto GzhZ8; G0B4c: $user = User::get($uid); goto uxC7d; ihGKQ: lXq19: goto DdUX8; xHTFW: throw new ShareException(["\x6d\163\x67" => "\xe8\x87\252\350\xba\xab\345\210\x86\344\xba\xab\347\232\x84\351\xa1\265\xe9\x9d\242"]); goto lR1gy; kBgaI: if (!$isBindMy) { goto JtHuZ; } goto un3pd; jNWmK: if (!($user->parent_id != 0)) { goto hUBKv; } goto L7_48; k3q8K: if ($res !== false) { goto DKk1g; } goto XN7cu; uQSbZ: if ($parent) { goto DfhuR; } goto lrU_x; xvnb9: MHiww: goto uQSbZ; OEs7Y: JtHuZ: goto jY5gR; DdUX8: $userData["\160\141\162\145\x6e\164\137\x75\163\x65\x72\x5f\151\x64"] = $parentId; goto eCLDA; b9yfE: throw new ShareException(["\x6d\x73\x67" => "\xe4\270\x8d\xe6\273\xa1\350\xb6\xb3\346\210\220\344\xb8\xba\344\xb8\x8b\347\272\247\xe7\x9a\x84\346\235\xa1\344\xbb\xb6"]); goto ihGKQ; lrU_x: throw new ShareException(["\155\163\147" => "\345\x88\x86\xe9\x94\x80\xe5\225\206\344\xb8\x8d\xe5\255\x98\xe5\x9c\250", "\x65\162\x72\x63\x6f\x64\x65" => 0]); goto RISNq; RISNq: DfhuR: goto QYoVt; L7Csx: hUBKv: goto Lrkhw; YIlnu: $userData["\x62\x69\156\144\137\164\151\155\x65"] = time(); goto FVueK; nl7zD: if (!($uid == $parentId)) { goto dO21m; } goto xHTFW; A60fI: OcgiA: goto jNWmK; WXSf6: return ["\x65\162\162\157\162\x43\157\x64\145" => 200, "\155\x73\147" => "\xe7\xbb\x91\345\xae\232\346\210\220\345\212\x9f", "\144\141\x74\x61" => $parent["\x6e\x69\x63\x6b\156\141\155\x65"]]; goto b90aq; iyGVN: Mr6ia: goto jzDBL; fDTc6: if (!($setting["\x73\167\x69\164\143\x68"] == 0)) { goto Mr6ia; } goto v7Ea7; FVueK: $res = User::update($userData); goto k3q8K; pCczX: DKk1g: goto WXSf6; g0sx2: $setting = ShareSetting::where(["\x75\x6e\151\x61\143\151\x64" => session("\165\x6e\x69\141\143\151\x64")])->find(); goto fDTc6; v7Ea7: throw new ShareException(["\x6d\x73\x67" => "\345\x95\206\345\xae\266\346\234\xaa\345\xbc\200\xe5\220\xaf\345\x88\206\351\x94\200"]); goto iyGVN; GzhZ8: goto YcIiU; goto pCczX; uxC7d: if (!($setting["\163\x75\x62\x6f\162\x64\151\x6e\141\x74\x65\137\143\x6f\156\x64\151\164\x69\x6f\156"] != UserService::shareCondition($uid))) { goto lXq19; } goto b9yfE; jh0xG: User::update($userData); goto zzMye; KbI7R: throw new ShareException(["\155\x73\x67" => "\344\270\x8d\350\x83\275\347\xbb\x91\345\xae\x9a\357\xbc\214\350\257\267\xe8\201\224\347\263\273\xe7\xae\241\347\220\206\xe5\221\x98", "\145\x72\162\143\157\144\x65" => 0]); goto xvnb9; jY5gR: $userData["\x70\x61\x72\x65\x6e\x74\x5f\151\x64"] = $parentId; goto YIlnu; p2zB8: } public static function check($user_id, $parent_id, $root = 0) { goto RC0_y; gDHmZ: ATDrr: goto fPB2w; e0SMy: EzUil: goto VLaN8; QNnUT: if (!($parent_id == 0)) { goto ATDrr; } goto TVCVp; fPB2w: $user = User::where("\151\x64", "\x3d", $user_id)->where("\151\x73\x5f\144\145\x6c\145\x74\x65", "\75", "\60")->find(); goto fgoPp; TVCVp: return ["\x63\x6f\x64\145" => 0, "\x6d\163\147" => "\345\x8f\xaf\xe4\xbb\245\347\xbb\x91\345\256\x9a"]; goto gDHmZ; gnqpI: W_sCg: goto QNnUT; fgoPp: if (!($user_id == $user->parent_id)) { goto EzUil; } goto OmbbM; GVAIg: return ["\x63\x6f\x64\145" => 0, "\x6d\x73\147" => "\345\x8f\257\344\273\245\347\xbb\221\xe5\xae\x9a"]; goto gnqpI; VLaN8: return self::check($user_id, $user->parent_id, $root + 1); goto SRAGE; OmbbM: return ["\x63\x6f\x64\x65" => 1, "\x6d\x73\147" => "\344\xb8\215\350\203\xbd"]; goto e0SMy; RC0_y: if (!($root == 3)) { goto W_sCg; } goto GVAIg; SRAGE: } }