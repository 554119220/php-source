<?php
 namespace app\api\controller\v1; use app\api\controller\BaseController; use app\api\model\Collect; use app\api\model\Content as ContentModel; use app\api\model\ContentCate as ContentCateModel; use app\api\service\Token as TokenService; use app\api\model\ContentCollect; use app\api\model\Footprint as FootprintModel; use app\api\model\Collect as CollectModel; class Content extends BaseController { public function collectContent($contentId = 0) { goto G0hPI; myfje: $data["\165\156\x69\141\x63\x69\144"] = session("\x75\156\x69\x61\x63\x69\x64"); goto JTuLf; xELzr: DMMal: goto oZEIY; BcJ5Y: if ($collect) { goto DMMal; } goto zoh8a; CPwYc: u8XD1: goto DlLDy; YGkZ7: wsp1v: goto xOtYg; RXHOa: $data["\143\x6f\156\164\145\x6e\164\137\x69\144"] = $contentId; goto myfje; s1GNT: return ["\x6d\163\147" => "\xe7\xbd\x91\xe7\xbb\x9c\xe5\274\202\345\xb8\xb8", "\145\x72\x72\157\x72\103\157\x64\x65" => 0]; goto F0xmi; G0hPI: if (!($contentId == 0 || $contentId == '')) { goto LYNMQ; } goto sVPTw; MoDTj: fqrub: goto Qy6Qo; JTuLf: $result = ContentCollect::create($data); goto cH75g; DlLDy: B_0ye: goto awvvs; kuVqV: $content = ContentModel::where("\x75\x6e\151\x61\143\x69\x64", session("\x75\156\151\141\143\x69\144"))->find($contentId); goto NoEIn; nTkMc: return ["\155\x73\147" => "\xe7\xbd\x91\xe7\273\234\xe5\274\x82\345\270\270", "\x65\x72\x72\x6f\x72\103\157\x64\145" => 0]; goto B7Z5g; zoh8a: $data["\x75\163\x65\x72\137\151\144"] = $uid; goto RXHOa; xOtYg: return ["\155\163\147" => "\345\xb7\xb2\xe6\224\266\350\227\217", "\144\x61\x74\141" => ["\151\x73\137\143\157\x6c\154\145\143\x74" => 1], "\145\162\162\157\x72\103\157\144\145" => 1]; goto MoDTj; F0xmi: goto fqrub; goto YGkZ7; D_Zuo: UlyfI: goto z9NFh; oZEIY: $result = $collect->delete(); goto QvTEs; NoEIn: if (!empty($content)) { goto BqBna; } goto O6Npu; cH75g: if ($result) { goto wsp1v; } goto s1GNT; ksMx5: $uid = TokenService::getCurrentUid(); goto CT_YZ; E6AqR: LYNMQ: goto kuVqV; QvTEs: if ($result) { goto UlyfI; } goto nTkMc; u620N: BqBna: goto ksMx5; Qy6Qo: goto B_0ye; goto xELzr; B7Z5g: goto u8XD1; goto D_Zuo; sVPTw: return ["\x6d\163\x67" => "\xe8\257\267\346\214\x87\345\xae\x9a\346\226\207\347\253\240\151\144", "\145\x72\x72\157\162\103\157\144\145" => 0]; goto E6AqR; O6Npu: return ["\155\x73\x67" => "\xe6\x96\207\347\253\240\xe4\270\215\345\255\230\345\x9c\250", "\145\162\162\157\x72\103\157\144\x65" => 0]; goto u620N; CT_YZ: $collect = ContentCollect::where("\165\x6e\x69\x61\143\x69\x64", session("\x75\x6e\151\x61\x63\151\x64"))->where(["\x75\x73\x65\x72\x5f\x69\x64" => $uid, "\143\x6f\x6e\x74\x65\156\x74\x5f\x69\144" => $contentId])->find(); goto BcJ5Y; z9NFh: return ["\155\163\x67" => "\xe5\xb7\262\xe5\x8f\226\xe6\xb6\x88\346\224\266\xe8\227\x8f", "\144\141\x74\x61" => ["\151\x73\137\143\x6f\x6c\x6c\x65\143\x74" => 0], "\145\x72\162\x6f\x72\x43\x6f\x64\x65" => 1]; goto CPwYc; awvvs: } public function getChildCateById($cateId = 0) { goto E_y3Z; E_y3Z: if (!($cateId == 0 || $cateId == '')) { goto dCqdZ; } goto P2r9O; O_BQr: dCqdZ: goto XR1EB; k9DxQ: return ["\163\164\171\x6c\145" => $parent["\x73\x74\x79\154\x65"], "\143\x68\151\x6c\x64\x5f\x73\x74\171\x6c\x65" => $parent["\x63\150\x69\x6c\144\x5f\x73\x74\x79\x6c\x65"], "\144\x69\x73\x70\x6c\141\171" => $parent["\x64\x69\x73\160\x6c\141\171"], "\x64\141\164\141" => $cate, "\145\162\162\157\x72\x43\x6f\x64\x65" => 1]; goto kKdos; Xegua: return ["\x6d\x73\147" => "\xe6\x9a\202\xe6\x97\240\xe6\x95\260\xe6\x8d\xae", "\145\x72\162\x6f\162\103\157\144\x65" => 0]; goto LUyou; XR1EB: $cate = ContentCateModel::where(["\x75\156\151\x61\x63\x69\x64" => session("\x75\156\x69\x61\143\151\x64"), "\160\x61\162\x65\156\x74\137\151\144" => $cateId])->order("\163\x6f\x72\x74", "\x64\145\163\x63")->field("\151\x64\x2c\156\141\155\x65\x2c\160\x61\162\x65\x6e\164\137\151\x64\54\x73\157\162\x74\x2c\x64\151\x73\160\x6c\x61\171\x2c\x63\162\145\141\x74\145\137\x74\151\155\145")->select(); goto E1wcr; LUyou: I5g7E: goto OHQbO; E1wcr: if (!empty($cate)) { goto I5g7E; } goto Xegua; P2r9O: return ["\155\163\x67" => "\xe8\xaf\xb7\xe6\214\207\345\256\232\xe5\210\x86\347\xb1\xbb\151\x64", "\x65\x72\162\x6f\162\x43\x6f\x64\145" => 0]; goto O_BQr; OHQbO: $parent = ContentCateModel::get($cateId); goto k9DxQ; kKdos: } public function getContentByCate($cateId = 0, $page = 0, $size = 12) { goto loJI1; fu2aR: $where = "\143\141\164\x65\137\151\144\x20\151\156\x20\x28{$cateId}\51"; goto bPCJq; aNTV_: if (!empty($child)) { goto mFQco; } goto fu2aR; k7bAz: $where = "\143\x61\x74\145\137\x69\144\40\x69\x6e\40\x28{$nid}\x29"; goto aDafp; q9ZaE: h3Q3R: goto YEmnD; EvJtc: pNjzV: goto AIAmj; TCHm0: foreach ($child as $k => $v) { $nid[] = $v["\151\x64"]; W9kh4: } goto YGubL; nO3Xk: $nid = implode("\x2c", $nid); goto k7bAz; y5VdT: return ["\x6d\163\147" => "\xe6\232\202\346\x97\240\xe6\225\xb0\xe6\215\256", "\x65\162\x72\157\x72\x43\157\x64\145" => 0]; goto EvJtc; YEmnD: $child = ContentCateModel::where(["\165\156\x69\x61\x63\151\144" => session("\x75\x6e\x69\141\143\151\x64"), "\x70\x61\x72\145\156\164\x5f\151\144" => $cateId])->order("\163\x6f\x72\164", "\x64\145\163\143")->select(); goto aNTV_; mTR6A: $content = ContentModel::where(["\x75\x6e\151\141\x63\x69\144" => session("\165\156\151\x61\x63\151\144")])->where($where)->order("\x73\157\162\x74", "\144\x65\x73\143")->paginate($size, false, ["\160\141\x67\145" => $page]); goto bMnHB; bMnHB: if (!$content->isEmpty()) { goto pNjzV; } goto y5VdT; bPCJq: goto pLC_s; goto SQeYg; nmM3J: array_push($nid, $cateId); goto nO3Xk; SQeYg: mFQco: goto vgiUN; vgiUN: $nid = []; goto TCHm0; aDafp: pLC_s: goto mTR6A; AIAmj: return ["\144\141\164\141" => $content->toArray(), "\x65\x72\162\x6f\x72\x43\157\x64\x65" => 1]; goto E9mIu; loJI1: if (!($cateId == 0 || $cateId == '')) { goto h3Q3R; } goto NHUpK; YGubL: t9dn7: goto nmM3J; NHUpK: return ["\x6d\163\147" => "\xe8\xaf\267\346\214\207\345\256\x9a\345\210\x86\xe7\261\xbb\151\144", "\145\162\162\157\x72\x43\x6f\x64\145" => 0]; goto q9ZaE; E9mIu: } public function getContentDetail($contentId = 0) { goto p3L_C; yv0dK: $content["\x69\x73\137\x63\x6f\154\x6c\145\143\x74"] = 1; goto l8ttO; Cg75a: sLVYe: goto VDWYB; RQXR4: if ($isCollect) { goto U47xy; } goto rvRA_; thFYA: $parent = ContentCateModel::get($content["\143\141\x74\145\137\151\x64"]); goto MDF7T; ludd5: k37uI: goto O1XV7; f5e4E: $content["\151\163\x5f\164\x69\x6d\x65"] = 1; goto Cg75a; p3L_C: if (!($contentId == '' || $contentId == 0)) { goto k37uI; } goto NJDI0; NJDI0: return ["\x6d\163\147" => "\x69\x64\xe4\270\215\350\x83\xbd\xe4\270\272\347\251\xba", "\x65\162\162\157\162\103\157\144\145" => 0]; goto ludd5; Ceus8: return ["\155\163\147" => "\xe8\x8e\267\xe5\x8f\x96\346\x88\x90\xe5\x8a\237", "\x64\x61\x74\141" => $content, "\145\162\x72\157\x72\103\157\x64\x65" => 1]; goto H3ka1; O1XV7: $content = ContentModel::where(["\x75\156\x69\141\143\x69\x64" => session("\165\156\151\141\143\151\144")])->find($contentId); goto mWvj5; m6C43: jX2bq: goto f5e4E; N3iGk: $content->views += 1; goto YY3KY; oGmOk: $content["\151\163\x5f\166\x69\x65\167\x73"] = 1; goto afga7; cEb1p: goto Znat0; goto cOqB2; l8ttO: Znat0: goto thFYA; rvRA_: $content["\x69\x73\x5f\x63\157\154\154\145\x63\164"] = 0; goto cEb1p; H3ka1: icv_7: goto DnZ8n; Z6ukj: $uid = TokenService::getCurrentUid(); goto Iv3hq; OL0KH: goto wOjN5; goto N5zTM; DnZ8n: return ["\155\163\x67" => "\xe8\x8e\267\xe5\x8f\x96\345\xa4\xb1\350\xb4\xa5", "\x65\x72\162\x6f\162\103\157\x64\x65" => 0]; goto KOEJJ; mWvj5: if (!$content) { goto icv_7; } goto N3iGk; RdEIt: goto sLVYe; goto m6C43; nTL4X: $footData = ["\x74\171\x70\145" => 2, "\143\157\x6e\164\x65\x6e\x74\137\151\144" => $contentId]; goto GcdYA; VDWYB: if (in_array(2, $parent["\x64\x69\163\160\154\x61\171"])) { goto gg61b; } goto lZFUB; cOqB2: U47xy: goto yv0dK; lZFUB: $content["\151\163\x5f\x76\151\x65\167\163"] = 0; goto OL0KH; afga7: wOjN5: goto nTL4X; N5zTM: gg61b: goto oGmOk; GcdYA: FootprintModel::addFootprint($footData); goto Ceus8; YY3KY: $content->save(); goto Z6ukj; p0qDN: $content["\x69\x73\x5f\x74\151\x6d\x65"] = 0; goto RdEIt; MDF7T: if (in_array(1, $parent["\144\151\x73\160\154\x61\171"])) { goto jX2bq; } goto p0qDN; Iv3hq: $isCollect = ContentCollect::where(["\x75\x6e\151\x61\x63\151\144" => session("\165\x6e\151\141\143\x69\144"), "\165\163\x65\162\x5f\151\x64" => $uid, "\143\157\x6e\x74\145\x6e\164\137\x69\x64" => $contentId])->find(); goto RQXR4; KOEJJ: } }