<?php
 namespace app\api\controller\v1; use app\api\controller\BaseController; use app\api\model\Express; use app\api\model\UserCoupon; use app\api\validate\IDMustBePositiveInt; use app\api\service\Token as TokenService; use app\api\service\Order as OrderService; use app\api\model\Order as OrderModel; use app\api\model\Product as ProductModel; use app\lib\exception\SuccessMessage; use app\api\service\Wechat as WechatService; use app\api\model\OrderRefund as OrderRefundModel; use app\api\model\RefundAddress; use think\Request; use app\api\model\User as UserModel; use app\api\model\PickPoint as PickPointModel; use app\boguan\service\SmsMessage; use app\boguan\service\EmailMessage; use app\boguan\model\SmsSet; use app\api\model\PlatformSettings; use app\api\service\Product as ProductService; use app\api\model\Coupon as CouponModel; use app\api\model\IntegralDetail; use app\api\model\Integral; use app\api\model\Message; use app\api\model\UserAccess; use app\api\model\OrderRefund; use app\api\model\Share as ShareModel; use app\api\service\Printer as PrinterService; class Order extends BaseController { protected $beforeActionList = array("\143\150\145\143\x6b\x45\x78\143\x6c\165\163\151\166\145\x53\x63\x6f\x70\145" => array("\157\x6e\154\x79" => "\x70\154\141\143\x65\117\162\x64\x65\162"), "\143\150\x65\143\153\x50\x72\x69\155\141\162\171\x53\x63\157\x70\145" => array("\157\x6e\154\x79" => "\x67\145\164\104\145\x74\x61\151\x6c\x2c\x67\145\x74\123\165\x6d\155\x61\x72\x79\102\171\x55\163\x65\162")); public function __construct(Request $request = null) { goto pWDvb; bkJSd: OrderService::autoConfirm(); goto vdcjm; D6XtU: UserAccess::checkIsAccess($uid); goto a4OJq; a4OJq: ShareModel::checkDistributor(); goto KRucx; PI14P: $uid = TokenService::getCurrentUid(); goto D6XtU; pWDvb: parent::__construct($request); goto bkJSd; vdcjm: OrderService::autoCancel(); goto PI14P; KRucx: } public function placeOrder() { goto q4tXG; cFwzO: return ["\155\163\x67" => "\xe6\232\202\xe6\x97\xa0\xe5\x8f\257\xe8\xb4\xad\344\xb9\xb0\345\225\x86\345\x93\x81", "\x65\162\162\157\162\103\x6f\144\x65" => 0]; goto OFXY7; FuQHs: if (!(!isset($data["\x70\x72\157\x64\165\143\164"]) || empty($data["\x70\x72\157\144\x75\x63\164"]))) { goto f3G4M; } goto cFwzO; q4tXG: $data = input("\160\x6f\163\x74\x2e"); goto FuQHs; v6kKo: return ["\x6d\x73\x67" => "\350\xaf\xb7\xe9\200\211\xe6\x8b\xa9\344\xb8\x80\xe7\247\215\xe5\217\x91\xe8\xb4\247\xe6\226\271\xe5\274\217", "\145\162\x72\x6f\x72\x43\157\144\x65" => 0]; goto nQirR; QuWwM: if (!(!isset($data["\157\x72\144\x65\162\137\164\x79\x70\145"]) || empty($data["\157\162\144\x65\162\137\164\171\160\x65"]))) { goto vT_mW; } goto v6kKo; GHTB1: $uid = TokenService::getCurrentUid(); goto im1YX; im1YX: $order = new OrderService(); goto P7vw1; P7vw1: $result = $order->place($uid, $data); goto OknJM; nQirR: vT_mW: goto GHTB1; OFXY7: f3G4M: goto QuWwM; OknJM: return $result; goto mPm9y; mPm9y: } public function clerkOrderDetail($orderId) { goto Xu9WC; uiPNE: return ["\155\x73\x67" => "\350\xaf\xb7\351\x80\211\346\213\xa9\350\xa6\x81\346\240\xb8\351\x94\200\xe7\x9a\204\350\xae\xa2\xe5\215\x95", "\145\162\x72\x6f\162\x43\157\x64\x65" => 0]; goto uhFip; uhFip: HzDOe: goto dhaT3; kFK_X: $pickPoint = PickPointModel::get($pickInfo["\x70\151\143\153\x49\x64"]); goto fHnLt; nc6UU: return ["\155\163\x67" => "\xe8\x8e\xb7\xe5\217\x96\xe6\210\x90\xe5\212\237", "\144\x61\164\x61" => $order, "\145\162\162\x6f\x72\x43\157\x64\145" => 1]; goto YXSas; pBiTn: if (!($order["\x63\154\145\x72\x6b\137\164\x69\155\145"] == null)) { goto lLEjb; } goto RkCOU; uMvSp: $user = UserModel::get($uid); goto gbDSU; RkCOU: $order["\x63\x6c\145\x72\x6b\137\164\x69\155\145"] = ''; goto JXe_D; rBN3W: if (!($order["\143\x6c\x65\162\x6b\137\151\144"] == null)) { goto vmyiI; } goto L4enC; dhaT3: $uid = TokenService::getCurrentUid(); goto uMvSp; bSPNr: return ["\x6d\163\x67" => "\344\275\xa0\xe4\xb8\215\xe6\x98\257\346\240\270\351\x94\200\xe5\x91\x98\357\xbc\x8c\346\x9a\202\344\270\x8d\346\224\257\346\214\201\346\240\270\xe9\x94\200", "\145\162\x72\x6f\162\103\157\144\145" => 0]; goto emhLJ; EWP3C: kk04Q: goto t2ARh; YDHur: if (!empty($order)) { goto kk04Q; } goto n6fCm; tI27n: vmyiI: goto nc6UU; L4enC: $order["\143\x6c\145\x72\153\x5f\151\144"] = ''; goto tI27n; gbDSU: if (!($user["\151\163\x5f\143\154\145\x72\x6b"] == 0 && $user["\x69\x73\x5f\x6d\x6f\x62\x69\154\x65"] != 1)) { goto A3_c0; } goto bSPNr; n6fCm: return ["\x6d\x73\147" => "\350\256\xa2\xe5\x8d\225\xe4\270\215\xe5\xad\230\345\x9c\250", "\x65\x72\162\157\162\x43\157\144\x65" => 0]; goto EWP3C; wNLwe: $order["\x70\151\x63\x6b\x5f\156\x61\155\x65"] = $pickPoint["\x6e\141\x6d\x65"]; goto pBiTn; Xu9WC: if (!($orderId == 0 || $orderId == '')) { goto HzDOe; } goto uiPNE; emhLJ: A3_c0: goto rXVDY; rXVDY: $order = OrderModel::where(["\165\x6e\151\141\143\151\144" => session("\x75\156\151\x61\143\151\144"), "\151\144" => $orderId])->find(); goto YDHur; t2ARh: $pickInfo = $order["\x70\151\x63\153\x5f\151\156\x66\157"]; goto kFK_X; fHnLt: $order["\x70\x69\143\153\137\164\145\x6c"] = $pickPoint["\164\x65\154"]; goto wNLwe; JXe_D: lLEjb: goto rBN3W; YXSas: } public function clerkOrder($orderId) { goto qoFPu; crdu6: $order->is_confirm = 1; goto cz8Gi; xxRBy: $user = UserModel::get($uid); goto K3Q2H; dtVdC: $result = $order->save(); goto pR2z_; hwbPp: return ["\155\x73\x67" => "\xe6\xa0\270\351\x94\x80\346\x88\220\xe5\x8a\237", "\145\x72\x72\157\162\103\x6f\144\x65" => 1]; goto POKVp; aitdU: L2K1Q: goto M0XoR; K3Q2H: if (!($user["\x69\x73\x5f\x63\154\x65\162\153"] == 0 && $user["\151\163\x5f\x6d\157\142\x69\154\x65"] != 1)) { goto LhUPL; } goto gM89P; GWwIM: return ["\x6d\x73\147" => "\xe8\xae\242\xe5\215\225\345\275\223\345\x89\215\347\212\266\346\200\x81\xe4\270\215\346\224\257\xe6\214\x81\xe6\240\270\351\x94\200", "\x65\162\162\157\x72\x43\x6f\x64\x65" => 0]; goto aitdU; pRLsj: $order = OrderModel::where(["\x75\156\x69\x61\143\151\144" => session("\x75\156\x69\141\143\151\144")])->find($orderId); goto G3Tj3; q8_iL: LhUPL: goto pRLsj; hkUSJ: $printer->printReceiptAtPaid($order["\151\x64"], "\143\154\145\x72\x6b"); goto hwbPp; M0XoR: if (!($order["\143\x6c\x65\x72\153\137\x69\144"] != '')) { goto c7vLE; } goto Kl343; G3Tj3: if (!empty($order)) { goto eOVDu; } goto Xwdcf; Xwdcf: return ["\x6d\x73\147" => "\350\xae\242\xe5\x8d\x95\xe4\xb8\x8d\345\xad\230\345\x9c\xa8\357\274\x8c\346\240\xb8\351\x94\200\xe5\244\261\350\264\245", "\x65\162\162\x6f\x72\103\x6f\144\145" => 0]; goto n1fQt; gM89P: return ["\x6d\163\x67" => "\344\275\240\344\xb8\215\346\x98\xaf\xe6\xa0\270\xe9\x94\x80\345\x91\x98\xef\274\x8c\346\232\202\xe4\270\x8d\xe6\224\xaf\xe6\214\x81\xe6\240\270\351\224\x80", "\x65\x72\x72\x6f\x72\x43\157\x64\145" => 0]; goto q8_iL; n1fQt: eOVDu: goto N9PYE; eOIkr: return ["\155\163\x67" => "\347\275\221\347\xbb\x9c\xe5\xbc\x82\xe5\270\270\357\274\x8c\xe8\257\267\xe7\xa8\x8d\345\200\231\xe5\206\x8d\xe8\257\x95", "\x65\162\x72\x6f\x72\x43\x6f\x64\145" => 0]; goto BgmH0; pR2z_: if ($result == true) { goto f9owo; } goto eOIkr; POKVp: Wum3i: goto M0DSK; PDrYk: f9owo: goto HqAkG; HqAkG: $printer = new PrinterService(); goto hkUSJ; DUaWO: return ["\155\x73\x67" => "\350\xaf\267\351\x80\211\346\x8b\251\350\246\x81\346\240\xb8\351\224\x80\xe7\232\204\xe8\256\xa2\xe5\215\x95", "\145\x72\x72\x6f\x72\x43\157\144\x65" => 0]; goto rM76S; r2uxM: c7vLE: goto VNoCc; VNoCc: $order->clerk_id = $uid; goto ZXVCa; cz8Gi: $order->confirm_time = time(); goto dtVdC; WGykv: $order->status = 3; goto crdu6; Kl343: return ["\x6d\163\147" => "\xe8\257\245\350\256\xa2\xe5\215\225\xe5\xb7\xb2\346\240\xb8\xe9\224\200", "\x65\162\x72\x6f\x72\x43\157\144\x65" => 0]; goto r2uxM; ZXVCa: $order->clerk_time = time(); goto WGykv; N9PYE: if (!($order["\x73\164\x61\164\165\163"] == 0 && $order["\x73\164\141\x74\165\163"] != 4)) { goto L2K1Q; } goto GWwIM; rM76S: sGtI5: goto RwwoI; RwwoI: $uid = TokenService::getCurrentUid(); goto xxRBy; qoFPu: if (!($orderId == 0 || $orderId == '')) { goto sGtI5; } goto DUaWO; BgmH0: goto Wum3i; goto PDrYk; M0DSK: } public function orderRefundConfirm() { goto thHKW; VlXtS: return ["\155\163\x67" => "\346\217\220\344\xba\244\346\210\x90\xe5\212\237\357\xbc\x8c\xe5\225\206\345\xae\266\346\224\266\345\210\260\xe8\xb4\xa7\xe5\220\216\xe9\200\x80\xe5\233\236\xe9\x80\x80\xe6\xac\276\351\207\221\xe9\242\x9d", "\145\162\x72\x6f\162\103\x6f\144\145" => 1]; goto KOg4P; okMnR: if (!($orderId == '' || $orderId == 0)) { goto qg6Mh; } goto ZlCOj; E3FuN: if (!(!isset($data["\x65\170\x70\162\145\x73\x73\116\141\x6d\x65"]) || $data["\145\170\160\x72\145\163\x73\116\x61\x6d\x65"] == '')) { goto nUIYS; } goto g85G0; oBYgP: $refundOrder->user_send_time = time(); goto uTjdA; QMXkm: return ["\155\x73\x67" => "\xe7\275\x91\xe7\273\234\xe5\xbc\202\xe5\xb8\270\xef\xbc\x8c\350\257\xb7\347\250\215\345\x80\231\345\x86\x8d\350\257\225", "\145\162\162\x6f\x72\103\157\x64\145" => 0]; goto mVIAI; ZgY3Y: return ["\x6d\x73\x67" => "\xe8\256\xa2\xe5\x8d\x95\xe4\270\x8d\345\xad\230\xe5\x9c\250", "\x65\x72\x72\157\162\103\157\144\x65" => 0]; goto fi5n0; ZlCOj: return ["\155\x73\147" => "\xe8\xaf\xb7\xe9\x80\x89\346\x8b\xa9\350\xae\xa2\345\215\225", "\145\x72\162\157\x72\103\157\x64\145" => 0]; goto jFkAr; y8o_t: $refundOrder = OrderRefundModel::where("\x75\x6e\x69\x61\x63\x69\144", session("\165\x6e\151\x61\x63\x69\x64"))->where("\x73\x74\x61\x74\165\163", "\75", 1)->find($orderId); goto qj6T5; Fe3hN: if ($result !== false) { goto MdXlR; } goto QMXkm; fi5n0: jj9_5: goto xMYTh; KOg4P: Be1iF: goto mRF43; bUTf6: $orderId = isset($data["\x6f\162\144\145\x72\x49\x64"]) ? $data["\157\162\x64\x65\162\111\144"] : 0; goto okMnR; thHKW: $data = input("\160\157\x73\164\x2e"); goto bUTf6; xMYTh: $order = OrderModel::get($refundOrder["\157\162\x64\145\x72\x5f\x69\144"]); goto LXuDx; g85G0: return ["\x6d\163\x67" => "\350\257\xb7\350\276\x93\345\x85\245\xe5\277\253\xe9\200\222\345\205\254\345\217\xb8", "\145\162\162\x6f\x72\103\157\x64\x65" => 0]; goto iiT4o; LI79y: TgDvp: goto Dmt23; mVIAI: goto Be1iF; goto cRiMD; cRiMD: MdXlR: goto VlXtS; uTjdA: $result = $refundOrder->save(); goto Fe3hN; LXuDx: if (!($order["\157\162\x64\145\x72\137\164\171\x70\145"] == 1)) { goto El0Qe; } goto E3FuN; qj6T5: if ($refundOrder) { goto jj9_5; } goto ZgY3Y; Dmt23: $refundOrder->user_send_express = $data["\145\170\160\x72\x65\163\x73\x4e\141\155\145"]; goto Z0uao; DSI_E: $refundOrder->is_user_send = 1; goto oBYgP; tGZkV: El0Qe: goto DSI_E; xjCMw: if (!(!isset($data["\x65\170\160\x72\145\163\x73\x4e\165\x6d\x62\x65\x72"]) || $data["\x65\170\160\x72\145\x73\x73\x4e\165\155\x62\145\162"] == '')) { goto TgDvp; } goto qraKq; qraKq: return ["\x6d\x73\147" => "\350\257\267\xe8\276\x93\345\x85\245\345\xbf\xab\351\200\222\xe5\x8d\x95\345\x8f\267", "\145\x72\162\157\x72\103\x6f\144\145" => 0]; goto LI79y; Z0uao: $refundOrder->user_send_express_no = $data["\x65\x78\160\162\145\163\x73\116\x75\x6d\142\145\x72"]; goto tGZkV; jFkAr: qg6Mh: goto y8o_t; iiT4o: nUIYS: goto xjCMw; mRF43: } public function orderRefundDetail() { goto IepQN; nPdHW: $orderId = isset($data["\x6f\162\x64\x65\x72\111\x64"]) ? $data["\157\162\x64\145\x72\x49\x64"] : 0; goto FzEdV; dRwlK: return ["\x6d\x73\147" => "\350\x8e\xb7\345\217\226\346\210\220\xe5\212\x9f", "\x64\141\x74\x61" => $order, "\x65\162\162\157\162\103\157\x64\145" => 1]; goto Q0B5j; mw22l: $order["\145\170\160\x72\x65\x73\163"] = Express::all(); goto B8voM; EdLqn: return ["\155\x73\x67" => "\350\xaf\xb7\351\200\x89\xe6\213\xa9\350\256\242\xe5\x8d\x95", "\145\x72\x72\157\x72\x43\157\144\145" => 0]; goto LU4Ms; IepQN: $data = input("\x70\157\163\164\x2e"); goto nPdHW; B8voM: $order["\x61\144\144\x72\145\163\163"] = RefundAddress::get($order["\141\x64\144\162\145\x73\163\137\x69\x64"]); goto jKek5; FzEdV: if (!($orderId == '' || $orderId == 0)) { goto E41eS; } goto EdLqn; J9kvM: if (!($order["\x73\x74\141\164\165\163"] == 1)) { goto KAUBe; } goto mw22l; UBblk: $order = OrderRefundModel::where("\x75\x6e\151\x61\143\x69\144", session("\x75\156\151\x61\x63\x69\x64"))->where("\165\x73\x65\162\x5f\x69\x64", "\x3d", $uid)->find($orderId); goto J9kvM; iDxzb: D6zr6: goto dRwlK; jKek5: KAUBe: goto PdbIb; lbk_2: return ["\x6d\163\x67" => "\xe8\216\267\xe5\x8f\x96\xe5\244\xb1\350\xb4\xa5", "\144\141\164\141" => [], "\x65\x72\162\x6f\162\103\x6f\x64\145" => 0]; goto iDxzb; LU4Ms: E41eS: goto EWcWM; EWcWM: $uid = TokenService::getCurrentUid(); goto UBblk; PdbIb: if ($order) { goto D6zr6; } goto lbk_2; Q0B5j: } public function orderRefundSubmit() { goto rBimX; W2baS: if ($order) { goto z_sWf; } goto Zurv2; l51w_: e4WkW: goto SKZP6; Tvba0: r8bdh: goto Bwdd3; g6Ysb: if (!($refund["\x72\x65\146\x75\156\x64\x5f\160\162\x69\143\145"] == null)) { goto e4WkW; } goto pmVqe; v0qWh: if (isset($data["\141\x74\x74\x72\137\x69\144\137\x6c\x69\x73\x74"])) { goto NH9Zn; } goto Z4xsk; WGlHO: $refund["\x73\x6e\141\160\137\x69\x6e\146\x6f"] = json_encode($snapInfo["\151\156\x66\157"], JSON_UNESCAPED_UNICODE); goto qH1sf; TX0_W: if (!(!isset($data["\160\162\x6f\144\165\x63\164\x49\144"]) || $data["\x70\x72\x6f\x64\x75\143\164\111\144"] == '')) { goto HlnJR; } goto kpG21; gNLgV: HlnJR: goto kGQe4; UgdB2: if (is_array($data["\x61\x74\x74\162\137\151\x64\x5f\x6c\151\x73\164"])) { goto p6Qio; } goto mCsBf; QLIGu: goto PvBcc; goto sjlgD; KFIs9: QhYAG: goto ser16; I2kAs: $uid = TokenService::getCurrentUid(); goto ZEQpK; DjJG4: $refund["\x72\145\x6d\x61\162\x6b"] = $data["\x72\145\155\141\162\153"]; goto e40lM; V3SpC: return ["\155\x73\147" => "\xe8\xaf\267\350\276\223\xe5\205\xa5\351\x80\200\xe6\xac\xbe\345\216\237\345\233\xa0", "\145\x72\162\157\162\103\x6f\144\145" => 0]; goto Tvba0; SKZP6: $refund["\x63\162\145\x61\164\145\137\164\151\x6d\x65"] = time(); goto VtQiA; kGQe4: $platform = PlatformSettings::where(["\x75\x6e\151\x61\x63\x69\x64" => session("\x75\156\x69\x61\x63\151\x64")])->find(); goto yAJRO; VtQiA: $orderRefund = new OrderRefundModel(); goto EuHlM; ojFxt: $refundPrice = $snapInfo["\x70\162\151\143\145"] - $snapInfo["\x64\x69\163\143\x6f\x75\x6e\164"]; goto I9RoJ; Elqj5: DKuk5: goto ItYJ0; R31cf: $refund["\162\145\x66\165\x6e\144\x5f\157\x72\x64\x65\x72\x5f\x6e\157"] = $orderService->createOrderNo(); goto a_a4h; ferpG: $orderId = isset($data["\157\162\x64\x65\x72\111\x64"]) ? $data["\x6f\162\x64\x65\x72\x49\x64"] : 0; goto Pbx2E; DXhK7: return ["\x6d\x73\x67" => "\x69\x6d\x61\147\x65\351\x9c\200\344\270\xba\346\x95\260\xe7\xbb\x84", "\145\162\162\x6f\x72\x43\157\x64\145" => 0]; goto QA2TS; kGh47: $snapInfo["\x69\156\x66\157"]["\x69\163\137\162\x65\x66\x75\x6e\144"] = 1; goto WGlHO; ZEP10: $refund["\157\x72\x64\145\162\137\156\x6f"] = $order["\157\x72\144\x65\162\137\156\x6f"]; goto R31cf; lIqUr: $refund["\143\151\x74\171"] = $order["\143\x69\x74\171"]; goto MMsSf; qH1sf: $refund["\x63\157\x6e\x66\151\162\x6d\137\164\x69\x6d\145"] = $order["\x63\157\x6e\146\151\162\155\137\164\151\x6d\145"]; goto Ov4mh; jGKme: $refund["\165\163\x65\x72\151\x6e\146\157"] = json_encode($order["\165\x73\x65\x72\151\x6e\146\x6f"], JSON_UNESCAPED_UNICODE); goto lIqUr; uJp9f: p6Qio: goto TEuCw; bb1NJ: $orderService->updateSnapInfo($orderId, $data["\x70\162\157\144\x75\143\x74\x49\x64"], $refund["\x61\x74\x74\162\137\x69\144\x5f\x6c\151\x73\x74"]); goto oqc0j; QA2TS: goto bQTyQ; goto jIIw5; It7fP: z_sWf: goto TX0_W; BKgwB: $refund["\x6f\162\x64\145\162\137\x69\144"] = $orderId; goto QaGJW; J74DO: $refund["\160\x72\145\160\141\171\137\x69\x64"] = $data["\146\x6f\162\155\111\144"]; goto dlWaE; Pbx2E: if (!($orderId == '' || $orderId == 0)) { goto zaiUQ; } goto KdYz6; jIIw5: jWS_Z: goto tG0kb; XsxT3: $message = new Message(); goto VO2Fa; KdYz6: return ["\155\x73\147" => "\xe8\257\xb7\351\200\211\xe6\213\xa9\350\256\242\xe5\215\x95", "\x65\162\162\157\162\x43\x6f\144\x65" => 0]; goto Kjr1M; TNAoH: $order->save(); goto XsxT3; Z4xsk: return ["\155\163\x67" => "\xe8\247\204\xe6\xa0\xbc\151\144\xe4\270\x8d\xe8\x83\xbd\347\251\xba", "\x65\162\x72\x6f\162\x43\x6f\144\x65" => 0]; goto WWn4Y; rpjrB: PvBcc: goto RJDRh; ZEQpK: $order = OrderModel::where("\x75\x6e\x69\141\143\151\144", session("\165\x6e\151\x61\143\151\x64"))->where(["\151\x64" => $orderId, "\x75\163\x65\x72\137\x69\144" => $uid, "\163\164\x61\x74\x75\163" => 3, "\x69\163\x5f\x63\157\x6e\x66\x69\x72\x6d" => 1, "\x69\163\x5f\x63\141\156\x63\x65\x6c" => 0, "\x69\x73\137\x64\x65\154\x65\x74\145" => 0])->find(); goto W2baS; wAdey: return ["\x6d\163\147" => "\346\217\220\xe4\272\xa4\xe6\210\220\xe5\x8a\237\357\274\x8c\xe8\xaf\267\347\255\211\xe5\xbe\x85\xe5\256\xa1\346\xa0\270", "\x65\x72\162\x6f\162\103\157\x64\x65" => 1]; goto riJVl; TrK_b: return ["\155\163\x67" => "\347\275\221\347\273\234\xe5\xbc\202\345\xb8\270\357\274\x8c\350\xaf\267\xe7\xa8\x8d\345\x80\231\345\x86\215\350\257\225", "\145\162\162\157\x72\103\x6f\x64\x65" => 0]; goto T7XFg; RXhx8: return ["\x6d\163\x67" => "\350\257\xa5\345\x95\x86\345\x93\x81\345\267\xb2\xe7\x94\xb3\xe8\xaf\267\xe5\224\256\345\x90\x8e", "\145\162\x72\157\x72\x43\157\x64\x65" => 0]; goto MNG3E; riJVl: lY3EC: goto xvxno; t6nkc: YT7Ql: goto nExLV; avJHS: if (!($platform["\141\x66\164\x65\x72\x5f\x74\151\155\145"] > 0 && $day > $platform["\x61\x66\164\145\162\x5f\164\151\x6d\x65"])) { goto LMGbt; } goto NpeUh; T7XFg: goto lY3EC; goto ZFJY6; EuHlM: $result = $orderRefund->insertGetId($refund); goto NvuRt; a_a4h: $snapInfo = $orderService->getOneSnapInfo($orderId, $data["\160\162\x6f\x64\165\143\164\x49\144"], $refund["\x61\x74\x74\162\137\151\x64\137\154\x69\x73\164"]); goto kGh47; pU8A8: LMGbt: goto H_uul; ItYJ0: $refund["\x72\x65\146\165\x6e\144\137\160\x72\x69\x63\145"] = round($refundPrice, 2); goto jGKme; Q6RVS: $message->saveMessage($messageData); goto wAdey; dlWaE: w23IX: goto g6Ysb; yAJRO: $day = diffTwoDays($order["\x63\x6f\156\146\151\x72\155\137\164\x69\155\145"], time()); goto avJHS; RJDRh: if (!($refundPrice <= 0)) { goto DKuk5; } goto qn04T; APycw: $refundPrice = $snapInfo["\160\162\x69\143\145"] - $snapInfo["\x64\x69\163\x63\157\165\156\164"]; goto QLIGu; Ov4mh: if ($order["\151\163\x5f\x63\x68\141\x6e\x67\145"] == 1) { goto ByzH2; } goto APycw; RpT1p: goto QhYAG; goto JAR3J; tz0H_: if (is_array($data["\x69\155\x61\147\145"])) { goto jWS_Z; } goto DXhK7; rRs11: bQTyQ: goto beA00; NvuRt: if ($result !== false) { goto Rd7NB; } goto TrK_b; JAR3J: M8D3P: goto v0qWh; pJTQo: $refund["\141\164\164\x72\137\151\144\x5f\x6c\x69\x73\164"] = null; goto RpT1p; qn04T: return ["\x6d\163\x67" => "\xe5\225\x86\345\x93\201\345\x8f\257\xe9\200\200\xe9\x87\x91\xe9\242\235\344\xb8\272\x30\xef\274\214\xe4\270\x8d\346\x94\257\xe6\214\x81\xe9\200\200\xe6\254\276\xef\274\x8c\345\xa6\202\346\234\211\xe7\x96\x91\351\x97\xae\xef\274\214\350\xaf\xb7\xe8\201\224\xe7\xb3\273\xe5\225\206\xe5\xae\266\xe5\244\x84\347\220\206", "\x65\x72\x72\157\162\x43\157\144\x65" => 0]; goto Elqj5; MlsRb: $refund["\141\164\164\x72\137\x69\144\137\154\151\x73\164"] = str_replace("\x22", '', $refund["\x61\x74\164\162\137\x69\x64\x5f\x6c\x69\x73\164"]); goto t6nkc; NpeUh: return ["\155\163\147" => "\xe8\xaf\245\350\xae\xa2\345\215\x95\xe5\xb7\262\xe8\266\205\345\x87\xba\xe5\x94\256\345\x90\216\346\227\xb6\xe9\x97\264", "\145\x72\162\157\x72\x43\157\x64\x65" => 0]; goto pU8A8; UBqPz: $haveRefund = OrderRefundModel::where("\165\x6e\x69\141\143\151\144", session("\x75\x6e\x69\141\x63\151\x64"))->where(["\157\162\144\145\162\137\x69\x64" => $orderId, "\165\163\x65\x72\137\151\x64" => $uid, "\160\x72\x6f\x64\165\143\164\137\151\144" => $data["\x70\x72\157\144\x75\x63\164\111\x64"], "\141\164\164\x72\137\x69\x64\x5f\x6c\x69\163\x74" => $refund["\141\x74\x74\x72\137\x69\x64\x5f\154\x69\x73\x74"]])->where("\163\164\x61\164\165\163\40\74\x20\x33")->find(); goto rzv6o; mlxiW: if (!isset($data["\146\x6f\x72\x6d\x49\144"])) { goto w23IX; } goto J74DO; tG0kb: $refund["\x69\x6d\x61\x67\145"] = json_encode($data["\151\x6d\141\x67\x65"]); goto rRs11; nExLV: t8Lm1: goto KFIs9; kpG21: return ["\155\x73\147" => "\xe8\xaf\xb7\346\x8c\x87\345\xae\x9a\xe5\225\x86\xe5\x93\201\x69\x64", "\145\x72\x72\157\x72\103\x6f\x64\145" => 0]; goto gNLgV; oqc0j: $order->is_refund = 1; goto TNAoH; aCVCT: $refund["\165\x73\x65\x72\137\x69\x64"] = $uid; goto BKgwB; mCsBf: return ["\155\163\x67" => "\350\xa7\x84\xe6\xa0\xbc\151\x64\xe9\234\x80\xe4\270\272\346\225\260\xe7\xbb\x84", "\x65\162\162\157\x72\x43\x6f\x64\145" => 0]; goto l69zN; eYNfl: $product = ProductModel::get($data["\x70\162\157\144\165\143\164\x49\144"]); goto aCVCT; e40lM: if ($product["\x69\163\x5f\141\164\164\162"] == 1) { goto M8D3P; } goto pJTQo; H_uul: if (!(!isset($data["\x72\145\155\x61\x72\x6b"]) || $data["\162\x65\155\x61\x72\x6b"] == '')) { goto r8bdh; } goto V3SpC; nlvKm: NH9Zn: goto UgdB2; MNG3E: kgW2M: goto ZEP10; ser16: if (!isset($data["\151\155\x61\147\x65"])) { goto HHMrO; } goto tz0H_; MMsSf: $refund["\x75\156\151\x61\x63\x69\144"] = session("\x75\x6e\x69\141\143\x69\144"); goto mlxiW; Kjr1M: zaiUQ: goto I2kAs; QaGJW: $refund["\x70\x72\x6f\144\x75\x63\x74\x5f\x69\x64"] = $data["\160\162\x6f\144\x75\x63\x74\111\x64"]; goto DjJG4; rBimX: $data = input("\160\x6f\x73\164\56"); goto ferpG; Bwdd3: $orderService = new OrderService(); goto eYNfl; WWn4Y: goto t8Lm1; goto nlvKm; ZFJY6: Rd7NB: goto bb1NJ; TEuCw: $refund["\x61\x74\x74\162\137\151\x64\x5f\154\151\x73\x74"] = json_encode($data["\x61\164\164\x72\137\151\144\x5f\154\151\x73\x74"]); goto MlsRb; I9RoJ: $refundPrice = $refundPrice / $order["\x61\155\x6f\165\x6e\x74"] * ($order["\157\137\141\x6d\x6f\x75\x6e\164"] - $order["\x65\x78\x70\x72\145\163\x73\137\x70\x72\x69\x63\x65"] - $order["\x64\145\x6c\x69\x76\145\x72\x79\x5f\x70\162\151\x63\145"]); goto rpjrB; beA00: HHMrO: goto UBqPz; Zurv2: return ["\x6d\163\147" => "\350\257\xa5\350\256\xa2\xe5\x8d\x95\344\270\215\xe6\x94\257\346\x8c\201\347\x94\xb3\xe8\257\xb7\xe5\x94\256\xe5\220\216", "\145\x72\x72\x6f\x72\103\157\144\145" => 0]; goto It7fP; pmVqe: return ["\x6d\163\147" => "\xe8\257\xa5\350\256\242\345\x8d\x95\xe6\262\241\346\234\x89\xe6\xad\xa4\xe5\225\206\345\223\201", "\x65\x72\x72\157\162\103\x6f\x64\145" => 0]; goto l51w_; l69zN: goto YT7Ql; goto uJp9f; sjlgD: ByzH2: goto ojFxt; VO2Fa: $messageData = ["\x75\x6e\x69\141\x63\x69\144" => $order->uniacid, "\165\163\145\x72\x5f\x69\x64" => $order->user_id, "\157\162\144\x65\162\137\151\144" => $result, "\164\x79\160\145" => 2]; goto Q6RVS; rzv6o: if (!$haveRefund) { goto kgW2M; } goto RXhx8; xvxno: } public function orderConfirm($orderId = 0) { goto pKrxC; M2lSh: return ["\x6d\163\147" => "\350\256\xa2\345\x8d\x95\xe4\xb8\215\345\xad\x98\345\234\xa8\346\210\x96\xe5\267\xb2\xe7\241\256\350\256\xa4", "\x65\x72\x72\x6f\x72\103\157\x64\145" => 0]; goto wBFHc; pKrxC: if (!($orderId == '' || $orderId == 0)) { goto ESJvV; } goto hs8Ae; K_4VD: ESJvV: goto V55Zo; uInNO: $order->status = 3; goto onZHG; onZHG: $order->is_confirm = 1; goto i9pD3; rnnSH: $order = OrderModel::where("\x75\x6e\151\x61\x63\x69\x64", session("\165\x6e\x69\x61\143\151\x64"))->where(["\x69\x64" => $orderId, "\165\163\145\162\137\x69\x64" => $uid, "\x69\163\137\163\x65\x6e\x64" => 1, "\x73\164\x61\x74\165\163" => 2, "\x69\163\137\x63\157\156\x66\151\162\x6d" => 0, "\151\x73\137\x63\x61\156\143\x65\x6c" => 0, "\151\163\137\144\x65\154\145\x74\x65" => 0])->find(); goto klmAR; klmAR: if ($order) { goto UdJ_j; } goto M2lSh; xMgtt: return ["\x6d\x73\x67" => "\xe7\241\xae\xe8\256\xa4\xe6\224\266\xe8\264\xa7\346\210\220\345\x8a\x9f", "\145\162\162\x6f\x72\103\157\144\145" => 1]; goto iMkGJ; iMkGJ: Kny78: goto dlank; i9pD3: $order->confirm_time = time(); goto BYL7f; keMUp: zR_jq: goto xMgtt; V55Zo: $uid = TokenService::getCurrentUid(); goto rnnSH; rNszg: return ["\155\163\147" => "\xe7\xbd\x91\347\xbb\x9c\345\xbc\202\345\270\xb8\357\xbc\214\xe8\257\267\xe7\xa8\x8d\345\200\x99\345\x86\215\350\xaf\225", "\145\162\x72\x6f\162\103\x6f\x64\145" => 0]; goto Pzj7y; WkCUa: if ($result == true) { goto zR_jq; } goto rNszg; Pzj7y: goto Kny78; goto keMUp; hs8Ae: return ["\155\x73\x67" => "\350\xaf\267\xe9\200\211\346\213\xa9\350\xae\xa2\xe5\x8d\x95", "\145\162\x72\x6f\x72\x43\157\144\145" => 0]; goto K_4VD; BYL7f: $result = $order->save(); goto WkCUa; wBFHc: UdJ_j: goto uInNO; dlank: } public function orderCancel($orderId = 0) { goto HxWxj; zJEr3: $order->status = 4; goto kIl6d; aRDma: $order->cancel_time = time(); goto zJEr3; S0sTN: $sendSmsMessage = new SmsMessage(); goto f6aqU; ODMaU: goto SeB6Q; goto fiyT8; uNh4U: $coupon->save(); goto nAivA; zpYSh: $data["\x6f\165\164\137\164\x72\x61\144\145\137\156\157"] = $order["\x6f\x72\144\145\x72\x5f\x6e\x6f"]; goto J1vSx; Sb206: $coupon->use_sum -= 1; goto vCU1h; RJxJA: MXCKs: goto MWt2I; O6ogF: puHMe: goto GHfSS; EE1hm: UserCoupon::updateUserCouponUnused($order["\165\163\x65\x72\x5f\x69\x64"], $order["\143\x6f\165\x70\x6f\x6e\x5f\151\x64"]); goto pCs4D; a31pG: if (!($order["\143\157\165\160\x6f\x6e\137\151\144"] != 0 || $order["\x63\157\x75\x70\x6f\x6e\x5f\151\x64"] != '')) { goto plHTF; } goto A0GVn; nAivA: ElXub: goto njYaV; h5WbC: $order->save(); goto K4Huh; zV8jq: if (!($order["\x69\x73\x5f\151\x6e\164\145\x67\162\x61\154"] == 1)) { goto tmzl3; } goto q2bHl; zbNXo: $coupon->use_sum -= 1; goto uNh4U; qFDqQ: return ["\155\x73\147" => "\350\xae\242\345\215\225\344\xb8\215\xe5\xad\x98\xe5\x9c\250\xe6\x88\226\xe5\xb7\xb2\xe5\217\x96\xe6\xb6\210", "\145\x72\162\x6f\x72\x43\157\x64\x65" => 0]; goto O6ogF; vCgDZ: $data["\162\x65\146\x75\x6e\144\137\x66\x65\145"] = $order["\157\x5f\x61\155\x6f\165\156\x74"] * 100; goto ICB_6; q2bHl: $user->integral = $user->integral + $order["\x69\156\x74\x65\147\162\141\154"]; goto A0Dlp; GpS3T: Fd1Vu: goto ZkmZ8; id3bj: $integralDetail = ["\165\x73\x65\162\x5f\x69\x64" => $user->id, "\157\x72\144\145\x72\137\151\144" => $order["\151\x64"], "\x69\x6e\164\x65\147\162\141\154" => $order["\x69\x6e\x74\145\147\x72\x61\154"], "\164\171\x70\x65" => 1, "\153\x69\156\144" => 2]; goto tGFPf; eqNw6: $productService = new ProductService(); goto ySzBJ; Tka4y: $uid = TokenService::getCurrentUid(); goto ZB5VP; vCU1h: $coupon->save(); goto yYz6h; gIiGY: if ($order["\163\x74\x61\164\x75\x73"] == 1 && $order["\151\x73\137\163\145\x6e\x64"] == 0) { goto Ih0SJ; } goto Gp62P; XEJGw: $order->is_cancel = 1; goto ib2LS; BPcI2: return json(["\x6d\163\147" => $res["\145\162\x72\x5f\x63\x6f\144\x65"], "\x65\162\162\x6f\x72\103\157\144\x65" => 0]); goto k2uJM; K4Huh: $user = UserModel::get($order["\165\x73\145\x72\137\151\x64"]); goto zV8jq; k2uJM: goto f0b9R; goto GpS3T; Y3Xcf: f0b9R: goto QKljv; Ia1Iu: $data["\x74\x6f\164\141\154\137\146\x65\145"] = $order["\x6f\x5f\141\x6d\157\165\156\x74"] * 100; goto vCgDZ; ib2LS: $order->cancel_time = time(); goto h5WbC; j2tY3: $productService->addStock($order["\x73\156\x61\160\137\151\x6e\146\x6f"]); goto S0sTN; U3MiP: goto SeB6Q; goto tPAOQ; yYz6h: plHTF: goto j2tY3; MWt2I: $sendEmailMessage = new EmailMessage(); goto OBA8R; ZkmZ8: $order->is_cancel = 1; goto aRDma; QVMO2: return ["\155\163\x67" => "\350\257\xb7\351\x80\211\xe6\213\xa9\xe8\256\xa2\xe5\215\x95", "\x65\x72\162\157\162\103\157\144\x65" => 0]; goto XiEwJ; Hp53Q: return ["\155\163\147" => "\xe5\x8f\x96\xe6\xb6\210\346\x88\x90\345\x8a\237", "\x65\x72\x72\157\x72\103\157\x64\x65" => 1]; goto U3MiP; YPyMo: sR56y: goto RJxJA; dEjPf: foreach ($phone as $key => $value) { $sendSmsMessage->smsMessage(session("\x75\156\x69\x61\143\151\x64"), $value, '', "\162\145\x66\x75\x6e\x64"); aabY5: } goto YPyMo; GHfSS: if ($order["\163\164\x61\164\165\163"] == 0) { goto tpRRP; } goto gIiGY; OBA8R: $sendEmailMessage->sendEmail(["\x75\156\x69\141\143\x69\x64" => session("\165\x6e\x69\x61\x63\x69\x64"), "\164\x69\x74\x6c\145" => "\347\224\xa8\346\x88\xb7\351\200\200\xe6\xac\276\xe6\217\220\351\206\222", "\x63\x6f\156\x74\x65\x6e\x74" => "\346\202\xa8\xe6\x9c\x89\xe4\xb8\200\346\235\241\xe6\x96\260\xe7\x9a\x84\351\200\200\xe6\254\276\350\256\xa2\xe5\215\225\xef\274\x8c\xe8\257\xb7\347\231\xbb\xe5\xbd\x95\345\225\206\xe5\x9f\x8e\345\220\x8e\xe5\x8f\260\357\274\210" . SITE_URL . "\xef\274\x89\346\x9f\245\347\x9c\213\xe3\x80\202"]); goto w1Fjv; gPsqK: $coupon = CouponModel::where(["\x75\156\151\141\143\x69\144" => session("\x75\x6e\x69\x61\x63\x69\144")])->find($order["\x63\x6f\x75\160\157\x6e\x5f\x69\144"]); goto Sb206; kIl6d: $order->save(); goto rWXff; cCdb6: if (!is_array($phone)) { goto MXCKs; } goto dEjPf; f6aqU: $sms = SmsSet::where("\165\x6e\x69\x61\143\151\144", session("\165\x6e\x69\x61\x63\151\x64"))->find(); goto hkoHR; w1Fjv: return json(["\155\163\x67" => "\351\x80\200\346\xac\xbe\346\x88\220\xe5\x8a\x9f", "\145\x72\x72\157\162\103\157\x64\145" => 1]); goto Y3Xcf; xGz4e: $user->save(); goto a31pG; EUnWH: $user->integral = $user->integral + $order["\x69\156\x74\145\147\x72\141\154"]; goto xGz4e; J1vSx: $data["\157\x75\164\137\x72\x65\x66\x75\x6e\144\x5f\156\x6f"] = $order["\157\x72\x64\145\x72\x5f\x6e\x6f"]; goto Ia1Iu; ySzBJ: if ($order) { goto puHMe; } goto qFDqQ; tPAOQ: Ih0SJ: goto zpYSh; pCs4D: $coupon = CouponModel::where(["\x75\x6e\x69\141\x63\151\144" => session("\165\x6e\151\x61\x63\151\x64")])->find($order["\143\157\165\x70\x6f\156\137\x69\x64"]); goto zbNXo; A0GVn: UserCoupon::updateUserCouponUnused($order["\x75\163\145\x72\137\151\144"], $order["\x63\x6f\x75\x70\157\156\137\151\144"]); goto gPsqK; ZB5VP: $order = OrderModel::where("\165\x6e\151\141\x63\x69\144", session("\165\x6e\151\x61\x63\x69\144"))->where(["\x69\144" => $orderId, "\165\x73\x65\x72\x5f\x69\144" => $uid, "\x69\x73\x5f\x63\x61\156\143\145\x6c" => 0, "\151\163\137\x64\145\154\145\164\x65" => 0])->find(); goto eqNw6; njYaV: $productService->addStock($order["\163\x6e\x61\x70\137\x69\156\146\x6f"]); goto Hp53Q; tGFPf: IntegralDetail::setIntegralDetail($integralDetail); goto Z53js; XiEwJ: VKC6c: goto Tka4y; fiyT8: tpRRP: goto XEJGw; ICB_6: $res = WechatService::refund($data); goto uzCxU; hkoHR: $phone = explode("\54", $sms["\156\x75\x6d\142\x65\x72"]); goto cCdb6; rWXff: $user = UserModel::get($order["\165\163\145\x72\x5f\151\144"]); goto EUnWH; Gp62P: return ["\x6d\163\x67" => "\345\xbd\223\xe5\211\x8d\350\256\xa2\345\215\x95\347\x8a\266\346\200\x81\xe4\xb8\x8d\xe6\224\257\xe6\214\201\345\x8f\226\346\266\210", "\145\x72\x72\157\162\103\157\144\145" => 0]; goto ODMaU; QKljv: SeB6Q: goto DONJm; A0Dlp: $user->save(); goto id3bj; uzCxU: if ($res["\x72\x65\164\165\162\x6e\x5f\143\157\x64\x65"] == "\123\x55\103\103\105\123\x53" && $res["\162\x65\163\165\154\x74\137\x63\x6f\x64\x65"] == "\x53\125\x43\x43\105\123\123") { goto Fd1Vu; } goto BPcI2; Z53js: tmzl3: goto OojDf; HxWxj: if (!($orderId == '' || $orderId == 0)) { goto VKC6c; } goto QVMO2; OojDf: if (!($order["\143\157\x75\160\x6f\x6e\137\151\x64"] != 0 || $order["\143\157\165\160\157\x6e\x5f\x69\144"] != '')) { goto ElXub; } goto EE1hm; DONJm: } public function getByUidAndKind($kind = '') { goto qMjeq; qI22n: goto sIrp_; goto fH8qC; kQq7h: if ($kind == "\163\x65\x6e\x64") { goto eEoxw; } goto eJXGO; ozsj3: C2oWu: goto caECU; AOeyd: return ["\x6d\x73\147" => "\xe7\261\273\345\236\x8b\351\x94\231\xe8\257\257", "\x65\x72\162\157\x72\x43\x6f\x64\x65" => 0]; goto ubu1w; aIoAH: if ($kind == "\141\x66\x74\145\162") { goto EMoaM; } goto B4me1; lWcm0: if ($kind == "\x63\157\155\x70\x6c\x65\x74\145\x64") { goto weUN_; } goto aIoAH; caECU: $data = $order->toArray(); goto lcnLM; B3817: goto sIrp_; goto igo0T; oM70z: return $refund; goto YxTBb; ubu1w: yZthx: goto QFKs7; eJXGO: if ($kind == "\143\157\156\x66\151\162\x6d") { goto v8z8F; } goto lWcm0; vmREt: $where = "\151\x73\137\x63\157\x6e\146\151\x72\x6d\40\x3d\x20\x31\40\141\x6e\144\x20\x73\164\141\164\165\163\40\75\40\63"; goto LHhH5; FWDYS: EMoaM: goto xhOYi; qfxVs: $size = isset($data["\163\151\x7a\x65"]) ? $data["\163\x69\x7a\145"] : 12; goto NoWk2; h7DTF: Tc339: goto xn3Pd; YxTBb: sIrp_: goto tSEI6; wdj3D: goto sIrp_; goto OEo6F; xhOYi: $refund = OrderRefundModel::getUserOrderRefund($uid, $size, $page); goto oM70z; NoWk2: $page = isset($data["\160\141\x67\x65"]) ? $data["\160\141\147\x65"] : 1; goto i4zQ6; mrOjQ: v8z8F: goto KLtrk; LHhH5: goto sIrp_; goto FWDYS; OdwPu: if ($kind == "\167\141\151\164") { goto x5G9U; } goto kQq7h; qMjeq: $kinds = ["\x61\x6c\154", "\x77\x61\x69\164", "\163\x65\x6e\144", "\x63\x6f\x6e\146\151\x72\x6d", "\x63\x6f\155\160\154\145\x74\145\x64", "\141\146\164\145\162"]; goto xsyUZ; i4zQ6: $uid = TokenService::getCurrentUid(); goto OdwPu; B4me1: $where = 1; goto wdj3D; fH8qC: weUN_: goto vmREt; K_YUM: goto sIrp_; goto mrOjQ; muNFx: foreach ($order as $key => $value) { goto DqN__; zqeYW: gOgaj: goto wFEKQ; gL7qn: $value["\x6f\x72\x64\145\162\137\x6e\157"] = $value["\157\154\144\137\157\x72\x64\145\x72\137\156\x6f"]; goto cbem8; cbem8: OBUJB: goto zqeYW; DqN__: if (!($value["\157\162\144\x65\162\x5f\x6e\157"] != $value["\x6f\154\x64\x5f\157\x72\x64\145\162\x5f\156\x6f"])) { goto OBUJB; } goto gL7qn; wFEKQ: } goto h7DTF; QFKs7: $data = input("\x70\157\163\x74\x2e"); goto qfxVs; igo0T: eEoxw: goto IvEEB; KLtrk: $where = "\151\x73\x5f\x63\157\x6e\x66\151\162\x6d\x20\75\x20\60\40\x61\x6e\144\x20\151\x73\x5f\163\x65\x6e\144\40\75\x20\61\x20\141\x6e\x64\40\x73\164\141\164\165\163\x20\75\40\62"; goto qI22n; Fh9hx: return ["\x6d\163\x67" => "\xe8\216\267\xe5\217\226\345\244\xb1\350\264\245", "\x64\141\164\141" => [], "\x63\x75\x72\162\x65\x6e\164\137\x70\x61\147\x65" => $order->getCurrentPage()]; goto ozsj3; XXjKK: $where = "\x73\x74\141\164\x75\163\40\75\x20\60"; goto B3817; lcnLM: return $data; goto ekJyr; xsyUZ: if (!($kind == '' || !in_array($kind, $kinds))) { goto yZthx; } goto AOeyd; tSEI6: $order = OrderModel::where("\165\156\151\141\143\x69\144", session("\x75\x6e\x69\x61\143\151\x64"))->where(["\x75\163\145\162\137\151\144" => $uid, "\x69\x73\x5f\144\145\x6c\145\164\145" => 0, "\151\x73\x5f\x63\141\156\143\145\154" => 0])->where($where)->order("\143\x72\145\x61\164\145\137\164\151\x6d\x65", "\144\145\163\143")->paginate($size, true, ["\x70\141\147\x65" => $page]); goto muNFx; xn3Pd: if (!$order->isEmpty()) { goto C2oWu; } goto Fh9hx; IvEEB: $where = "\163\164\141\x74\165\x73\x20\x3d\40\61\40\141\156\144\40\x69\163\x5f\x73\x65\156\x64\x20\x3d\40\60"; goto K_YUM; OEo6F: x5G9U: goto XXjKK; ekJyr: } public function searchOrder($keyword = '') { goto YRFDc; PtLuh: return ["\x6d\163\x67" => "\xe8\216\xb7\xe5\217\x96\345\244\261\350\xb4\xa5", "\x64\141\x74\141" => [], "\x65\162\162\x6f\162\x43\x6f\x64\x65" => 0]; goto FuByx; drZCR: $where = "\x6f\x6c\144\x5f\157\x72\x64\145\162\x5f\x6e\x6f\40\x6c\151\x6b\x65\40\47\45{$keyword}\x25\47"; goto dTQnS; tsJM4: Hg3Q7: goto ICnU7; dTQnS: $uid = TokenService::getCurrentUid(); goto N25Dr; ICnU7: return ["\155\x73\x67" => "\350\x8e\267\xe5\x8f\x96\xe6\x88\x90\xe5\212\237", "\x64\x61\x74\141" => $product, "\x65\x72\162\x6f\162\x43\157\144\145" => 1]; goto zJz0z; N25Dr: $product = OrderModel::where("\x75\x6e\x69\x61\x63\151\144", session("\x75\156\x69\x61\x63\151\144"))->where($where)->where(["\x75\163\x65\x72\137\x69\x64" => $uid, "\x69\163\x5f\144\145\154\145\164\145" => 0, "\x69\x73\x5f\143\141\x6e\143\145\x6c" => 0])->order("\143\x72\145\141\x74\x65\137\164\x69\155\x65", "\144\x65\163\x63")->select(); goto oNGu2; zJz0z: gnfnE: goto cSvKM; SVo0x: return ["\155\x73\x67" => "\345\x85\263\xe9\224\xae\xe8\257\215\xe4\270\x8d\xe8\x83\xbd\344\xb8\272\xe7\xa9\xba", "\145\x72\162\157\x72\x43\x6f\144\x65" => 0]; goto HFYcF; HFYcF: rgrAr: goto drZCR; oNGu2: if (!$product->isEmpty()) { goto Hg3Q7; } goto PtLuh; FuByx: goto gnfnE; goto tsJM4; YRFDc: if ($keyword) { goto rgrAr; } goto SVo0x; cSvKM: } public function getDetail($orderId) { goto WPrTl; AQHvT: eFWZW: goto BFTPl; vrrfX: $order = OrderModel::get($orderId); goto i87J9; IIaj0: $overdue = strtotime("\x2b{$setting["\157\162\x64\x65\x72\x5f\164\x69\155\x65"]}\40\155\x69\156\x75\x74\x65", strtotime($orderDetail["\143\x72\145\141\x74\145\x5f\x74\x69\155\145"])); goto Gglat; FCNdu: $setting = PlatformSettings::where("\x75\x6e\x69\141\x63\x69\x64", session("\165\156\x69\141\x63\x69\x64"))->find(); goto IIaj0; X7luG: foreach ($order["\x73\x6e\141\x70\137\151\x6e\x66\157"] as $key => &$value) { goto vDWFm; l7wYx: $value["\x72\x65\x66\165\156\x64\x5f\163\x74\141\164\165\x73"] = $refund_status; goto m9mHh; M6v1N: goto UcETO; goto GaPgP; aP76Y: $refund = OrderRefund::getOrderRefundByData($data); goto n4l9n; ePhuT: PVi9v: goto H0tcI; M2aAk: $refund_status = "\55\x31"; goto M6v1N; m9mHh: $snap_info[$key] = $value; goto ePhuT; n4l9n: $refund_status = $refund["\163\164\x61\164\x75\163"]; goto Ta3Xs; GaPgP: bu73u: goto XviDs; Ta3Xs: UcETO: goto l7wYx; XviDs: $data = ["\157\162\144\145\x72\x49\144" => $order["\x69\x64"], "\160\x72\157\x64\x75\x63\x74\111\144" => $value["\x70\162\157\144\165\143\164\x49\x64"], "\x61\164\164\162\137\x69\x64\x5f\154\151\163\164" => $value["\x61\x74\x74\162\137\151\144\137\x6c\151\163\x74"]]; goto aP76Y; vDWFm: if ($value["\151\163\137\162\x65\146\x75\x6e\x64"] == 1) { goto bu73u; } goto M2aAk; H0tcI: } goto yyLp6; gmFsJ: $orderData["\163\156\x61\160\x5f\151\x6e\146\157"] = json_encode($snap_info, JSON_UNESCAPED_UNICODE); goto tz2Sl; BFTPl: if (!($order["\151\163\x5f\162\145\x66\165\x6e\144"] == 1)) { goto aaFvu; } goto tKgrE; jqFKx: return ["\x6d\x73\x67" => "\xe8\xaf\267\xe9\x80\211\346\213\xa9\350\256\242\345\215\x95", "\x65\x72\162\157\162\103\157\x64\145" => 0]; goto Vdbkl; Vdbkl: i0n0v: goto vrrfX; fP2Dh: $orderDetail["\x70\x69\143\153\x5f\164\x65\154"] = $pickPoint["\x74\145\154"]; goto GGaqJ; yuPNy: return ["\x6d\x73\x67" => "\350\x8e\267\xe5\x8f\x96\346\210\220\xe5\212\237", "\x64\141\164\x61" => $orderDetail, "\x65\162\x72\x6f\x72\x43\157\144\x65" => 1]; goto bFmAn; WPrTl: if (!($orderId == '' || $orderId == 0)) { goto i0n0v; } goto jqFKx; tKgrE: $snap_info = []; goto X7luG; GGaqJ: $orderDetail["\x70\x69\143\153\x5f\156\141\x6d\145"] = $pickPoint["\156\x61\x6d\x65"]; goto yuPNy; HvIp2: $orderDetail["\143\x6c\x65\x72\153\x5f\164\x69\x6d\x65"] = $orderDetail["\x63\154\145\162\153\137\x74\151\x6d\145"] ? date("\131\x2d\155\x2d\144\x20\x48\72\151\72\x73", $orderDetail["\x63\x6c\x65\x72\x6b\x5f\x74\x69\155\x65"]) : ''; goto mCns6; i87J9: if ($order) { goto eFWZW; } goto YLPF_; oXSRs: aaFvu: goto zNbNh; xuhy9: $orderDetail["\157\x72\144\x65\x72\x5f\156\x6f"] = $orderDetail["\x6f\x6c\144\x5f\x6f\x72\x64\x65\162\x5f\x6e\x6f"]; goto blIh4; pEMhD: $pickPoint = PickPointModel::get($pickInfo["\160\x69\x63\153\111\x64"]); goto fP2Dh; goi3b: OrderModel::update($orderData); goto oXSRs; mCns6: $pickInfo = $orderDetail["\x70\x69\143\x6b\137\x69\156\146\x6f"]; goto pEMhD; tz2Sl: $orderData["\x69\144"] = $order["\x69\x64"]; goto goi3b; Gglat: $orderDetail["\x6f\166\145\x72\144\x75\145"] = date("\x59\55\155\55\x64\40\x48\x3a\151\x3a\163", $overdue); goto HvIp2; yyLp6: pp5a7: goto gmFsJ; YLPF_: return ["\155\x73\x67" => "\350\x8e\xb7\xe5\x8f\x96\345\244\xb1\350\264\xa5", "\144\141\164\x61" => [], "\145\x72\x72\x6f\x72\103\157\x64\x65" => 0]; goto AQHvT; wxDki: if (!($orderDetail["\x6f\162\x64\x65\x72\x5f\156\x6f"] != $orderDetail["\x6f\x6c\144\x5f\157\162\x64\x65\x72\137\x6e\157"])) { goto g8p3s; } goto xuhy9; blIh4: g8p3s: goto FCNdu; zNbNh: $orderDetail = OrderModel::get($orderId); goto wxDki; bFmAn: } }