<?php
 namespace app\api\controller\v1; use app\lib\exception\SuccessMessage; use think\Controller; use think\File; use app\api\controller\BaseController; use app\api\model\PlatformSettings; use think\Loader; use app\api\service\Token as TokenService; use app\api\service\Express as ExpressService; use app\api\model\Delivery as DeliveryModel; class Base extends BaseController { public function getPlatformInfo() { goto WVGfR; JU__l: NqSba: goto xxuyg; MEqzP: $delivery = DeliveryModel::where(["\165\156\151\141\143\x69\x64" => session("\x75\x6e\151\x61\143\x69\x64")])->field(["\x6d\151\x6e\x5f\160\162\x69\143\x65\x2c\x69\x73\137\x74\x69\x6d\151\156\147\54\144\145\154\151\x76\145\162\x79\137\141\x72\145\x61"])->find(); goto UWOfc; GEU_g: eIdOr: goto hW2wy; vlbIU: goto eIdOr; goto JU__l; YZV0y: if (!(strpos($info["\154\x6f\147\x6f"], "\x2f\57") == 0)) { goto rMw09; } goto r20wD; ywCW3: $info["\x61\160\x69\137\165\x72\154"] = API_URL; goto YZV0y; WVGfR: $info = PlatformSettings::where(["\165\156\151\x61\143\151\144" => session("\165\x6e\x69\x61\143\151\144")])->field(["\156\x61\x6d\x65", "\164\145\154", "\154\157\147\x6f", "\157\162\144\145\162\137\164\151\155\x65", "\x69\163\137\x74\157\153\145\156", "\x69\163\137\x70\151\143\153", "\x69\163\137\144\x65\x6c\151\166\x65\162\x79", "\151\163\x5f\x65\x78\160\162\x65\x73\x73", "\x69\x73\x5f\160\162\157\x6d\x69\163\x65", "\x61\x64\144\162\145\x73\163", "\x6c\x6f\x6e\147\151\x74\165\144\145", "\x6c\141\x74\x69\x74\165\x64\x65"])->find(); goto ywCW3; r20wD: $info["\154\157\147\157"] = str_replace("\x2f\x2f", "\x68\164\x74\x70\163\x3a\x2f\x2f", $info["\x6c\x6f\147\x6f"]); goto uyYjc; XmQRI: return ["\x6d\x73\147" => "\350\216\267\xe5\x8f\x96\xe5\xa4\261\350\264\xa5", "\145\x72\x72\157\162\103\157\x64\x65" => 0]; goto vlbIU; uyYjc: rMw09: goto MEqzP; xxuyg: return ["\155\163\x67" => "\xe8\216\267\xe5\217\226\346\210\220\xe5\212\x9f", "\144\x61\x74\x61" => ["\x69\156\x66\157" => $info, "\144\x65\154\x69\x76\145\162" => ["\155\151\156\x5f\x70\162\x69\143\x65" => $delivery["\x6d\x69\156\x5f\x70\x72\x69\143\145"] ? $delivery["\x6d\x69\x6e\x5f\x70\x72\x69\143\145"] : "\60", "\x69\x73\137\164\x69\155\151\x6e\147" => $delivery["\151\x73\x5f\x74\151\155\x69\x6e\147"] ? $delivery["\x69\163\137\164\151\x6d\x69\156\x67"] : '', "\x64\x65\154\x69\x76\x65\162\x79\x5f\141\x72\x65\141" => $delivery["\144\145\x6c\151\x76\x65\x72\x79\x5f\x61\x72\x65\141"] ? $delivery["\x64\x65\154\x69\166\145\162\171\137\141\x72\x65\x61"] : '']], "\x65\162\x72\157\x72\103\157\x64\x65" => 1]; goto GEU_g; UWOfc: if ($info) { goto NqSba; } goto XmQRI; hW2wy: } public function getExpress() { goto D4KS9; v72_3: return ["\x6d\x73\x67" => "\xe8\257\267\xe8\276\223\xe5\x85\xa5\345\277\253\351\x80\x92\xe5\x8d\x95\345\x8f\xb7", "\x65\x72\162\x6f\162\103\157\144\x65" => 0]; goto WM3Xr; IO2Il: if (!(!isset($data["\145\x78\x70\x72\145\x73\x73\116\x61\x6d\x65"]) || $data["\x65\x78\x70\162\145\163\x73\x4e\141\x6d\x65"] == '')) { goto mqmy2; } goto prZC2; BUCr2: $express = $expressService->kdniao($data); goto t0ZKf; prZC2: return ["\x6d\163\147" => "\xe8\257\xb7\xe8\276\x93\345\205\245\345\277\xab\351\x80\x92\345\205\254\345\217\xb8", "\145\x72\162\157\x72\103\157\x64\x65" => 0]; goto McnlC; D4KS9: $data = input("\x70\157\163\164\56"); goto IO2Il; WM3Xr: dNmWi: goto oCT3p; H1YDO: if (!(!isset($data["\145\x78\x70\x72\x65\x73\x73\x4e\165\155\142\x65\162"]) || $data["\145\x78\160\x72\x65\163\x73\116\165\x6d\x62\x65\162"] == '')) { goto dNmWi; } goto v72_3; oCT3p: $expressService = new ExpressService(); goto BUCr2; McnlC: mqmy2: goto H1YDO; t0ZKf: return $express; goto YCahY; YCahY: } public function WxUploadImages() { goto e81KI; hARRa: $saveRoot = "\x70\x75\x62\154\x69\143" . DS . "\x75\x70\x6c\157\x61\x64\163" . DS . "\x77\170\x61\160\x70"; goto aa5d3; aa5d3: foreach ($files as $item) { goto RYVgM; iZVB8: $picUrl = str_replace("\134", '', $picUrl); goto Y8RcQ; RYVgM: $info = $files->validate(["\163\x69\172\145" => 2097152, "\x65\170\164" => "\x6a\x70\x67\54\x70\x6e\x67\54\147\151\146"])->move($saveRoot); goto ioKDF; BPgiB: $picUrl = MINI_WE7_PATH . $saveRoot . DS . $info->getSaveName(); goto iZVB8; e3uNa: puWW2: goto TmIyV; ioKDF: if (!$info) { goto puWW2; } goto BPgiB; TmIyV: h0Xu2: goto v5d2F; Y8RcQ: echo $picUrl; goto e3uNa; v5d2F: } goto VhsJI; VhsJI: WNC35: goto kvcHJ; e81KI: $files = request()->file("\x66\x69\x6c\145\x73"); goto hARRa; kvcHJ: } public function WxUploadImage() { goto c0Sue; p6Nk4: PevsN: goto DGkIw; DGkIw: ga35N: goto dET0P; c0Sue: $fileName = input("\160\157\163\164\x2e\x66\x69\x6c\145\x4e\x61\x6d\145"); goto Wvxvc; zTfWS: return ["\x6d\163\147" => $file->getError(), "\x65\162\x72\x6f\162\103\157\144\145" => 0]; goto RWOOA; nRkt8: return ["\x6d\x73\x67" => "\xe4\xb8\x8a\xe4\xbc\240\346\210\220\xe5\212\237", "\144\141\x74\x61" => $picUrl, "\145\x72\162\157\x72\x43\157\144\x65" => 1]; goto p6Nk4; UQEHU: $picUrl = str_replace("\42", '', $picUrl); goto nRkt8; U0rE4: if ($info) { goto t1Psr; } goto zTfWS; Wvxvc: $rootPath = "\x70\165\x62\x6c\x69\143" . DS . "\x75\160\x6c\157\x61\144\163" . DS . "\167\x78\x61\x70\x70"; goto g1w3e; o_A6C: $picUrl = MINI_WE7_PATH . $rootPath . DS . $info->getSaveName(); goto UQEHU; U3whj: $info = $file->validate(["\163\x69\172\145" => 2097152, "\145\x78\164" => "\152\160\147\x2c\x70\156\147\x2c\x67\151\146"])->move($rootPath); goto U0rE4; ztuyY: if (!$file) { goto ga35N; } goto U3whj; g1w3e: $file = request()->file($fileName); goto ztuyY; LaZ1c: t1Psr: goto o_A6C; RWOOA: goto PevsN; goto LaZ1c; dET0P: } public function WxDelImage() { goto unXiS; dxfT0: yyjhS: goto VaPww; lQn5c: cW0gE: goto dxfT0; TdK85: if (!$imageUrl) { goto yyjhS; } goto rqAai; rqAai: if (!file_exists($imageUrl)) { goto cW0gE; } goto cVt64; LXGDE: $imageUrl = str_replace(MINI_WE7_PATH, '', $imageUrl); goto z2pji; VaPww: return ["\x6d\x73\x67" => "\xe5\210\240\351\x99\244\xe5\244\261\xe8\264\245", "\145\162\x72\157\162\x43\157\144\145" => 0]; goto He3kU; UkHGM: $imageUrl = str_replace("\150\x74\164\160\x73\x3a", '', $imageUrl); goto TdK85; SPT4o: return ["\x6d\163\x67" => "\xe5\x88\xa0\351\231\244\346\x88\220\345\212\237", "\145\162\162\x6f\x72\103\x6f\x64\x65" => 1]; goto lQn5c; z2pji: $imageUrl = str_replace("\x68\164\164\x70\x3a", '', $imageUrl); goto UkHGM; cVt64: unlink($imageUrl); goto SPT4o; unXiS: $imageUrl = input("\x69\x6d\141\x67\145\125\x72\154"); goto LXGDE; He3kU: } public function decodeUserPhone() { goto AzXcc; Suvm8: $platform = PlatformSettings::where("\x75\156\x69\x61\143\151\144", session("\165\156\x69\141\x63\x69\144"))->find(); goto J__uX; VuUSx: WvYGm: goto yr2jo; yr2jo: Loader::import("\x64\145\x63\x6f\x64\x65\x50\x68\x6f\x6e\x65\x2e\167\x78\x42\151\x7a\104\x61\164\141\x43\162\171\x70\x74"); goto Suvm8; TeyKM: goto vZEPS; goto mjAcC; P9m7U: $iv = input("\x69\x76"); goto j5aLA; TLjgt: $data = json_decode($data); goto ZqYOB; XhA2i: $sessionKey = TokenService::getCurrentTokenVar("\x73\x65\x73\163\151\157\x6e\137\153\x65\x79"); goto wJe1x; W4Yjw: return ["\155\163\147" => "\145\156\x63\x72\171\x70\x74\145\144\104\x61\164\141\xe4\xb8\215\xe8\203\xbd\xe4\270\272\347\xa9\xba", "\x65\x72\162\x6f\x72\103\x6f\144\x65" => 0]; goto LWQv8; ZcgY6: if (!empty($encryptedData)) { goto AMGr7; } goto W4Yjw; vaFlY: vZEPS: goto jSDNO; I7g5v: return ["\x6d\x73\147" => "\350\x8e\xb7\xe5\x8f\226\345\244\261\350\264\xa5", "\144\141\x74\x61" => $errCode, "\145\162\x72\157\x72\x43\x6f\144\145" => 0]; goto TeyKM; ZqYOB: return ["\155\x73\x67" => "\350\x8e\xb7\xe5\x8f\x96\xe6\x88\x90\xe5\212\x9f", "\x64\x61\x74\x61" => $data->phoneNumber, "\145\x72\x72\x6f\162\x43\157\x64\x65" => 1]; goto vaFlY; JOY4l: $errCode = $pc->decryptData($encryptedData, $iv, $data); goto NqdUG; j5aLA: if (!empty($iv)) { goto WvYGm; } goto cOi8N; NqdUG: if ($errCode == 0) { goto wqwUJ; } goto I7g5v; AzXcc: $encryptedData = input("\145\x6e\143\162\171\x70\164\x65\144\x44\141\x74\x61"); goto ZcgY6; mjAcC: wqwUJ: goto TLjgt; wJe1x: $pc = new \WXBizDataCrypt($appid, $sessionKey); goto JOY4l; LWQv8: AMGr7: goto P9m7U; J__uX: $appid = $platform["\141\x70\160\151\x64"]; goto XhA2i; cOi8N: return ["\155\163\x67" => "\x69\166\xe4\xb8\x8d\350\x83\275\344\270\272\347\xa9\272", "\145\162\162\x6f\x72\x43\157\x64\x65" => 0]; goto VuUSx; jSDNO: } }