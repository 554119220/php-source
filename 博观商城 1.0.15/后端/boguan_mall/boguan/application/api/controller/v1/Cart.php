<?php
 namespace app\api\controller\v1; use app\api\controller\BaseController; use app\api\model\Product as ProductModel; use app\api\service\Token as TokenService; use app\api\model\Cart as CartModel; use app\api\service\Product as ProductService; use app\api\model\User as UserModel; use app\api\service\Wechat as WechatService; use think\Request; use app\api\model\UserAccess; class Cart extends BaseController { public $uid; public function __construct(Request $request = null) { goto QXnJ6; ukJTq: $uid = TokenService::getCurrentUid(); goto ZhWMn; ZhWMn: $this->uid = $uid; goto KN9_3; KN9_3: UserAccess::checkIsAccess($uid); goto xx4Pt; QXnJ6: parent::__construct($request); goto ukJTq; xx4Pt: } public function delCart() { goto LTPe6; lakR9: Qeo54: goto ABU_X; LTPe6: $data = input("\x70\x6f\163\x74\x2e"); goto IUIM1; IUIM1: $cartId = isset($data["\x63\x61\162\164\111\x64"]) ? $data["\143\x61\x72\164\111\144"] : ''; goto ilPao; ilPao: if (!($cartId == '' || !is_array($cartId) || empty($cartId))) { goto QNLxc; } goto mjTb1; NalCS: QNLxc: goto D5LQw; t1kD6: $cartId = implode("\x2c", $cartId); goto qAVUp; YloP1: $carts = CartModel::where(["\x75\x73\x65\x72\137\151\x64" => $uid, "\151\x73\x5f\144\x65\x6c\x65\x74\x65" => 0])->where($where)->select(); goto R9XWq; i720y: YdVna: goto BK7XQ; UofmB: TRfPl: goto IplJ2; IplJ2: if ($this->result !== false) { goto Qeo54; } goto BIDpM; KyKxh: goto OGizW; goto OpFUv; R9XWq: if (!$carts->isEmpty()) { goto bSvtF; } goto Z0jvu; D5LQw: $uid = TokenService::getCurrentUid(); goto r6RPC; OpFUv: bSvtF: goto SF2xl; BIDpM: return ["\x6d\163\147" => "\347\275\x91\347\273\x9c\xe5\xbc\202\345\xb8\xb8", "\x65\162\162\157\x72\x43\x6f\x64\145" => 0]; goto UfTMk; qAVUp: $where = "\x69\144\40\x69\x6e\x28{$cartId}\51"; goto YloP1; Z0jvu: return ["\155\163\x67" => "\347\xbd\221\xe7\273\234\345\274\202\xe5\270\270", "\x65\x72\x72\x6f\162\103\x6f\144\x65" => 0]; goto KyKxh; ABU_X: return ["\155\163\x67" => "\xe5\x88\240\351\231\244\346\210\x90\xe5\x8a\x9f", "\x65\x72\x72\157\x72\103\157\x64\145" => 1]; goto i720y; SF2xl: foreach ($carts as $key => $cart) { goto EzoDo; G_FmP: $attr_id_list = implode("\x2c", $attr_id_list); goto HwgdK; TdCS6: WechatService::delCartList($delData); goto wZeZl; sPr4Y: $attr_id_list = $cart["\160\x72\157\144\x75\143\x74\137\151\x64"]; goto WlOOI; EzoDo: $cartData["\151\x64"] = $cart["\x69\x64"]; goto of7Be; uccxE: $this->result = false; goto qYLJS; EwRN_: sTNxw: goto VZXqP; wZeZl: $this->result = true; goto fiJcs; gumxQ: $attr_id_list = json_decode($cart["\x61\x74\164\162\x5f\151\144\137\x6c\151\x73\x74"], true); goto G_FmP; HwgdK: goto f5900; goto vr3cl; vr3cl: IKCnZ: goto sPr4Y; hDx_d: $result = CartModel::update($cartData); goto SLvJw; of7Be: $cartData["\151\x73\137\144\145\x6c\x65\x74\x65"] = 1; goto hDx_d; WlOOI: f5900: goto kfrbd; SLvJw: if ($result !== false) { goto sTNxw; } goto uccxE; CQdkI: S7Yre: goto etyTj; fiJcs: X_wWB: goto CQdkI; kfrbd: $delData = ["\157\x70\145\156\x69\x64" => $user["\x6f\160\x65\156\151\x64"], "\x70\162\x6f\144\x75\x63\x74\137\x69\x64" => $cart["\x70\162\x6f\x64\165\x63\x74\137\x69\x64"], "\x61\x74\164\162\x5f\x69\x64\x5f\154\151\163\x74" => $attr_id_list]; goto TdCS6; VZXqP: if ($cart["\x61\x74\x74\162\x5f\x69\144\137\x6c\151\163\x74"] == '') { goto IKCnZ; } goto gumxQ; qYLJS: goto X_wWB; goto EwRN_; etyTj: } goto UofmB; r6RPC: $user = UserModel::get($uid); goto t1kD6; BK7XQ: OGizW: goto PDAoF; UfTMk: goto YdVna; goto lakR9; mjTb1: return ["\155\163\147" => "\xe8\xaf\267\xe9\200\x89\346\213\xa9\xe8\246\201\345\210\240\351\231\xa4\347\x9a\x84\345\225\x86\345\x93\x81", "\x65\162\162\x6f\162\103\157\x64\145" => 0]; goto NalCS; PDAoF: } public function checkCart() { goto qsFdc; YWNKH: if (isset($data["\143\141\162\x74\111\x64"]) || $data["\x63\141\x72\164\x49\x64"] == '') { goto HiYFA; } goto vX_HO; Pm5fv: if ($result == true) { goto AO0Dc; } goto R2YgG; ntjZ0: s0lVs: goto oZV66; hy3IT: goto Ci1vV; goto NjCIp; xznfm: B_P5J: goto Cg6RL; gvwCU: goto U0hJ_; goto ntjZ0; vX_HO: return ["\155\163\x67" => "\143\141\x72\x74\x49\144\xe4\270\x8d\xe8\203\xbd\xe4\xb8\xba\xe7\xa9\272", "\145\x72\x72\157\162\103\x6f\144\x65" => 0]; goto Rp0lP; qCnnY: foreach ($data["\x63\141\x72\164\111\144"] as $key => $value) { goto gV96j; H20y_: zX1e1: goto JVZw9; r41rC: $can_buy = 0; goto bsE4F; cFZwA: goto AEcyf; goto icqUK; DLg6K: if (!($product["\163\x74\x6f\143\x6b"] - $cart["\x6e\165\155"] < 0)) { goto UTHGf; } goto fK_EP; fK_EP: $can_buy = 0; goto GRH_v; icqUK: c2jVY: goto klTH0; GRH_v: UTHGf: goto cFZwA; V55rA: if (!($product["\163\164\x61\164\165\x73"] == 0)) { goto NRV5V; } goto hXEVS; bsE4F: NwWRU: goto OmqKc; fV48g: if ($product["\x69\x73\137\x61\164\x74\x72"] == 1) { goto c2jVY; } goto DLg6K; EH3JL: $can_buy = 0; goto DsgDL; BOezF: MOQMJ: goto FTHq4; JVZw9: if (!($can_buy == 1)) { goto QBkVU; } goto kDx4Z; kDx4Z: $result = $this->cartIsChecked($value, true, $uid); goto YbCQ8; gV96j: $cart = CartModel::get($value); goto EMIt1; yARBE: $attr_id_list = $cart["\x61\164\x74\x72\137\151\x64\x5f\154\x69\163\164"]; goto fV48g; DsgDL: Q0Kpa: goto oWaXj; OmqKc: AEcyf: goto V55rA; klTH0: $attr = $productService->getAttrInfo($cart["\x70\x72\157\x64\x75\143\164\137\x69\144"], $attr_id_list); goto dFEJa; oWaXj: if ($attr) { goto NwWRU; } goto r41rC; EMIt1: $can_buy = 1; goto p0pbI; p0pbI: $product = ProductModel::get($cart["\160\162\x6f\144\x75\143\x74\137\151\144"]); goto yARBE; nzNKH: NRV5V: goto BrSju; JKZvQ: $can_buy = 0; goto H20y_; dFEJa: if (!($attr["\163\164\157\x63\153"] - $cart["\156\x75\155"] < 0)) { goto Q0Kpa; } goto EH3JL; BrSju: if (!($product["\151\163\137\x64\145\154\x65\x74\x65"] == 1)) { goto zX1e1; } goto JKZvQ; YbCQ8: QBkVU: goto BOezF; hXEVS: $can_buy = 0; goto nzNKH; FTHq4: } goto CRRHJ; dqLvR: goto dVhD1; goto J8yb1; UbCcU: if ($op) { goto s0lVs; } goto bUI_H; EWbid: KvjQg: goto okJET; iRRAZ: if (is_array($data["\x63\141\x72\164\111\x64"])) { goto T22mI; } goto Vy0B4; F4imS: Ci1vV: goto pXaOX; qsFdc: $uid = TokenService::getCurrentUid(); goto k6Pew; R2YgG: return ["\x6d\163\147" => "\xe6\223\215\xe4\275\234\xe5\244\xb1\xe8\xb4\245", "\145\162\162\x6f\162\103\157\x64\x65" => 0]; goto dqLvR; yMMoe: HiYFA: goto iRRAZ; k6Pew: $productService = new ProductService(); goto BWRD2; Vy0B4: return ["\x6d\163\147" => "\143\x61\x72\164\x49\x64\xe4\270\272\346\x95\260\347\273\204", "\x65\162\x72\157\x72\x43\x6f\x64\x65" => 0]; goto O07Oj; BWRD2: $data = input("\160\157\163\164\x2e"); goto YWNKH; qs7tw: E3ZCt: goto gvwCU; okJET: foreach ($data["\x63\141\x72\x74\111\x64"] as $key => $value) { $result = $this->cartIsChecked($value, false, $uid); gjfOT: } goto pv_2W; NjCIp: PRWYM: goto qCnnY; oZV66: if ($op == "\x63\x68\145\x63\153\145\144") { goto PRWYM; } goto eOL3f; pv_2W: nprDC: goto F4imS; NceLh: goto Ci1vV; goto EWbid; J8yb1: AO0Dc: goto OepIR; eOL3f: if ($op == "\143\141\156\143\x65\154") { goto KvjQg; } goto hy3IT; ajIGB: $result = false; goto UbCcU; O07Oj: T22mI: goto xznfm; cQA6V: dVhD1: goto nQImq; Rp0lP: goto B_P5J; goto yMMoe; Cg6RL: $op = isset($data["\x6f\160"]) ? $data["\157\160"] : ''; goto ajIGB; bUI_H: foreach ($data["\143\141\x72\164\111\144"] as $key => $value) { goto DdvBG; Rg0iU: $cartData["\x69\x73\x5f\x63\x68\x65\x63\153\145\144"] = 1; goto q90so; FxvCD: CyzfM: goto HH1Jd; MW2OA: i0JRT: goto Rg0iU; AQtAp: $cartData["\x69\x73\137\143\x68\145\x63\x6b\x65\144"] = 0; goto cGLYP; DdvBG: $cart = CartModel::where("\x75\163\x65\x72\137\151\x64", $uid)->find($value); goto nHVEi; nHVEi: if (!$cart) { goto CyzfM; } goto z0K3r; HH1Jd: BcV2e: goto S_QRd; q90so: NCBwu: goto QpLam; QpLam: $cartData["\x69\144"] = $value; goto ddG0M; ddG0M: $result = CartModel::update($cartData); goto FxvCD; cGLYP: goto NCBwu; goto MW2OA; z0K3r: if ($cart["\151\163\137\x63\x68\x65\143\x6b\x65\x64"] == 0) { goto i0JRT; } goto AQtAp; S_QRd: } goto qs7tw; OepIR: return ["\155\x73\147" => "\xe6\223\x8d\344\xbd\x9c\346\210\220\xe5\212\237", "\145\x72\162\157\x72\x43\x6f\144\x65" => 1]; goto cQA6V; CRRHJ: DRXJy: goto NceLh; pXaOX: U0hJ_: goto Pm5fv; nQImq: } private function cartIsChecked($cartId, $status, $uid) { goto XnA1V; XnA1V: $cart = CartModel::where("\165\x73\x65\x72\137\151\144", $uid)->find($cartId); goto VsdfT; DovRe: $result = $cart->save(); goto omjJt; Xhus8: goto VV85o; goto vXFNy; vXFNy: kEPmA: goto kWof9; VsdfT: if (!empty($cart)) { goto v0m7E; } goto U71PE; TBuB0: if ($status) { goto YjC_v; } goto C8KsP; U71PE: return false; goto Nzj1f; XiqYi: v0m7E: goto TBuB0; lDm20: M6MUh: goto nvASG; Hc1Ef: YjC_v: goto DXx9C; K5Fxb: Cqr6D: goto DovRe; Nzj1f: goto M6MUh; goto XiqYi; DXx9C: $cart->is_checked = 1; goto K5Fxb; B33xm: return false; goto Xhus8; VrKJu: goto Cqr6D; goto Hc1Ef; rvjDl: VV85o: goto lDm20; omjJt: if ($result !== false) { goto kEPmA; } goto B33xm; kWof9: return true; goto rvjDl; C8KsP: $cart->is_checked = 0; goto VrKJu; nvASG: } public function editCart() { goto hehSe; dlsl9: return ["\x6d\x73\x67" => "\xe7\xbd\x91\347\xbb\234\345\274\x82\345\xb8\xb8", "\x65\x72\x72\157\162\x43\157\144\145" => 0]; goto wBGyA; qTa5m: return ["\x6d\163\147" => "\xe5\x95\x86\345\223\x81\345\xb7\xb2\344\xb8\213\xe6\236\266", "\x65\162\162\x6f\x72\103\x6f\x64\x65" => 0]; goto BUtoM; krt1J: return ["\x6d\163\147" => "\xe5\267\xb2\346\x98\xaf\xe6\x9c\x80\345\xb0\x8f\346\225\260\351\x87\217", "\145\x72\x72\157\162\103\157\144\x65" => 0]; goto Q3s7y; Vi212: aU1TZ: goto C34_9; lrxEW: T7SSI: goto cZrwF; uJDre: $uid = TokenService::getCurrentUid(); goto Civam; cf2db: if (!($cartId == '')) { goto Z6SKH; } goto Tj3Db; Civam: $cart = CartModel::where(["\x69\x64" => $cartId, "\x75\x73\x65\162\x5f\151\x64" => $uid])->find(); goto K7zz1; JjJod: OFHOa: goto o8XUv; PwA8Z: ICOW7: goto tjxeM; o8XUv: return ["\155\163\x67" => "\xe4\xbf\256\xe6\224\xb9\xe6\210\220\xe5\x8a\x9f", "\x65\162\162\x6f\162\x43\x6f\144\x65" => 1]; goto NhCi_; z4j1B: if ($product) { goto tbUN2; } goto qTa5m; cZrwF: $productService = new ProductService(); goto uuxMd; GXvgA: return ["\155\163\147" => "\xe8\264\255\xe7\x89\251\xe8\xbd\246\xe4\xb8\272\xe7\xa9\xba", "\x65\162\162\x6f\x72\103\157\x64\x65" => 0]; goto llOpD; A_SZ4: $cartData["\156\165\x6d"] = 1; goto heOuG; bMjj1: return ["\x6d\x73\147" => "\xe8\xaf\267\xe9\x80\211\xe6\x8b\xa9\346\x95\260\351\207\x8f", "\x65\162\162\157\x72\103\x6f\144\145" => 0]; goto KPFHW; heOuG: TjfIw: goto cZBx6; SfYAa: return ["\x6d\x73\x67" => "\345\x95\x86\xe5\223\x81\xe6\x95\xb0\xe9\x87\x8f\xe8\xb6\x85\350\277\207\345\272\x93\xe5\xad\230", "\145\x72\x72\x6f\162\x43\x6f\144\145" => 0]; goto zvJp2; K7zz1: $product = ProductModel::where("\165\x6e\151\x61\x63\x69\x64", session("\165\156\x69\141\143\151\x64"))->where(["\x69\x64" => $cart["\x70\162\157\x64\165\143\x74\137\x69\x64"], "\x73\164\141\164\x75\x73" => 1])->find(); goto ImalY; tjxeM: if (!($cart["\x61\164\x74\x72\x5f\x69\144\x5f\x6c\151\x73\164"] == '')) { goto T7SSI; } goto iUQ3G; fcWY9: goto IQJD5; goto PwA8Z; Rg1bo: $cartData["\x6e\x75\155"] = $cart["\156\165\155"] + $num; goto z4j1B; SNCWD: tbUN2: goto Wz3TV; KPFHW: zaaO7: goto cf2db; bhrCU: Z6SKH: goto uJDre; h0XD0: $cartId = isset($data["\x63\x61\162\164\111\x64"]) ? $data["\x63\x61\x72\x74\x49\144"] : ''; goto SeRR1; NhCi_: BnYqo: goto C0aPj; ny4Cy: $result = CartModel::update($cartData); goto fofJd; llOpD: goto x5mcZ; goto GAA4u; YOPRp: if (!($cart["\x6e\x75\x6d"] == 1 && $num < 1)) { goto WyNEO; } goto krt1J; C0aPj: x5mcZ: goto eyGgN; cZBx6: $cartData["\x69\144"] = $cartId; goto ny4Cy; hehSe: $data = input("\160\x6f\x73\164\x2e"); goto pWtpI; GAA4u: nY_no: goto YOPRp; ImalY: if ($cart) { goto nY_no; } goto GXvgA; SeRR1: if (!($num == '')) { goto zaaO7; } goto bMjj1; zvJp2: IvL7m: goto fcWY9; WJXwQ: if (!($cartData["\x6e\165\x6d"] > $product["\163\x74\157\143\153"])) { goto IvL7m; } goto SfYAa; Q3s7y: WyNEO: goto Rg1bo; H2gPS: IQJD5: goto Vi212; iUQ3G: return ["\x6d\163\x67" => "\xe8\257\267\xe9\200\211\346\213\251\xe5\225\x86\xe5\223\x81\xe8\247\x84\346\240\274", "\145\162\x72\157\x72\103\x6f\144\145" => 0]; goto lrxEW; HNkgh: return ["\155\163\x67" => "\xe5\225\206\345\223\x81\346\x95\260\351\207\217\350\xb6\205\xe8\277\x87\345\272\x93\345\xad\230", "\145\162\x72\157\162\103\x6f\x64\x65" => 0]; goto cCaea; C34_9: if (!($cartData["\x6e\165\x6d"] <= 0)) { goto TjfIw; } goto A_SZ4; uuxMd: $attrInfo = $productService->getAttrInfo($product["\151\x64"], $cart["\x61\x74\x74\x72\x5f\151\144\x5f\154\x69\x73\164"]); goto kshrt; fofJd: if ($result !== false) { goto OFHOa; } goto dlsl9; wBGyA: goto BnYqo; goto JjJod; kshrt: if (!($cartData["\156\165\x6d"] > $attrInfo["\x73\164\157\143\x6b"])) { goto Z58E2; } goto HNkgh; pWtpI: $num = isset($data["\156\x75\x6d"]) ? $data["\156\x75\155"] : ''; goto h0XD0; BUtoM: goto aU1TZ; goto SNCWD; Tj3Db: return ["\155\x73\147" => "\350\257\267\351\x80\211\xe6\x8b\251\350\xa6\201\344\xbf\xae\346\x94\271\xe7\x9a\x84\345\225\206\345\x93\x81", "\145\162\162\157\x72\103\x6f\144\x65" => 0]; goto bhrCU; Wz3TV: if ($product["\151\163\x5f\x61\x74\x74\162"] == 1) { goto ICOW7; } goto WJXwQ; cCaea: Z58E2: goto H2gPS; eyGgN: } public function getCart() { goto C7R2L; AvhmV: if ($setData) { goto LWfTC; } goto ikSq1; qWbey: wg6JJ: goto FI4gQ; QQwkp: return ["\x6d\163\x67" => "\xe8\216\267\xe5\217\226\xe6\210\x90\xe5\x8a\x9f", "\x64\x61\x74\x61" => $setData, "\145\162\x72\x6f\162\103\x6f\x64\x65" => 1]; goto cASqC; XI5r9: $total_price = []; goto vvrkB; k6OmQ: $setData["\x69\x6e\x66\x6f"] = $data; goto jK9T3; KAplA: goto JrLfK; goto LngVd; C7R2L: $uid = TokenService::getCurrentUid(); goto aL5j2; cASqC: JrLfK: goto xJPky; Reird: foreach ($data as $key => $value) { goto Uvnl0; Jd2MD: UOUDC: goto aMLXn; aMLXn: lfkSG: goto d7RVc; Oz194: $total_price[] = 0; goto OYYir; Uvnl0: $product = ProductModel::get($value["\160\162\157\144\165\x63\164\137\151\x64"]); goto tRZR9; xnKf3: idWx0: goto e0aGa; p3QSo: $data[$key]["\x61\164\x74\x72\x5f\x69\144\x5f\x6c\151\163\164"] = json_decode($value["\x61\x74\x74\162\x5f\x69\144\137\154\x69\x73\164"], true); goto Jd2MD; tRZR9: if (empty($product)) { goto UOUDC; } goto oWEA3; J53Of: wfJS4: goto p3QSo; F2vmH: if ($value["\x69\x73\x5f\x63\x68\x65\x63\153\x65\144"] == 1 && $data[$key]["\160\162\157\x64\x75\x63\x74"]["\143\x61\156\x5f\142\x75\x79"] == 1) { goto idWx0; } goto Oz194; OYYir: goto wfJS4; goto xnKf3; oWEA3: $data[$key]["\160\x72\x6f\144\165\x63\x74"] = ProductModel::getCartProduct($value["\151\x64"], $value["\160\x72\x6f\144\165\143\x74\x5f\x69\144"], json_encode($value["\x61\x74\x74\162\137\151\144\x5f\x6c\x69\x73\x74"], true)); goto F2vmH; e0aGa: $total_price[] = doubleval(sprintf("\45\x2e\x32\x66", $data[$key]["\x70\x72\157\x64\x75\x63\x74"]["\166\x69\x70\137\x70\162\x69\143\145"] * $value["\x6e\165\155"])); goto J53Of; d7RVc: } goto qWbey; aL5j2: $data = CartModel::getCartByUid($uid); goto XI5r9; jK9T3: $setData["\164\157\x74\x61\x6c\x5f\160\162\151\143\x65"] = array_sum($total_price); goto AvhmV; ikSq1: return ["\x6d\163\147" => "\346\x9a\202\xe6\227\240\xe6\x95\260\xe6\x8d\256", "\144\141\164\x61" => [], "\x65\162\162\157\x72\x43\157\x64\x65" => 0]; goto KAplA; LngVd: LWfTC: goto QQwkp; vvrkB: if (empty($data)) { goto mU6l0; } goto Reird; FI4gQ: mU6l0: goto k6OmQ; xJPky: } public function ProductAddCart() { goto LNyzg; yny_l: goto eiUsb; goto UKAfA; UKAfA: MhE7a: goto YDK15; joUDf: dKyad: goto KuYJw; RHgt7: goto Do82q; goto joUDf; OAjYK: u8_Bk: goto uO3tE; j9nuC: $productService = new ProductService(); goto d_QTf; UGD5D: $cart->num = $cart->num + intval($data["\156\165\155"]); goto EYWs_; t555e: $attr_id_list = isset($data["\141\164\164\162\137\x69\x64\137\154\x69\163\x74"]) ? json_encode($data["\141\164\164\x72\x5f\x69\144\137\154\x69\163\164"]) : ''; goto nMwNU; uX4Lp: if ($attr_id_list == '') { goto MhE7a; } goto tOcnd; UoGT3: eiUsb: goto pvlFd; pvlFd: $addData = ["\x6f\x70\x65\156\151\144" => $user["\x6f\160\x65\156\x69\x64"], "\x70\162\157\144\x75\143\164\111\x64" => $data["\160\162\x6f\x64\x75\x63\x74\x5f\151\144"], "\164\x69\164\x6c\x65" => $product["\156\141\x6d\145"], "\144\x65\163\x63" => $product["\x73\165\155\x6d\141\x72\x79"], "\164\150\165\x6d\142" => $product["\x74\x68\x75\155\x62"], "\160\162\x69\143\x65" => $product["\x70\162\151\x63\x65"], "\x6f\x5f\x70\162\x69\143\x65" => $product["\157\x5f\160\162\x69\x63\145"], "\143\141\162\164\111\x64" => $cartId, "\x61\x74\164\162" => $attr_list, "\141\x74\164\162\x5f\151\x64\x5f\154\151\x73\x74" => $attr_id_list]; goto m_57U; OKtgP: return ["\x6d\163\147" => "\xe5\x95\206\345\223\201\346\225\260\351\x87\x8f\350\266\205\350\xbf\207\345\272\223\xe5\xad\x98", "\145\162\162\157\x72\103\157\x64\145" => 0]; goto DPRKx; S9Mjh: LYPrW: goto J3J8U; nmYFF: bOQYR: goto uX4Lp; mAgP6: $cartModel = new CartModel(); goto tx4o8; amj2S: $cartData["\165\156\x69\141\143\151\144"] = session("\165\x6e\x69\141\x63\x69\x64"); goto LXo2L; SvPr6: RGKI6: goto VO8hR; KuYJw: if (!($attr_id_list == '')) { goto C8vEk; } goto J_bND; J3J8U: $attr_list = []; goto RHgt7; n0XUQ: $validate = \think\Loader::validate("\x43\x61\162\164"); goto gdYI9; kvIcc: return ["\155\163\x67" => "\346\267\xbb\345\212\xa0\346\210\220\345\212\237", "\145\x72\162\157\162\103\x6f\x64\x65" => 1]; goto SvPr6; nMwNU: $product = ProductModel::where("\165\x6e\x69\141\143\x69\x64", session("\x75\156\x69\x61\x63\151\x64"))->where(["\151\x64" => $data["\x70\x72\x6f\x64\165\x63\164\x5f\151\x64"], "\x73\164\x61\164\165\x73" => 1])->find(); goto u5py3; H41zg: if ($cart) { goto rhLaN; } goto amj2S; fJ15C: return ["\155\x73\x67" => "\345\225\206\xe5\223\x81\xe5\267\262\xe4\270\213\xe6\x9e\266", "\x65\162\162\157\x72\103\157\x64\x65" => 0]; goto E3fz0; LNyzg: $data = input("\160\157\x73\164\x2e"); goto n0XUQ; AO8Ew: if ($cartId) { goto bOQYR; } goto LNJZd; tqwAn: goto RGKI6; goto nmYFF; gdYI9: $result = $validate->scene("\141\144\x64")->check($data); goto WV7SW; yRAFq: $attr_id_list = ''; goto GLTZs; TyDnW: if (!($data["\156\x75\x6d"] > $attrInfo["\163\x74\x6f\143\x6b"])) { goto c90BW; } goto OKtgP; uO3tE: $uid = TokenService::getCurrentUid(); goto PXmpQ; NHPHw: $attr_id_list = implode("\54", $attr_id_list); goto yny_l; tH55e: Do82q: goto fFqL8; tF5m0: y1eDt: goto aiQK3; VO8hR: alpFT: goto SJKQh; DPRKx: c90BW: goto M8Kxd; M8Kxd: $attr_list = $productService->getAttrList($attr_id_list); goto tH55e; aiQK3: if ($product["\x69\163\137\141\164\x74\162"] == 1) { goto dKyad; } goto yRAFq; YDK15: $attr_id_list = $product["\151\144"]; goto UoGT3; J_bND: return ["\x6d\x73\147" => "\xe8\257\267\351\x80\211\346\x8b\xa9\345\x95\x86\xe5\223\201\350\247\204\xe6\xa0\274", "\145\162\162\157\x72\103\157\x64\145" => 0]; goto dNrFb; gQTyP: $cartData["\143\x72\x65\x61\164\145\137\x74\151\155\x65"] = time(); goto mAgP6; dNrFb: C8vEk: goto j9nuC; mlE1J: return ["\x6d\x73\147" => "\345\x95\x86\345\x93\201\xe6\x95\xb0\xe9\x87\x8f\xe8\xb6\x85\xe8\xbf\207\345\xba\223\xe5\xad\230", "\x65\x72\x72\x6f\x72\x43\157\144\145" => 0]; goto S9Mjh; LXo2L: $cartData["\x75\x73\145\x72\x5f\151\144"] = $uid; goto eyQpE; u5py3: if ($product) { goto y1eDt; } goto fJ15C; PXmpQ: $user = UserModel::get($uid); goto t555e; M5iqY: $cartData["\141\164\x74\x72\x5f\x69\144\137\154\151\163\164"] = $attr_id_list; goto gQTyP; fFqL8: $uid = TokenService::getCurrentUid(); goto PSA61; E3fz0: goto alpFT; goto tF5m0; A5Vfp: rhLaN: goto UGD5D; tx4o8: $cartId = $cartModel->insertGetId($cartData); goto YGQta; EYWs_: $cart->save(); goto BgTe3; d_QTf: $attr_id_list = str_replace("\42", '', $attr_id_list); goto jYbBN; jYbBN: $attrInfo = $productService->getAttrInfo($product["\x69\x64"], $attr_id_list); goto TyDnW; eyQpE: $cartData["\160\x72\x6f\144\165\143\164\x5f\x69\144"] = $data["\160\162\x6f\x64\165\x63\164\137\151\144"]; goto HoNbH; GLTZs: if (!($data["\x6e\165\155"] > $product["\163\x74\x6f\x63\153"])) { goto LYPrW; } goto mlE1J; fxTWd: n2JJu: goto AO8Ew; PSA61: $cart = CartModel::where("\x75\156\151\141\143\151\144", session("\165\x6e\x69\x61\143\x69\x64"))->where(["\x75\163\145\x72\137\x69\144" => $uid, "\160\x72\157\x64\x75\x63\x74\x5f\x69\144" => $data["\160\x72\157\144\165\143\164\137\x69\x64"], "\x61\x74\x74\x72\137\x69\144\137\x6c\151\x73\164" => $attr_id_list, "\x69\x73\x5f\144\x65\x6c\x65\x74\x65" => 0])->find(); goto H41zg; m_57U: WechatService::addCartList($addData); goto kvIcc; MSeLh: return ["\x6d\163\147" => $validate->getError(), "\x65\x72\162\157\x72\103\x6f\144\145" => 0]; goto OAjYK; tOcnd: $attr_id_list = json_decode($attr_id_list, true); goto NHPHw; LNJZd: return ["\155\x73\147" => "\xe6\xb7\xbb\345\x8a\240\xe5\244\xb1\xe8\xb4\xa5", "\x65\x72\x72\x6f\x72\103\157\x64\x65" => 0]; goto tqwAn; BgTe3: $cartId = $cart["\151\x64"]; goto fxTWd; WV7SW: if ($result) { goto u8_Bk; } goto MSeLh; YGQta: goto n2JJu; goto A5Vfp; HoNbH: $cartData["\156\165\155"] = $data["\x6e\165\x6d"]; goto M5iqY; SJKQh: } }