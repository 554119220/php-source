<?php
 namespace app\api\controller\v1; use app\api\controller\BaseController; use app\api\model\Comment as CommentModel; use app\api\service\Token as TokenService; use app\api\model\Product as ProductModel; use app\api\service\Order as OrderService; use app\api\model\User as UserModel; class Comment extends BaseController { public function commentList($page = 1, $size = 12) { goto fJpzT; PbSUW: $comment = CommentModel::with("\165\163\145\x72")->where(["\165\156\151\x61\143\x69\144" => session("\165\156\x69\141\x63\x69\x64"), "\160\x72\x6f\x64\x75\143\x74\x5f\x69\x64" => $productId, "\x73\164\x61\x74\x75\x73" => 1])->order("\x63\x72\145\x61\x74\145\x5f\x74\151\155\145", "\144\x65\x73\143")->paginate($size, true, ["\x70\x61\147\145" => $page]); goto WIaJu; rQabO: return ["\155\x73\147" => "\346\232\202\xe6\x97\xa0\xe8\xaf\204\344\273\xb7", "\x65\x72\162\x6f\x72\x43\157\x64\x65" => 0]; goto TiUFn; cOTbi: oYnXd: goto O8rDA; FR41m: return ["\x6d\x73\147" => "\xe8\xaf\xb7\xe6\214\207\345\xae\232\xe5\225\x86\345\223\201", "\145\x72\x72\x6f\x72\x43\157\x64\x65" => 0]; goto J8VJB; J8VJB: aVdrl: goto PbSUW; WIaJu: if (!$comment->isEmpty()) { goto Rhyy0; } goto rQabO; fJpzT: $productId = input("\160\x6f\163\x74\x2e\x70\162\x6f\x64\x75\143\164\x49\x64"); goto RNAKp; ZaU5V: foreach ($comment as $key => $value) { goto oqI89; PFrTZ: fnLBL: goto b3WJE; Jjz96: unset($value["\x61\166\141\x74\141\162"]); goto x0G3P; x0G3P: unset($value["\156\151\143\153\156\141\x6d\145"]); goto PFrTZ; hpCsP: q9iVa: goto Jjz96; oqI89: if ($value["\165\x73\x65\x72\x5f\x69\x64"]) { goto q9iVa; } goto ckkdg; ckkdg: $value["\x75\x73\145\x72"] = ["\x61\166\141\164\141\162" => $value["\141\x76\x61\x74\x61\162"], "\156\x69\143\x6b\156\141\x6d\x65" => $value["\x6e\151\143\x6b\x6e\x61\x6d\145"]]; goto hpCsP; b3WJE: } goto cOTbi; O8rDA: return $comment; goto AOkPe; TiUFn: Rhyy0: goto ZaU5V; RNAKp: if (!($productId == 0 || $productId == '')) { goto aVdrl; } goto FR41m; AOkPe: } public function commentSubmit() { goto C4oDR; KLCb1: $validate = \think\Loader::validate("\103\x6f\x6d\x6d\x65\x6e\164"); goto XjxAo; wIJhe: return ["\155\x73\147" => $validate->getError(), "\x65\x72\162\157\x72\x43\157\144\x65" => 0]; goto P4Uty; apnGK: if (is_array($data["\141\164\x74\162\137\x69\x64\137\x6c\x69\163\164"])) { goto s67aT; } goto IEUhX; UqFMh: L7TFR: goto d6rq1; P4Uty: Avp8e: goto sbE2u; ZMTRR: $product = ProductModel::get($data["\160\162\x6f\x64\165\143\164\x49\x64"]); goto Ndrzg; Ndrzg: if ($product["\151\163\137\x61\164\x74\x72"] == 1) { goto Lm3fY; } goto iBwGA; WM1AL: if ($data["\x73\143\x6f\x72\145"] > 5) { goto opT0F; } goto ahZ6g; NHsPv: wR5kT: goto xFlR3; fZAT7: $attr_id_list = str_replace("\x22", '', $attr_id_list); goto yJlLJ; QIyq1: opT0F: goto gVh44; JOz59: $attr_id_list = json_encode($data["\x61\164\x74\x72\137\151\144\137\x6c\x69\x73\164"]); goto fZAT7; zZlh9: goto J0To5; goto E5Ev1; xSlpW: $post = ["\165\x6e\x69\x61\x63\x69\x64" => session("\165\x6e\x69\x61\x63\151\x64"), "\x75\x73\x65\x72\x5f\x69\x64" => $uid, "\x6f\162\144\145\162\x5f\x69\x64" => $data["\x6f\x72\144\x65\x72\111\x64"], "\160\x72\157\x64\x75\143\164\x5f\x69\x64" => $data["\x70\162\x6f\x64\165\x63\164\x49\x64"], "\x61\164\x74\x72\137\151\x64\137\154\151\x73\164" => $attr_id_list, "\x63\157\156\x74\x65\156\x74" => $data["\143\157\156\164\145\x6e\x74"], "\x73\143\x6f\162\145" => $data["\x73\x63\x6f\x72\145"], "\x69\x6d\141\147\x65" => json_encode($data["\x69\x6d\141\x67\145"], true)]; goto Vn1ut; gHfag: $orderService = new OrderService(); goto D4aM7; dY7rO: if (isset($data["\141\164\164\162\137\x69\144\x5f\x6c\x69\x73\164"])) { goto d12h3; } goto j47Tn; C4oDR: $data = input("\x70\157\x73\x74\x2e"); goto KLCb1; Vn1ut: $res = CommentModel::create($post); goto YMyL2; YMyL2: if ($res) { goto AiXG3; } goto moliw; DPLSF: return ["\x6d\163\147" => "\xe8\xaf\204\344\xbb\267\xe6\210\x90\345\x8a\237", "\145\162\162\157\162\103\157\x64\x65" => 1]; goto UqFMh; xFlR3: J0To5: goto MSQMm; j47Tn: return ["\x6d\x73\x67" => "\350\247\204\346\xa0\274\151\x64\xe4\xb8\x8d\350\x83\xbd\347\251\272", "\x65\162\x72\x6f\x72\x43\157\144\145" => 0]; goto vx303; XjxAo: $result = $validate->check($data); goto YpfrQ; ahZ6g: goto PJIVR; goto ocPon; iBwGA: $attr_id_list = ''; goto zZlh9; YpfrQ: if ($result) { goto Avp8e; } goto wIJhe; j1pL_: goto tQPgp; goto jYIQ4; yJlLJ: tQPgp: goto NHsPv; CzElK: d12h3: goto apnGK; sbE2u: if ($data["\163\143\157\x72\x65"] <= 0) { goto z1REV; } goto WM1AL; EKxAf: AiXG3: goto gHfag; jYIQ4: s67aT: goto JOz59; rAGLw: PJIVR: goto ZMTRR; IEUhX: return ["\x6d\x73\x67" => "\350\xa7\204\xe6\xa0\274\151\144\xe9\x9c\200\344\270\xba\346\225\260\xe7\273\x84", "\x65\162\x72\157\x72\x43\x6f\144\145" => 0]; goto j1pL_; l1Lg3: goto PJIVR; goto QIyq1; ocPon: z1REV: goto nnTmK; tLzpc: goto L7TFR; goto EKxAf; nnTmK: return ["\155\x73\147" => "\xe8\xaf\267\xe9\x80\x89\346\x8b\251\xe8\xaf\x84\344\xbb\xb7\xe7\255\211\xe7\272\247", "\x65\162\162\x6f\x72\103\x6f\x64\x65" => 0]; goto l1Lg3; moliw: return ["\x6d\163\147" => "\xe7\xbd\221\xe7\273\234\345\xbc\202\345\270\270\xef\274\x8c\xe8\xaf\267\xe7\250\215\345\200\x99\xe5\206\x8d\350\257\225", "\x65\x72\x72\x6f\x72\x43\x6f\144\x65" => 0]; goto tLzpc; gVh44: return ["\x6d\163\x67" => "\350\xaf\204\xe4\xbb\xb7\xe7\xad\x89\347\272\xa7\xe9\224\x99\xe8\257\xaf\xef\xbc\x8c\xe8\257\267\351\x87\215\346\x96\xb0\xe9\x80\211\346\213\xa9", "\145\x72\162\x6f\162\103\x6f\x64\145" => 0]; goto rAGLw; MSQMm: $uid = TokenService::getCurrentUid(); goto xSlpW; vx303: goto wR5kT; goto CzElK; E5Ev1: Lm3fY: goto dY7rO; D4aM7: $orderService->updateSnapInfoCommentStatus($data["\x6f\x72\x64\145\x72\111\x64"], $data["\x70\162\x6f\x64\165\x63\164\111\144"], $attr_id_list); goto DPLSF; d6rq1: } }