<?php
 namespace app\api\controller\v1; use app\api\controller\BaseController; use app\api\model\Category as CategoryModel; use app\api\model\Product as ProductModel; use app\api\model\PlatformSettings; use app\api\service\Product as ProductService; use app\api\service\Order as OrderService; class Category extends BaseController { public function getCategoryChild($page = 0, $size = 15) { goto ADuzW; wSfIV: return ["\155\x73\x67" => "\xe8\x8e\267\345\217\x96\xe5\244\xb1\xe8\xb4\245", "\144\141\x74\x61" => [], "\145\162\x72\157\x72\x43\x6f\144\145" => 0]; goto Kb9L4; EK8Vc: return ["\155\x73\x67" => "\xe6\x9c\xaa\xe6\214\x87\xe5\256\x9a\345\210\x86\xe7\xb1\xbb\151\x64", "\x65\x72\162\157\x72\103\157\x64\x65" => 0]; goto MdDit; G4M2W: goto TCZAW; goto DgvkB; Kb9L4: TCZAW: goto LOYEQ; HpyMM: if (!(!isset($data["\x63\141\x74\145\x49\144"]) || $data["\143\141\164\145\x49\144"] == 0 || $data["\x63\x61\x74\x65\x49\144"] == '')) { goto LqM9u; } goto EK8Vc; xqVJ7: if ($category->isEmpty()) { goto qDS3N; } goto InNne; DgvkB: qDS3N: goto wSfIV; AE3fI: $where = "\x70\141\x72\x65\x6e\164\137\x69\144\x20\151\156\x28{$cateIds}\x29\x20\141\156\144\x20\163\x74\141\164\165\x73\x20\75\40\x31"; goto amAgT; ADuzW: $data = input("\x67\x65\164\x2e"); goto HpyMM; InNne: return $category->toArray(); goto G4M2W; vA24C: $cateIds = getChildCate($data["\143\x61\164\145\111\x64"]); goto AE3fI; MdDit: LqM9u: goto vA24C; amAgT: $category = CategoryModel::where("\165\156\x69\x61\143\151\144", session("\x75\x6e\x69\141\143\x69\x64"))->where($where)->paginate($size, true, ["\x70\x61\x67\x65" => $page]); goto xqVJ7; LOYEQ: } public function getCategoryAll($cateId = 0, $page = 0, $size = 12) { goto tUMDA; BE6tN: plzgJ: goto kG5Fa; vqjFS: vPUWr: goto iKRbx; Y2caM: $cate = CategoryModel::getCategoryThirdByParentId(0); goto BE6tN; ZcbG4: if ($setting["\143\x61\x74\145\137\164\171\160\x65"] == "\65") { goto IzBg6; } goto KCXaW; wB0Lb: pXQil: goto D_LK5; YdYyW: eWnfu: goto X5yoq; lLqRO: $cateChildIds = ''; goto KXmBC; EJPBe: RDHmG: goto f3Q__; czZWt: $cate = CategoryModel::getCategoriesByParentId(0); goto Bwg5C; lgZKP: $cate = $product = []; goto go7zj; t7nmh: return ["\155\163\x67" => "\346\x9c\xaa\350\xae\276\347\xbd\256\345\210\206\347\261\273\xe6\xa0\267\345\xbc\x8f", "\x65\162\162\x6f\x72\103\157\x64\x65" => 0]; goto rrRq2; kG5Fa: if (empty($cate)) { goto pXQil; } goto pT8ON; iKRbx: goto plzgJ; goto dn8em; ynWMX: $product = ProductModel::where(["\165\x6e\151\141\x63\x69\144" => session("\165\x6e\x69\141\143\151\x64"), "\163\164\x61\164\165\163" => 1, "\151\163\x5f\144\145\154\145\x74\x65" => 0])->where($where)->field("\x69\x64\54\156\141\x6d\x65\54\x74\150\x75\155\x62\x2c\x73\165\155\x6d\141\162\171\x2c\x70\162\151\143\145\x2c\157\137\x70\162\x69\x63\x65\54\166\151\160\x5f\160\162\151\143\x65\54\x69\x73\x5f\141\x74\x74\x72\x2c\x73\164\x6f\143\153\54\x74\157\164\141\154\137\163\x74\157\143\153\54\x6c\151\x6d\151\164\137\156\165\x6d\x2c\151\163\137\154\x69\x6d\x69\x74")->order("\x73\x6f\162\164", "\x64\145\163\143")->paginate($size, true, ["\x71\165\x65\x72\x79" => $page]); goto PY23d; FJZCN: goto plzgJ; goto QTayk; fUQdR: $where = "\143\x61\164\x65\137\x69\144\x20\x69\156\x28" . $cateId . $cateChildIds . "\x29"; goto ynWMX; qncoQ: goto plzgJ; goto WX02t; QjrYJ: $childIds = getChildCate($cateId); goto yWUVx; Kxmqg: acp07: goto IgD5L; X5yoq: $cate = CategoryModel::getCategoryChildByParentId(0); goto FJZCN; BK2gJ: $cateChildIds = "\x2c" . $childIds; goto WVBnY; bq4vG: $setting = PlatformSettings::where("\165\156\151\x61\143\x69\144", session("\x75\x6e\151\141\x63\151\x64"))->find(); goto hY5YW; yWUVx: if ($childIds) { goto KmUXN; } goto lLqRO; Bwg5C: if (!($cateId != 0 || $cateId != '')) { goto vPUWr; } goto QjrYJ; PY23d: foreach ($product as $k => $v) { goto iTrZ_; FPHpY: $product[$k]["\142\x75\x79\137\x6c\x69\x6d\x69\164\x5f\156\x75\x6d"] = $orderService->sumUserOrderProduct($v["\x69\x64"]); goto kIsXt; LIXSO: $product[$k]["\141\164\164\162"] = $productService->getAttrGroupList($v["\151\144"]); goto FPHpY; kIsXt: SSUWM: goto POIXz; iTrZ_: $product[$k]["\x76\x69\x70\x5f\x70\162\151\x63\145"] = $productService->getProductVipPrice($v["\x69\144"], $v["\x70\x72\x69\x63\145"], $v["\x69\163\x5f\x61\x74\x74\x72"]); goto LIXSO; POIXz: } goto KG65x; MbqDy: $orderService = new OrderService(); goto bq4vG; pT8ON: return ["\155\163\147" => "\xe8\216\xb7\345\217\x96\xe6\x88\220\345\212\237", "\164\171\x70\145" => $setting["\x63\x61\x74\145\x5f\164\x79\x70\145"], "\144\141\164\141" => $cate, "\x70\162\x6f\x64\x75\x63\x74" => $product, "\145\162\162\157\x72\103\x6f\144\145" => 1]; goto Agoir; d4hOM: KmUXN: goto BK2gJ; rrRq2: v0alJ: goto lgZKP; QTayk: P3nU7: goto czZWt; tUMDA: $productService = new ProductService(); goto MbqDy; D_LK5: return ["\155\163\x67" => "\346\232\x82\346\x97\240\xe6\x95\260\xe6\215\256", "\x64\x61\x74\141" => [], "\x65\162\162\x6f\x72\103\x6f\144\x65" => 0]; goto EJPBe; n9srk: if ($setting["\143\141\x74\x65\x5f\x74\171\160\x65"] == "\63") { goto eWnfu; } goto vs25C; KGEaI: goto plzgJ; goto YdYyW; WVBnY: PVyeO: goto fUQdR; dn8em: IzBg6: goto Y2caM; vs25C: if ($setting["\x63\x61\x74\145\x5f\x74\171\x70\145"] == "\x34") { goto P3nU7; } goto ZcbG4; hY5YW: if (!($setting["\143\x61\164\x65\137\164\171\160\145"] == null || $setting["\143\x61\x74\145\x5f\164\x79\160\x65"] == 0)) { goto v0alJ; } goto t7nmh; go7zj: if ($setting["\143\x61\164\145\137\x74\171\x70\x65"] == "\61") { goto acp07; } goto nm15E; nm15E: if ($setting["\x63\141\x74\145\x5f\x74\x79\160\x65"] == "\x32") { goto gvDcW; } goto n9srk; IgD5L: $cate = CategoryModel::getCategoriesByParentId(0); goto qncoQ; Agoir: goto RDHmG; goto wB0Lb; WX02t: gvDcW: goto BL6Fr; KCXaW: goto plzgJ; goto Kxmqg; KXmBC: goto PVyeO; goto d4hOM; KG65x: Q_hsX: goto vqjFS; BL6Fr: $cate = CategoryModel::getCategoryChildByParentId(0); goto KGEaI; f3Q__: } public function getProductByCategoryHot($cateId = 0) { goto mIFQn; D_CNt: $categories = ProductModel::getProductsByCategoryHot($parentId, 0, 10); goto DxfGk; mIFQn: if (!($cateId == '' || $cateId == 0)) { goto fwfzV; } goto uceis; DxfGk: if ($categories->isEmpty()) { goto gbPYE; } goto NArQZ; NArQZ: return ["\x6d\163\147" => "\350\216\267\345\217\x96\346\210\220\345\x8a\x9f", "\x64\x61\x74\141" => $categories, "\145\x72\x72\157\162\103\x6f\144\145" => 1]; goto S7LPi; A9BGW: return ["\155\x73\x67" => "\xe8\216\xb7\xe5\217\226\345\244\261\xe8\264\xa5", "\144\x61\164\141" => [], "\x65\162\x72\x6f\162\103\x6f\144\145" => 0]; goto ZcrCi; TZy9D: $parentId = getChildCate($cateId); goto D_CNt; S7LPi: goto tstwb; goto yhmq6; UhmRW: fwfzV: goto TZy9D; yhmq6: gbPYE: goto A9BGW; uceis: return ["\155\163\147" => "\350\257\xb7\351\x80\211\346\x8b\251\345\210\x86\347\261\273", "\x65\162\x72\157\162\x43\157\144\145" => 0]; goto UhmRW; ZcrCi: tstwb: goto eiqBh; eiqBh: } public function getCategoryHot() { goto dd1vi; TMVfZ: if ($categories->isEmpty()) { goto N9H0r; } goto ADA2I; kysV2: NTmfp: goto pjg2H; x8UXE: N9H0r: goto sAyZ2; ADA2I: return ["\x6d\x73\x67" => "\xe8\x8e\267\xe5\x8f\x96\346\x88\220\xe5\212\237", "\x64\141\x74\x61" => $categories, "\x65\162\x72\x6f\x72\103\157\x64\x65" => 1]; goto bmiHk; sAyZ2: return ["\155\x73\147" => "\350\x8e\267\345\217\x96\345\244\xb1\xe8\xb4\245", "\x64\141\x74\141" => [], "\145\162\x72\157\162\103\x6f\x64\x65" => 0]; goto kysV2; dd1vi: $categories = CategoryModel::getCategoriesHot(); goto TMVfZ; bmiHk: goto NTmfp; goto x8UXE; pjg2H: } }