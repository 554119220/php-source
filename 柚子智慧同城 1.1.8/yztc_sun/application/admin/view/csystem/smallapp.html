{extend name="common/edit2" /}
{block name="content"}
<div class="layui-form-item">
    <label class="layui-form-label">小程序appid</label>
    <div class="layui-input-block">
        <input autocomplete="off" type="text" name="appid" lay-verify="required" placeholder="请输入小程序appid" class="layui-input" value="{$info.appid??''}">
    </div>
</div>
<div class="layui-form-item">
    <label class="layui-form-label">小程序appsecret</label>
    <div class="layui-input-block">
        <input autocomplete="off" type="text" name="appsecret" lay-verify="required" placeholder="请输入appsecret" class="layui-input" value="{$info.appsecret??''}">
    </div>
</div>
<div class="layui-form-item">
    <label class="layui-form-label">商户号</label>
    <div class="layui-input-block">
        <input autocomplete="off" type="text" name="mchid" lay-verify="required" placeholder="请输入mchid" class="layui-input" value="{$info.mchid??''}">
    </div>
</div>
<div class="layui-form-item">
    <label class="layui-form-label">商户号密钥</label>
    <div class="layui-input-block">
        <input autocomplete="off" type="text" name="wxkey" lay-verify="required" placeholder="请输入wxkey" class="layui-input" value="{$info.wxkey??''}">
        <div class="layui-form-mid layui-word-aux">*请输入微信支付商户后台32位API密钥</div>
    </div>
</div>
<div class="layui-form-item">
    <label class="layui-form-label">apiclient_cert.pem</label>
    <div class="layui-input-block">
        <button type="button" class="layui-btn layui-btn-normal" id="apiclient_cert_btn"><i class="layui-icon"></i><span>{$info.apiclient_cert?"重新上传":'上传文件';}</span></button>
        <input type="hidden" name="apiclient_cert" value="{$info.apiclient_cert??''}">
    </div>
</div>
<div class="layui-form-item">
    <label class="layui-form-label">apiclient_key.pem</label>
    <div class="layui-input-block">
        <button type="button" class="layui-btn layui-btn-normal" id="apiclient_key_btn"><i class="layui-icon"></i><span>{$info.apiclient_key?"重新上传":'上传文件';}</span></button>
        <input type="hidden" name="apiclient_key" value="{$info.apiclient_key??''}">
    </div>
</div>


<div class="layui-form-item">
    <label class="layui-form-label">过审开关</label>
    <div class="layui-input-block">
        <input type="radio" name="showcheck" value="1" title="开启" {php} if($info['showcheck']==1) echo "checked";{/php}>
        <input type="radio" name="showcheck" value="0" title="关闭" {php} if($info['showcheck']==0) echo "checked";{/php}>
    </div>
    <div class="layui-form-mid layui-word-aux">*提交小程序前端微信审核的时候打开</div>
</div>

<div class="layui-form-item">
    <label class="layui-form-label">过审小程序版本号</label>
    <div class="layui-input-block">
        <input autocomplete="off" type="text" name="version" lay-verify="required" placeholder="请输入版本号" class="layui-input" value="{$info.version??''}">
    </div>
</div>

<div class="layui-form-item">
    <label class="layui-form-label">首页菜单显示</label>
    <div class="layui-input-block">
        <input type="radio" name="show_type" value="1" title="功能" {php} if($info['show_type']==1) echo "checked";{/php}>
        <input type="radio" name="show_type" value="2" title="圈子" {php} if($info['show_type']==2) echo "checked";{/php}>
        <input type="radio" name="show_type" value="3" title="商家" {php} if($info['show_type']==3) echo "checked";{/php}>
    </div>
</div>

<div class="layui-form-item">
    <label class="layui-form-label">首页天气图标</label>
    <div class="layui-input-block">
        {php}echo tpl_form_field_image('weather_icon', isset($info['weather_icon'])?$info['weather_icon']:'','/web/resource/images/nopic.jpg');{/php}
        <div class="layui-form-mid layui-word-aux">建议尺寸：40*40</div>
    </div>
</div>

<div class="layui-form-item">
    <label class="layui-form-label">我的页面顶部背景图</label>
    <div class="layui-input-block">
        {php}echo tpl_form_field_image('mine_bg', isset($info['mine_bg'])?$info['mine_bg']:'','/web/resource/images/nopic.jpg');{/php}
        <div class="layui-form-mid layui-word-aux">建议尺寸：750 * 410</div>
    </div>
</div>


<div class="layui-form-item">
    <label class="layui-form-label">腾讯地图key</label>
    <div class="layui-input-block">
        <input autocomplete="off" type="text" name="map_key" placeholder="请输入地图key" class="layui-input" value="{$info.map_key??''}">
        <div class="layui-form-mid layui-word-aux">申请地址：<a href=" ">https://lbs.qq.com/console/key.html</a></div>
        <div style="clear: both;color: #FF5722;">
            <p>1、申请开发者密钥</p>
            <p>2、启用产品，选择WebServiceAPI</p>
            <p>3、设置安全域名，在"微信公众平台|小程序"->"设置"->"开发设置"->"服务器域名"中设置request合法域名添加https://apis.map.qq.com</p>
        </div>
    </div>
</div>

<div class="layui-form-item">
    <label class="layui-form-label">百度开放平台key(获取当前天气使用)</label>
    <div class="layui-input-block">
        <input autocomplete="off" type="text" name="ak" placeholder="请输入key" class="layui-input" value="{$info.ak??''}">
        <div class="layui-form-mid layui-word-aux">申请地址：<a href=" ">http://lbsyun.baidu.com/</a></div>
        <div style="clear: both;color: #FF5722;">
            <p>1、申请成为开发者</p>
            <p>2、创建应用，选择微信小程序(请填写对应小程序appid否则不生效)</p>
            <p>3、设置安全域名，在"微信公众平台|小程序"->"设置"->"开发设置"->"服务器域名"中设置request合法域名添加https://api.map.baidu.com</p>
        </div>
    </div>
</div>


<script>
    layui.use('upload', function() {
        var upload = layui.upload;
        //指定允许上传的文件类型
        upload.render({
            elem: '#apiclient_cert_btn'
            ,url: '{:adminurl("upload")}'
            ,accept: 'file' //普通文件
            ,done: function(res){
                if (typeof res == "string"){
                    res = JSON.parse($res);
                }
                layer.msg('上传成功',{icon: 6,anim: 6});
                $('input[name=apiclient_cert]').val(res.data.src);
                $('#apiclient_cert_btn span').html('重新上传');
            }
        });
        upload.render({
            elem: '#apiclient_key_btn'
            ,url: '{:adminurl("upload")}'
            ,accept: 'file' //普通文件
            ,done: function(res){
                if (typeof res == "string"){
                    res = JSON.parse($res);
                }
                layer.msg('上传成功',{icon: 6,anim: 6});
                $('input[name=apiclient_key]').val(res.data.src);
                $('#apiclient_key_btn span').html('重新上传');
            }
        });
    });
</script>
{/block}