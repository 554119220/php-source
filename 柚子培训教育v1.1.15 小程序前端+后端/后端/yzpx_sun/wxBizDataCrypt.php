<?php
 goto PwXuN; PwXuN: include_once "\x70\x6b\143\x73\67\x45\156\x63\x6f\144\145\162\x2e\160\150\x70"; goto IbY9C; IbY9C: include_once "\x65\162\162\157\x72\103\157\144\145\56\160\150\x70"; goto luV53; luV53: class WXBizDataCrypt { private $appid; private $sessionKey; public function WXBizDataCrypt($appid, $sessionKey) { $this->sessionKey = $sessionKey; $this->appid = $appid; } public function decryptData($encryptedData, $iv, &$data) { goto bWM0_; dEoeM: vFgCa: goto lotU8; bWM0_: if (!(strlen($this->sessionKey) != 24)) { goto IdjlT; } goto wM3Wh; wZIpM: return ErrorCode::$IllegalBuffer; goto leS_S; kRfGo: if (!($result[0] != 0)) { goto PUnZO; } goto Z_qP2; Z_qP2: return $result[0]; goto WXRIL; wM3Wh: return ErrorCode::$IllegalAesKey; goto c5kpF; UCowr: $aesCipher = base64_decode($encryptedData); goto lSXWu; leS_S: fKqVi: goto PWlk4; lotU8: if (!($dataObj->watermark->appid != $this->appid)) { goto fKqVi; } goto wZIpM; XVVMa: $dataObj = json_decode($result[1]); goto k7eT7; KLbhe: Dzn68: goto UmGIs; SxFJM: if (!(strlen($iv) != 24)) { goto Dzn68; } goto fR7jj; eA1UI: $aesKey = base64_decode($this->sessionKey); goto SxFJM; PWlk4: $data = $result[1]; goto tvC7I; fR7jj: return ErrorCode::$IllegalIv; goto KLbhe; c5kpF: IdjlT: goto eA1UI; lSXWu: $pc = new Prpcrypt($aesKey); goto UAs0J; WXRIL: PUnZO: goto XVVMa; b20RW: return ErrorCode::$IllegalBuffer; goto dEoeM; tvC7I: return ErrorCode::$OK; goto eETpk; k7eT7: if (!($dataObj == NULL)) { goto vFgCa; } goto b20RW; UAs0J: $result = $pc->decrypt($aesCipher, $aesIV); goto kRfGo; UmGIs: $aesIV = base64_decode($iv); goto UCowr; eETpk: } }