<!DOCTYPE html>
<html lang="en">
<head>
    {template 'common/edithead'}
    <!--微擎 -->
    <!--这个放在最后一切平白安全-->
    <script src="https://cdn.staticfile.org/bootstrap-slider/10.0.2/bootstrap-slider.min.js"></script>
    <link href="https://cdn.staticfile.org/bootstrap-slider/10.0.2/css/bootstrap-slider.min.css" rel="stylesheet">
    <link href="https://cdn.staticfile.org/Swiper/4.3.0/css/swiper.min.css" rel="stylesheet">
    <script src="https://cdn.staticfile.org/Swiper/4.3.0/js/swiper.min.js"></script>
    <script src="https://cdn.staticfile.org/vue/2.5.17-beta.0/vue.min.js"></script>
    <script src="https://cdn.staticfile.org/Sortable/1.6.0/Sortable.min.js"></script>
    <script src="https://cdn.staticfile.org/Vue.Draggable/15.0.0/vuedraggable.min.js"></script>
    <link href="https://cdn.staticfile.org/bootstrap-colorpicker/2.5.1/css/bootstrap-colorpicker.min.css" rel="stylesheet">
    <link href="../addons/xc_xinguwu/resource/diy/style.css?p=8" rel="stylesheet">
    <script src="https://cdn.staticfile.org/bootstrap-colorpicker/2.5.2/js/bootstrap-colorpicker.min.js"></script>
    <script src="https://cdn.staticfile.org/blueimp-JavaScript-Templates/3.11.0/js/tmpl.min.js"></script>
    <script type="text/javascript" src="./resource/js/require.js?v=20170915"></script>
    <script type="text/javascript">
        //编辑器里使用
        var urobj = [];
    </script>
</head>
<body class="nav-md" style="min-width: 800px; ">

<form class="form-horizontal form-label-left input_mask" method="post" action="{php echo $this->createWebUrl($do, array('op'=>'save','keyval'=>$keyval));}" id="xc_form">

</form>
{template 'mymanage/diypage/subpage/diy_template'}
<div class="container xc_edit_from">
    <div class="main_container xc_diy_page"
         style="overflow-x: hidden;min-height: 100vh;background-color: white;width: 100%;">
        <div class="all">
            <!--左边部分-->
            <div class="left-menu">
                <div class="method">
                    <div class="xheader">
                        <div class="xhead select" style="cursor:pointer;">
                            <i class="fa fa-id-card-o" aria-hidden="true"></i>
                            <div>组件库</div>
                            <span class="triangle triangleShow"></span>
                        </div>
                        <div class="xhead" style="cursor:pointer;">
                            <i class="fa fa-id-card-o" aria-hidden="true"></i>
                            <div>组合</div>
                            <span class="triangle"></span>
                        </div>
                    </div>
                    <div>
                        <div class="list" style="display: block">
                            <div class="all-child">
                                <div class="child" data-value="xc_diy_text">
                                    <a> <i class="fa fa-id-card-o" aria-hidden="true"></i>
                                        <div>文本</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>
                                <div class="child" data-value="diy_notice">
                                    <a> <i class="fa fa-id-card-o" aria-hidden="true"></i>
                                        <div>公告</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>
                                <div class="child" data-value="diy_img_num_col">
                                    <a> <i class="fa fa-id-card-o" aria-hidden="true"></i>
                                        <div>图片</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>
                                <div class="child" data-value="diy_img_num_mofu">
                                    <a> <i class="fa fa-id-card-o" aria-hidden="true"></i>
                                        <div>魔方</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>
                                <div class="child" data-value="diy_bananer">
                                    <a> <i class="fa fa-id-card-o" aria-hidden="true"></i>
                                        <div>轮播图</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>

                                <div class="child" data-value="diy_video">
                                    <a> <i class="fa fa-id-card-o" aria-hidden="true"></i>
                                        <div>视频</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>
                                <div class="child" data-value="diy_audio">
                                    <a> <i class="fa fa-id-card-o"></i>
                                        <div>音乐</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>
                                <div class="child" data-value="diy_line">
                                    <a> <i class="fa fa-id-card-o"></i>
                                        <div>分割线</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>


                                <div class="child" data-value="diy_richtext">
                                    <a> <i class="fa fa-id-card-o"></i>
                                        <div>编辑器</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>
                                <div class="child" data-value="diy_article_1">
                                    <a> <i class="fa fa-id-card-o"></i>
                                        <div>图文列表1</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>

                                <!--<div class="child">-->
                                <!--<a> <i class="fa fa-id-card-o"></i>-->
                                <!--<div>文章</div>-->
                                <!--<div class="mask"></div>-->
                                <!--</a>-->
                                <!--</div>-->
                                <div class="child" data-value="diy_page_kefu">
                                    <a> <i class="fa fa-id-card-o"></i>
                                        <div>客服</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>
                                <!--<div class="child">-->
                                <!--<a> <i class="fa fa-id-card-o"></i>-->
                                <!--<div>产品组合</div>-->
                                <!--<div class="mask"></div>-->
                                <!--</a>-->
                                <!--</div>-->


                            </div>
                        </div>
                        <div class="list">
                            <div class="all-child">
                                <div class="child" data-value="diy_article_1">
                                    <a> <i class="fa fa-id-card-o"></i>
                                        <div>图文列表1</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>
                                <div class="child" data-value="diy_article_2">
                                    <a> <i class="fa fa-id-card-o"></i>
                                        <div>图文列表2</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>
                                <div class="child" data-value="diy_article_2">
                                    <a> <i class="fa fa-id-card-o"></i>
                                        <div>图文列表3</div>
                                        <div class="mask"></div>
                                    </a>
                                </div>
                                <div class="child">
                                    <a href=""> <i class="fa fa-id-card-o"></i>
                                        <div>面板</div>
                                        <div class="mask"></div>
                                    </a>

                                </div>
                                <div class="child">
                                    <a href=""> <i class="fa fa-id-card-o"></i>
                                        <div>自由面板</div>
                                        <div class="mask"></div>
                                    </a>

                                </div>
                                <div class="child">
                                    <a href=""> <i class="fa fa-id-card-o"></i>
                                        <div>滑动面板</div>
                                        <div class="mask"></div>
                                    </a>

                                </div>
                                <div class="child">
                                    <a href=""> <i class="fa fa-id-card-o"></i>
                                        <div>动态分类</div>
                                        <div class="mask"></div>
                                    </a>

                                </div>

                                <div class="child">
                                    <a href="">
                                        <i class="fa fa-id-card-o"></i>
                                        <div>侧边栏</div>
                                        <div class="mask"></div>
                                    </a>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--中间部分-->
            <div class="center-menu">
                <!--<video src="http://wqsturds.mweishop.com/IocBAFq7n3SAeR0JAaCqdDVy6ss961.mp4" controls="controls">-->
                <!--您的浏览器不支持 video 标签。-->
                <!--</video>-->
                <!--<video _ngcontent-c101="" src="http://wqsturds.mweishop.com/IocBAFq7n3SAeR0JAaCqdDVy6ss961.mp4">你的浏览器不支持video元素 请更换浏览器或在手机端浏览效果</video>-->
                {template 'mymanage/diypage/subpage/phone_component'}
            </div>
            <!--右边部分-->
            <div class="right-menu">
            </div>
            {template 'mymanage/diypage/subpage/opcentcore'}
            <div class="form-group xc_btn_row">
                <div class="col-md-9 col-sm-9 col-xs-12 col-md-offset-5 col-sm-offset-5  col-md-xs-5 ">
                    <button type="button" class="btn btn-primary" id="btsave">确认</button>
                </div>
            </div>

        </div>
    </div>

</div>
{template 'common/editfoot'}
<script type="text/javascript">
    $("body").on("click", ".play-btn", function () {
        var $_video = $(this).prev("video");
        if ($_video.length > 0 && $_video.attr("src")) {
            $_video.get(0).play();
        }
    })
    function copyunit(obj) {
        $cloneobj = $(obj).prev().clone();
        $(obj).before($cloneobj);
        $cloneobj.find("input[type='text']").val("");
        eval($(obj).closest("form").attr("data-fun"))
    }
    var xctool = {
        toint: function ($ojb, $deafluevalue) {
            $_dv = 0;
            if ($deafluevalue) {
                $_dv = $deafluevalue;
            }
            if (typeof($ojb) === "object") {

                $_reslut = parseInt($ojb["value"]);
            }
            else {

                $_reslut = parseInt($ojb);

            }
            return isNaN($_reslut) ? $_dv : $_reslut;
        }
    }

    function getinputvalue($ojb, datatype) {
        var data_type = $ojb.attr("data-type");
        if (datatype) {
            data_type = datatype;
        }
        var field_name = $ojb.attr("data-field");
        var $unit = $ojb.attr("data-unit");
        var $casekey = "normal";
        if (data_type) {
            $casekey = data_type;
        }
        else if (field_name == "font-size") {
            $casekey = "font-size";
        } else if ($unit) {
            $casekey = "size";
        }
        switch ($casekey) {
            case "size": {
                var objmodel = {};
                objmodel["value"] = $ojb.val();
                objmodel["type"] = "size";
                objmodel["unit"] = $unit;
                return objmodel;
                break;
            }
            case "font-size": {
                var objmodel = {};
                objmodel["value"] = $ojb.val();
                objmodel["type"] = "size";
                objmodel["unit"] = $ojb.next().find("[data-field='unit']").val();
                return objmodel;
                break;
            }
            case "normal": {
                return $ojb.val();
                break;
            }
            case "btngroup": {
                var objmodel = {};
                $ojb.find("button.style").each(function () {
                    objmodel[$(this).attr("data-field")] = $(this).attr("data-value");
                })

                return objmodel;
                break;
            }
            case "radgroup": {
                var objmodel = {};
                var $chkojb = $ojb.find("input:checked");
                if ($chkojb.length > 0) {
                    objmodel[$chkojb.attr("data-field")] = $chkojb.val();
                }
                return objmodel;
            }
            case "imgmodel": {
                var $_imgmodel = {};
                $ojb.find("input").each(function () {
                    $_imgmodel[$(this).attr("data-field")] = $(this).val();
                })
                return $_imgmodel;
            }
            default : {
                return $ojb.val();
            }
        }
    }
    function getgroupvalue($ojb) {
        var datatype = $ojb.attr("data-type")
        switch (datatype) {
            case "fontgroup": {

                var reslutmodel = {};
                var fontmodel = {};
                fontmodel["value"] = $ojb.find("[data-field='font-size']").val();
                fontmodel["type"] = "size";
                fontmodel["unit"] = $ojb.find("[data-field='font-size']").next().find("select").val();
                $ojb.find(".op-style").find("button.style").each(function () {

                    reslutmodel[$(this).attr("data-field")] = $(this).attr("data-value");
                })
                reslutmodel["font-size"] = fontmodel;
                return reslutmodel;
            }
            case "radgroup": {
                var reslutmodel = {};
                var selectrad = $ojb.find(":checked");
                if (selectrad.length > 0) {
                    reslutmodel[selectrad.attr("data-field")] = selectrad.val();
                }
                return reslutmodel;
            }
        }
        return {};
    }

    var componentdefalut = {};
    componentdefalut["xc_diy_text"] = {
        title: "请设置标题",
        itype: 'xc_diy_text',
        istyle: {"font-size": {value: 30, unit: "rpx", type: "size"}, color: "#666666"}
    };
    componentdefalut["diy_img_num_col"] = {
        col: 1,
        itype: 'diy_img_num_col',
        imgslist: [{
            imgurl: "",
            appid: "",
            path: ""
        }, {
            imgurl: "",
            appid: "",
            path: ""
        }],
        istyle: {"font-size": {value: 30, unit: "rpx", type: "size"}, "color": "red"},
        cid: "img_num_col_1",
        imgstyle: {height: {value: 330, unit: "rpx", type: "size"}}
    };
    componentdefalut["diy_img_num_mofu"] = {
        col: 3,
        itype: 'diy_img_num_mofu',
        cid: "img_num_mofu_1",
        imgslist: [{
            imgurl: "",
            appid: "",
            path: "",
            istyle: {
                width: {value: 375, unit: "rpx", type: "size"},
                height: {value: 375, unit: "rpx", type: "size"}
            }

        }, {
            imgurl: "",
            appid: "",
            path: "",
            istyle: {
                width: {value: 375, unit: "rpx", type: "size"},
                height: {value: 187.5, unit: "rpx", type: "size"}
            }
        },
            {
                imgurl: "",
                appid: "",
                path: "",
                istyle: {
                    width: {value: 375, unit: "rpx", type: "size"},
                    height: {value: 187.5, unit: "rpx", type: "size"}
                }
            }

        ],
        istyle: {
            width: {value: 750, unit: "rpx", type: "size"},

        },
        imgstyle: {
            height: {value: 375, unit: "rpx", type: "size"},

        }
    };
    componentdefalut["diy_bananer"] = {
        itype: 'diy_bananer',
        imgslist: [
            {
                imgurl: "",
                appid: "",
                path: "",
                istyle: {
                    width: {value: 375, unit: "rpx", type: "size"},
                    height: {value: 375, unit: "rpx", type: "size"}
                }

            }, {
                imgurl: "",
                appid: "",
                path: "",
                istyle: {
                    width: {value: 375, unit: "rpx", type: "size"},
                    height: {value: 187.5, unit: "rpx", type: "size"}
                }
            },
            {
                imgurl: "",
                appid: "",
                path: "",
                istyle: {
                    width: {value: 375, unit: "rpx", type: "size"},
                    height: {value: 187.5, unit: "rpx", type: "size"}
                }
            }

        ],
        istyle: {"height": {type: "size", unit: "rpx", value: 350}},
        dots: "true",
        delay: 3
    };
    componentdefalut["diy_notice"] = {
        interval: 3,
        itype: 'diy_notice',
        noticedata: [{title: "12345", appid: "1234", path: "567"}],
        istyle: {"font-size": {value: 30, unit: "rpx", type: "size"}, color: "#666666"},
        rollingtype: "left"
    }
    ///var componentdefalutstr=JSON.stringify()
    componentdefalut["diy_video"] = {
        itype: 'diy_video',
        videourl: "",
        istyle: {"height": {type: "size", unit: "rpx", value: 350}},
        dots: "true"
    };
    componentdefalut["diy_audio"] = {
        itype: 'diy_audio',
        audiourl: "",
        poster: "",
        name: "",
        author: "",
        istyle: {}
    };
    componentdefalut["diy_line"] = {
        itype: 'diy_line',
        istyle: {
            "border-bottom-style": "solid",
            "border-bottom-width": {value: 1, unit: "px", type: "size"},
            "border-bottom-color": "#dddddd",
            "margin-top": {value: 10, unit: "rpx", type: "size"},
            "margin-bottom": {value: 10, unit: "rpx", type: "size"}
        },
    };
    componentdefalut["diy_page_kefu"] =


        {
            "itype": "diy_page_kefu",
            imgslist: [
                {
                    imgurl: "http://fooddns.zuofushi.com/images/2/2018/07/ycJFJg2E557GZ0RPEEZev3J35EXCGF.png",
                    appid: "",
                    path: "",
                    linktype: "bindcontact",
                    istyle: {
                        height: {value: 30, unit: "px", type: "size"},
                        width: {value: 30, unit: "px", type: "size"}
                    },
                }
            ],
            istyle: {
                "x": {value: 5, unit: "%", type: "size"},
                "y": {value: 5, unit: "%", type: "size"},
                "right": {value: 5, unit: "%", type: "size"},
                "bottom": {value: 5, unit: "%", type: "size"},
                "opacity": 1
            },
            imgstyle: {
                height: {value: 30, unit: "px", type: "size"},
                width: {value: 30, unit: "px", type: "size"}
            },
            showstyle: "rows",
            position: "rightbottom",
        }


    componentdefalut["diy_richtext"] = {
        itype: 'diy_richtext',
        istyle: {"padding-top": {type: "size", unit: "rpx", value: 5}, "opacity": 1},
        html: "<p>html数据</p>"

    };

    //height
    componentdefalut["diy_article_1"] =
        {
            itype: 'diy_article_1',
            hastitle: true,
            title: {title: "123456", showtite: 'show', ico: {istyle: {}}},
            ico: {istyle: {}},
            istyle: {"padding-top": {type: "size", unit: "rpx", value: 5}, "opacity": 1},
            imgstyle: {"height": {type: "size", unit: "rpx", value: 330}},
            cid: "img_num_col_1",
            col: 1,
            imgslist: [{
                imgurl: "",
                appid: "",
                path: "",
                title: "产品1"

            }, {
                imgurl: "",
                appid: "",
                path: "",
                title: "产品2"
            }]

        };


    $(".xccheck").each(function (index) {
        var keyid = "xccheck_xc_" + index;
        $(this).attr("id", keyid);
        $(this).after(" <label for='" + keyid + "'></label>");
    })
    //导航栏
    $(function () {
        $(".xhead").click(function () {
            var indexN = $(this).index();
            $(this).addClass("select").siblings().removeClass("select");
            $(".method .list").eq(indexN).show().siblings().hide();
            $(this).children(".triangle").addClass("triangleShow").parent().siblings().children(".triangle").removeClass("triangleShow");
        });
        $("#opcentcore").on("click", ".delico", function () {
            if ($(this).parent().siblings(".xmodel").length > 0) {
                var $_fun = $(this).closest("form").attr("data-fun");
                $(this).parent().remove();
                eval($_fun);
            }

        })
        $(".divWrap .divWrap-list").eq($(this).find(".move-select").index()).show().siblings().hide();
        $(".move").click(function () {
            var indexN = $(this).index();
            $(this).addClass("move-select").siblings().removeClass("move-select");
            $(".divWrap .divWrap-list").eq(indexN).show().siblings().hide();
        });
        $("#opcentcorechildss").on("click", ".oneselect li", function () {
            $(this).addClass("selectedborder").siblings().removeClass("selectedborder");
            if ($(this).parent().hasClass("oneselectex")) {
                $(this).closest(".xc_black").find('[data-field="height"]').val($(this).attr("data-height"));
            }
            else {
                if ($(this).parent().attr("data-fun")) {
                    eval($(this).parent().attr("data-fun") + "(this)");
                }
            }
            $_fun = $(this).closest("form").attr("data-fun");
            eval($_fun);
        })
    })

    //拖拽
    $(function ($) {
        $.fn.dragDiv = function (divWrap) {
            return this.each(function () {
                var $divMove = $(this);//鼠标可拖拽区域
                var $divWrap = divWrap ? $divMove.parents(divWrap) : $divMove;//整个移动区域
                var mX = 0, mY = 0;//定义鼠标X轴Y轴
                var dX = 0, dY = 0;//定义div左、上位置
                var isDown = false;//mousedown标记
                if (document.attachEvent) {//ie的事件监听，拖拽div时禁止选中内容，firefox与chrome已在css中设置过-moz-user-select: none; -webkit-user-select: none;
                    $divMove[0].attachEvent('onselectstart', function () {
                        return false;
                    });
                }
                $divMove.mousedown(function (event) {
                    var event = event || window.event;
                    mX = event.clientX;
                    mY = event.clientY;
                    dX = $divWrap.offset().left;
                    dY = $divWrap.offset().top;
                    isDown = true;//鼠标拖拽启动
                });
                $(document).mousemove(function (event) {
                    var event = event || window.event;
                    var x = event.clientX;//鼠标滑动时的X轴
                    var y = event.clientY;//鼠标滑动时的Y轴
                    if (isDown) {
                        $divWrap.css({"left": x - mX + dX, "top": y - mY + dY});//div动态位置赋值
                    }
                });
                $divMove.mouseup(function () {
                    isDown = false;//鼠标拖拽结束
                });
            });
        };
    });


    //获取长度
    $(function () {
        //拖拽div头部
        $(".wrap-head").dragDiv(".box-shadow");
        $('.na-length').html($(this).val().length)
        $('[name="content"]:input').bind("keyup", function () {
            $('.na-length').html($(this).val().length)
        });
    })
    $(function () {
        $(".op-style button").click(function () {
            if ($(this).hasClass("my-btn")) {
                if ($(this).hasClass('style')) {
                    $(this).removeClass('style');
                } else {
                    $(this).addClass('style');
                }
            }
            if ($(this).hasClass("my-btn1")) {
                if ($(this).hasClass("style")) {
                    $(this).removeClass("style");
                }
                else {
                    $(this).addClass("style").siblings().removeClass("style");
                }
            }
            eval($(this).closest("form").attr("data-fun"))
        })

        $(".input-group-addon_xc .xc_btn").click(function () {
            if ($(this).hasClass("selected")) {
                $(this).removeClass("selected");
            }
            else {
                $(this).addClass("selected");
                $(this).siblings().removeClass("selected");
            }
            if ($(this).parent().find(".selected").length > 0) {
                $(this).parent().prev().find("input").bootstrapSlider('disable').attr("disabled", "disabled");
            }
            else {
                $(this).parent().prev().find("input").bootstrapSlider('enable').removeAttr("disabled");

            }
            liandongbtn($(this));
            //  eval($(this).closest("form").attr("data-fun"))
        })
    })
    //字体加减
    $(function () {
        $(".addbtn").click(function () {
            $_actinput = $(this).parent().parent().parent().find("input");
            var num = $_actinput.val()
            $_actinput.val(parseInt(num) + 1)
            $_actinput.change();
            eval($(this).closest("form").attr("data-fun"));
        })
        $(".addbtn1").click(function () {
            $_actinput = $(this).parent().parent().parent().find("input");
            var num = $_actinput.val()
            if (num >= 1) {
                $_actinput.val(parseInt(num) - 1)
            }
            $_actinput.change();
            eval($(this).closest("form").attr("data-fun"));
        })
    })
    //进度条
    //宽度进度条
    $(function () {

        $("input.slider").bootstrapSlider();

        $("input.slider").show();

    })

    $actlink = null;
    function blacklink($url, obj) {
        $actlink.val($url);
        $actlink.change();


        $(obj).closest(".all-link").hide();
    }
    function kefumesageechage($_actobj, $chkvalue) {
        $_actobj.find(".appgrouplink,.phonelink").hide();
        switch ($chkvalue) {
            case "bindcontact": {
                break;
            }
            case "tel": {
                $_actobj.find(".phonelink").show();
                break;
            }
            case "link": {
                $_actobj.find(".appgrouplink").show();
                break;
            }
        }
    }

    //显示改变显示的内容
    function titlecontents() {
        var umodel = {};
        umodel["showtite"] = $("#utitle").find("[name='showtite']:checked").val();
//是否显示标题
        if (umodel["showtite"] == "show") {
            $("#utitle").find(".titleinfo").show();
        }
        else {
            $("#utitle").find(".titleinfo").hide();
        }


        //是否显示 更多
        umodel["moreshow"] = $("#utitle").find("[name='moreshow']:checked").val();

        if (umodel["moreshow"] == "show") {
            $("#utitle").find(".moreshowinfo").show();
        }
        else {
            $("#utitle").find(".moreshowinfo").hide();
        }
        umodel["moreshowstyle"] = $("#utitle").find("[name='moreshowstyle']:checked").val();

        if (umodel["moreshowstyle"] == "text") {

            $("#utitle").find(".moreshowstytext").show();
            $("#utitle").find(".moreshowstytext").next().hide();
            //  $("#utitle").find(".moreshowstytext").siblings().hide();
        }
        if (umodel["moreshowstyle"] == "img") {
            $("#utitle").find(".moreshowstytimg").show();
            $("#utitle").find(".moreshowstytimg").prev().hide();

        }
//是滞显示小图标
        umodel["radicoshow"] = $("#utitle").find("[name='radicoshow']:checked").val();
        if (umodel["radicoshow"] == "show") {
            $("#utitle").find(".icomore").show();
        }
        else {
            $("#utitle").find(".icomore").hide();
        }
        return umodel["radicoshow"];

    }
    //显示链接
    $(function () {

        $("#opcentcore").on("click", ".xlink", function () {
            $('.all-link').show();
            $actlink = $(this).parent().prev();
        })

        $('.link-big').click(function () {
            if ($('.all-link').is('.big-link')) {
                $('.all-link').removeClass('big-link')
                $(this).addClass('fa-window-maximize')
            } else {
                $('.all-link').addClass('big-link')
                $(this).removeClass('fa-window-maximize').addClass('fa-square')
            }

        })

        $('.link-close').click(function () {
            $('.all-link').hide();
            $('.shadow').hide();
        })

        $(".border").click(function () {
            if ($(this).find(".bfa").hasClass('fa-caret-left')) {
                $(this).next().show();
                $(this).find(".bfa").removeClass('fa-caret-left').addClass('fa-caret-down')
            }
            else {
                $(this).next().hide();
                $(this).find(".bfa").removeClass('fa-caret-down').addClass('fa-caret-left')
            }
        })
        //客服 操作
        $("#opcentcore").on("change", ".xcradiogroup input[type='radio']", function () {
            $(this).parent().siblings().find("input").removeAttr("checked");
            kefumesageechage($(this).parent().parent().parent(), $(this).val());
        })
    })

</script>
<!--Vue-->
<script type="text/javascript">

    var pdata={$vuedata};

    var mySwiper = [];
    var uephone = new Vue(
        {
            el: "#phone-component",
            data: {
                syswidth: 320,
                actunit: -1,
                actclass: "modeldata",
                modeldata: pdata["modeldata"],
                sysycofnig: pdata["sysycofnig"],
                kefu:  pdata["kefu"],
                them: pdata["them"],

            },
            methods: {
                endDrag: function (evt) {
                    if (evt.oldIndex == this.actunit) {
                        this.actunit = evt.newIndex;
                    }
                },
                styleraw: function ($obj, $arrkey, $askey) {

                    var arr = [];
                    var arraskey = [];
                    if ($arrkey) {
                        arr = $arrkey.split(",");
                    }
                    if ($askey) {
                        arraskey = $askey.split(",");
                    }
                    if ($obj) {
                        var attr = [];
                        for (var $key in $obj) {
                            $asnma = $key;
                            if ($arrkey) {
                                var pindex = $.inArray($key, arr);
                                if (pindex < 0) {
                                    continue;
                                }
                                else if ($askey && arraskey[pindex]) {
                                    $asnma = arraskey[pindex];
                                }
                            }
                            if (typeof ($obj[$key]) === "object" && $obj[$key] != null) {
                                if (typeof($obj[$key]["type"]) !== "undefined" && $obj[$key]["type"] == "size") {
                                    if (($key == "width" || $key == "height") && $obj[$key]["value"] == "-1") {
                                        break;
                                    }


                                    if ($obj[$key]["value"] == "") {
                                        continue;
                                    }
                                    switch ($obj[$key]["unit"].toLowerCase()) {
                                        case "%": {
                                            attr.push($key + ":" + $obj[$key]["value"] + "%");
                                            break;
                                        }
                                        case "px": {
                                            attr.push($key + ":" + $obj[$key]["value"] + "px");
                                            break;
                                        }
                                        case "vw": {
                                            attr.push($key + ":" + ($obj[$key]["value"] * this.syswidth / 100).toFixed(2) + "px");
                                            break;
                                        }
                                        case "rpx": {
                                            attr.push($key + ":" + ($obj[$key]["value"] * this.syswidth / 750).toFixed(2) + "px");
                                            break;
                                        }
                                    }
                                }
                            }
                            else {
                                switch ($key) {
                                    case "background-image": {
                                        attr.push($asnma + ":url('" + basicimgurl + $obj[$key] + "')");
                                        break;
                                    }
                                    case "top": {
                                        break;
                                    }
                                    case "background-image": {
                                        break;
                                    }
                                    default: {
                                        attr.push($asnma + ":" + $obj[$key]);
                                    }
                                }
                            }
                        }
                        return attr.join(";") + ";";
                    }
                    else {
                        return "";
                    }
                },
                stylerawex: function ($objlsit) {
                    var basomodel = null;
                    for (var i = 0; i < $objlsit.length; i++) {
                        if ($objlsit[i] !== undefined) {
                            if (basomodel == null) {
                                basomodel = JSON.parse(JSON.stringify($objlsit[i]));
                            }
                            else {
                                for (var t in $objlsit[i]) {

                                    basomodel[t] = $objlsit[i][t];
                                }
                            }
                        }
                    }
                    if (basomodel != null) {

                        return this.styleraw(basomodel);
                    }
                    return "";
                },
                showurl: function ($url) {

                    if ($url == "") {

                        return "../web/resource/images/nopic.jpg"
                    }


                    if ($url.indexOf("http") === -1) {
                        return basicimgurl + $url;
                    }
                    else {
                        return $url;
                    }
                },
                selected: function ($itemindex, $actclass) {

                    if ($actclass) {
                        this.actclass = $actclass;
                    }
                    else {
                        this.actclass = "modeldata";
                    }
                    this.actunit = $itemindex;
                    if (this.actclass === "modeldata") {
                        switch ($itemindex) {
                            case -5: {
                                xcobjupdate(this.kefu)
                                break;
                            }
                            case -3: {
                                xcobjupdate(this.them)
                                break;
                            }
                            case -2: {
                                xcobjupdate(this.sysycofnig)
                                break;
                            }
                            default: {
                                xcobjupdate(this.modeldata[$itemindex])
                            }
                        }
                    } else if (this.actclass = "kefu") {
                        xcobjupdate(this.kefu[$itemindex]);
                    }

                },
                del: function ($itemindex, $actclass) {


                    switch ($actclass) {
                        case "kefu": {

                            this.kefu.splice($itemindex, 1);
                        }
                        default: {
                            this.modeldata.splice($itemindex, 1);
                        }
                    }

                    //kefu
                },
                moveup: function ($itemindex) {
                    if ($itemindex >= 1) {
                        this.modeldata.splice($itemindex - 1, 0, this.modeldata[$itemindex]);
                        this.modeldata.splice($itemindex + 1, 1);
                        if (this.actunit == $itemindex) {

                            this.actunit = $itemindex - 1;
                        }
                    }
                },
                movedown: function ($itemindex) {
                    if ($itemindex < this.modeldata.length - 1) {
                        this.modeldata.splice($itemindex + 2, 0, this.modeldata[$itemindex]);
                        this.modeldata.splice($itemindex, 1);
                        if (this.actunit == $itemindex) {
                            this.actunit = $itemindex + 1;
                        }
                    }
                }

            },
            mounted: function () {
                this.$nextTick(function () {
                    $(".swiper-container").each(function () {
                        var tmppagination = {
                            el: '.swiper-pagination',
                            clickable: true,
                        };

                        if ($(this).attr("data-dots") == "false") {
                            tmppagination = {};
                        }
                        var tempSwiper = new Swiper($(this).attr("forclass"), {
                            autoplay: {
                                delay: $(this).attr("data-delay") * 1000,
                                disableOnInteraction: true,
                            },
                            spaceBetween: 30,
                            width: 320,
                            pagination: tmppagination

                        });
                        mySwiper.push(tempSwiper);
                    })
                })
            },
            updated: function () {
                setTimeout(function () {
                    var pleng = mySwiper.length;
                    if (pleng > 0) {
                        for (var i = 0; i < pleng; i++) {
                            var tempSwiper = mySwiper.splice(0, 1);
                            if (tempSwiper[0]["destroyed"] != true) {
                                tempSwiper[0].destroy();
                            }
                        }
                    }

                    $(".swiper-container").each(function () {
                        var tmppagination = {
                            el: '.swiper-pagination',
                            clickable: true,
                        };
                        if ($(this).attr("data-dots") == "false") {
                            tmppagination = {};
                        }
                        var tempSwiper = new Swiper($(this).attr("forclass"), {
                            autoplay: {
                                delay: $(this).attr("data-delay") * 1000,
                                disableOnInteraction: true,
                            },
                            spaceBetween: 30,
                            width: 320,
                            pagination: tmppagination

                        });
                        mySwiper.push(tempSwiper);
                    })
                }, 100)
            }
        }
    )

    $(function () {
       // uephone.selected(0);
    })

</script>


<script type="text/javascript">

    function data_set_tile($tite) {
        $_actfrom = $("#utitle");
        $_actfrom.find('[name="title"]').val($_title["title"]);
    }

    function xc_set_data($actojb, $modeldata, $temtype) {
        var $_temtype = $actojb.attr("data-type");
        if ($temtype) {
            $_temtype = $temtype;
        }
        var datavalue = "";
        if ($modeldata && $modeldata != null) {

            if (typeof($modeldata) == "object") {
                if ($modeldata["value"]) {
                    datavalue = $modeldata["value"];
                }
            }
            else {
                datavalue = $modeldata;
            }
        }
        if (datavalue == "" && ($actojb.attr("data-default"))) {
            datavalue = $actojb.attr("data-default");
        }
        if (datavalue != "") {
            switch ($_temtype) {
                case "color": {
                    $actojb.val(datavalue);
                    $actojb.find("i").css("background-color", datavalue)
                    break;
                }
                case "image": {
                    $actojb.val(datavalue);
                    $actojb.parent().next().find("img").attr("src", basicimgurl + datavalue)
                    break;
                }

                default: {
                    $actojb.val(datavalue);
                }
            }
        }
        else {
            switch ($_temtype) {
                case "color": {
                    $actojb.val("");
                    $actojb.next().find("i").css("background-color", "#dddddd")
                    break;
                }
                case "image": {
                    $actojb.val("");
                    //  $actojb.parent().next().find("img").attr("src", basicimgurl +"web/resource/images/nopic.jpg")
                    $actojb.parent().next().find("img").attr("src", "../web/resource/images/nopic.jpg")
                    break;
                }
                case "select": {
                    $actojb.find("option").eq(0).prop("selected", "selected");
                    console.log("select ");

                    break;
                }
                default: {
                    $actojb.val("");
                }
            }

        }
    }
    function xc_set_grou_data($actojb, $modeldata) {
        $_type = $actojb.attr("data-type");
        switch ($_type) {
            case "fontgroup": {
                if ($modeldata["font-size"] && typeof($modeldata["font-size"]) == "object") {
                    $actojb.find('[data-field="font-size"]').val($modeldata["font-size"]["value"]);
                    $actojb.find('[data-field="unit"]').val($modeldata["font-size"]["unit"]);
                }
                else {
                    $actojb.find('[data-field="font-size"]').val("");
                }
                $actojb.find(".op-style").find("button").each(function () {
                    var tem_field = $(this).attr("data-field")
                    if ($modeldata[tem_field]) {
                        $(this).addClass("style")
                    }
                    else {
                        $(this).removeClass("style");
                    }
                })
                break;
            }
            case "radgroup": {
                var tem_field = $actojb.attr("data-field");
                var selectedvlaue = $modeldata[tem_field]
                if (selectedvlaue) {
                    $actojb.find("input[value='" + selectedvlaue + "']").prop("checked", "checked");
                }
                else {
                    $actojb.find("input").eq(0).prop("checked", "checked");
                }
                break;
            }
        }
    }

    function data_set_style($_istyle) {
        var $_actfrom = $("#borderfrom");
        var $_temfiled;
        var $_temtype;
        $_actfrom.find("input,select").each(function () {
            $_temfiled = $(this).attr("data-field");
            $_temtype = $(this).attr("data-type");
            xc_set_data($(this), $_istyle[$_temfiled], $_temtype);
            //  xc_set_data($(this),$_istyle[$_temfiled],$_temtype);
        })
    }

    function diy_text_set($model) {
        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"])
        $_istyle = $model["istyle"];
        $("#opcentcore").show();
        $("#xc_diy_text").show();
        $("#xc_diy_text").siblings().hide();
        $("#borderfrom").attr("data-fun", $_actfrom.attr("data-fun"));
        //一级数据
        $_actfrom.find(".onedata").each(function () {
            $_temfiled = $(this).attr("data-field");
            if ($model[$_temfiled]) {
                xc_set_data($(this), $model[$_temfiled]);
            }
            else {
                $(this).val("");
            }
        })
        var $_istyle = $model["istyle"];
        if ($_istyle) {
        } else {
            $_istyle = {};

        }
        $_actfrom.find(".data_style").each(function () {
            $_temfiled = $(this).attr("data-field");
            if ($_istyle[$_temfiled]) {
                xc_set_data($(this), $_istyle[$_temfiled]);
            }
            else {
                $(this).val("");
            }
        })
        data_set_style($_istyle);
    }

    function diy_notice_set($model) {
        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"])
        $_istyle = $model["istyle"];
        $("#opcentcore").show();
        $_actfrom.show();
        $_actfrom.siblings().hide();
        $("#borderfrom").attr("data-fun", $_actfrom.attr("data-fun"));
        $_actfrom.find(".onedata").each(function () {
            $_temfiled = $(this).attr("data-field");
            xc_set_data($(this), $model[$_temfiled]);
        })
        var template_html = xc_templates_notice($model["noticedata"]);
        $xmodellistact = $_actfrom.find(".xmodellist");
        $xmodellistact.find(".xmodel").remove();
        $xmodellistact.find(".fullbtn").before(template_html);
        $_actfrom.find(".onedata").each(function () {
            if ($model[$(this).attr(" data-field")]) {
                $(this).val($model[$(this).attr(" data-field")])
            }
        })

        $_actfrom.find(".modelv1").each(function () {
            var modelname = $(this).attr("data-model");
            var mdoelfilename = $(this).attr("data-field");
            if ($model[modelname]) {
                xc_set_data($(this), $model[modelname][$_temfiled]);
            }
            else {
                xc_set_data($(this), null);
            }
        })
        data_set_style($_istyle);
    }
    function diy_img_num_col_set($model) {

        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"])
        $_istyle = $model["istyle"];
        $imgstyle = $model["imgstyle"];
        $("#opcentcore").show();
        $_actfrom.show();
        $_actfrom.siblings().hide();
        $("#borderfrom").attr("data-fun", $_actfrom.attr("data-fun"));


        //一般ul 单选
        $_actfrom.find(".oneselect").each(function () {
            $(this).children().removeClass("selectedborder")
            if ($model[$(this).attr("data-field")]) {
                $(this).find("[data-value='" + $model[$(this).attr("data-field")] + "']").addClass("selectedborder")
            }
        })


        if ($model["imgslist"] && $model["imgslist"].length > 0) {
            $imgshtml = xc_templates_imglist_1(JSON.parse(JSON.stringify($model["imgslist"])));
            $xmodellistact = $_actfrom.find(".xmodellist");
            $xmodellistact.find(".xmodel").remove();
            $xmodellistact.find(".fullbtn").before($imgshtml);

        }
        if ($_istyle) {
        } else {
            $_istyle = {};

        }
        $_actfrom.find('[data-model="imgstyle"]').each(function () {
            xc_set_data($(this), $model["imgstyle"][$(this).attr("data-field")]);
        })

        data_set_style($_istyle);
    }
    function diy_img_num_mofu_set($model) {

        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"])
        $_istyle = $model["istyle"];
        $imgstyle = $model["imgstyle"];
        $("#opcentcore").show();
        $_actfrom.show();
        $_actfrom.siblings().hide();
        $("#borderfrom").attr("data-fun", $_actfrom.attr("data-fun"));

        //一般ul 单选
        $_actfrom.find(".oneselect").each(function () {
            $(this).children().removeClass("selectedborder")
            if ($model[$(this).attr("data-field")]) {
                $(this).find("[data-value='" + $model[$(this).attr("data-field")] + "']").addClass("selectedborder")
            }
        })
        $xmodellistact = $_actfrom.find(".xmodellist");
        $xmodellistact.find(".xmodel").remove();
        if ($model["imgslist"] && $model["imgslist"].length > 0) {
            $imgshtml = xc_templates_imglist_1(JSON.parse(JSON.stringify($model["imgslist"])), $model["col"], false);

            $xmodellistact.find(".fullbtn").before($imgshtml);
        }
        if ($_istyle) {
        } else {
            $_istyle = {};
        }

        $_actfrom.find("input.slider.img_style").each(function () {
            $_temfiled = $(this).attr("data-field");
            switch ($(this).attr("data-type")) {
                case "imgstyle": {

                    if ($imgstyle[$_temfiled]) {
                        $(this).bootstrapSlider('setValue', $imgstyle[$_temfiled]["value"]);
                    }
                    else {
                        $(this).bootstrapSlider('setValue', 0);
                    }
                    break;
                }
            }
        })
        data_set_style($_istyle);
    }
    function diy_bananer_set($model) {


        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"])
        $_istyle = $model["istyle"];
        $imgstyle = $model["imgstyle"];
        $("#opcentcore").show();
        $_actfrom.show();
        $_actfrom.siblings().hide();
        $("#borderfrom").attr("data-fun", $_actfrom.attr("data-fun"));

        $_actfrom.find("[name='dots']").removeAttr("checked");
        $_actfrom.find("[name='dots'][value='" + $model["dots"] + "']").prop("checked", "checked");

        if ($model["imgslist"] && $model["imgslist"].length > 0) {
            $imgshtml = xc_templates_imglist_1(JSON.parse(JSON.stringify($model["imgslist"])));
            $xmodellistact = $_actfrom.find(".xmodellist");
            $xmodellistact.find(".xmodel").remove();
            $xmodellistact.find(".fullbtn").before($imgshtml);
        }
        if ($_istyle) {
        } else {
            $_istyle = {};
        }
        $actinterval = $_actfrom.find('[data-field="delay"]');

        if ($model["delay"]) {
            $actinterval.bootstrapSlider('setValue', $model["delay"]);
        }
        else {
            $actinterval.bootstrapSlider('setValue', 3);
        }

        data_set_style($_istyle);
    }
    function diy_video_set($model) {
        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"])
        $_istyle = $model["istyle"];
        $("#opcentcore").show();
        $_actfrom.show();
        $_actfrom.siblings().hide();
        $("#borderfrom").attr("data-fun", $_actfrom.attr("data-fun"));

        if ($model["videourl"] === undefined || $model["videourl"] === "") {
            $model["icourl"] = basiurljs + "/addons/xc_xinguwu/them/diyimg/notice_1.png";
        }
        //一级数据
        $_actfrom.find(".onedata").each(function () {
            $_temfiled = $(this).attr("name");
            if ($model[$_temfiled]) {
                console.log($_temfiled);
                $(this).val($model[$_temfiled]);
            }
            else {
                $(this).val("");
            }
        })
        $_actfrom.find("[name='rollingtype']").removeAttr("checked");
        if ($model["rollingtype"]) {
            $_actfrom.find("[name='rollingtype'][value='" + $model["rollingtype"] + "']").prop("checked", "checked");

        }
        else {
            $_actfrom.find("[name='rollingtype']").eq(0).attr("checked", "checked");

        }
        if ($_istyle) {
        } else {
            $_istyle = {};

        }
        if ($_istyle["font-size"]) {
            $_actfrom.find("[name='font-size']").val($_istyle["font-size"]["value"]);
            $_actfrom.find("[name='unit']").val($_istyle["font-size"]["unit"]);
        }
        else {
            $_actfrom.find("[name='font-size']").val("30");
            $_actfrom.find("[name='unit']").val("rpx");
        }
        $_actfrom.find("button.my-btn").each(function () {
            $_temfiled = $(this).attr("data-field");
            $(this).removeClass("style")
            if ($_istyle[$_temfiled]) {
                if ($_temfiled === "text-align") {
                    if ($_istyle[$_temfiled] === $(this).attr("data-value")) {
                        $(this).addClass("style");
                    }
                }
                else {
                    $(this).addClass("style");
                }
            }
        })
        $_actfrom.find("button.my-btn1").removeClass("style");
        if ($_istyle["text-align"]) {
            $_actfrom.find("button.my-btn1[data-value='" + $_istyle["text-align"] + "']").addClass("style");
        }
        $_actfrom.find(".twodata").each(function () {
            $_temfiled = $(this).attr("data-field");
            switch ($(this).attr("data-type")) {
                case "color": {
                    if ($_istyle[$_temfiled]) {
                        $(this).val($_istyle[$_temfiled]);
                        $(this).next().find("i").css("background-color", $_istyle[$_temfiled]);
                    }
                    else {
                        $(this).val("");
                        $(this).next().find("i").css("background-color", "");
                    }
                    break;
                }
                case "text": {

                    if ($_istyle[$_temfiled]) {
                        $(this).val($_istyle[$_temfiled]);

                    }
                    else {
                        $(this).val("");

                    }

                    break;
                }
                case "select": {
                    if ($_istyle[$_temfiled]) {
                        $(this).val($_istyle[$_temfiled]);
                    }
                    else {
                        $(this).find("option").eq(0).attr("selected", "selected").siblings().removeAttr("selected");
                    }
                    break;
                }
                case "image": {

                    if ($_istyle[$_temfiled]) {
                        $(this).val($_istyle[$_temfiled]);
                        $(this).parent().next().find("img").attr("src", basicimgurl + $_istyle[$_temfiled])
                    }
                    else {
                        $(this).val("");
                        $(this).parent().next().find("img").attr("src", "./resource/images/nopic.jpg")
                    }

                    break;
                }
            }

        })
        data_set_style($_istyle);
    }

    function diy_audio_set($model) {
        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"])
        $_istyle = $model["istyle"];
        $("#opcentcore").show();
        $_actfrom.show();
        $_actfrom.siblings().hide();
        $("#borderfrom").attr("data-fun", $_actfrom.attr("data-fun"));
        //一级数据
        $_actfrom.find(".onedata").each(function () {
            $_temfiled = $(this).attr("data-field");
            if ($model[$_temfiled]) {

                $(this).val($model[$_temfiled]);
            }
            else {
                $(this).val("");
            }
        })


        data_set_style($_istyle);
    }
    function diy_page_cofnig_set($model) {

        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"]);
        $("#opcentcore").show();
        $("#opcentcore").find(".wrap-head .move ").eq(1).hide();
        $_actfrom.show();
        $_actfrom.siblings().hide();

        $_actfrom.find("[data-field='title']").val($model["title"]);
        $_actfrom.find("[data-field='color']").val($model["color"]);
        $_actfrom.find("[data-field='background-color']").val($model["background-color"]);


    }
    function diy_page_kefu_set($model) {


        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"]);
        $("#opcentcore").show();
        $("#opcentcore").find(".wrap-head .move ").eq(1).hide();
        $_actfrom.show();
        $_actfrom.siblings().hide();

        $_actfrom.find("[name='showstyle']:checked").removeAttr("checked");
        $_actfrom.find("[name='showstyle'][value='" + $model["showstyle"] + "']").prop("checked", "checked");

        $_actfrom.find("[name='position']:checked").removeAttr("checked");

        $_actfrom.find("[name='position'][value='" + $model["position"] + "']").prop("checked", "checked");


        $imgshtml = xc_templates_icolist($model["imgslist"])
        $xmodellistojb = $_actfrom.find(".xmodellist");
        $xmodellistojb.find(".xmodel").remove();
        $xmodellistojb.find(".fullbtn").before($imgshtml);
        var $img_style = $model["imgstyle"];
        $_actfrom.find(".img_style").each(function () {
            if ($img_style[$(this).attr("data-field")]) {
                if (typeof($img_style[$(this).attr("data-field")]) == "object") {
                    $(this).val($img_style[$(this).attr("data-field")]["value"]);
                }
                else {
                    $(this).val($img_style[$(this).attr("data-field")]);
                }

            }
            else {

                $(this).val("");
            }

        })


        var $_istyle = $model["istyle"];
        $_actfrom.find(".data_style").each(function () {
            if (typeof ($_istyle[$(this).attr("data-field")]) == "string") {
                $(this).val($_istyle[$(this).attr("data-field")])
                if ($(this).attr("data-type") == "color") {
                    $(this).next().find("i").css("background-color", $_istyle[$(this).attr("data-field")])
                }
            }
            else {
                if (typeof ($_istyle[$(this).attr("data-field")]) === "object" && $_istyle[$(this).attr("data-field")] != null) {
                    $(this).val($_istyle[$(this).attr("data-field")]["value"])
                }
                else if ($_istyle[$(this).attr("data-field")]) {
                    $(this).val($_istyle[$(this).attr("data-field")])

                }
                else {
                    $(this).val("")
                }
            }

        })
        $_actfrom.find("input.slider").each(function () {
                if ($(this).val() == "") {
                    $(this).bootstrapSlider('setValue', 0);
                }
                else {
                    $(this).bootstrapSlider('setValue', $(this).val());
                }
            }
        )
    }

    function diy_line_set($model) {
        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"])
        $_istyle = $model["istyle"];
        $("#opcentcore").show();
        $("#opcentcore").find(".wrap-head .move").eq(1).hide();
        $_actfrom.show();
        $_actfrom.siblings().hide();
        $("#borderfrom").attr("data-fun", $_actfrom.attr("data-fun"));
        var linestyle = $model["istyle"];

        $_actfrom.find(".data_style").each(function () {

            if (typeof (linestyle[$(this).attr("data-field")]) == "string") {

                $(this).val(linestyle[$(this).attr("data-field")])
                if ($(this).attr("data-type") == "color") {

                    $(this).next().find("i").css("background-color", linestyle[$(this).attr("data-field")])
                }
            }
            else {

                if (typeof (linestyle[$(this).attr("data-field")]) === "object") {

                    $(this).val(linestyle[$(this).attr("data-field")]["value"])
                }

            }
        })

        $_actfrom.find("input.slider").each(function () {
            $(this).bootstrapSlider('setValue', $(this).val());
        })


    }
    function diy_menu_set($model) {


        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"])
        $_istyle = $model["istyle"];
        $("#opcentcore").show();
        $_actfrom.show();
        $_actfrom.siblings().hide();
        $("#borderfrom").attr("data-fun", $_actfrom.attr("data-fun"));

        template_html = xc_templates_menulist($model["menu"]);

        $xmodellistact = $_actfrom.find(".xmodellist");
        $xmodellistact.find(".xmodel").remove();
        $xmodellistact.find(".fullbtn").before(template_html);

        var linestyle = $model["istyle"];
        $_actfrom.find(".data_style").each(function () {
            if (typeof (linestyle[$(this).attr("data-field")]) == "string") {
                $(this).val(linestyle[$(this).attr("data-field")])
                if ($(this).attr("data-type") == "color") {

                    $(this).next().find("i").css("background-color", linestyle[$(this).attr("data-field")])
                }
            }
            else {

                if (typeof (linestyle[$(this).attr("data-field")]) === "object") {

                    $(this).val(linestyle[$(this).attr("data-field")]["value"])
                }

            }
        })

        $_actfrom.find("input.slider").each(function () {
            $(this).bootstrapSlider('setValue', $(this).val());
        })


        data_set_style($_istyle);

    }

    function sethtmltimeout($html, itmes) {

        if (itmes > 4) {
            return;
        }

        if (uecontents == null) {
            setTimeout(function () {
                sethtmltimeout($html, itmes + 1)
            }, 1000);

        }
        else {
            uecontents.setContent($html);
        }

    }
    function diy_richtext_set($model) {

        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"])
        $_istyle = $model["istyle"];
        $("#opcentcore").show();
        $_actfrom.show();
        $_actfrom.siblings().hide();
        $("#borderfrom").attr("data-fun", $_actfrom.attr("data-fun"));
        data_set_style($_istyle);
        sethtmltimeout($model["html"], 0);

    }

    function diy_article_1_set($model) {
        var $_temfiled = "";
        var $_actfrom = $("#" + $model["itype"])
        var $oneselectex = $_actfrom.find(".oneselectex")
        $oneselectex.find("li").removeClass("selectedborder");
        $oneselectex.find("li[data-value='" + $model["cid"] + "']").addClass("selectedborder");
        $_istyle = $model["istyle"];
        $imgstyle = $model["imgstyle"];
        $("#opcentcore").show();
        $_actfrom.show();
        $_actfrom.siblings().hide();
        $("#borderfrom").attr("data-fun", $_actfrom.attr("data-fun"));
        $("#utitle").attr("data-fun", $_actfrom.attr("data-fun"));

        //标题
        $_title = $model["title"];
        data_set_tile($_title);
        $_actfrom.find('[name="title"]').val($_title["title"]);

//图片
        $strjson = JSON.stringify($model["imgslist"]);
        var template_html = xc_templates_imglist_title(JSON.parse($strjson));
        $xmodellistact = $_actfrom.find(".xmodellist");
        $xmodellistact.find(".xmodel").remove();
        $xmodellistact.find(".fullbtn").before(template_html);
        data_set_style($_istyle);
    }


    function _addmodel(model) {
        if (uephone.actunit == -1) {
            uephone.modeldata.push(model);
            uephone.actunit = uephone.modeldata.length - 1;
        }
        else {
            uephone.modeldata.splice(uephone.actunit, 0, model)

        }

    }

    function xcobjadd($comkey, $actclass) {

        $("#opcentcore").find(".wrap-head .move ").show();
        $("#opcentcore").find(".wrap-head .move ").eq(2).hide();

        $("#opcentcore").find(".wrap-head .move ").eq(0).click();
        if (!$actclass) {

            $actclass = "modeldata";
        }
        var imgmodel = componentdefalut[$comkey];

        if ($comkey == "diy_page_kefu") {
            console.log("客服...............................................");
            console.log(imgmodel);


            uephone.kefu.push(imgmodel);
            uephone.actunit = uephone.kefu.length - 1;
            uephone.actclass = "kefu"
            diy_page_kefu_set(imgmodel)
        }
        else {
            _addmodel(imgmodel);
            switch ($comkey) {
                case "xc_diy_text": {
                    diy_text_set(imgmodel)
                    break;
                }
                case "diy_img_num_col": {
                    diy_img_num_col_set(imgmodel)
                    break;
                }
                case "diy_img_num_mofu": {
                    diy_img_num_mofu_set(imgmodel)
                    break;
                }
                case "diy_notice": {
                    diy_notice_set(imgmodel)
                    break;
                }
                case "diy_bananer": {
                    diy_bananer_set(imgmodel)
                    break;
                }
                case "diy_video": {
                    diy_video_set(imgmodel)
                    break;
                }
                case "diy_audio": {
                    diy_audio_set(imgmodel)
                    break;
                }
                case "diy_line": {
                    diy_line_set(imgmodel)
                    break;
                }
                case "diy_richtext": {

                    diy_richtext_set(imgmodel)
                    break;
                }
                case "diy_article_1": {
                    if (imgmodel["hastitle"]) {
                        $("#opcentcore").find(".wrap-head .move ").eq(2).show();
                    }
                    diy_article_1_set(imgmodel)
                    break;
                }
            }

        }
    }

    function xcobjupdate($model) {
        $("#opcentcore").find(".wrap-head .move ").show();
        //  $("#opcentcore").find(".wrap-head .move ").eq(2).click();
        //没标题的不显示
        $("#opcentcore").find(".wrap-head .move ").eq(2).hide();
        $("#opcentcore").find(".wrap-head .move ").eq(0).click();
        switch ($model["itype"]) {
            case "xc_diy_text": {
                diy_text_set($model);
                break;
            }
            case "diy_notice": {
                diy_notice_set($model)
                break;
            }
            case "diy_img_num_col": {
                diy_img_num_col_set($model)
                break;
            }
            case "diy_img_num_mofu": {
                diy_img_num_mofu_set($model)
                break;
            }

            case "diy_bananer": {
                diy_bananer_set($model)
                break;
            }
            case "diy_video": {
                diy_video_set($model)
                break;
            }
            case "diy_line": {
//                $("#opcentcore").find(".wrap-head .move ").eq(1).hide();
                diy_line_set($model)
                break;
            }
            case "diy_menu": {
                diy_menu_set($model);
            }
            case "diy_audio": {
                diy_audio_set($model)
                break;
            }
            case "diy_page_cofnig": {
                diy_page_cofnig_set($model)
                break;
            }
            case "diy_richtext": {
                diy_richtext_set($model)
                break;
            }

            case "diy_page_kefu": {
                diy_page_kefu_set($model)
                break;
            }
            case "diy_article_1": {

//                if( $model["hastitle"])
//                {
//                    $("#opcentcore").find(".wrap-head .move ").eq(2).show();
//                }


                $("#opcentcore").find(".wrap-head .move ").eq(2).show();
                diy_article_1_set($model)
                break;
            }


        }
    }
    //上下左右对舞台的操作
    document.onkeydown = function (event) {
//37左 38 上 39右 40下
        var e = event || window.event || arguments.callee.caller.arguments[0];
        if (e) {
            switch (e.keyCode) {

                case 37: {     //37左
                    break;
                }
                case 38: {  //38 上
                    if (uephone.actunit >= 1) {
                        uephone.modeldata.splice(uephone.actunit - 1, 0, uephone.modeldata[uephone.actunit]);
                        uephone.modeldata.splice(uephone.actunit + 1, 1);
                        uephone.actunit--;
                    }

                    break;
                }
                case 39: { //39右
                    break;
                }
                case 40: {  //40下
                    if (uephone.actunit >= 0) {
                        if (uephone.actunit < uephone.modeldata.length - 1) {
                            uephone.modeldata.splice(uephone.actunit + 2, 0, uephone.modeldata[uephone.actunit]);
                            uephone.modeldata.splice(uephone.actunit, 1);
                            uephone.actunit++;
                        }
                    }
                    break;
                }
                case 46: { //46删除
                    if (uephone.actunit != -1) {
                        uephone.modeldata.splice(uephone.actunit, 1);
                        if (uephone.actunit == (uephone.modeldata.length )) {
                            uephone.actunit--;
                        }
                    }
                    break;
                }
            }
        }

    };

    $("#opcentcorechildss").on("input", "input[name='title'],input[name='font-size'],input[name='path'],input[name='background-image'],input[name='width'],input[name='appid'],.chageinput", function () {
        eval($(this).closest("form").attr("data-fun"));
    })

    $("#opcentcorechildss").on("change", "select,input[name='font-size'],input[name='background-image'],.chageinput", function () {
        eval($(this).closest("form").attr("data-fun"));
    })

    $("#borderfrom").on("input", "select,input[name='font-size'],input[name='background-image'],.chageinput", function () {
        eval($(this).closest("form").attr("data-fun"));
    });


    $("#borderfrom").on("change", "input[data-type='color'],input[data-field='background-image']", function () {
        eval($(this).closest("form").attr("data-fun"));
    });

    $("#utitle").on("change", "select.chageinput,select.chageinput[type='radio'],[data-type='color'],[data-type='image'],input[name='font-size']", function () {

        eval($(this).closest("form").attr("data-fun"));
    })

    $("#utitle").on("input", ".chageinput", function () {
        eval($(this).closest("form").attr("data-fun"));
    })
    function borderfromsyle($model) {
        var istyle = $model["istyle"];
        $("#borderfrom").find("input,select").each(function () {
            if ($(this).val() != "") {
                istyle[$(this).attr("data-field")] = getinputvalue($(this));
            }
        })
        $model["istyle"] = istyle;
        return $model;
    }
    function titstyle($model) {
        var $_title = {};
        var $_actfrom = $("#utitle");
        var istyle = {};
        $_title["title"] = $_actfrom.find("[name='title']").val();
        $_title["showtite"] = $_actfrom.find("[name='showtite']:checked").val();
        $_title["moreshow"] = $_actfrom.find("[name='moreshow']:checked").val();
        $_title["iconums"] = $_actfrom.find("[name='iconums']:checked").val();
        $_title["moreshowstyle"] = $_actfrom.find("[name='moreshowstyle']:checked").val();
        $_actfrom.find(".op-style").find("button").each(function () {
            if ($(this).hasClass("style")) {
                istyle[$(this).attr("data-field")] = $(this).attr("data-value");
            }
        })
        var fontsize = {};
        fontsize["value"] = $_actfrom.find(".data_type_size [data-field='font-size']").val();
        fontsize["unit"] = $_actfrom.find(".data_type_size [data-field='unit']").val();
        fontsize["type"] = "size"; //尺寸方便处理单位
        istyle["font-size"] = fontsize;
        istyle["text-align"] = $_actfrom.find('[name="text-align"]:checked').val();
        //morelink
        $_actfrom.find(".data_style").each(function () {
            if ($(this).val() != "") {
                if ($(this).attr("data-unit")) {
                    istyle[$(this).attr("data-field")] = {};
                    istyle[$(this).attr("data-field")]["value"] = $(this).val();
                    istyle[$(this).attr("data-field")]["unit"] = $(this).attr("data-unit");
                    istyle[$(this).attr("data-field")]["type"] = "size";
                }
                else {
                    istyle[$(this).attr("data-field")] = $(this).val();
                }
            }
        })
        $_title["istyle"] = istyle;
        var more = {};
        var moreistyle = {};
        var $_temfiledname = "";
        $morelink = $_actfrom.find(".morelink");
        $morelink.find("input[type='text'],input[type='number'],select").each(function () {
            $_temfiledname = $(this).attr("data-field");

            if ($(this).val() == "") {
                return true;
            }

            switch ($(this).attr("data-type")) {
                case  undefined: {
                    more[$_temfiledname] = $(this).val();
                    break;
                }
                case "size": {
                    moreistyle[$_temfiledname] = {};
                    moreistyle[$_temfiledname]["value"] = $(this).val();
                    moreistyle[$_temfiledname]["type"] = "size";
                    moreistyle[$_temfiledname]["unit"] = $(this).attr("data-unit");
                    break;
                }
                default: {
                    more[$_temfiledname] = $(this).val();
                    break;
                }
            }
        })
        $moreistylefont = {};
        $moreistylefont["value"] = $morelink.find("[data-field='font-size']").val();
        $moreistylefont["type"] = "size";
        $moreistylefont["unit"] = $morelink.find("[data-field='unit']").val();
        moreistyle["font-size"] = $moreistylefont;
        more["istyle"] = moreistyle;
        $_title["more"] = more;
        var $jqicomore = $_actfrom.find(".icomore");
        var ico = {};
        $jqicomore.find("input[type='radio']:checked").each(function () {
            ico[$(this).attr("data-field")] = $(this).val();
        })
        $icoistyle = {};
        $jqicomore.find('input.xstyle').each(function () {
            $_temfiledname = $(this).attr("data-field");
            if ($(this).val() == "") {
                return true;
            }

            switch ($(this).attr("data-type")) {
                case  undefined: {
                    $icoistyle[$_temfiledname] = $(this).val();
                    break;
                }
                case "size": {
                    $icoistyle[$_temfiledname] = {};
                    $icoistyle[$_temfiledname]["value"] = $(this).val();
                    $icoistyle[$_temfiledname]["type"] = "size";
                    $icoistyle[$_temfiledname]["unit"] = $(this).attr("data-unit");
                    break;
                }
                case "color": {
                    $icoistyle[$_temfiledname] = $(this).val();
                    break;
                }
            }
        })
        ico["istyle"] = $icoistyle;
        ico["icourl"] = $jqicomore.find("[data-field='icourl']").val();
        $_title["ico"] = ico;
        $model["title"] = $_title;
        return $model;
    }

</script>

<script type="text/javascript">

    var mofangdata = {}
    mofangdata["img_num_mofu_1"] = [{x: [1, 2], y: [1, 1]}, {x: [1, 2], y: [1, 2]}, {x: [1, 2], y: [1, 2]}];
    mofangdata["img_num_mofu_2"] = [{x: [1, 2], y: [1, 1]}, {x: [1, 2], y: [1, 2]}, {x: [1, 2], y: [1, 4]}, {
        x: [1, 2],
        y: [1, 4]
    }];
    mofangdata["img_num_mofu_3"] = [{x: [1, 2], y: [1, 1]}, {x: [1, 2], y: [1, 3]}, {x: [1, 2], y: [1, 3]}, {
        x: [1, 2],
        y: [1, 3]
    }];
    mofangdata["img_num_mofu_4"] = [{x: [1, 2], y: [1, 1]}, {x: [1, 2], y: [1, 3]}, {x: [1, 4], y: [2, 3]}, {
        x: [1, 4],
        y: [2, 3]
    }];
    mofangdata["img_num_mofu_5"] = [{x: [1, 2], y: [1, 1]}, {x: [1, 2], y: [1, 2]}, {x: [1, 4], y: [1, 2]}, {
        x: [1, 4],
        y: [1, 2]
    }];
    mofangdata["img_num_mofu_6"] = [{x: [1, 2], y: [1, 1]}, {x: [1, 2], y: [1, 4]}, {x: [1, 2], y: [1, 4]}, {
        x: [1, 2],
        y: [1, 4]
    }, {x: [1, 2], y: [1, 4]}];

    function restdiy_img_num_col_imghegith(obj) {
        $_opobj = $(obj);
        var $imgheight = $_opobj.closest("form").find(".imgheight")
        $imgheight.val($(obj).attr("data-height"));
        //     $imgheight.bootstrapSlider('setValue', $(obj).attr("data-height"));

    }
    function diy_text_chage_contents(from) {
        var model = {};
        $actfrom = $(from);
        $actfrom.find(".onedata").each(function () {
            model[$(this).attr("data-field")] = $(this).val();
        })
        var $_istyle = {};
        $actfrom.find(".data_style").each(function () {
            $_istyle[$(this).attr("data-field")] = getinputvalue($(this));
        })
        $actfrom.find(".xcgroup").each(function () {
            $_istyle = $.extend($_istyle, getgroupvalue($(this)))
        })
        model["itype"] = "xc_diy_text";
        model["istyle"] = $_istyle;
        model = borderfromsyle(model);
        uephone.modeldata.splice(uephone.actunit, 1, model);

    }
    function diy_notice_chage_contents(from) {

        $actfrom = $(from);
        var model = {};
        model["itype"] = "diy_notice";
        $actfrom.find(".onedata ").each(function () {
            model[$(this).attr("data-field")] = getinputvalue($(this));
        })
        var $_istyle = {};
        $actfrom.find(".data_style").each(function () {
            $_istyle[$(this).attr("data-field")] = getinputvalue($(this));
        })
        $actfrom.find(".xcgroup").each(function () {
            if ($(this).attr("root")) {
                model = ($.extend(model, getgroupvalue($(this))))
            }
            else {
                $_istyle = $.extend($_istyle, getgroupvalue($(this)))

                console.log("fonts");

            }
        })
        $actfrom.find(".modelv1").each(function () {
            var modelname = $(this).attr("data-model");
            var mdoelfilename = $(this).attr("data-field");
            if (!model[modelname]) {
                model[modelname] = {};
            }
            model[modelname][mdoelfilename] = getinputvalue($(this));
        })

        $actfrom.find(".xmodellist").each(function () {
                var $modelistname = $(this).attr("data-field");
                var temmodellist = [];
                $(this).find(".xmodel").each(function (_index) {
                    var temmdoel = {};
                    $(this).find("input").each(function () {
                        temmdoel[$(this).attr("data-field")] = $(this).val();
                    })
                    temmodellist.push(temmdoel);
                })
                model[$modelistname] = temmodellist;
            }
        )
        model["istyle"] = $_istyle;
        model = borderfromsyle(model);
        console.log(model);
        uephone.modeldata.splice(uephone.actunit, 1, model);
    }
    function diy_img_num_col_chage_contents(from) {
        $actfrom = $(from);
        var model = {};
        var istyle = {};
        var imgstyle = {};
        $actfrom.find(".oneselect").each(function () {
            model[$(this).attr("data-field")] = $(this).find(".selectedborder").attr("data-value");
            if ($(this).attr("data-field") == "cid") {
                model["col"] = $(this).find(".selectedborder").attr("data-col");
            }
        })
        model["itype"] = "diy_img_num_col";
        var tempselected = "";

        $actfrom.find(".modelv1").each(function () {
            var modelname = $(this).attr("data-model");
            var mdoelfilename = $(this).attr("data-field");
            if (!model[modelname]) {
                model[modelname] = {};
            }
            model[modelname][mdoelfilename] = getinputvalue($(this));
        })

        var img_style = model["imgstyle"];
        model["istyle"] = istyle;
        model = borderfromsyle(model);
        var $picwitd = (model["istyle"]["width"] == undefined ? 750 : model["istyle"]["width"]["value"]);
        var padmarlefr = parseInt(model["istyle"]["padding-left"] ? model["istyle"]["padding-left"]["value"] : 0) + parseInt(model["istyle"]["padding-right"] ? model["istyle"]["padding-right"]["value"] : 0) + parseInt(model["istyle"]["margin-left"] ? model["istyle"]["margin-left"]["value"] : 0) + parseInt(model["istyle"]["margin-right"] ? model["istyle"]["margin-right"]["value"] : 0);

        _spacing = img_style["spacing"] ? img_style["spacing"]["value"] : 0;
        $_height = (img_style["height"] == undefined ? 0 : img_style["height"]["value"]);
        var otherwidth = padmarlefr;
        if (model["col"] !== 1) {
            // $_height=$_height-(_spacing* (model["col"]-1)/model["col"])
            otherwidth = otherwidth + (_spacing * (model["col"] - 1));
            $_height = $_height - otherwidth * $_height / $picwitd;
            $picwitd = $picwitd - otherwidth;
        }
        $_width = $picwitd / model["col"];
        var $_imgwidth = {};
        $_imgwidth["unit"] = "rpx";
        $_imgwidth["type"] = "size";
        $_imgwidth["value"] = $_width;
        model["imgwidth"] = $_imgwidth;
        var $_imgheight = {};
        $_imgheight["unit"] = "rpx";
        $_imgheight["type"] = "size";
        $_imgheight["value"] = $_height;
        $actfrom.find(".xmodellist").each(function () {
                var $modelistname = $(this).attr("data-field");
                var temmodellist = [];
                $(this).find(".xmodel").each(function (_index) {
                    var temmdoel = {};
                    temmdoel["style"] = {};
                    temmdoel["style"]["width"] = $_imgwidth;
                    temmdoel["style"]["height"] = $_imgheight;
                    if ((_index + 1) % model["col"] != 0) {
                        temmdoel["style"]["margin-right"] = img_style["spacing"];
                    }
                    $(this).find("input").each(function () {
                        temmdoel[$(this).attr("data-field")] = $(this).val();
                    })
                    temmodellist.push(temmdoel);
                })
                model[$modelistname] = temmodellist;
            }
        )
        uephone.modeldata.splice(uephone.actunit, 1, model);
    }
    function diy_img_num_mofu_contents(from) {
        $actfrom = $(from);
        var model = {};
        var istyle = {};
        var imgstyle = {};
        $actfrom.find(".oneselect").each(function () {
            model[$(this).attr("data-field")] = $(this).find(".selectedborder").attr("data-value");
            if ($(this).attr("data-field") == "cid") {
                model["col"] = $(this).find(".selectedborder").attr("data-col");
            }
        })
        $showlen = $actfrom.find(".xmodellist").find(".unitimg").length;

        if ($showlen < model["col"]) {
            $imgshtml = xc_templates_imglist_1([], model["col"] - $showlen, false);

            $xmodellistact.find(".fullbtn").before($imgshtml);

        }
        else if ($showlen > model["col"]) {

            $xmodellistobj = $actfrom.find(".xmodellist").find(".unitimg");

            for (var i = $showlen; i > model["col"]; i--) {
                $xmodellistobj.eq(i - 1).remove();
            }
        }
        model["itype"] = "diy_img_num_mofu";
        var tempselected = "";

        var img_style = {}
        $actfrom.find(".img_style").each(function () {
            if ($(this).val() != "") {
                if ($(this).attr("data-unit")) {
                    img_style[$(this).attr("data-field")] = {};
                    img_style[$(this).attr("data-field")]["value"] = $(this).val();
                    img_style[$(this).attr("data-field")]["unit"] = $(this).attr("data-unit");
                    img_style[$(this).attr("data-field")]["type"] = "size";
                }
                else {
                    img_style[$(this).attr("data-field")] = $(this).val();
                }
            }
        })
        model["imgstyle"] = img_style;
        model["istyle"] = istyle;
        model = borderfromsyle(model);
        var $picwitd = (model["istyle"]["width"] == undefined ? 750 : model["istyle"]["width"]["value"]);
        var padmarlefr = parseInt(model["istyle"]["padding-left"] ? model["istyle"]["padding-left"]["value"] : 0) + parseInt(model["istyle"]["padding-right"] ? model["istyle"]["padding-right"]["value"] : 0) + parseInt(model["istyle"]["margin-left"] ? model["istyle"]["margin-left"]["value"] : 0) + parseInt(model["istyle"]["margin-right"] ? model["istyle"]["margin-right"]["value"] : 0);
        $_height = (img_style["height"] == undefined ? 0 : img_style["height"]["value"]);
        $_height = $_height - (padmarlefr * ($_height / $picwitd))
        $picwitd = $picwitd - padmarlefr;

        // $_width = $picwitd / model["col"];
        $_width = $picwitd;
        var $_imgwidth = {};
        $_imgwidth["unit"] = "rpx";
        $_imgwidth["type"] = "size";
        $_imgwidth["value"] = $_width;
        model["imgwidth"] = $_imgwidth;
        var $_imgheight = {};
        $_imgheight["unit"] = "rpx";
        $_imgheight["type"] = "size";
        $_imgheight["value"] = $_height;
        var $_imgwidthjsonstr = JSON.stringify($_imgwidth);
        var $_imgheightjsonstr = JSON.stringify($_imgheight);

        $actfrom.find(".xmodellist").each(function () {
                var $modelistname = $(this).attr("data-field");
                var temmodellist = [];
                $(this).find(".xmodel").each(function (_index) {
                    var temmdoel = {};
                    var $_imgwidth_tem = {};
                    var $_imgheight_tem = {};
                    $_imgwidth_tem = JSON.parse($_imgwidthjsonstr);
                    $_imgheight_tem = JSON.parse($_imgheightjsonstr);
                    $_imgwidth_tem["value"] = $_imgwidth_tem["value"] * mofangdata[model["cid"]][_index]["x"][0] / mofangdata[model["cid"]][_index]["x"][1]
                    $_imgheight_tem["value"] = $_imgheight_tem["value"] * mofangdata[model["cid"]][_index]["y"][0] / mofangdata[model["cid"]][_index]["y"][1]
                    temmdoel["istyle"] = {};
                    temmdoel["istyle"]["width"] = $_imgwidth_tem;
                    temmdoel["istyle"]["height"] = $_imgheight_tem;
                    $(this).find("input").each(function () {
                        temmdoel[$(this).attr("data-field")] = $(this).val();
                    })
                    //   console.log(JSON.stringify(temmdoel) );
                    temmodellist.push(temmdoel);
                })
                model[$modelistname] = temmodellist;
            }
        )
        uephone.modeldata.splice(uephone.actunit, 1, model);
    }
    function diy_bananer_chage_contents(from) {
        $actfrom = $(from);
        var model = {};
        var istyle = {};
        var imgstyle = {};
        model["dots"] = $actfrom.find("input[name='dots']:checked").val();
        model["delay"] = $actfrom.find("input[name='delay']").val();
        $actfrom.find(".oneselect").each(function () {
            model[$(this).attr("data-field")] = $(this).find(".selectedborder").attr("data-value");
        })
        model["itype"] = "diy_bananer";
        var tempselected = "";
        model["istyle"] = istyle;
        model = borderfromsyle(model);
        $actfrom.find(".xmodellist").each(function () {
                var $modelistname = $(this).attr("data-field");
                var temmodellist = [];
                $(this).find(".xmodel").each(function (_index) {
                    var temmdoel = {};
                    temmdoel["style"] = {};

                    $(this).find("input").each(function () {
                        temmdoel[$(this).attr("data-field")] = $(this).val();
                    })
                    temmodellist.push(temmdoel);
                })
                model[$modelistname] = temmodellist;
            }
        )
        uephone.modeldata.splice(uephone.actunit, 1, model);
    }
    function diy_video_chage_contents(from) {

        $actfrom = $(from);
        var model = {};
        $attrdata = $actfrom.serializeArray()
        for (var i = 0; i < $attrdata.length; i++) {
            model[$attrdata[i]["name"]] = $attrdata[i]["value"];
        }
        /// noticedata
        var istyle = {};

        $(".op-style").find("button").each(function () {
            if ($(this).hasClass("style")) {
                istyle[$(this).attr("data-field")] = $(this).attr("data-value");
            }
        })
        model["itype"] = "diy_video";
        var tempselected = "";
        $actfrom.find(".data_style").each(function () {
            if ($(this).is(":disabled")) {
                tempselected = $(this).parent().next().find(".selected").attr("data-value");
                if (tempselected != "") {
                    istyle[$(this).attr("data-field")] = tempselected;
                }
            }
            else {

                if ($(this).val() != "") {

                    if ($(this).attr("data-unit")) {
                        istyle[$(this).attr("data-field")] = {};
                        istyle[$(this).attr("data-field")]["value"] = $(this).val();
                        istyle[$(this).attr("data-field")]["unit"] = $(this).attr("data-unit");
                        istyle[$(this).attr("data-field")]["type"] = "size";
                    }
                    else {
                        istyle[$(this).attr("data-field")] = $(this).val();
                    }
                }
            }
        })
        $actfrom.find(".xmodellist").each(function () {
                var $modelistname = $(this).attr("data-field");
                var temmodellist = [];
                $(this).find(".xmodel").each(function (_index) {
                    var temmdoel = {};
                    $(this).find("input").each(function () {
                        temmdoel[$(this).attr("data-field")] = $(this).val();
                    })
                    temmodellist.push(temmdoel);
                })
                model[$modelistname] = temmodellist;
            }
        )


        model["istyle"] = istyle;
        model = borderfromsyle(model);
        uephone.modeldata.splice(uephone.actunit, 1, model);
    }
    function diy_line_chage_contents(from) {

        $actfrom = $(from);
        var model = {};
        var istyle = {};
        model["itype"] = "diy_line";
        var tempselected = "";
        $actfrom.find(".data_style").each(function () {
            if ($(this).is(":disabled")) {
                tempselected = $(this).parent().next().find(".selected").attr("data-value");
                if (tempselected != "") {
                    istyle[$(this).attr("data-field")] = tempselected;
                }
            }
            else {

                if ($(this).val() != "") {

                    if ($(this).attr("data-unit")) {
                        istyle[$(this).attr("data-field")] = {};
                        istyle[$(this).attr("data-field")]["value"] = $(this).val();
                        istyle[$(this).attr("data-field")]["unit"] = $(this).attr("data-unit");
                        istyle[$(this).attr("data-field")]["type"] = "size";
                    }
                    else {
                        istyle[$(this).attr("data-field")] = $(this).val();
                    }
                }
            }
        })
        model["istyle"] = istyle;
        uephone.modeldata.splice(uephone.actunit, 1, model);
    }
    function diy_menu_chage_contents(from) {

        $actfrom = $(from);
        var model = {};


        $actfrom.find(".xmodellist").each(function () {
                var $modelistname = $(this).attr("data-field");
                var temmodellist = [];
                $(this).find(".xmodel").each(function (_index) {
                    var temmdoel = {};

                    $(this).find("input").each(function () {
                        temmdoel[$(this).attr("data-field")] = $(this).val();
                    })
                    temmodellist.push(temmdoel);
                })
                model[$modelistname] = temmodellist;
            }
        )


        /// noticedata
        var istyle = {};
        model["itype"] = "diy_menu";
        var tempselected = "";
        $actfrom.find(".data_style").each(function () {
            if ($(this).is(":disabled")) {
                tempselected = $(this).parent().next().find(".selected").attr("data-value");
                if (tempselected != "") {
                    istyle[$(this).attr("data-field")] = tempselected;
                }
            }
            else {

                if ($(this).val() != "") {

                    if ($(this).attr("data-unit")) {
                        istyle[$(this).attr("data-field")] = {};
                        istyle[$(this).attr("data-field")]["value"] = $(this).val();
                        istyle[$(this).attr("data-field")]["unit"] = $(this).attr("data-unit");
                        istyle[$(this).attr("data-field")]["type"] = "size";
                    }
                    else {
                        istyle[$(this).attr("data-field")] = $(this).val();
                    }
                }
            }
        })


        model["istyle"] = istyle;
        model = borderfromsyle(model);

        uephone.sysycofnig = model;

        //(uephone.actunit, 1, model);
        //(uephone.actunit, 1, model);
    }
    function diy_audio_chage_contents(from) {

        $actfrom = $(from);
        var model = {};

        $actfrom.find(".onedata").each(function () {
            model[$(this).attr("data-field")] = $(this).val();
        })
        /// noticedata
        var istyle = {};
        model["itype"] = "diy_audio";

        model["istyle"] = istyle;
        model = borderfromsyle(model);
        uephone.modeldata.splice(uephone.actunit, 1, model);
    }
    function diy_page_cofnig_contents(from) {
        $_actfrom = $(from);
        var model = {};
        model["title"] = $_actfrom.find("[data-field='title']").val();
        model["color"] = $_actfrom.find("[data-field='color']").val();
        model["background-color"] = $_actfrom.find("[data-field='background-color']").val();
        model["itype"] = "diy_page_cofnig";
        uephone.them = model;


    }
    function diy_page_kefu_contents(from) {
        var $_actfrom = $(from);
        var model = {};
        model["itype"] = "diy_page_kefu";

        var $showstylevalue = $_actfrom.find("[name='showstyle']:checked").val();
        model["showstyle"] = $showstylevalue;
        $img_style = {};

        $xname = "";
        $yname = "";
        var $position = $_actfrom.find("[name='position']:checked").val();
        switch ($position) {
            case "lefttop": {
                $xname = "left";
                $yname = "top";
                break;
            }
            case "righttop": {
                $xname = "right";
                $yname = "top";
                break;
            }
            case "leftbottom": {
                $xname = "left";
                $yname = "bottom";
                break;
            }
            case "rightbottom": {
                $xname = "right";
                $yname = "bottom"
                break;
            }
        }

        $_istyle = {};
        var temfiledname = "";
        $_actfrom.find(".data_style").each(function () {
            temfiledname = $(this).attr("data-field");
            if ($(this).attr("data-unit")) {
                $_istyle[temfiledname] = {value: $(this).val(), unit: $(this).attr("data-unit"), type: "size"}
            }
            else {
                $_istyle[temfiledname] = $(this).val();
            }

        })
        $_istyle[$xname] = $_istyle["x"];
        $_istyle[$yname] = $_istyle["y"];
        model["istyle"] = $_istyle;


        $_actfrom.find(".img_style").each(function () {
            temfiledname = $(this).attr("data-field");
            if ($(this).attr("data-unit")) {
                $img_style[temfiledname] = {value: $(this).val(), unit: $(this).attr("data-unit"), type: "size"}
            }
            else {
                $img_style[temfiledname] = $(this).val();
            }

        })

        $img_style["height"] = $img_style["width"]
        model["imgstyle"] = $img_style;
        var nospacestype = "";
        switch ($showstylevalue) {
            case "cols": {
                $img_style["display"] = "block";
                nospacestype = JSON.stringify($img_style);
                $img_style["margin-top"] = $img_style["xmargin"]
                break;
            }
            case "rows": {
                $img_style["display"] = "inline-block";
                nospacestype = JSON.stringify($img_style);
                $img_style["margin-left"] = $img_style["xmargin"];
                break;
            }
        }

        $_actfrom.find(".xmodellist").each(function () {
                var $modelistname = $(this).attr("data-field");
                var temmodellist = [];


                var $xmodels = $(this).find(".xmodel");
                var ilen = $xmodels.length;

                $xmodels.each(function (_index) {

                    var temmdoel = {};
                    $(this).find("input").each(function () {
                        temmdoel[$(this).attr("data-field")] = $(this).val();
                    })
                    if (_index === 0) {
                        temmdoel["istyle"] = JSON.parse(nospacestype);
                    }
                    else {
                        temmdoel["istyle"] = $img_style;
                    }

                    temmodellist.push(temmdoel);
                })
                model[$modelistname] = temmodellist;
            }
        )

        console.log("客服2");
        console.log(model);
        uephone.kefu.splice(uephone.actunit, 1, model);
    }
    function diy_richtext_contents(from) {

        var $_actfrom = $(from);
        var model = {};
        model["itype"] = "diy_richtext";
        model["html"] = uecontents.getContent();
        var tempselected = "";
        var istyle = {};

        model["istyle"] = istyle;
        model = borderfromsyle(model);
        uephone.modeldata.splice(uephone.actunit, 1, model);
    }
    function diy_article_1_chage_contents(from) {

        var $_actfrom = $(from);
        var model = {};
        $actcid = $_actfrom.find(".oneselect").find(".selectedborder")
        if ($actcid.length > 0) {
            model["cid"] = $actcid.attr("data-value");
            model["col"] = $actcid.attr("data-col");
        }
        else {
            model["cid"] = "";
        }
        model["itype"] = "diy_article_1";
        model["hastitle"] = true;
        model["istyle"] = {"padding-top": {type: "size", unit: "rpx", value: 5}, "opacity": 1};
        titlecontents();
        model = titstyle(model)
        $_actfrom.find(".xc_black,.xmodellist").each(function () {
            var actmodel = $(this).attr("data-model");
            switch (actmodel) {
                case "imgstyle": {
                    var $imgstyle = {};
                    $imgstyle["cid"] = $(this).find("[data-field='cid']").find(".selectedborder").attr("data-value");
                    $(this).find("input").each(function () {
                        $imgstyle[$(this).attr("data-field")] = getinputvalue($(this));
                    })
                    model["imgstyle"] = $imgstyle;
                    break;
                }
                case "imgtxtstyle": {
                    var $imgtxtstyle = {};
                    $(this).find("input").each(function () {
                        $imgtxtstyle[$(this).attr("data-field")] = getinputvalue($(this));
                    })

                    $(this).find(".xcgroup").each(function () {
                        $imgtxtstyle = $.extend($imgtxtstyle, getinputvalue($(this)))
                    });
                    model["imgtxtstyle"] = $imgtxtstyle;

                    break;
                }
                case "imgslist": {
                    var $imgslist = [];
                    $(this).find(".xmodel").each(function () {
                        $imgslist.push(getinputvalue($(this), "imgmodel"))

                    })
                    model["imgslist"] = $imgslist;
                    break;
                }
                case "istyle": {
                    var $istyle = {};
                    $(this).find(".chageinput").each(function () {
                        $istyle[$(this).attr("data-field")] = getinputvalue($(this));
                    })


                    model["istyle"] = $istyle;
                    break;
                }
                case "unitstyle": {
                    var $unitstyle = {};
                    $(this).find(".chageinput").each(function () {
                        $unitstyle[$(this).attr("data-field")] = getinputvalue($(this));
                    })
                    model["unitstyle"] = $unitstyle;


                    break;
                }
            }
        })
        model = borderfromsyle(model);


//        计算宽度
        var $_col = model["col"];
        $_marpad = xctool.toint(model["istyle"]["padding-left"]) + xctool.toint(model["istyle"]["padding-right"]) + xctool.toint(model["istyle"]["margin-left"]) + xctool.toint(model["istyle"]["margin-right"]) + xctool.toint(model["istyle"]["border-right-width"]) + xctool.toint(model["istyle"]["border-left-width"]);

        $width = 750 - $_marpad;

        if (model["unitstyle"]["r-spc"]) {
            if ($_col > 1) {

                $width = $width - ($_col - 1) * model["unitstyle"]["r-spc"]["value"];
                $width = $width / $_col;
            }
        }

        $_actfrom.find(".oneimgwidth").html($width);
        $widthmodel = {};
        $widthmodel["value"] = $width;
        $widthmodel["type"] = "size";
        $widthmodel["unit"] = "rpx";
        model["imgstyle"]["width"] = $widthmodel;
        model["imgtxtstyle"]["width"] = $widthmodel;

//        计算宽度结束
        uephone.modeldata.splice(uephone.actunit, 1, model);
    }

</script>
<div></div>
<script type="text/javascript">
    $(function () {
        $(".all-child .child").click(function () {

            $comkey = $(this).attr("data-value");
            xcobjadd($comkey);
        })
        $('.xccolorpicker').colorpicker();
        $("#bottom-fixed-container").click(function () {
            $(this).addClass("active");

        })
    })

</script>


<script type="text/javascript">


    $(function () {

        $("#btsave").click(function () {

            var savemodel={};
            savemodel["modeldata"]=uephone.modeldata;
            savemodel["sysycofnig"]=uephone.sysycofnig;
            savemodel["kefu"]=uephone.kefu;
            savemodel["them"]=uephone.them;



            xajaxfrom("#xc_form",savemodel);
            return



        })
    })




    function message(data) {
        $mesoption = {};
        if (data["status"] === 1) {
            if ($('[name="id"]').val() == ""||$('[name="id"]').val() == "0") {
                xc_form.reset();
                //
                $(".container").find(".img-thumbnail").attr("src", "./resource/images/nopic.jpg");
                if( urobj.length>0){
                    for(var i=0;i<urobj.length;i++){
                        urobj[i].setContent("");
                    }
                }
            }
            $mesoption["timer"] = 1000;
            $mesoption["type"] = replyrdata[data["status"]];
        }
        if( typeof(data["title"])=="undefined" )
        {
            $mesoption["title"] = data["message"];
        }
        else {
            $mesoption["title"]=data["title"];
        }
        $mesoption["text"] = data["message"];
        swal($mesoption);
    }

    function xajaxfrom(actform,$savemdoel) {
        $actfrom = $(actform);
        var $postdate={};
           $postdate["xc"]=$savemdoel;
        xpagecss.xload();
        $.ajax({
            type: $("#xc_form").attr("method"),
            url:$("#xc_form").attr("action"),
            dataType: "json",
            data: $postdate,
            success: function (msg) {
                message(msg)

            }
        });
    }








</script>


</body>
</html>

