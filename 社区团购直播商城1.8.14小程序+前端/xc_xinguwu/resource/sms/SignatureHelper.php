<?php
 class SignatureHelper { public function request($accessKeyId, $accessKeySecret, $domain, $params, $security = false) { goto R4uBn; ISQPG: $sign = base64_encode(hash_hmac("\163\x68\x61\x31", $stringToSign, $accessKeySecret . "\46", true)); goto lp0K1; R4uBn: $apiParams = array_merge(array("\x53\x69\x67\x6e\141\x74\x75\x72\x65\115\x65\164\150\157\144" => "\110\x4d\x41\103\x2d\123\110\101\x31", "\123\151\147\x6e\x61\x74\x75\x72\x65\x4e\x6f\x6e\x63\x65" => uniqid(mt_rand(0, 0xffff), true), "\123\x69\147\156\141\164\x75\162\145\126\145\162\163\x69\157\x6e" => "\61\x2e\60", "\101\x63\143\x65\163\163\x4b\x65\x79\x49\144" => $accessKeyId, "\x54\151\155\145\163\x74\141\x6d\x70" => gmdate("\131\x2d\x6d\55\x64\x5c\124\x48\72\x69\72\163\x5c\132"), "\x46\x6f\x72\155\141\164" => "\x4a\123\x4f\116"), $params); goto pOyJT; ZR7h3: $url = ($security ? "\x68\164\x74\160\x73" : "\150\x74\164\x70") . "\x3a\57\57{$domain}\57\77\x53\151\x67\x6e\x61\x74\165\162\145\75{$signature}{$sortedQueryStringTmp}"; goto nG129; XMyCx: $sortedQueryStringTmp = ''; goto z9L0u; BoMbq: vVCso: goto MJc4X; lp0K1: $signature = $this->encode($sign); goto ZR7h3; z9L0u: foreach ($apiParams as $key => $value) { $sortedQueryStringTmp .= "\x26" . $this->encode($key) . "\75" . $this->encode($value); FH1f2: } goto BoMbq; nG129: try { $content = $this->fetchContent($url); return json_decode($content); } catch (\Exception $e) { return false; } goto n59uq; MJc4X: $stringToSign = "\x47\105\124\46\x25\62\x46\x26" . $this->encode(substr($sortedQueryStringTmp, 1)); goto ISQPG; pOyJT: ksort($apiParams); goto XMyCx; n59uq: } private function encode($str) { goto Aei8y; lVkIY: $res = preg_replace("\57\x25\x37\105\x2f", "\x7e", $res); goto nkSCI; nkSCI: return $res; goto UylyS; eaiDh: $res = preg_replace("\x2f\x5c\x2b\x2f", "\45\x32\60", $res); goto gfQrS; Aei8y: $res = urlencode($str); goto eaiDh; gfQrS: $res = preg_replace("\57\134\52\57", "\x25\62\x41", $res); goto lVkIY; UylyS: } private function fetchContent($url) { goto dhIm2; KeGdN: curl_setopt($ch, CURLOPT_HTTPHEADER, array("\170\x2d\163\144\153\55\x63\154\x69\x65\x6e\x74" => "\160\x68\x70\x2f\x32\x2e\x30\x2e\60")); goto e1elg; EKGbs: GH1Lg: goto flbh7; KWBSW: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto KeGdN; QkJ7v: curl_setopt($ch, CURLOPT_URL, $url); goto sEZ7v; dhIm2: $ch = curl_init(); goto QkJ7v; p3Jps: $rtn = curl_exec($ch); goto DQYNI; rII1W: UrasP: goto p3Jps; e1elg: if (!(substr($url, 0, 5) == "\150\x74\x74\160\x73")) { goto UrasP; } goto p1QvW; w7QBW: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); goto rII1W; sEZ7v: curl_setopt($ch, CURLOPT_TIMEOUT, 5); goto KWBSW; rFrCS: trigger_error("\x5b\x43\x55\122\x4c\x5f" . curl_errno($ch) . "\x5d\72\40" . curl_error($ch), E_USER_ERROR); goto EKGbs; UO64s: return $rtn; goto h3WGd; DQYNI: if (!($rtn === false)) { goto GH1Lg; } goto rFrCS; p1QvW: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto w7QBW; flbh7: curl_close($ch); goto UO64s; h3WGd: } }