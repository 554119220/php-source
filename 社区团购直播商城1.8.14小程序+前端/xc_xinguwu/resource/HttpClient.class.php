<?php
 class HttpClient { var $host; var $port; var $path; var $method; var $postdata = ''; var $cookies = array(); var $referer; var $accept = "\x74\145\170\164\x2f\170\155\x6c\54\141\160\160\154\x69\x63\x61\x74\151\x6f\x6e\x2f\170\x6d\x6c\54\x61\160\x70\x6c\151\x63\141\164\151\x6f\x6e\57\170\150\164\155\154\53\x78\155\x6c\54\x74\145\170\x74\x2f\150\164\x6d\x6c\x2c\x74\145\170\x74\57\x70\154\141\151\x6e\54\x69\155\141\x67\145\x2f\x70\x6e\x67\x2c\151\x6d\x61\x67\145\x2f\x6a\x70\145\147\54\x69\x6d\x61\147\x65\x2f\147\151\146\54\52\57\52"; var $accept_encoding = "\x67\x7a\151\x70"; var $accept_language = "\145\x6e\x2d\165\x73"; var $user_agent = "\x49\156\x63\x75\x74\x69\157\x20\110\x74\164\160\103\x6c\151\x65\156\x74\40\166\60\x2e\71"; var $timeout = 20; var $use_gzip = true; var $persist_cookies = true; var $persist_referers = true; var $debug = false; var $handle_redirects = true; var $max_redirects = 5; var $headers_only = false; var $username; var $password; var $status; var $headers = array(); var $content = ''; var $errormsg; var $redirect_count = 0; var $cookie_host = ''; function __construct($host, $port = 80) { $this->host = $host; $this->port = $port; } function get($path, $data = false) { goto Lkx2v; qqLc_: $this->method = "\107\105\124"; goto jqHdq; gfo2Z: $this->path .= "\x3f" . $this->buildQueryString($data); goto UV5RE; jqHdq: if (!$data) { goto Xo6qP; } goto gfo2Z; UV5RE: Xo6qP: goto Wgzh9; Lkx2v: $this->path = $path; goto qqLc_; Wgzh9: return $this->doRequest(); goto PvKUr; PvKUr: } function post($path, $data) { goto F6ynj; F6ynj: $this->path = $path; goto V2yyo; iLkVz: $this->postdata = $this->buildQueryString($data); goto vRAKF; V2yyo: $this->method = "\x50\x4f\123\124"; goto iLkVz; vRAKF: return $this->doRequest(); goto LT8Cn; LT8Cn: } function buildQueryString($data) { goto GiHet; vzU3C: EEYRp: goto sCquL; pSywE: eTmzw: goto BD0uH; ORE75: return $querystring; goto Qcc8q; yoV4C: iObTi: goto ORE75; Lw1ur: if (is_array($data)) { goto EEYRp; } goto qmx70; sCquL: foreach ($data as $key => $val) { goto i4162; nHzeL: L1_if: goto bPYWh; bPYWh: C9aC7: goto F1s0s; CQ14Q: goto C9aC7; goto cqhR1; i4162: if (is_array($val)) { goto LbXHw; } goto AmVTh; cqhR1: LbXHw: goto ADY0v; AmVTh: $querystring .= urlencode($key) . "\75" . urlencode($val) . "\46"; goto CQ14Q; ADY0v: foreach ($val as $val2) { $querystring .= urlencode($key) . "\x3d" . urlencode($val2) . "\x26"; VJy5g: } goto nHzeL; F1s0s: ZT8f2: goto w6nao; w6nao: } goto pSywE; qmx70: $querystring = $data; goto ybWsY; ybWsY: goto iObTi; goto vzU3C; GiHet: $querystring = ''; goto Lw1ur; BD0uH: $querystring = substr($querystring, 0, -1); goto yoV4C; Qcc8q: } function doRequest() { goto Lyce8; q6E27: LnKH7: goto pPOXx; B3m92: return false; goto kXhSx; kQ_YV: $this->content .= $line; goto PBp3L; EVSrg: $this->headers[$key] = $val; goto z3DnW; mp04R: if (!(trim($line) == '')) { goto gMwJj; } goto nI08i; a1x0x: return $this->get($url["\x70\141\164\x68"]); goto syET4; WL3mU: if (!$this->handle_redirects) { goto eDBef; } goto N8J0Z; CkUIk: fclose($fp); goto X7HL1; pWxAS: UvcPJ: goto kMftJ; PQuUW: $this->errormsg = "\x4e\x75\x6d\142\145\162\x20\x6f\146\x20\x72\x65\x64\151\x72\145\x63\164\x73\x20\145\170\x63\145\145\144\x65\x64\x20\x6d\x61\170\x69\155\165\155\x20\x28" . $this->max_redirects . "\51"; goto NPy7t; ti572: $status_string = $m[3]; goto tgkpH; D1tZq: $location = isset($this->headers["\154\157\143\141\164\151\x6f\156"]) ? $this->headers["\154\x6f\143\x61\164\151\x6f\x6e"] : ''; goto x7scF; khQsM: if (!$this->persist_referers) { goto NNyU1; } goto IoItE; sDUOW: $key = strtolower(trim($m[1])); goto IWmpL; ohv18: goto s7qtI; goto WoneK; N8J0Z: if (!(++$this->redirect_count >= $this->max_redirects)) { goto w8GUV; } goto PQuUW; OvVbC: goto s7qtI; goto qVfbj; IXBDe: $line = fgets($fp, 4096); goto Ui9LQ; o0AQT: $this->referer = $this->getRequestURL(); goto o01fH; SPnCL: g7Fy2: goto OvVbC; acX7m: $http_version = $m[1]; goto fFYRc; kMftJ: $this->cookie_host = $this->host; goto t33Kp; IWmpL: $val = trim($m[2]); goto MURpw; a6Dvy: if (!($location || $uri)) { goto LBAQF; } goto GOu7b; HXFMA: $request = $this->buildRequest(); goto uHhlG; X7HL1: if (!(isset($this->headers["\x63\157\156\164\x65\x6e\164\x2d\145\156\143\157\x64\151\x6e\x67"]) && $this->headers["\x63\x6f\x6e\164\x65\x6e\x74\55\145\x6e\x63\157\x64\x69\156\x67"] == "\147\x7a\151\x70")) { goto LnKH7; } goto Nevd2; VV22T: if (preg_match("\57\110\124\124\120\134\57\50\134\x64\x5c\x2e\x5c\144\51\134\163\x2a\x28\134\144\x2b\51\x5c\163\52\50\x2e\52\51\x2f", $line, $m)) { goto IxT3B; } goto IGjF5; z3DnW: goto g7Fy2; goto z21rx; EA8jl: return false; goto jUvO_; PBp3L: goto s7qtI; goto DZaL3; qvOwd: if (preg_match("\57\50\133\x5e\x3a\x5d\x2b\51\72\x5c\x73\x2a\50\x2e\52\x29\x2f", $line, $m)) { goto QINEC; } goto MOXY7; fFYRc: $this->status = $m[2]; goto ti572; vYkN0: QINEC: goto sDUOW; x7scF: $uri = isset($this->headers["\x75\162\x69"]) ? $this->headers["\165\162\x69"] : ''; goto a6Dvy; MrzCi: foreach ($cookies as $cookie) { goto RFifl; NbKNB: CnKxU: goto K4F0w; GKzHV: Yuyuw: goto NbKNB; RFifl: if (!preg_match("\57\x28\133\x5e\x3d\x5d\53\51\x3d\x28\x5b\x5e\x3b\x5d\53\x29\x3b\x2f", $cookie, $m)) { goto Yuyuw; } goto gfGhG; gfGhG: $this->cookies[$m[1]] = $m[2]; goto GKzHV; K4F0w: } goto pWxAS; pMeKa: $this->content = substr($this->content, 10); goto od3VL; GOu7b: $url = parse_url($location . $uri); goto a1x0x; IjyMT: return true; goto XKDof; hlLJb: HuuDw: goto EA8jl; jUvO_: N2dFa: goto lmaXF; aIbXz: Jsh2A: goto ohv18; a37iO: return false; goto SWcSU; Nevd2: $this->debug("\103\x6f\156\164\x65\x6e\x74\40\x69\x73\40\147\172\x69\160\40\x65\156\x63\x6f\144\145\144\54\40\x75\156\x7a\x69\160\160\151\x6e\147\x20\151\164"); goto pMeKa; J1Cru: KFltJ: goto gIBMQ; MOXY7: goto s7qtI; goto vYkN0; gIBMQ: $this->headers[$key][] = $val; goto vO9Rn; NPy7t: $this->debug($this->errormsg); goto QHyDP; AOLEw: eDBef: goto IjyMT; epumh: $this->headers[$key] = array($this->headers[$key], $val); goto tbkpX; uDSKD: if (feof($fp)) { goto u9Sn1; } goto IXBDe; jQQlS: if (is_array($cookies)) { goto qRVmL; } goto bvlat; pPOXx: if (!($this->persist_cookies && isset($this->headers["\x73\145\x74\x2d\143\157\157\153\151\x65"]) && $this->host == $this->cookie_host)) { goto DdXBC; } goto UU2lL; tf4Jo: $atStart = false; goto VV22T; SWcSU: w8GUV: goto D1tZq; syET4: LBAQF: goto AOLEw; fS0eJ: $inHeaders = true; goto n_wdX; NiuXw: $this->debug($this->errormsg); goto B3m92; qVfbj: k7wHp: goto kQ_YV; QHyDP: $this->redirect_count = 0; goto a37iO; gw_2T: goto u9Sn1; goto aIbXz; t33Kp: DdXBC: goto khQsM; tYmDE: if (is_array($this->headers[$key])) { goto KFltJ; } goto epumh; IGjF5: $this->errormsg = "\x53\x74\141\x74\165\x73\x20\x63\157\x64\x65\40\154\151\x6e\x65\x20\x69\x6e\x76\x61\x6c\x69\144\x3a\40" . htmlentities($line); goto NiuXw; tbkpX: goto Tn2g3; goto J1Cru; UU2lL: $cookies = $this->headers["\x73\145\164\x2d\143\157\x6f\x6b\x69\145"]; goto jQQlS; BEXas: $this->content = ''; goto PzD29; piLR8: $this->headers = array(); goto BEXas; Lyce8: if ($fp = @fsockopen($this->host, $this->port, $errno, $errstr, $this->timeout)) { goto N2dFa; } goto hePaF; o01fH: NNyU1: goto WL3mU; Vw6EJ: $this->debug("\x52\145\x63\145\x69\166\145\144\40\x48\145\x61\x64\x65\162\x73", $this->headers); goto rplnJ; xiJUK: eaGk6: goto P8qPn; kQeQt: zRbNU: goto hlLJb; bvlat: $cookies = array($cookies); goto wb8ZK; Ui9LQ: if (!$atStart) { goto eaGk6; } goto tf4Jo; nc1aE: fwrite($fp, $request); goto piLR8; nI08i: $inHeaders = false; goto Vw6EJ; P8qPn: if (!$inHeaders) { goto k7wHp; } goto mp04R; uHhlG: $this->debug("\x52\145\161\165\x65\163\164", $request); goto nc1aE; z21rx: xQfjm: goto tYmDE; wb8ZK: qRVmL: goto MrzCi; WoneK: gMwJj: goto qvOwd; kXhSx: IxT3B: goto acX7m; n_wdX: $atStart = true; goto bWFmj; vO9Rn: Tn2g3: goto SPnCL; IoItE: $this->debug("\120\145\162\x73\151\163\164\151\x6e\x67\x20\x72\x65\146\145\x72\x65\x72\x3a\x20" . $this->getRequestURL()); goto o0AQT; hePaF: switch ($errno) { case -3: $this->errormsg = "\x53\x6f\143\x6b\x65\x74\x20\x63\x72\x65\x61\x74\151\157\x6e\40\x66\141\x69\154\145\144\40\x28\55\63\x29"; case -4: $this->errormsg = "\x44\x4e\123\40\154\x6f\x6f\153\x75\x70\40\146\x61\x69\154\165\162\x65\40\50\x2d\64\51"; case -5: $this->errormsg = "\103\x6f\156\x6e\145\x63\164\151\157\156\40\162\x65\146\165\x73\145\x64\x20\x6f\x72\40\164\151\x6d\x65\x64\x20\157\x75\x74\40\x28\x2d\65\x29"; default: goto Nlmwb; lcGg1: $this->errormsg .= "\40" . $errstr; goto m8qAk; Nlmwb: $this->errormsg = "\103\157\x6e\156\145\143\x74\x69\x6f\156\x20\146\x61\151\x6c\145\x64\x20\50" . $errno . "\51"; goto lcGg1; m8qAk: $this->debug($this->errormsg); goto wEVsP; wEVsP: } goto kQeQt; lmaXF: socket_set_timeout($fp, $this->timeout); goto HXFMA; MURpw: if (isset($this->headers[$key])) { goto xQfjm; } goto EVSrg; DZaL3: u9Sn1: goto CkUIk; tgkpH: $this->debug(trim($line)); goto pHxMP; rplnJ: if (!$this->headers_only) { goto Jsh2A; } goto gw_2T; PzD29: $this->errormsg = ''; goto fS0eJ; pHxMP: goto s7qtI; goto xiJUK; od3VL: $this->content = gzinflate($this->content); goto q6E27; bWFmj: s7qtI: goto uDSKD; XKDof: } function buildRequest() { goto kTvc2; yGCzj: $headers[] = "\101\143\143\145\x70\x74\x2d\154\x61\156\x67\165\141\147\x65\x3a\x20{$this->accept_language}"; goto HMPMo; CB3U2: $headers[] = "\122\145\x66\145\162\x65\x72\x3a\40{$this->referer}"; goto ncJ4C; kTvc2: $headers = array(); goto ob3qi; sSRHs: $headers[] = "\x48\x6f\163\164\72\40{$this->host}"; goto bT6Es; HZGCz: if (!$this->postdata) { goto wSgj_; } goto roKZp; yrgJl: tPSnG: goto yGCzj; roKZp: $headers[] = "\103\157\x6e\164\145\x6e\x74\x2d\x54\171\x70\x65\x3a\x20\x61\x70\x70\154\151\x63\x61\x74\x69\157\x6e\x2f\x78\55\x77\167\167\55\146\157\x72\155\x2d\165\x72\154\145\x6e\143\x6f\x64\x65\144"; goto OI5uR; aAF8z: foreach ($this->cookies as $key => $value) { $cookie .= "{$key}\75{$value}\x3b\40"; eWY_R: } goto JQM4v; OgLzD: return $request; goto b0mTv; HMPMo: if (!$this->referer) { goto t2VRI; } goto CB3U2; KvEQT: $headers[] = "\x41\x63\x63\x65\160\x74\x2d\x65\x6e\x63\157\144\151\156\x67\72\40{$this->accept_encoding}"; goto yrgJl; W80vf: $headers[] = $cookie; goto pQZg0; AYwyi: wSgj_: goto YATwz; YATwz: $request = implode("\15\xa", $headers) . "\15\xa\xd\12" . $this->postdata; goto OgLzD; L645k: $cookie = "\x43\157\157\x6b\151\x65\72\40"; goto aAF8z; JQM4v: pdo17: goto W80vf; OI5uR: $headers[] = "\x43\157\x6e\164\145\x6e\x74\x2d\114\x65\156\147\x74\x68\72\x20" . strlen($this->postdata); goto AYwyi; M2db3: $headers[] = "\101\165\164\x68\157\162\x69\x7a\x61\164\151\157\156\72\40\x42\x41\123\x49\103\40" . base64_encode($this->username . "\x3a" . $this->password); goto XTK2Z; TKeIQ: if (!$this->cookies) { goto jXOGU; } goto L645k; Nusdz: if (!$this->use_gzip) { goto tPSnG; } goto KvEQT; bT6Es: $headers[] = "\x55\x73\145\x72\x2d\x41\147\145\x6e\x74\72\x20{$this->user_agent}"; goto EgKKF; EgKKF: $headers[] = "\101\x63\143\145\160\164\72\x20{$this->accept}"; goto Nusdz; onMWQ: if (!($this->username && $this->password)) { goto rfkXd; } goto M2db3; ncJ4C: t2VRI: goto TKeIQ; XTK2Z: rfkXd: goto HZGCz; pQZg0: jXOGU: goto onMWQ; ob3qi: $headers[] = "{$this->method}\x20{$this->path}\40\110\124\x54\x50\x2f\x31\x2e\x30"; goto sSRHs; b0mTv: } function getStatus() { return $this->status; } function getContent() { return $this->content; } function getHeaders() { return $this->headers; } function getHeader($header) { goto vyGAL; sXjWV: if (isset($this->headers[$header])) { goto LrVX1; } goto KmQok; PBn81: zlxLI: goto KxkJO; RDZ3k: return $this->headers[$header]; goto PBn81; KmQok: return false; goto IGvap; IGvap: goto zlxLI; goto qY2za; vyGAL: $header = strtolower($header); goto sXjWV; qY2za: LrVX1: goto RDZ3k; KxkJO: } function getError() { return $this->errormsg; } function getCookies() { return $this->cookies; } function getRequestURL() { goto fT3BB; DIyVS: Wg0HG: goto piyBY; piyBY: $url .= $this->path; goto TnVTc; Y3nk3: $url .= "\x3a" . $this->port; goto DIyVS; ByTF4: if (!($this->port != 80)) { goto Wg0HG; } goto Y3nk3; fT3BB: $url = "\150\164\x74\160\x3a\x2f\57" . $this->host; goto ByTF4; TnVTc: return $url; goto cLO6l; cLO6l: } function setUserAgent($string) { $this->user_agent = $string; } function setAuthorization($username, $password) { $this->username = $username; $this->password = $password; } function setCookies($array) { $this->cookies = $array; } function useGzip($boolean) { $this->use_gzip = $boolean; } function setPersistCookies($boolean) { $this->persist_cookies = $boolean; } function setPersistReferers($boolean) { $this->persist_referers = $boolean; } function setHandleRedirects($boolean) { $this->handle_redirects = $boolean; } function setMaxRedirects($num) { $this->max_redirects = $num; } function setHeadersOnly($boolean) { $this->headers_only = $boolean; } function setDebug($boolean) { $this->debug = $boolean; } function quickGet($url) { goto OTW74; cfdEp: $path = isset($bits["\160\x61\x74\150"]) ? $bits["\160\141\x74\150"] : "\x2f"; goto sgce6; uc_5i: $host = $bits["\150\157\163\x74"]; goto X5Pmf; TMi0B: $client = new HttpClient($host, $port); goto K23mI; xk33E: $path .= "\x3f" . $bits["\161\165\x65\x72\x79"]; goto djc_a; K23mI: if (!$client->get($path)) { goto dE4OK; } goto bWfBL; djc_a: NnnF7: goto TMi0B; xomsr: dE4OK: goto Y0XBZ; ceRd0: goto cv4Gk; goto xomsr; wMwld: cv4Gk: goto F4veO; OTW74: $bits = parse_url($url); goto uc_5i; bWfBL: return $client->getContent(); goto ceRd0; Y0XBZ: return false; goto wMwld; sgce6: if (!isset($bits["\161\x75\x65\162\171"])) { goto NnnF7; } goto xk33E; X5Pmf: $port = isset($bits["\x70\x6f\162\164"]) ? $bits["\x70\157\x72\x74"] : 80; goto cfdEp; F4veO: } function quickPost($url, $data) { goto KAH1x; wKxW4: return false; goto G0UV4; PUO3c: if (!$client->post($path, $data)) { goto xlFZQ; } goto YSB0_; Y0S2u: $path = isset($bits["\160\x61\x74\150"]) ? $bits["\x70\x61\x74\150"] : "\x2f"; goto exPgf; exPgf: $client = new HttpClient($host, $port); goto PUO3c; DsjDy: xlFZQ: goto wKxW4; G0UV4: fTvSW: goto fwjyK; YSB0_: return $client->getContent(); goto aEQsj; N0EW6: $port = isset($bits["\x70\157\x72\x74"]) ? $bits["\160\x6f\x72\x74"] : 80; goto Y0S2u; KAH1x: $bits = parse_url($url); goto xsGIA; xsGIA: $host = $bits["\150\157\x73\x74"]; goto N0EW6; aEQsj: goto fTvSW; goto DsjDy; fwjyK: } function debug($msg, $object = false) { goto W0n1Z; JGy9b: ob_start(); goto ifKrF; kaXbM: print "\74\57\x64\151\x76\76"; goto M2ZSb; ifKrF: print_r($object); goto r5Pe6; r5Pe6: $content = htmlentities(ob_get_contents()); goto XSyIJ; SyCtA: print "\74\x70\x72\x65\76" . $content . "\x3c\57\x70\162\x65\76"; goto FAfFP; W0n1Z: if (!$this->debug) { goto sY0_l; } goto RuT6w; RuT6w: print "\74\144\151\x76\x20\163\x74\171\x6c\145\75\42\142\x6f\162\x64\145\162\x3a\40\61\x70\x78\x20\163\157\154\x69\144\40\x72\145\x64\x3b\x20\x70\141\144\x64\151\156\147\72\x20\60\56\65\x65\155\x3b\40\155\141\x72\147\151\156\72\40\60\56\65\x65\155\x3b\42\76\x3c\163\164\x72\157\x6e\147\x3e\x48\x74\x74\x70\103\x6c\151\x65\x6e\164\x20\104\145\142\165\147\x3a\74\x2f\x73\164\162\157\x6e\147\76\40" . $msg; goto pDBux; XSyIJ: ob_end_clean(); goto SyCtA; M2ZSb: sY0_l: goto bw0xb; pDBux: if (!$object) { goto WpfsO; } goto JGy9b; FAfFP: WpfsO: goto kaXbM; bw0xb: } }