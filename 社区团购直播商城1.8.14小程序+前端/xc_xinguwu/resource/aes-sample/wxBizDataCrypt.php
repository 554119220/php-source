<?php
 class ErrorCode { public static $OK = 0; public static $IllegalAesKey = -41001; public static $IllegalIv = -41002; public static $IllegalBuffer = -41003; public static $DecodeBase64Error = -41004; } class WXBizDataCrypt { private $appid; private $sessionKey; public function __construct($appid, $sessionKey) { $this->sessionKey = $sessionKey; $this->appid = $appid; } public function decryptData($encryptedData, $iv, &$data) { goto kfBfw; hjgJH: L1s_O: goto vF9Pb; UEq0p: return ErrorCode::$IllegalBuffer; goto ebUPL; a5RVi: if (!($dataObj->watermark->appid != $this->appid)) { goto L1s_O; } goto KRHLH; HGaQe: return ErrorCode::$IllegalAesKey; goto QY0np; kfBfw: if (!(strlen($this->sessionKey) != 24)) { goto LmW0W; } goto HGaQe; cXj38: return ErrorCode::$IllegalIv; goto EKf5B; alOzX: return ErrorCode::$OK; goto VIoCf; vF9Pb: $data = $result; goto alOzX; ebUPL: FyY44: goto a5RVi; xhZ_d: $aesCipher = base64_decode($encryptedData); goto rtmF4; KRHLH: return ErrorCode::$IllegalBuffer; goto hjgJH; V6Loh: $aesKey = base64_decode($this->sessionKey); goto bR1O5; QY0np: LmW0W: goto V6Loh; K6KOw: if (!($dataObj == NULL)) { goto FyY44; } goto UEq0p; bR1O5: if (!(strlen($iv) != 24)) { goto aiE2p; } goto cXj38; EKf5B: aiE2p: goto qACUP; KVoiS: $dataObj = json_decode($result); goto K6KOw; qACUP: $aesIV = base64_decode($iv); goto xhZ_d; rtmF4: $result = openssl_decrypt($aesCipher, "\101\105\x53\55\x31\x32\70\x2d\103\x42\103", $aesKey, 1, $aesIV); goto KVoiS; VIoCf: } }