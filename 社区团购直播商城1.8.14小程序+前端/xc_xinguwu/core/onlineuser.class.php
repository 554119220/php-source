<?php
 class onlineuser { private $liveid; private $xcmodule; private $htdata; public function __construct($liveid, $xcmodule) { goto N4KRr; iKysr: $this->xcmodule = $xcmodule; goto E6KHG; N4KRr: $this->liveid = $liveid; goto iKysr; E6KHG: $this->htdata = $this->getdata(); goto UeLFS; UeLFS: } private function getdata() { goto BeM6s; E1PJf: $_htdata["\x6e\x75\x6d"] = 0; goto QfaHO; QfaHO: yVQ0b: goto gGsnH; hVxje: $_htdata["\144\141\x74\x61"] = array(); goto E1PJf; YKg5T: $_htdata["\x75\160\x64\141\164\x65\164\151\x6d\x65"] = time(); goto hVxje; gGsnH: return $_htdata; goto Z39E3; snNNs: if (!empty($_htdata)) { goto yVQ0b; } goto YKg5T; BeM6s: $_htdata = cache_load($this->xcmodule . "\137\x6c\x69\x76\145\x5f\165\x73\145\x72\x5f" . $this->liveid); goto snNNs; Z39E3: } private function savedata() { goto LiobK; Fu5dT: xRkJ_: goto kjD4f; vWmTr: cache_write($this->xcmodule . "\x5f\x6c\x69\x76\145\x5f\x75\x73\145\x72\x5f" . $this->liveid, $this->htdata); goto rAQBS; rAQBS: goto mUYcz; goto Fu5dT; kjD4f: $this->htdata["\x75\x70\144\x61\x74\145\x74\x69\x6d\x65"] = time(); goto lNCS7; JoBvq: mUYcz: goto yP2O0; LiobK: if (time() - $this->htdata["\165\160\144\141\164\x65\164\151\x6d\145"] >= 60) { goto xRkJ_; } goto vWmTr; lNCS7: $this->updatenum(); goto JoBvq; yP2O0: } private function updatenum() { goto pzVP6; jdCY6: $strwhere["\x69\163\x70\154\x61\171"] = 1; goto cmq6A; DsjUr: $strwhere["\x69\x64"] = $this->liveid; goto jdCY6; wEXYK: $strwhere = array(); goto DsjUr; X79zl: $this->htdata["\165\160\x64\x61\164\145\164\151\155\145"] = time(); goto ksBoQ; cmq6A: pdo_update($this->xcmodule . "\137\154\151\166\x65", $savemodel, $strwhere); goto pvsDt; shahv: $savemodel = array("\x6e\x75\155\142\x65\162" => $totlanum); goto wEXYK; ksBoQ: UfghV: goto Mntod; J0ZDE: foreach ($this->htdata["\x64\x61\x74\141"] as $key => $val) { goto r6Lfm; uHfPL: eo7jZ: goto Snitz; Snitz: $delkey[] = $key; goto HUBmW; HUBmW: MUzyQ: goto FJzyX; T6odH: goto MUzyQ; goto uHfPL; r6Lfm: if ($ptime - $val > 300) { goto eo7jZ; } goto vh02x; vh02x: $totlanum++; goto T6odH; FJzyX: p3BQr: goto kkW4b; kkW4b: } goto L6Uvf; Mntod: $this->htdata["\156\165\155"] = $totlanum; goto BEOIk; Rvc_m: foreach ($delkey as $item) { goto G5Sey; CdmQS: Mnlwn: goto yU26k; q2mIW: unset($this->htdata["\x64\x61\x74\x61"][$delkey]); goto CdmQS; G5Sey: if (!array_key_exists($item, $this->htdata["\x64\x61\x74\141"])) { goto Mnlwn; } goto q2mIW; yU26k: POoBE: goto IAGkQ; IAGkQ: } goto EkJmg; pzVP6: $ptime = time(); goto uoUkZ; TRD_s: $totlanum = 0; goto J0ZDE; EkJmg: Q2dOz: goto X79zl; BEOIk: cache_write($this->xcmodule . "\x5f\x6c\151\x76\x65\137\165\163\x65\x72\x5f" . $this->liveid, $this->htdata); goto shahv; Q_6tg: if (empty($delkey)) { goto UfghV; } goto Rvc_m; L6Uvf: NJDCB: goto Q_6tg; uoUkZ: $delkey = array(); goto TRD_s; pvsDt: } function updateuser($uid) { goto kqdeF; CN7T0: return $this->htdata["\x64\141\x74\x61"]["\x6e\x75\155"]; goto fjhgI; IH5cc: $this->htdata["\x64\x61\164\141"][$uid] = time(); goto i5z6D; or0Ng: $this->htdata["\x64\141\164\x61"]["\156\165\155"] = $this->htdata["\x64\x61\164\x61"]["\x6e\x75\x6d"] + 1; goto jI2fW; kqdeF: if (!(array_key_exists($uid, $this->htdata["\x64\x61\x74\141"]) == false)) { goto QNtVu; } goto or0Ng; jI2fW: QNtVu: goto IH5cc; i5z6D: $this->savedata(); goto CN7T0; fjhgI: } function removeuser($uid) { goto PUyJw; OGeHp: $this->htdata["\144\x61\164\141"]["\156\165\155"] = $this->htdata["\144\141\x74\141"]["\x6e\165\x6d"] - 1; goto Iy4X9; Iy4X9: Z43kS: goto tWdy7; PUyJw: if (!array_key_exists($uid, $this->htdata["\144\141\x74\141"])) { goto Z43kS; } goto rqcF_; tWdy7: return $this->htdata["\x64\141\x74\141"]["\156\x75\155"]; goto nsbi8; rqcF_: unset($this->htdata["\x64\x61\164\x61"][$uid]); goto LsxdI; LsxdI: $this->savedata(); goto OGeHp; nsbi8: } function close() { goto oKFn8; OE6hc: pdo_update($this->xcmodule . "\x5f\x6c\151\x76\145", $savemodel, $strwhere); goto Zn4JZ; xcXWm: $strwhere["\151\144"] = $this->liveid; goto bKr66; oKFn8: cache_delete($this->xcmodule . "\x5f\154\x69\166\145\x5f\x75\163\145\162\x5f" . $this->liveid); goto Jqsy4; Jqsy4: $strwhere = array(); goto xcXWm; bKr66: $savemodel = array("\156\x75\155\142\x65\x72" => 0); goto OE6hc; Zn4JZ: } }