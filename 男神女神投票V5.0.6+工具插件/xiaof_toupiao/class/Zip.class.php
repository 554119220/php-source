<?php
 class Zip { private $ctrl_dir = array(); private $datasec = array(); var $fileList = array(); public function visitFile($path) { goto t2LZi; EyRw5: $path = str_replace("\134", "\x2f", $path); goto nWoHb; XO4wV: $pathSub = preg_replace("\x2a\x2f\173\x32\54\x7d\x2a", "\57", $path . "\57" . $file); goto qiw_N; ALC9q: goto qgCYA; goto s1FEU; t2LZi: global $fileList; goto EyRw5; e4O64: W_CMH: goto XO4wV; qiw_N: $fileList[] = is_dir($pathSub) ? $pathSub . "\x2f" : $pathSub; goto t9EhU; l5ARJ: goto qgCYA; goto e4O64; NE91a: $this->visitFile($pathSub); goto ODQTU; nWoHb: $fdir = dir($path); goto yTVsG; rgeE2: $fdir->close(); goto aQdcI; ODQTU: XasgI: goto ALC9q; aQdcI: return $fileList; goto JivPg; yTVsG: qgCYA: goto u5_W1; t9EhU: if (!is_dir($pathSub)) { goto XasgI; } goto NE91a; oa2LY: if (!($file == "\56" || $file == "\56\x2e")) { goto W_CMH; } goto l5ARJ; s1FEU: VjL2V: goto rgeE2; u5_W1: if (!(($file = $fdir->read()) !== false)) { goto VjL2V; } goto oa2LY; JivPg: } private function unix2DosTime($unixtime = 0) { goto Qa1TQ; Qa1TQ: $timearray = $unixtime == 0 ? getdate() : getdate($unixtime); goto yP_gO; KifbA: $timearray["\x79\x65\141\x72"] = 1980; goto s_taR; qEen1: $timearray["\x73\x65\x63\157\x6e\x64\x73"] = 0; goto U_8Qe; CUq04: $timearray["\x6d\x69\156\x75\x74\145\163"] = 0; goto qEen1; s_taR: $timearray["\x6d\x6f\x6e"] = 1; goto v70bt; yP_gO: if (!($timearray["\x79\x65\x61\162"] < 1980)) { goto goNb5; } goto KifbA; U_8Qe: goNb5: goto i51_E; v70bt: $timearray["\x6d\x64\141\x79"] = 1; goto cGXxd; i51_E: return $timearray["\171\x65\x61\x72"] - 1980 << 25 | $timearray["\155\157\x6e"] << 21 | $timearray["\155\144\141\171"] << 16 | $timearray["\x68\x6f\x75\162\163"] << 11 | $timearray["\x6d\x69\x6e\165\x74\x65\x73"] << 5 | $timearray["\x73\145\143\x6f\156\x64\163"] >> 1; goto sCaX0; cGXxd: $timearray["\150\x6f\165\162\x73"] = 0; goto CUq04; sCaX0: } var $old_offset = 0; private function addFile($data, $filename, $time = 0) { goto zDPI8; V2zKo: $this->ctrl_dir[] = $cdrec; goto OUKSH; SOSUl: $fr .= pack("\x56", $c_len); goto affbc; zgqCK: $this->datasec[] = $fr; goto HyWgu; Nuvrt: $zdata = gzcompress($data); goto bNyoT; cM4pb: $cdrec .= pack("\x76", 0); goto iqasX; zDPI8: $filename = str_replace("\134", "\57", $filename); goto x1sY_; iqasX: $cdrec .= pack("\x76", 0); goto DrvVR; DrvVR: $cdrec .= pack("\166", 0); goto SL1nu; HyWgu: $new_offset = strlen(implode('', $this->datasec)); goto GKAit; kpuf9: $fr .= pack("\x56", $crc); goto SOSUl; qG_fr: $cdrec .= pack("\x76", 0); goto cM4pb; E0xmx: $cdrec .= pack("\x56", $unc_len); goto L4NH2; YijSs: $cdrec .= "\0\x0"; goto JWnBH; ecv75: $fr .= pack("\166", 0); goto gwIm8; x1sY_: $dtime = dechex($this->unix2DosTime($time)); goto WyWga; JWnBH: $cdrec .= "\x14\0"; goto isC8v; WoUaI: $this->old_offset = $new_offset; goto PYU_9; SL1nu: $cdrec .= pack("\126", 32); goto ljVpf; MjCc6: $cdrec .= pack("\x56", $c_len); goto E0xmx; JBISH: $unc_len = strlen($data); goto XdNk1; isC8v: $cdrec .= "\x0\0"; goto uDV7k; PYU_9: $cdrec .= $filename; goto V2zKo; uDV7k: $cdrec .= "\x8\x0"; goto TQUKq; XCJRs: $fr .= "\x14\0"; goto X3CML; Sq3Yw: $zdata = substr(substr($zdata, 0, strlen($zdata) - 4), 2); goto kpuf9; L4NH2: $cdrec .= pack("\x76", strlen($filename)); goto qG_fr; GKAit: $cdrec = "\x50\x4b\1\2"; goto YijSs; R7LXF: $fr .= pack("\126", $c_len); goto ETngC; gwIm8: $fr .= $filename; goto kJeBG; dmaVz: eval("\44\150\145\x78\x64\164\151\155\x65\40\75\x20\x22" . $hexdtime . "\x22\x3b"); goto eXwbK; affbc: $fr .= pack("\126", $unc_len); goto CjJJj; X3CML: $fr .= "\x0\x0"; goto Ih3d6; eXwbK: $fr = "\120\113\x3\4"; goto XCJRs; kJeBG: $fr .= $zdata; goto IqDdT; XdNk1: $crc = crc32($data); goto Nuvrt; CjJJj: $fr .= pack("\x76", strlen($filename)); goto ecv75; ETngC: $fr .= pack("\x56", $unc_len); goto zgqCK; TQUKq: $cdrec .= $hexdtime; goto Z_34G; Z_34G: $cdrec .= pack("\x56", $crc); goto MjCc6; Ih3d6: $fr .= "\x8\x0"; goto eagux; IqDdT: $fr .= pack("\126", $crc); goto R7LXF; bNyoT: $c_len = strlen($zdata); goto Sq3Yw; WyWga: $hexdtime = "\134\x78" . $dtime[6] . $dtime[7] . "\134\x78" . $dtime[4] . $dtime[5] . "\134\x78" . $dtime[2] . $dtime[3] . "\134\x78" . $dtime[0] . $dtime[1]; goto dmaVz; ljVpf: $cdrec .= pack("\126", $this->old_offset); goto WoUaI; eagux: $fr .= $hexdtime; goto JBISH; OUKSH: } var $eof_ctrl_dir = "\x50\x4b\5\6\x0\0\0\x0"; private function file() { goto jUHVT; rh7Mp: $ctrldir = implode('', $this->ctrl_dir); goto vNFd4; jUHVT: $data = implode('', $this->datasec); goto rh7Mp; vNFd4: return $data . $ctrldir . $this->eof_ctrl_dir . pack("\x76", sizeof($this->ctrl_dir)) . pack("\166", sizeof($this->ctrl_dir)) . pack("\126", strlen($ctrldir)) . pack("\x56", strlen($data)) . "\0\x0"; goto QS77h; QS77h: } public function compress($dir, $saveName) { goto LAqZq; LAqZq: if (!@(!function_exists("\x67\x7a\x63\157\155\x70\162\145\163\x73"))) { goto aTLoZ; } goto ySWoj; DEx1y: fclose($fp); goto Uehvc; ePco4: return; goto fpr9w; qVUTY: foreach ($filelist as $file) { goto NX7k2; LkxwJ: p3tb1: goto v52c4; Fhxa9: if (!(substr($file, 0, 1) == "\x5c" || substr($file, 0, 1) == "\x2f")) { goto Y_ZOO; } goto gDzKQ; oFi7r: $file = substr($file, strlen($dir)); goto Fhxa9; gDzKQ: $file = substr($file, 1); goto jBCMC; NX7k2: if (!(!file_exists($file) || !is_file($file))) { goto p3tb1; } goto TNr23; dF4vX: gK0ix: goto kOJj2; v52c4: $fd = fopen($file, "\x72\x62"); goto O2jB5; jBCMC: Y_ZOO: goto aqOB_; O2jB5: $content = @fread($fd, filesize($file)); goto CQiRQ; TNr23: goto gK0ix; goto LkxwJ; CQiRQ: fclose($fd); goto oFi7r; aqOB_: $this->addFile($content, $file); goto dF4vX; kOJj2: } goto y1K8M; fpr9w: BR_m8: goto qVUTY; ubUO0: if (!(count($filelist) == 0)) { goto BR_m8; } goto ePco4; H8jFM: $fp = fopen($saveName, "\x77\x62"); goto dUrr0; y1K8M: j_olk: goto yVI_v; yVI_v: $out = $this->file(); goto H8jFM; dUrr0: fwrite($fp, $out, strlen($out)); goto DEx1y; gUUmN: aTLoZ: goto azaAK; ySWoj: return; goto gUUmN; azaAK: $filelist = $this->visitFile($dir); goto ubUO0; Uehvc: } public function compress2download($dir, $saveName) { goto IK7nc; URAd6: foreach ($filelist as $file) { goto GYe3S; B0_kI: $content = @fread($fd, filesize($file)); goto VKc0Z; IfCy_: KViFB: goto rQAx7; tfaSH: $file = substr($file, 1); goto iiCie; iiCie: TF_MN: goto xEthI; VKc0Z: fclose($fd); goto GhkhQ; rQAx7: $fd = fopen($file, "\x72\x62"); goto B0_kI; GYe3S: if (!(!file_exists($file) || !is_file($file))) { goto KViFB; } goto onTcE; GhkhQ: $file = substr($file, strlen($dir)); goto r_rLN; r_rLN: if (!(substr($file, 0, 1) == "\x5c" || substr($file, 0, 1) == "\x2f")) { goto TF_MN; } goto tfaSH; xEthI: $this->addFile($content, $file); goto rb8P_; onTcE: goto RZlnR; goto IfCy_; rb8P_: RZlnR: goto mSYXD; mSYXD: } goto c3KJe; ta38t: @header("\x43\x6f\156\x74\145\156\164\x2d\x44\x69\x73\x70\157\x73\151\164\151\157\x6e\72\x20\141\164\x74\x61\143\150\155\145\x6e\x74\40\73\x20\146\151\x6c\145\x6e\141\x6d\145\x3d" . $saveName); goto qNXGe; vjfLa: vzr8C: goto URAd6; e9cG0: l25Cg: goto hJ0Nk; gpXog: @header("\x43\157\x6e\164\145\x6e\164\x2d\x45\x6e\143\x6f\x64\151\x6e\x67\72\40\x6e\x6f\x6e\x65"); goto iVBwo; WNEu3: $filelist = $this->visitFile($dir); goto Ad5l_; c3KJe: dqrDh: goto FwMOr; Hjij4: @header("\x45\x78\160\151\x72\145\x73\x3a\40\x30"); goto lO5qV; TaCnH: return; goto vjfLa; lO5qV: print $out; goto AqX2F; hJ0Nk: ob_end_clean(); goto WNEu3; Ad5l_: if (!(count($filelist) == 0)) { goto vzr8C; } goto TaCnH; IK7nc: if (!@(!function_exists("\x67\172\143\157\x6d\160\162\145\163\163"))) { goto l25Cg; } goto MM66g; FwMOr: $out = $this->file(); goto gpXog; qNXGe: @header("\120\162\x61\147\x6d\x61\72\40\x6e\x6f\x2d\x63\x61\x63\150\145"); goto Hjij4; MM66g: return; goto e9cG0; iVBwo: @header("\103\x6f\156\164\145\x6e\164\x2d\124\x79\160\x65\72\x20\141\160\160\x6c\151\x63\141\x74\x69\157\x6e\57\172\x69\x70"); goto ta38t; AqX2F: } private function ReadCentralDir($zip, $zipfile) { goto xvY5k; aoAy2: $centd["\144\x69\x73\153\137\163\x74\141\x72\x74"] = $data["\x64\x69\x73\x6b\x5f\163\x74\x61\162\x74"]; goto yYWpS; L4RH9: if (!($bytes == 0x504b0506)) { goto cb4wP; } goto aBYfA; aBYfA: goto CRKvV; goto bQMFl; tHZg2: if (!($pos < $size)) { goto CRKvV; } goto fHlwW; h_8uV: $max_size = $size < 277 ? $size : 277; goto ne806; LsnWD: $bytes = $bytes << 8 | Ord($byte); goto LDTVY; ne806: @fseek($zip, $size - $max_size); goto I79r3; I79r3: $pos = ftell($zip); goto YJuzE; yYWpS: $centd["\x73\151\x7a\145"] = $data["\163\x69\x7a\x65"]; goto z_mW3; KMU7X: goto gMwd7; goto Jl05V; ztBXz: $centd["\143\x6f\155\x6d\145\156\164"] = $data["\x63\157\x6d\155\145\156\164\137\163\x69\172\x65"] != 0 ? fread($zip, $data["\x63\x6f\155\155\x65\x6e\x74\x5f\163\x69\172\145"]) : ''; goto UOYqg; Cc51N: $centd["\x64\x69\163\153\x5f\x65\x6e\164\162\x69\x65\163"] = $data["\144\151\x73\153\x5f\x65\x6e\x74\x72\151\145\163"]; goto aCaFl; gWfT0: gMwd7: goto tHZg2; kWX5D: return $centd; goto ZThE3; LDTVY: $pos++; goto L4RH9; aCaFl: $centd["\x6f\x66\146\163\145\164"] = $data["\x6f\x66\146\163\145\164"]; goto aoAy2; bQMFl: cb4wP: goto KMU7X; xvY5k: $size = filesize($zipfile); goto h_8uV; yDQrY: $data = unpack("\166\x64\151\163\153\57\x76\144\x69\163\153\x5f\x73\164\x61\x72\x74\57\166\144\x69\x73\153\137\145\156\x74\162\x69\x65\163\x2f\166\145\x6e\x74\x72\151\145\163\57\x56\x73\151\x7a\145\57\126\x6f\x66\x66\x73\145\x74\57\166\143\157\x6d\x6d\145\156\x74\x5f\163\151\x7a\145", fread($zip, 18)); goto ztBXz; UOYqg: $centd["\x65\x6e\164\162\x69\145\x73"] = $data["\145\x6e\x74\x72\151\x65\163"]; goto Cc51N; YJuzE: $bytes = 0x0; goto gWfT0; fHlwW: $byte = @fread($zip, 1); goto LsnWD; Jl05V: CRKvV: goto yDQrY; z_mW3: $centd["\144\151\163\153"] = $data["\x64\x69\x73\153"]; goto kWX5D; ZThE3: } private function ReadCentralFileHeaders($zip) { goto y3fKY; xHQ0m: scUsN: goto dw84C; dw84C: $header["\x73\164\x6f\162\145\x64\x5f\146\x69\x6c\x65\156\141\x6d\x65"] = $header["\x66\x69\154\x65\x6e\x61\155\x65"]; goto GxFDe; fUvpF: $header = unpack("\166\x63\150\153\151\x64\57\x76\x69\x64\57\166\166\145\x72\x73\x69\157\x6e\57\x76\166\145\x72\x73\x69\157\156\x5f\145\170\x74\162\x61\x63\x74\145\144\x2f\166\146\x6c\141\147\57\166\143\x6f\155\160\162\x65\163\x73\151\157\156\x2f\166\155\x74\x69\155\145\57\166\x6d\144\141\x74\145\57\126\143\162\x63\x2f\126\143\x6f\155\160\x72\x65\163\163\145\x64\x5f\x73\x69\172\x65\57\x56\x73\x69\172\145\x2f\x76\x66\151\x6c\145\x6e\141\x6d\x65\137\x6c\145\156\57\x76\x65\x78\x74\x72\141\137\154\x65\x6e\57\x76\143\157\x6d\x6d\145\x6e\164\137\154\145\156\57\166\x64\x69\163\153\57\x76\x69\x6e\x74\x65\x72\x6e\141\x6c\x2f\126\145\x78\164\x65\x72\156\x61\154\57\x56\x6f\x66\146\163\x65\164", $binary_data); goto TPKud; d2pCk: $seconde = ($header["\x6d\x74\x69\155\x65"] & 0x1f) * 2; goto Z2zU4; Mx6WP: JpVQY: goto asqTk; asqTk: return $header; goto petga; u2HA2: $day = $header["\x6d\144\x61\x74\x65"] & 0x1f; goto Oo68t; TPKud: $header["\146\151\154\x65\x6e\x61\x6d\x65"] = $header["\x66\x69\x6c\x65\156\141\155\145\x5f\154\145\156"] != 0 ? fread($zip, $header["\146\151\154\145\x6e\141\x6d\145\137\x6c\x65\156"]) : ''; goto eptSE; y3fKY: $binary_data = fread($zip, 46); goto fUvpF; b2Frf: if (!(substr($header["\146\x69\154\145\156\x61\x6d\145"], -1) == "\x2f")) { goto JpVQY; } goto NT4uo; Omi5g: $header["\x63\x6f\155\155\145\156\164"] = $header["\143\x6f\155\155\145\156\x74\137\x6c\145\156"] != 0 ? fread($zip, $header["\x63\157\155\x6d\145\156\x74\137\x6c\x65\156"]) : ''; goto sL17S; NT4uo: $header["\x65\170\x74\145\162\x6e\141\154"] = 0x41ff0010; goto Mx6WP; GxFDe: $header["\163\164\141\164\x75\x73"] = "\x6f\x6b"; goto b2Frf; X6aov: $header["\155\x74\x69\155\145"] = time(); goto Y98gR; yd1Qh: $minute = ($header["\x6d\164\151\155\145"] & 0x7e0) >> 5; goto d2pCk; QGQ7m: $month = ($header["\x6d\x64\x61\x74\x65"] & 0x1e0) >> 5; goto u2HA2; Y98gR: goto scUsN; goto UzwXm; Oo68t: $header["\155\x74\151\x6d\x65"] = mktime($hour, $minute, $seconde, $month, $day, $year); goto xHQ0m; UzwXm: iEcn_: goto dwCBp; dwCBp: $hour = ($header["\x6d\164\x69\155\x65"] & 0xf800) >> 11; goto yd1Qh; Z2zU4: $year = (($header["\155\144\x61\164\145"] & 0xfe00) >> 9) + 1980; goto QGQ7m; eptSE: $header["\x65\x78\x74\162\x61"] = $header["\145\170\x74\162\x61\137\154\145\x6e"] != 0 ? fread($zip, $header["\x65\x78\x74\x72\x61\x5f\154\145\156"]) : ''; goto Omi5g; sL17S: if ($header["\155\144\141\164\x65"] && $header["\x6d\164\151\x6d\145"]) { goto iEcn_; } goto X6aov; petga: } private function ReadFileHeader($zip) { goto SYshW; Ewg9q: $header["\x66\154\141\x67"] = $data["\146\154\141\147"]; goto gmrua; SYshW: $binary_data = fread($zip, 30); goto tNPIC; iL03d: $year = (($header["\155\x64\141\164\145"] & 0xfe00) >> 9) + 1980; goto gOMry; ND2o8: $header["\x73\x69\x7a\145"] = $data["\x73\x69\x7a\x65"]; goto dH6LL; ru4p3: Pcu1c: goto quq4X; jjHcR: $header["\155\164\151\155\x65"] = mktime($hour, $minute, $seconde, $month, $day, $year); goto ru4p3; R8edu: $header["\x63\162\x63"] = $data["\143\162\x63"]; goto Ewg9q; tNPIC: $data = unpack("\x76\x63\x68\x6b\x2f\166\151\x64\57\166\x76\x65\162\x73\151\157\156\x2f\166\146\x6c\141\x67\57\x76\x63\x6f\x6d\160\x72\145\x73\163\151\x6f\156\57\166\x6d\x74\151\155\145\x2f\x76\155\144\141\x74\145\57\126\143\162\x63\x2f\x56\x63\x6f\x6d\x70\162\145\x73\163\145\x64\x5f\163\151\x7a\x65\57\x56\163\x69\172\145\57\166\x66\151\154\145\156\x61\x6d\145\x5f\x6c\145\156\57\166\145\170\x74\162\x61\x5f\154\145\x6e", $binary_data); goto vm89a; vm89a: $header["\x66\x69\154\x65\156\x61\x6d\145"] = fread($zip, $data["\x66\151\x6c\145\x6e\x61\155\x65\x5f\154\145\x6e"]); goto c4H69; quq4X: $header["\x73\x74\157\162\145\x64\x5f\146\x69\154\145\156\141\x6d\145"] = $header["\146\x69\154\x65\x6e\141\155\145"]; goto Wdtzj; Wdtzj: $header["\x73\x74\x61\164\165\x73"] = "\157\x6b"; goto KAK12; RiOcV: $minute = ($header["\x6d\164\151\155\x65"] & 0x7e0) >> 5; goto h3sap; f5ysn: goto Pcu1c; goto AIIqD; ngBNJ: $header["\x6d\x74\151\x6d\145"] = time(); goto f5ysn; KAK12: return $header; goto AojJy; OxGTh: $header["\x6d\x74\151\155\145"] = $data["\155\x74\x69\155\x65"]; goto v4CTM; dH6LL: $header["\143\x6f\x6d\x70\x72\x65\163\163\x65\x64\x5f\163\151\172\x65"] = $data["\x63\157\x6d\160\162\x65\163\163\x65\144\137\163\x69\x7a\145"]; goto R8edu; Yxd2j: $header["\143\157\x6d\x70\x72\x65\x73\163\151\x6f\156"] = $data["\143\157\x6d\x70\x72\x65\x73\x73\151\157\x6e"]; goto ND2o8; iGZM4: $hour = ($header["\155\x74\x69\x6d\x65"] & 0xf800) >> 11; goto RiOcV; AIIqD: xzjh3: goto iGZM4; gmrua: $header["\x6d\x64\x61\x74\145"] = $data["\155\x64\141\164\x65"]; goto OxGTh; KRJJX: $day = $header["\155\x64\141\164\145"] & 0x1f; goto jjHcR; gOMry: $month = ($header["\155\x64\141\164\x65"] & 0x1e0) >> 5; goto KRJJX; h3sap: $seconde = ($header["\155\x74\x69\155\145"] & 0x1f) * 2; goto iL03d; v4CTM: if ($header["\x6d\144\141\164\x65"] && $header["\155\164\151\155\x65"]) { goto xzjh3; } goto ngBNJ; c4H69: $header["\x65\170\164\x72\141"] = $data["\145\170\x74\162\x61\137\x6c\x65\156"] != 0 ? fread($zip, $data["\x65\170\164\x72\141\137\x6c\145\156"]) : ''; goto Yxd2j; AojJy: } private function ExtractFile($header, $to, $zip) { goto iMOrq; C6EUS: touch($to . $header["\x66\151\154\x65\156\x61\155\x65"], $header["\155\164\x69\x6d\x65"]); goto oIZiY; Pnxno: gzclose($gzp); goto Dq6td; xsZXX: goto Q4Iv3; goto LO4Mo; of3iR: return true; goto Owir2; oONUz: $gzp = @gzopen($to . $header["\x66\x69\154\x65\156\x61\155\x65"] . "\x2e\x67\x7a", "\x72\x62") or die("\x43\x65\164\x74\x65\x20\x61\162\143\x68\x69\x76\x65\x20\145\163\164\40\143\157\x6d\160\x72\x65\163\x73\x21"); goto TqFva; Klvq4: n0ZP2: goto QuOLQ; D1qx2: $read_size = $size < 1024 ? $size : 1024; goto VBFJh; Z7XhZ: @unlink($to . $header["\146\151\x6c\145\x6e\x61\155\x65"] . "\56\x67\x7a"); goto xsZXX; MvSCI: fclose($fp); goto oONUz; vzaJ6: $read_size = $size < 2048 ? $size : 2048; goto lh0Yd; tjB36: goto Iol3w; goto Klvq4; sgnr0: $size -= $read_size; goto isDV8; gpPk0: if (is_dir($to . $pthss)) { goto fBRPN; } goto j41AG; gawsQ: kk9Lp: goto hz2Cf; A65x1: $read_size = $size < 2048 ? $size : 2048; goto Lv0nM; Z6chC: goto CyZHe; goto aHkm8; hz2Cf: $binary_data = pack("\x76\x61\x31\141\x31\126\141\61\x61\x31", 0x8b1f, Chr($header["\143\x6f\x6d\x70\162\x65\163\x73\151\157\x6e"]), Chr(0x0), time(), Chr(0x0), Chr(3)); goto QDpaB; VBFJh: $buffer = fread($zip, $read_size); goto GJgLI; x5DzP: $pthss .= $pth[$i] . "\57"; goto gpPk0; UqORM: if ($pth[$i]) { goto QP0bw; } goto fGupH; jSNIa: if (@is_dir($to)) { goto CX7oy; } goto hgNVk; ANOZk: $fp = @fopen($to . $header["\x66\151\154\145\x6e\141\155\145"], "\167\142"); goto PhBCS; SYP_o: if ($fp) { goto kk9Lp; } goto AgZDl; PhBCS: if ($fp) { goto HAEi_; } goto A09zo; qwsdx: if (!(substr($to, -1) != "\57")) { goto vBOn0; } goto WNq_3; GJgLI: $binary_data = pack("\141" . $read_size, $buffer); goto umvmf; QuOLQ: fclose($fp); goto C6EUS; p9xRv: $binary_data = pack("\141" . $read_size, $buffer); goto Hy65b; e3tjh: QP0bw: goto x5DzP; XHfx4: if (!(!($header["\145\x78\x74\145\x72\156\141\x6c"] == 0x41ff0010) && !($header["\x65\170\164\145\162\x6e\x61\154"] == 16))) { goto VZQWQ; } goto OHaok; Tptf3: $size = $header["\163\151\172\145"]; goto a0vln; aHkm8: XEbmT: goto XHfx4; Lv0nM: $buffer = fread($zip, $read_size); goto p9xRv; m7LtQ: vBOn0: goto jSNIa; yEAZT: $i++; goto Z6chC; hgNVk: @mkdir($to, 0777); goto k9sxE; oIZiY: Q4Iv3: goto JBGdv; k9sxE: CX7oy: goto SLdo4; bAAuS: Iol3w: goto qH4No; fGupH: goto QDYxj; goto e3tjh; u94Ph: return -1; goto zfwXU; Hy65b: @fwrite($fp, $binary_data, $read_size); goto d0p4A; zg76r: $fp = @fopen($to . $header["\x66\151\154\x65\156\141\x6d\145"] . "\56\x67\172", "\167\142"); goto SYP_o; isDV8: goto zVNUr; goto jI6gk; KXPJO: if (!isset($pth[$i])) { goto XEbmT; } goto UqORM; WNq_3: $to .= "\57"; goto m7LtQ; ONby7: fwrite($fp, $binary_data, 8); goto MvSCI; LO4Mo: EcG80: goto ANOZk; B2XZE: dPphv: goto VufSk; OYgrz: $i = 0; goto YQGi3; QDpaB: fwrite($fp, $binary_data, 10); goto gfCKM; b6cFf: return -2; goto v_St3; vG3bZ: $size -= $read_size; goto mq_qN; umvmf: @fwrite($fp, $binary_data, $read_size); goto sgnr0; cWZ1a: $binary_data = pack("\x56\x56", $header["\143\x72\x63"], $header["\163\151\x7a\145"]); goto ONby7; dAoE4: if ($fp) { goto HjW5r; } goto u94Ph; lh0Yd: $buffer = gzread($gzp, $read_size); goto uXaBG; yO3lh: fBRPN: goto MaWOh; zfwXU: HjW5r: goto Tptf3; AgZDl: return -1; goto gawsQ; JBGdv: VZQWQ: goto of3iR; E91r9: $fp = @fopen($to . $header["\146\x69\154\x65\x6e\141\x6d\145"], "\x77\x62"); goto dAoE4; mdG0L: if (!($size != 0)) { goto dPphv; } goto vzaJ6; A09zo: return -1; goto J_t2d; DZYtR: $size = $header["\x63\157\155\x70\x72\145\x73\x73\x65\x64\x5f\163\x69\x7a\x65"]; goto bAAuS; OHaok: if ($header["\143\x6f\155\160\x72\x65\163\163\x69\157\x6e"] == 0) { goto EcG80; } goto zg76r; v_St3: ugZGW: goto E91r9; YQGi3: CyZHe: goto KXPJO; Dq6td: touch($to . $header["\x66\x69\154\145\x6e\141\155\x65"], $header["\x6d\x74\151\x6d\145"]); goto Z7XhZ; gfCKM: $size = $header["\143\x6f\x6d\160\162\x65\163\163\x65\144\x5f\x73\151\172\145"]; goto a1kQP; MaWOh: QDYxj: goto yEAZT; VufSk: fclose($fp); goto Pnxno; a1kQP: zVNUr: goto neFQW; SLdo4: $pth = explode("\57", dirname($header["\146\x69\x6c\145\x6e\x61\x6d\145"])); goto OYgrz; v7l2b: @fwrite($fp, $binary_data, $read_size); goto vG3bZ; iMOrq: $header = $this->readfileheader($zip); goto qwsdx; uXaBG: $binary_data = pack("\141" . $read_size, $buffer); goto v7l2b; TqFva: if ($gzp) { goto ugZGW; } goto b6cFf; J_t2d: HAEi_: goto DZYtR; jI6gk: LeN51: goto cWZ1a; a0vln: pZc5m: goto mdG0L; qH4No: if (!($size != 0)) { goto n0ZP2; } goto A65x1; mq_qN: goto pZc5m; goto B2XZE; j41AG: @mkdir($to . $pthss, 0777); goto yO3lh; d0p4A: $size -= $read_size; goto tjB36; neFQW: if (!($size != 0)) { goto LeN51; } goto D1qx2; Owir2: } public function unZip($zipfile, $to, $index = array(-1)) { goto JaQw5; UDP7B: if (is_array($index)) { goto DmDpg; } goto uPnMN; HUxnM: GgUDp: goto ORsyL; pJwMn: $header = $this->ReadCentralFileHeaders($zip); goto SMhy9; RiouG: $i = 0; goto w46GH; I29ud: ufM7J: goto aD8Yk; aD8Yk: e2yB2: goto nJJty; nJJty: $i++; goto IFBtF; C3Qn9: TUqUM: goto VEZlI; nWy6y: $pos_entry = ftell($zip); goto kYhzf; EBouC: DTGZ3: goto RiouG; hHKb5: return -1; goto HUxnM; VEZlI: fclose($zip); goto XTx3u; XTx3u: return $stat; goto oHTX7; i3CAK: YdDLe: goto vTHEE; O1PYd: fseek($zip, $header["\157\146\x66\x73\145\x74"]); goto YZ5Ns; uPnMN: $index = array($index); goto D_m2q; mk8ae: if (!($i < $cdir["\145\156\164\162\151\145\x73"])) { goto TUqUM; } goto bn1EB; S3z6L: $pos_entry = $cdir["\x6f\x66\146\163\x65\164"]; goto UDP7B; IFBtF: goto PR46l; goto C3Qn9; JaQw5: $ok = 0; goto nD9_y; BYw8l: if (!(intval($index[$i]) != $index[$i] || $index[$i] > $cdir["\x65\x6e\164\x72\151\x65\x73"])) { goto YdDLe; } goto xIyEC; ORsyL: $cdir = $this->ReadCentralDir($zip, $zipfile); goto S3z6L; xIyEC: return -1; goto i3CAK; v43bJ: $stat[$header["\146\151\x6c\145\156\x61\x6d\145"]] = $this->ExtractFile($header, $to, $zip); goto I29ud; nD9_y: $zip = @fopen($zipfile, "\x72\142"); goto AEIlV; wDIaO: if (!$index[$i]) { goto DTGZ3; } goto BYw8l; bn1EB: @fseek($zip, $pos_entry); goto pJwMn; qmpcs: $i = 0; goto JI0lB; vTHEE: d2oUH: goto CmUWe; kYhzf: @rewind($zip); goto O1PYd; AEIlV: if ($zip) { goto GgUDp; } goto hHKb5; rXYoK: goto bVDIW; goto EBouC; JI0lB: bVDIW: goto wDIaO; CmUWe: $i++; goto rXYoK; D_m2q: DmDpg: goto qmpcs; SMhy9: $header["\151\156\x64\145\170"] = $i; goto nWy6y; YZ5Ns: if (!(in_array("\x2d\61", $index) || in_array($i, $index))) { goto ufM7J; } goto v43bJ; w46GH: PR46l: goto mk8ae; oHTX7: } public function GetZipInnerFilesInfo($zipfile) { goto N55n3; EKK97: unset($header); goto WLKfY; r2oFP: ewuHT: goto jJHga; ftI9v: $i++; goto Gjh85; MLRJ8: $ret = array(); goto cUbiN; xy5mg: if (!($i < $centd["\145\x6e\x74\162\x69\x65\163"])) { goto ewuHT; } goto qVZO_; OM7mN: return 0; goto o2GlA; ZLDGV: GPr6Q: goto xy5mg; qydm4: $info = array("\x66\x69\154\x65\156\x61\x6d\x65" => $header["\x66\x69\154\145\x6e\141\x6d\x65"], "\x73\x74\157\x72\x65\x64\x5f\146\151\154\145\x6e\141\155\x65" => $header["\x73\x74\x6f\162\x65\x64\x5f\146\x69\154\145\156\x61\x6d\x65"], "\163\x69\x7a\x65" => $header["\x73\x69\172\x65"], "\143\157\155\160\162\145\x73\163\145\x64\137\x73\151\x7a\x65" => $header["\x63\x6f\155\x70\x72\x65\163\163\145\144\x5f\163\x69\172\x65"], "\x63\162\x63" => strtoupper(dechex($header["\x63\x72\x63"])), "\x6d\x74\x69\155\145" => date("\131\x2d\x6d\55\x64\x20\110\72\x69\x3a\x73", $header["\x6d\164\x69\155\x65"]), "\143\157\155\x6d\145\156\164" => $header["\143\157\x6d\x6d\x65\156\x74"], "\146\x6f\154\144\x65\x72" => $header["\x65\x78\164\145\162\x6e\x61\x6c"] == 0x41ff0010 || $header["\x65\x78\x74\x65\x72\x6e\141\154"] == 16 ? 1 : 0, "\151\156\144\145\x78" => $header["\x69\156\x64\x65\170"], "\x73\x74\x61\x74\165\x73" => $header["\x73\164\x61\x74\165\x73"]); goto tZq1O; jJHga: fclose($zip); goto iGEb3; Gjh85: goto GPr6Q; goto r2oFP; TfVcF: @fseek($zip, $centd["\x6f\x66\146\163\x65\x74"]); goto MLRJ8; Kgu60: $header["\x69\156\144\145\x78"] = $i; goto qydm4; N55n3: $zip = @fopen($zipfile, "\x72\142"); goto qjYub; qVZO_: $header = $this->ReadCentralFileHeaders($zip); goto Kgu60; o2GlA: m5FIA: goto qFlAv; cUbiN: $i = 0; goto ZLDGV; qFlAv: $centd = $this->ReadCentralDir($zip, $zipfile); goto WMyjy; qjYub: if ($zip) { goto m5FIA; } goto OM7mN; tZq1O: $ret[] = $info; goto EKK97; WLKfY: HZA6e: goto ftI9v; WMyjy: @rewind($zip); goto TfVcF; iGEb3: return $ret; goto un708; un708: } public function GetZipComment($zipfile) { goto ddu1S; ZvyoE: $centd = $this->ReadCentralDir($zip, $zipfile); goto Z7w1L; UA45H: if ($zip) { goto aHehu; } goto XEK8H; Bh2h3: aHehu: goto ZvyoE; Z7w1L: fclose($zip); goto OpsQG; OpsQG: return $centd[comment]; goto myILR; ddu1S: $zip = @fopen($zipfile, "\x72\142"); goto UA45H; XEK8H: return 0; goto Bh2h3; myILR: } }