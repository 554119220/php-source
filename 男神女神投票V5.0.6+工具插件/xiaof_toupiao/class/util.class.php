<?php
 defined("\x49\116\137\x49\x41") or exit("\101\143\x63\x65\x73\x73\40\104\145\156\151\145\144"); class SupermanToupiaoUtil { public static function uni_modules_fetch($name) { goto qIGNH; qIGNH: load()->model("\x61\x63\x63\x6f\165\x6e\x74"); goto wNiXK; wNiXK: $modules = uni_modules(false); goto BhlMp; BhlMp: return $modules[$name]; goto VDtJ6; VDtJ6: } public static function formatTime($timestamp) { goto BJEMd; YHeLC: $format = floor($time_diff / 60) . "\345\260\x8f\xe6\x97\xb6"; goto FeziX; BJEMd: $time_diff = (TIMESTAMP - $timestamp) / 60; goto iIsZk; QhLXn: lITD8: goto YHeLC; OjIVF: if ($time_diff >= 43200 && $time_diff < 518400) { goto Jlw8q; } goto WnpYR; cVja3: $format = floor($time_diff / 1440) . "\xe5\244\251"; goto xTkUL; akFrk: goto Epl7J; goto gBG34; WnpYR: $format = floor($time_diff / 518400) . "\345\271\264"; goto EwXsy; EMTK0: goto te5Nd; goto Zoj3c; iX8BB: if ($time_diff >= 60 && $time_diff < 1440) { goto lITD8; } goto ZAdrL; Tgl6h: if ($time_diff > 1 && $time_diff < 60) { goto gn_K4; } goto iX8BB; iIsZk: if ($time_diff <= 1) { goto nCW33; } goto Tgl6h; E99aA: $format = floor($time_diff / 43200) . "\xe6\x9c\210"; goto jLWRY; Zoj3c: TTHI6: goto cVja3; mxwOb: goto TMDnQ; goto KiplJ; ZAdrL: if ($time_diff >= 1440 && $time_diff < 43200) { goto TTHI6; } goto OjIVF; xKByK: $format = "\61\345\210\x86\xe9\x92\237"; goto xivjG; Lc38j: Jlw8q: goto E99aA; jLWRY: UkDOR: goto EMTK0; xTkUL: te5Nd: goto r5gn_; gBG34: nCW33: goto xKByK; KiplJ: gn_K4: goto JJTRQ; r5gn_: goto okv4b; goto QhLXn; JJTRQ: $format = floor($time_diff) . "\xe5\210\x86\xe9\222\237"; goto lprX1; xivjG: Epl7J: goto KmmXh; KmmXh: return $format; goto O7r3u; lprX1: TMDnQ: goto akFrk; FeziX: okv4b: goto mxwOb; EwXsy: goto UkDOR; goto Lc38j; O7r3u: } public static function json($errno, $errmsg = '', $data = array()) { goto b4QeE; cT4dr: LRL0Y: goto az2gB; vfhrJ: $errmsg = SupermanToupiaoErrno::$ERRMSG[$errno]; goto cT4dr; htnrx: @header("\103\x6f\156\164\145\x6e\164\55\x54\x79\x70\145\x3a\x20\141\x70\x70\x6c\x69\x63\141\x74\151\157\156\x2f\152\x73\157\x6e\73\40\143\150\141\x72\163\145\x74\75\165\x74\x66\x2d\x38"); goto owh0B; owh0B: exit(json_encode($result)); goto tW3EK; pDaG7: if (!($errmsg == '')) { goto LRL0Y; } goto vfhrJ; az2gB: $result = array("\145\x72\162\156\157" => $errno, "\x65\162\162\x6d\x73\x67" => $errmsg, "\144\141\x74\141" => $data); goto htnrx; b4QeE: ob_end_clean(); goto pDaG7; tW3EK: } public static function background_running() { } public static function redirect($url) { goto P57vo; CF2IX: exit; goto JKCjW; whlkE: @header("\x4c\x6f\x63\x61\x74\151\157\156\x3a\40" . $url); goto CF2IX; P57vo: ob_end_clean(); goto whlkE; JKCjW: } public static function weiqing_polyfill() { goto si9ne; jc1nn: $do = $_GPC["\x64\157"]; goto Je21B; NjnG2: WAvEh: goto u9DAx; M8X4I: goto mLAM4; goto VUIbH; DcCHS: if (!empty($do)) { goto qQlLT; } goto jc1nn; cftb5: $do = $_GPC["\x64\x6f"]; goto NjnG2; si9ne: global $_GPC, $do; goto j38G9; Je21B: qQlLT: goto M8X4I; dNya8: $eid = intval($_GPC["\145\151\x64"]); goto mgErV; mgErV: $row = pdo_get("\x6d\157\144\x75\x6c\145\x73\137\142\151\156\144\151\156\147\163", array("\x65\x69\x64" => $eid)); goto sFpGr; sFpGr: if (empty($row)) { goto WAvEh; } goto r7j48; a5rmE: if (!(isset($_GPC["\145\151\144"]) && $_GPC["\x65\x69\x64"])) { goto k9tXQ; } goto dNya8; j38G9: if (empty($_GPC["\x64\x6f"])) { goto yLGum; } goto DcCHS; R6AUZ: $_GPC["\155"] = $row["\155\x6f\x64\x75\x6c\x65"]; goto cftb5; r7j48: $_GPC["\x64\x6f"] = $row["\144\x6f"]; goto R6AUZ; VUIbH: yLGum: goto a5rmE; u9DAx: k9tXQ: goto VCsMq; VCsMq: mLAM4: goto lWTjG; lWTjG: } public static function get_tables($module_name = '') { goto pgChr; LkCZ3: $list = pdo_fetchall($sql); goto jEeh5; pgChr: if (!($module_name == '' && defined("\x53\125\120\105\122\x4d\101\116\137\x4d\x4f\104\x55\114\105\x5f\x4e\x41\x4d\105"))) { goto PGHAV; } goto sipkM; yCTic: PGHAV: goto Wf677; jEeh5: if (empty($list)) { goto R1J18; } goto sPiEN; Wf677: $tables = array(); goto w3Rgw; IELyi: R1J18: goto bywxl; w3Rgw: $sql = "\123\x48\117\x57\40\x54\x41\x42\x4c\x45\x53"; goto LkCZ3; sipkM: $module_name = SUPERMAN_MODULE_NAME; goto yCTic; uv9u3: egLxp: goto IELyi; bywxl: return $tables; goto B3Olf; sPiEN: foreach ($list as $k => $v) { goto T35JB; KXT8s: yMSWe: goto qw8PN; Ex_8Q: L1FI0: goto KXT8s; Moati: $tables[] = $tablename; goto Ex_8Q; d74ah: if (!(strpos($tablename, $module_name) !== false)) { goto L1FI0; } goto Moati; SdxxM: $tablename = $arr[0]; goto d74ah; T35JB: $arr = array_values($v); goto SdxxM; qw8PN: } goto uv9u3; B3Olf: } public static function format_date($str) { return substr($str, 0, 4) . "\55" . substr($str, 4, 2) . "\x2d" . substr($str, 6, 2); } public static function float_format($num, $len = 2) { goto tzYRK; tzYRK: $multiplier = pow(10, $len); goto vQDjX; vQDjX: $arr = explode("\56", $num * $multiplier); goto CyI5j; CyI5j: $result = $arr[0] / $multiplier; goto XYm50; XYm50: return sprintf("\x25\x2e" . $len . "\x66", $result); goto pUhHZ; pUhHZ: } public static function uid2openid($uid) { goto QIFQE; MHoGC: return $fans && $fans["\x6f\160\145\156\x69\144"] ? $fans["\x6f\x70\145\156\x69\144"] : ''; goto qfPMa; QIFQE: $uid = intval($uid); goto aSh6l; aSh6l: $fans = mc_fansinfo($uid); goto MHoGC; qfPMa: } public static function weaccount_create() { goto aekb9; BfTUF: goto AjCYe; goto YH8ue; sUPbi: return error(-1, "\345\205\254\344\274\227\345\217\267\xe6\xb2\xa1\346\234\211\347\xbb\217\350\277\x87\350\xae\244\xe8\257\x81"); goto YKbFs; HMrnl: AjCYe: goto Zlrwg; hb18z: WeUtility::logging("\x66\141\x74\141\x6c", "\x5b\x77\145\x61\x63\x63\x6f\165\156\164\137\143\x72\145\x61\x74\145\135\345\x88\x9b\xe5\xbb\xba\xe5\x85\xac\xe4\xbc\x97\345\217\267\346\223\215\344\xbd\234\xe5\257\xb9\350\261\241\345\244\xb1\350\xb4\245"); goto UR1De; Mg7Vu: WeUtility::logging("\x66\141\x74\141\154", "\133\x77\x65\x61\143\x63\157\165\156\164\x5f\143\x72\145\x61\x74\145\135\xe5\x85\254\344\274\x97\345\217\xb7\xe6\262\241\xe6\234\x89\xe7\xbb\217\xe8\277\207\350\xae\xa4\350\xaf\x81"); goto sUPbi; ChSWG: return $account; goto AXED5; Aqo8u: if (isset($_W["\141\143\x69\144"]) && $_W["\x61\143\x69\x64"]) { goto ePOKk; } goto in13H; KphZU: $account = WeAccount::create(); goto sXy41; wR1Ae: $_W["\x61\x63\x63\157\x75\x6e\164"] = uni_fetch($_W["\165\156\151\x61\143\151\144"]); goto UqNpA; AXED5: yjfP8: goto PJ3pD; aekb9: global $_W; goto zGHaY; YH8ue: ePOKk: goto Z5SA_; Z5SA_: $_W["\141\143\143\157\165\156\164"] = account_fetch($_W["\141\x63\x69\x64"]); goto HMrnl; sXy41: if (!is_null($account)) { goto S3SAH; } goto hb18z; zGHaY: static $account = null; goto vDl9w; vCR8J: EF6cI: goto Inj9a; YKbFs: Pj8Bi: goto KphZU; x0bA6: return $account; goto FTUSu; UR1De: return error(-1, "\345\x88\233\xe5\xbb\272\xe5\205\xac\344\274\x97\xe5\x8f\xb7\346\223\215\xe4\275\234\xe5\xaf\271\350\261\xa1\xe5\244\xb1\350\xb4\245"); goto QuMoK; YErF_: return error(-1, "\xe5\210\235\xe5\xa7\x8b\xe5\x8c\x96\xe5\xa4\261\xe8\264\xa5\xef\xbc\214\xe7\274\272\345\xb0\x91\x61\x63\151\144\174\174\165\x6e\x69\141\143\x69\144\345\x8f\x82\346\225\260"); goto BfTUF; vDl9w: if (is_null($account)) { goto yjfP8; } goto ChSWG; Zlrwg: goto niLVt; goto Ox7ZX; PJ3pD: if (!empty($_W["\x61\x63\x63\157\x75\x6e\164"])) { goto EF6cI; } goto WRbaH; WRbaH: if (isset($_W["\x75\156\151\141\143\151\x64"]) && $_W["\x75\156\x69\x61\143\151\144"]) { goto Zrurl; } goto Aqo8u; Ox7ZX: Zrurl: goto wR1Ae; in13H: WeUtility::logging("\x66\x61\164\141\x6c", "\133\167\145\x61\x63\143\x6f\165\x6e\164\137\143\x72\x65\141\x74\145\x5d\345\210\x9d\xe5\xa7\x8b\345\214\226\xe5\xa4\261\350\xb4\245\357\xbc\214\347\274\272\345\260\x91\141\143\x69\144\x7c\x7c\165\x6e\151\141\x63\x69\144\345\x8f\x82\xe6\x95\260"); goto YErF_; QuMoK: S3SAH: goto x0bA6; Inj9a: if (!($_W["\141\x63\x63\x6f\x75\x6e\x74"]["\x6c\x65\166\x65\x6c"] < 3)) { goto Pj8Bi; } goto Mg7Vu; UqNpA: niLVt: goto vCR8J; FTUSu: } public static function send_tmplmsg($message) { goto W2rmN; Mu_20: if ($ret !== true) { goto Oeql2; } goto sL5iW; MPY0x: if (!empty($message["\x74\x6d\160\x6c\137\x69\144"])) { goto hy5fT; } goto k1gz4; PlDqw: Sxhhz: goto P0M3K; P0M3K: if ($message["\x6f\x70\x65\156\151\x64"]) { goto DH2SG; } goto lwu62; QK3X2: return false; goto PlDqw; lwu62: WeUtility::logging("\x66\141\164\141\x6c", "\133\x73\x65\156\x64\x5f\x74\x6d\160\154\155\163\x67\x5d\x20\xe6\xa8\xa1\346\x9d\277\346\xb6\x88\xe6\201\xaf\345\x8f\221\351\200\x81\345\244\261\xe8\xb4\245\357\274\x9a\157\x70\x65\x6e\151\x64\xe4\xb8\272\347\251\xba"); goto PAFVJ; PAFVJ: return false; goto VNbEQ; Vg4Ja: goto LQYsr; goto WF3jH; XxlmA: WeUtility::logging("\x66\141\x74\x61\154", "\133\163\x65\x6e\144\x5f\164\155\x70\x6c\x6d\163\x67\x5d\x20\346\250\241\xe6\x9d\277\346\266\210\346\201\257\xe5\217\221\xe9\200\x81\xe5\xa4\xb1\xe8\xb4\xa5\xef\xbc\x9a\155\145\x73\x73\141\x67\x65\x3d" . var_export($message, true)); goto dxKfS; uoio3: $ret = $account->sendTplNotice($message["\x6f\160\145\x6e\151\144"], $message["\164\155\160\x6c\x5f\151\144"], $message["\160\x6f\x73\x74\x64\x61\x74\x61"], $message["\x75\x72\x6c"]); goto Mu_20; k1gz4: WeUtility::logging("\146\141\164\x61\x6c", "\133\163\145\x6e\x64\x5f\x74\x6d\160\x6c\155\x73\147\x5d\40\xe6\xa8\xa1\xe6\235\xbf\xe6\xb6\x88\xe6\201\257\xe5\x8f\x91\xe9\200\x81\345\xa4\261\xe8\xb4\xa5\xef\xbc\232\xe6\234\252\xe9\x85\x8d\xe7\xbd\256\xe6\250\xa1\xe7\x89\x88\xe6\xb6\210\xe6\201\xaf"); goto Oy0b2; W2rmN: global $_W; goto tyQc4; dxKfS: LQYsr: goto jg2Rp; H4wTs: hy5fT: goto uoio3; sL5iW: WeUtility::logging("\151\156\146\157", "\133\x73\x65\156\144\x5f\164\x6d\160\x6c\x6d\163\x67\x5d\40\xe6\250\241\xe6\x9d\xbf\xe6\xb6\x88\346\x81\xaf\xe5\x8f\x91\351\x80\x81\xe6\210\x90\xe5\212\237\357\274\x9a\157\x70\x65\156\x69\x64\75{$message["\x6f\x70\x65\156\x69\144"]}\54\x20\x6d\x65\163\x73\141\147\x65\x3d" . var_export($message, true)); goto Vg4Ja; Oy0b2: return false; goto H4wTs; tyQc4: $account = self::weaccount_create(); goto FpxxJ; VNbEQ: DH2SG: goto MPY0x; FpxxJ: if (!($_W["\141\x63\x63\x6f\x75\x6e\164"]["\x6c\145\166\x65\154"] != 4)) { goto Sxhhz; } goto ayFqP; WF3jH: Oeql2: goto XxlmA; ayFqP: WeUtility::logging("\146\141\x74\x61\x6c", "\x5b\163\x65\x6e\144\137\x74\155\160\154\x6d\163\x67\135\40\346\250\241\346\235\277\xe6\xb6\210\346\201\xaf\xe5\217\221\351\x80\201\xe5\xa4\261\350\264\xa5\357\274\232\351\x9d\x9e\xe8\256\244\xe8\xaf\x81\346\x9c\215\xe5\x8a\241\345\217\xb7\346\xb2\241\xe6\234\211\xe5\217\x91\351\200\x81\xe6\xa8\241\xe6\235\xbf\346\266\210\346\201\xaf\346\235\x83\351\x99\x90"); goto QK3X2; jg2Rp: } public static function get_sign($params = array(), $key = '') { goto RzckL; A26E7: $str = http_build_query($params); goto ofFyV; RzckL: ksort($params); goto A26E7; LvG4f: return sha1($str); goto ZH5YP; ofFyV: $str .= "\46\x6b\145\x79\75" . $key; goto LvG4f; ZH5YP: } public static function is_we7_encrypt($filename) { $content = file_get_contents($filename); return strstr($content, "\162\x65\x74\x75\x72\x6e\x3b\x3f\76") !== false && substr($content, 5, 8) == "\x20\x64\145\x66\x69\x6e\x65\x28" ? true : false; } public static function get_qrcode($url, $save_img = true) { goto YfSoQ; irES9: uMEga: goto CBKmF; SL_k4: return $ret; goto qw8i2; YfSoQ: global $_W; goto Xw8A7; eLpBK: $qrcode_path = $path . "\57" . $filename; goto mpdXS; CBKmF: $ret = array("\x70\141\x74\x68" => $qrcode_path, "\141\142\163\137\x70\141\164\150" => MODULE_ROOT . "\57" . $qrcode_path, "\x75\162\x6c" => MODULE_URL . $qrcode_path, "\x66\151\154\145\x6e\141\155\145" => $filename); goto SL_k4; wf1aT: mkdirs(MODULE_ROOT . "\x2f" . $path); goto bhZKp; Xw8A7: $path = "\144\x61\x74\141\57" . $_W["\165\x6e\151\x61\143\151\x64"] . "\x2f\161\x72\143\157\144\145"; goto wf1aT; mpdXS: if (!($save_img && !file_exists(MODULE_ROOT . "\57" . $qrcode_path))) { goto uMEga; } goto FF6A4; FF6A4: SupermanToupiaoUtil::qrcode_png($url, MODULE_ROOT . "\57" . $qrcode_path); goto irES9; bhZKp: $filename = md5("\x73\165\x70\x65\162\155\x61\156\x5f\155\x61\x6c\154\72\161\x72\x63\x6f\x64\x65\72" . $url) . "\56\x70\156\147"; goto eLpBK; qw8i2: } public static function get_poster_path($uid, $id) { goto RyQOA; h6YSR: $path = "\x64\141\x74\141\x2f" . $_W["\165\156\151\141\143\x69\144"] . "\x2f\160\x6f\x73\164\145\162"; goto j0H5T; j4gER: return $poster_path; goto Twsgh; j0H5T: mkdirs(MODULE_ROOT . "\x2f" . $path); goto K2FAS; RyQOA: global $_W; goto h6YSR; hXi1V: $poster_path = $path . "\57" . $poster_filename; goto j4gER; K2FAS: $poster_filename = md5("\x78\x69\x61\x6f\146\137\164\157\165\x70\151\141\x6f\72\x70\141\162\164\x6e\x65\x72\x5f\x70\157\x73\164\145\x72\x3a" . $uid) . "\55" . $id . "\56\x70\156\147"; goto hXi1V; Twsgh: } public static function get_bgimg_localpath($filepath) { goto re0Mw; hoPsE: $path = "\x64\141\164\141\x2f" . $_W["\x75\156\x69\141\143\151\x64"] . "\57\x69\x6d\x61\x67\x65"; goto w4E_c; RLz6W: $ext = strtolower(pathinfo($filepath, PATHINFO_EXTENSION)); goto hoPsE; iaoK1: IoDxo: goto ER2G4; yB3nF: $url = tomedia($filepath); goto RLz6W; qrfn0: if (!empty($content)) { goto r0dVP; } goto f_6Lx; xFGgc: return false; goto Smc3w; AE0dr: $ext = "\152\x70\147"; goto Aa2ce; d7_e1: return IA_ROOT . "\x2f\x61\144\144\157\x6e\x73" . $file_arr[1]; goto UOWou; eTrhD: return IA_ROOT . "\57" . $filepath; goto DQc9S; DkgVB: return $filename; goto yhHiN; yhHiN: goto jAjfC; goto iaoK1; ZhvLo: STyPI: goto GBgxF; w4E_c: $filename = MODULE_ROOT . "\57" . $path . "\57" . md5($url) . "\x2e" . $ext; goto X_Spq; DQc9S: ZAQDb: goto IfPFg; X_Spq: if (!empty($ext)) { goto STyPI; } goto AE0dr; EGbLx: file_put_contents($filename, $content); goto DkgVB; iys_E: jAjfC: goto P3voP; leRkK: if (!strexists($filepath, "\x61\144\x64\157\x6e\163\x2f")) { goto ZAQDb; } goto eTrhD; GBgxF: if (file_exists($filename)) { goto IoDxo; } goto mpKTz; Aa2ce: $filename .= "\56" . $ext; goto ZhvLo; BuGVS: return ATTACHMENT_ROOT . $filepath; goto lxGdg; ER2G4: return $filename; goto iys_E; Smc3w: r0dVP: goto EGbLx; re0Mw: global $_W; goto Bg0DC; f_6Lx: WeUtility::logging("\146\x61\x74\141\154", "\133\147\145\164\x5f\142\x67\x69\155\x67\x5f\154\157\x63\141\x6c\x70\x61\164\150\x5d\40\x66\141\x69\154\145\x64\x2c\x20\165\x72\x6c\75" . $url); goto xFGgc; mpKTz: mkdirs(MODULE_ROOT . "\x2f" . $path); goto RibFs; Bg0DC: $file_arr = explode("\141\x64\x64\157\156\163", $filepath); goto qUZjX; IfPFg: if (!file_exists(ATTACHMENT_ROOT . $filepath)) { goto FCrO_; } goto BuGVS; qUZjX: if (!strexists($file_arr[1], "\x70\x6f\163\x74\x65\162\x62\147\x2e\152\160\147")) { goto T270C; } goto d7_e1; lxGdg: FCrO_: goto yB3nF; UOWou: T270C: goto leRkK; RibFs: $content = file_get_contents($url); goto qrfn0; P3voP: } public static function create_image($imgpath) { goto iN0gV; brp6P: $ext = pathinfo($imgpath, PATHINFO_EXTENSION); goto IbLuS; IbLuS: $ext = strtolower($ext); goto XUl2t; H6mjS: WeUtility::logging("\x66\141\x74\x61\154", "\x5b\x63\162\x65\141\164\x65\x5f\x69\x6d\x61\x67\x65\x5d\40\146\x61\151\154\x65\144\x2c\x20\151\x6d\x61\x67\145\40\160\x61\164\150\x20\156\x6f\40\145\170\x69\x73\164\x2c\x20\151\x6d\147\160\141\x74\150\75" . $imgpath); goto NI__2; iN0gV: if (file_exists($imgpath)) { goto Nle7g; } goto H6mjS; XUl2t: $ext = $ext == "\x6a\160\147" ? "\152\x70\x65\147" : $ext; goto wT10j; IRk4F: return $method($imgpath); goto aFtzg; tU0wU: Nle7g: goto brp6P; NI__2: trigger_error("\x5b\x63\162\x65\141\164\x65\x5f\x69\x6d\141\147\145\135\x20\146\141\151\x6c\x65\x64\x2c\40\x69\155\141\x67\145\x20\160\x61\164\x68\x20\156\x6f\x20\145\170\x69\163\164\54\40\151\x6d\147\160\x61\x74\x68\x3d" . $imgpath, E_USER_ERROR); goto tU0wU; ZlrUt: if (!function_exists($method)) { WeUtility::logging("\146\x61\164\x61\x6c", "\x5b\x63\x72\x65\141\x74\145\137\151\x6d\x61\x67\x65\135\x20\x66\x61\x69\x6c\145\144\x2c\x20\x66\165\156\x63\164\x69\157\x6e\40\156\x6f\40\145\x78\151\x73\164\x2c\x20\146\x75\156\x63\164\x69\157\x6e\x3d" . $method); trigger_error("\x5b\x63\162\145\x61\x74\145\137\151\x6d\x61\x67\x65\135\40\146\x61\x69\x6c\145\144\54\x20\146\x75\x6e\143\164\x69\157\156\x20\x6e\x6f\x20\x65\170\x69\x73\x74\54\40\146\x75\156\x63\164\x69\157\x6e\x3d" . $method, E_USER_ERROR); } goto IRk4F; wT10j: $method = "\151\155\141\x67\145\143\x72\x65\x61\x74\x65\146\162\157\155{$ext}"; goto ZlrUt; aFtzg: } public static function qrcode_png($text, $outfile = false, $level = QR_ECLEVEL_L, $size = 10, $margin = 4, $saveandprint = false) { goto RFoHz; u7n3M: ob_end_clean(); goto Q3WfP; RFoHz: include_once IA_ROOT . "\57\146\162\141\155\x65\x77\157\x72\x6b\57\154\151\142\162\x61\162\171\57\x71\x72\x63\x6f\x64\145\x2f\x70\x68\160\x71\x72\x63\x6f\144\x65\56\x70\150\x70"; goto u7n3M; Q3WfP: QRcode::png($text, $outfile, $level, $size, $margin, $saveandprint); goto Zp8x1; Zp8x1: } public static function _create_image(&$bgimg, $imgpath, $x, $y, $w, $h, $pct = 100) { goto eUrhd; SE0Z0: $imgpath = $dest; goto lFvne; eUrhd: if (!empty($imgpath)) { goto B6IbP; } goto fJkOa; VO8Ma: $dest = self::get_thumb_filenames($imgpath); goto J1YzV; J1YzV: self::file_image_thumb($imgpath, $dest, $w, $h); goto SE0Z0; lFvne: $img = self::create_image($imgpath); goto r2x1O; r2x1O: self::imagecopymerge_alpha($bgimg, $img, $x, $y, 0, 0, $w, $h, $pct); goto cGhPY; fJkOa: return; goto KDDIU; KDDIU: B6IbP: goto VO8Ma; cGhPY: imagedestroy($img); goto pdf0M; pdf0M: } public static function save_image($img, $imgpath) { goto FU9bT; dAfN0: $ext = strtolower($ext); goto VzE_2; YkDkl: return $method($img, $imgpath); goto wVurN; D_2Pp: $method = "\151\155\141\147\x65{$ext}"; goto axf6g; axf6g: if (!function_exists($method)) { WeUtility::logging("\x66\x61\164\x61\154", "\133\163\141\166\145\x5f\x69\x6d\141\147\145\135\x20\146\141\151\x6c\x65\144\54\x20\146\165\x6e\x63\x74\151\157\156\x20\x6e\157\40\x65\x78\x69\x73\x74\x2c\x20\146\x75\156\x63\x74\x69\157\156\x3d" . $method); trigger_error("\x5b\x73\x61\x76\145\137\x69\x6d\x61\147\x65\x5d\x20\146\x61\151\154\145\144\54\40\146\x75\x6e\143\x74\x69\157\x6e\x20\156\x6f\x20\x65\170\151\x73\x74\54\40\146\165\156\143\x74\151\x6f\x6e\x3d" . $method, E_USER_ERROR); } goto YkDkl; VzE_2: $ext = $ext == "\152\160\x67" ? "\x6a\x70\145\x67" : $ext; goto D_2Pp; FU9bT: $ext = pathinfo($imgpath, PATHINFO_EXTENSION); goto dAfN0; wVurN: } public static function get_thumb_filenames($filename, $thumb_suffix = '') { goto rm4ZR; LNQry: $filename = $arr[0] . $thumb_suffix . "\56" . $ext; goto Dl8dw; rm4ZR: $ext = strtolower(pathinfo($filename, PATHINFO_EXTENSION)); goto n81rS; Dl8dw: return $filename; goto p2bx_; n81rS: $arr = explode("\x2e" . $ext, $filename); goto LNQry; p2bx_: } public static function file_image_thumb($srcfile, $desfile = '', $width = 0, $hight = 0) { goto XXWFH; bLmok: goto tPfBP; goto TH_Wa; jHLa_: imagesavealpha($img_org, true); goto nUwzZ; D_5A4: imagejpeg($img_dst, $desfile); goto ehV4u; V_NK3: L0YrS: goto aKxiF; h9DXZ: return error("\55\x31", "\xe5\x88\233\xe5\xbb\272\xe7\233\xae\345\xbd\x95\xe5\xa4\xb1\xe8\xb4\xa5"); goto i4a6I; epvgq: fSbx_: goto BDtIf; jUF9C: if ($org_info[2] == 3) { goto EqJV4; } goto k7z4N; zhqqS: RJaN8: goto bLmok; JsOpL: obKy2: goto lMRKl; IAi5c: return error("\x2d\61", "\345\x8e\237\345\x9b\xbe\xe5\203\x8f\344\xb8\x8d\xe5\255\x98\xe5\234\250"); goto JsOpL; lMRKl: if (file_is_image($srcfile)) { goto xGb05; } goto jq9JT; gbffk: qgsYU: goto j7GAj; H9Xs0: return error("\x2d\61", "\347\x9b\xae\xe5\275\x95\xe6\x97\240\xe6\263\225\345\x86\x99\xe5\x85\xa5"); goto xWNj8; Zxeky: copy($srcfile, $desfile); goto m0G0q; NQRm0: kef70: goto Jt8Xn; tlVio: if (!(intval($width) < 0)) { goto JEUtU; } goto q6klA; Jt8Xn: imagedestroy($img_dst); goto XoTzr; XcWsU: $img_org = imagecreatefromjpeg($srcfile); goto JKbl2; j7GAj: goto kef70; goto V_NK3; h0BvO: FQnpb: goto RFuug; vyTtP: tPfBP: goto vrR9D; o0fXp: if ($org_info) { goto In7ev; } goto f9NzX; hO04e: imagecopyresampled($img_dst, $img_org, 0, 0, 0, 0, $width, $hight, $org_info[0], $org_info[1]); goto gFA3d; HjcC3: goto tPfBP; goto Na5E6; TH_Wa: iRHSG: goto erweF; nzi0S: if (!empty($desfile)) { goto gLqXk; } goto wz5od; QXBU1: imagesavealpha($img_dst, true); goto hO04e; RFuug: imagealphablending($img_dst, false); goto QXBU1; MFxng: $org_info = @getimagesize($srcfile); goto o0fXp; i4a6I: uDJ3B: goto FQRhT; q6klA: return error("\55\x31", "\xe7\xbc\xa9\xe6\x94\276\345\256\275\xe5\xba\246\346\227\240\xe6\x95\x88"); goto n1qAI; ktvBd: if (!is_writable($des)) { goto zsSjs; } goto OQte2; JKbl2: wWmG9: goto HjcC3; dsyT3: load()->model("\x73\x65\164\164\151\x6e\x67"); goto wk8L2; nUwzZ: vZV23: goto vyTtP; btDEf: if (file_exists($srcfile)) { goto obKy2; } goto IAi5c; XiqnI: return error("\55\61", "\120\x48\120\xe7\x8e\257\xe5\xa2\203\xe4\270\x8d\xe6\224\xaf\346\214\x81\345\x9b\xbe\347\211\x87\345\xa4\204\xe7\x90\x86"); goto amFiL; m0G0q: return str_replace(ATTACHMENT_ROOT . "\x2f", '', $desfile); goto w1eaw; uC2AF: y13VX: goto tlVio; tPOqN: if (!function_exists("\151\155\x61\147\145\160\156\x67")) { goto qgsYU; } goto RVpy1; vrR9D: nS0xi: goto CiRjI; XoTzr: imagedestroy($img_org); goto lRd1q; n1qAI: JEUtU: goto nzi0S; gBS2t: $desfile = $srcdir . "\x2f" . random(30) . "\x2e{$ext}"; goto Oj5aI; uCXM8: $img_org = imagecreatefromgif($srcfile); goto zhqqS; aKxiF: if (!function_exists("\x69\x6d\x61\x67\x65\152\x70\145\x67")) { goto PIFMg; } goto D_5A4; ehV4u: PIFMg: goto NQRm0; bSEc3: VwXvW: goto gBS2t; wk8L2: $width = intval($_W["\x73\145\164\164\151\156\147"]["\x75\x70\154\x6f\x61\x64"]["\151\x6d\x61\147\145"]["\x77\x69\144\x74\150"]); goto uC2AF; jq9JT: return error("\55\61", "\xe5\216\x9f\xe5\233\xbe\345\x83\217\344\270\215\xe5\255\230\xe5\x9c\xa8"); goto xH6CH; xWNj8: OL242: goto MFxng; CiRjI: if (function_exists("\x69\155\x61\x67\x65\143\x72\x65\x61\164\x65\x74\162\x75\145\143\x6f\x6c\x6f\162") && function_exists("\x69\x6d\x61\147\145\x63\x6f\160\171\x72\145\x73\x61\x6d\160\154\145\144") && @($img_dst = imagecreatetruecolor($width, $hight))) { goto FQnpb; } goto XiqnI; gFA3d: LbLRQ: goto FGzPk; FQRhT: goto OL242; goto wKkJt; wz5od: $ext = pathinfo($srcfile, PATHINFO_EXTENSION); goto t2oSt; FGzPk: if ($org_info[2] == 2) { goto L0YrS; } goto tPOqN; cBV5G: if ($org_info[2] == 1) { goto wqisM; } goto m0xbz; RVpy1: imagepng($img_dst, $desfile); goto gbffk; k7z4N: goto tPfBP; goto n97JZ; BDtIf: if (mkdirs($des)) { goto uDJ3B; } goto h9DXZ; LiXcB: if (!(intval($width) == 0)) { goto y13VX; } goto dsyT3; px_hB: goto nS0xi; goto e30ct; wKkJt: zsSjs: goto H9Xs0; n97JZ: wqisM: goto rm1vD; Na5E6: EqJV4: goto iRLv7; xH6CH: xGb05: goto LiXcB; XXWFH: global $_W; goto btDEf; M6yU3: aoZ4Q: goto NkFYh; DwDEv: $img_org = imagecreatefrompng($srcfile); goto jHLa_; lRd1q: return str_replace(ATTACHMENT_ROOT . "\57", '', $desfile); goto O7dma; e30ct: In7ev: goto RKWzM; amFiL: goto LbLRQ; goto h0BvO; w1eaw: ggBEx: goto cBV5G; NkFYh: gLqXk: goto dShpS; OQte2: goto OL242; goto epvgq; Oj5aI: if (file_exists($desfile)) { goto VwXvW; } goto M6yU3; rm1vD: if (!function_exists("\151\x6d\141\147\145\x63\x72\x65\141\164\x65\146\162\157\155\147\x69\146")) { goto RJaN8; } goto uCXM8; xJdRd: if (!file_exists($des)) { goto fSbx_; } goto ktvBd; RKWzM: if (!($width == 0)) { goto ggBEx; } goto Zxeky; t2oSt: $srcdir = dirname($srcfile); goto bSEc3; iRLv7: if (!function_exists("\151\x6d\x61\147\x65\x63\x72\x65\x61\164\145\x66\162\x6f\x6d\x70\x6e\x67")) { goto vZV23; } goto DwDEv; dShpS: $des = dirname($desfile); goto xJdRd; erweF: if (!function_exists("\x69\x6d\141\147\x65\x63\162\x65\x61\x74\x65\146\162\x6f\x6d\152\x70\x65\147")) { goto wWmG9; } goto XcWsU; f9NzX: return error("\55\x31", "\xe8\x8e\xb7\xe5\x8f\226\345\x8e\237\xe5\xa7\213\xe5\x9b\xbe\345\203\217\344\277\xa1\xe6\201\xaf\xe5\244\261\xe8\264\xa5"); goto px_hB; m0xbz: if ($org_info[2] == 2) { goto iRHSG; } goto jUF9C; O7dma: } public static function imagecopymerge_alpha($dst_im, $src_im, $dst_x, $dst_y, $src_x, $src_y, $src_w, $src_h, $pct) { goto D6HfZ; D6HfZ: $opacity = $pct; goto xTuba; f8WNh: $white = imagecolorallocate($cut, 255, 255, 255); goto afRdl; ZTtba: imagecopy($cut, $dst_im, 0, 0, $dst_x, $dst_y, $src_w, $src_h); goto qOdD6; ugcEo: return imagecopymerge($dst_im, $cut, $dst_x, $dst_y, $src_x, $src_y, $src_w, $src_h, $opacity); goto XnuhE; qOdD6: imagecopy($cut, $src_im, 0, 0, $src_x, $src_y, $src_w, $src_h); goto ugcEo; afRdl: imagefill($cut, 0, 0, $white); goto ZTtba; xTuba: $cut = imagecreatetruecolor($src_w, $src_h); goto f8WNh; XnuhE: } public static function get_address_location($address, $key = "\x5a\130\x54\x42\132\x2d\124\x35\106\x33\66\x2d\126\67\x36\123\64\x2d\115\x5a\132\x4c\130\55\67\x44\x5a\x50\x51\55\x35\x44\106\x4d\131") { goto yyjSX; K8_SU: QB_8A: goto r4q4o; bTped: $url = sprintf($api, $address, $key); goto bshV6; IN2Wy: return false; goto K8_SU; yyjSX: $api = "\x68\x74\164\160\163\72\57\x2f\x61\160\x69\x73\x2e\x6d\x61\160\x2e\x71\161\56\143\x6f\x6d\x2f\167\x73\x2f\x67\x65\157\x63\157\x64\x65\162\57\x76\x31\x2f\x3f\141\144\144\x72\145\163\163\75\45\x73\46\x6b\x65\x79\75\x25\163"; goto Pfy48; O00rs: $data = json_decode($resp, true); goto Nv_Uc; qbegw: WeUtility::logging("\x66\x61\164\x61\x6c", "\133\x53\x75\x70\x65\x72\155\x61\x6e\124\x6f\x75\160\151\141\x6f\x55\x74\151\154\x3a\72\147\x65\164\x5f\x61\x64\x64\x72\x65\x73\163\x5f\154\x6f\x63\141\164\x69\157\x6e\135\x67\145\x74\x20\x6c\x6f\x63\x61\x74\151\x6f\156\x20\145\162\162\x6f\x72\54\x72\145\x73\160\x3d" . var_export($data, true) . "\54\x61\x64\x64\x72\145\163\163\x3d" . $address . "\54\153\x65\171\x3d" . $key); goto IN2Wy; Nv_Uc: if (!(!is_array($data) || $data["\x73\164\141\x74\165\x73"] != 0 || $data["\162\x65\163\x75\x6c\164"]["\162\x65\154\151\141\x62\151\154\x69\x74\171"] < 7)) { goto QB_8A; } goto qbegw; bshV6: $resp = file_get_contents($url); goto O00rs; Pfy48: $address = urlencode($address); goto bTped; r4q4o: return $data["\162\x65\163\x75\154\x74"]["\x6c\157\143\x61\x74\151\x6f\156"]; goto nhi6u; nhi6u: } public static function get_distance($lat1, $lng1, $lat2, $lng2) { goto DeFro; N3k1b: $lng2 = $lng2 * pi() / 180; goto N942g; ZMICH: $calcLatitude = $lat2 - $lat1; goto XNqeK; wPzWB: $stepTwo = 2 * asin(min(1, sqrt($stepOne))); goto f9SVo; DeFro: $earthRadius = 6367000; goto dTEHT; ucAFR: $lng1 = $lng1 * pi() / 180; goto aaOBB; N942g: $calcLongitude = $lng2 - $lng1; goto ZMICH; aaOBB: $lat2 = $lat2 * pi() / 180; goto N3k1b; XNqeK: $stepOne = pow(sin($calcLatitude / 2), 2) + cos($lat1) * cos($lat2) * pow(sin($calcLongitude / 2), 2); goto wPzWB; dTEHT: $lat1 = $lat1 * pi() / 180; goto ucAFR; f9SVo: $calculatedDistance = $earthRadius * $stepTwo; goto bMUNA; bMUNA: return round($calculatedDistance, 2); goto AmjoO; AmjoO: } public static function sign($data, $sign_key) { goto GKBwl; qrb6K: $data_str = ''; goto nzJwB; GKBwl: ksort($data); goto qrb6K; giNtg: $sign = strtoupper(md5($data_str)); goto ygOO0; VSJ1c: $data_str .= "\x6b\x65\171\x3d" . $sign_key; goto giNtg; ygOO0: return $sign; goto HmaZd; fQVpm: Dv4BS: goto VSJ1c; nzJwB: foreach ($data as $k => $v) { goto wwtBo; g_S2H: tKXeH: goto wwaz1; wwtBo: if (!($v == '' || $k == "\163\151\x67\156")) { goto zef34; } goto gzzrF; DmKe7: zef34: goto ao1WT; ao1WT: $data_str .= "{$k}\x3d{$v}\x26"; goto g_S2H; gzzrF: goto tKXeH; goto DmKe7; wwaz1: } goto fQVpm; HmaZd: } public static function hex2rgb($hex) { goto BnpxD; kLo1d: $g = substr($color, 1, 1) . substr($color, 1, 1); goto UqN3d; dFk6S: mA_bT: goto e8QoW; Tgxp9: $color = $hex; goto qiVws; e8QoW: $color = str_replace("\x23", '', $hex); goto jJ7lz; sQcnr: $rgb = array("\x72" => "\x30", "\147" => "\60", "\x62" => "\60"); goto dFk6S; jJ7lz: if (strlen($color) > 3) { goto s3MvA; } goto Tgxp9; w_D57: $rgb = array("\x72" => hexdec(substr($color, 0, 2)), "\x67" => hexdec(substr($color, 2, 2)), "\x62" => hexdec(substr($color, 4, 2))); goto uBCxv; UqN3d: $b = substr($color, 2, 1) . substr($color, 2, 1); goto S0xYX; Rm004: goto rjpGq; goto AQwvr; yZy98: return $rgb; goto PYeLN; AQwvr: s3MvA: goto w_D57; qiVws: $r = substr($color, 0, 1) . substr($color, 0, 1); goto kLo1d; uBCxv: rjpGq: goto yZy98; S0xYX: $rgb = array("\x72" => hexdec($r), "\x67" => hexdec($g), "\142" => hexdec($b)); goto Rm004; BnpxD: if (!($hex == '')) { goto mA_bT; } goto sQcnr; PYeLN: } public static function _create_text(&$bgimg, $text, $x, $y, $rgb, $font, $fonsize = 14) { goto W4Rda; W4Rda: $color = imagecolorallocate($bgimg, $rgb["\x72"], $rgb["\147"], $rgb["\x62"]); goto P54iV; P54iV: $gdv = self::gdVersion(); goto prrAN; OpiYh: imagettftext($bgimg, $size, 0, $x, $y + $fonsize, $color, $font, $text); goto igBVX; prrAN: $size = $gdv >= 2 ? $fonsize * 3 / 4 : $fonsize; goto OpiYh; igBVX: } public static function gdVersion($user_ver = 0) { goto HAkAA; Hbafm: if (!($user_ver != 2 && $gd_ver > 0)) { goto ec0tY; } goto qB3K6; vxKGF: $info = stristr($info, "\147\144\x20\x76\x65\162\x73\151\157\x6e"); goto xIx0V; mK1wN: phpinfo(8); goto yNBcD; IcfPo: ec0tY: goto iOYvp; PrmWa: ob_end_clean(); goto vxKGF; dvA0O: $gd_ver = $match[0]; goto ISuae; p7OzH: $gd_ver = $match[0]; goto EZAhG; ISuae: return $match[0]; goto dkvxl; xIx0V: preg_match("\57\134\x64\57", $info, $match); goto p7OzH; k3JUe: T3nHU: goto wy33Y; LI73Z: $gd_ver = 1; goto efkKN; EZAhG: return $match[0]; goto SdXYG; csojR: ob_start(); goto mK1wN; t0fRw: preg_match("\x2f\x5c\x64\x2f", $ver_info["\107\x44\x20\126\x65\162\x73\x69\x6f\x6e"], $match); goto dvA0O; W2fDJ: static $gd_ver = 0; goto cYgE3; YL0GO: if ($user_ver == 2) { goto kLTBR; } goto ZIg50; JlTAr: $gd_ver = 2; goto tbF8X; yJCcg: kLTBR: goto JlTAr; tbF8X: return 2; goto k3JUe; HAkAA: if (extension_loaded("\x67\x64")) { goto W1rVE; } goto Zu3ZL; cYgE3: if (!($user_ver == 1)) { goto Dq_En; } goto LI73Z; U0Kg1: if (!preg_match("\x2f\160\150\160\151\156\x66\157\57", ini_get("\x64\x69\163\141\x62\154\145\137\146\x75\x6e\143\x74\x69\157\156\x73"))) { goto WgTkk; } goto YL0GO; yNBcD: $info = ob_get_contents(); goto PrmWa; qB3K6: return $gd_ver; goto IcfPo; p4r6K: W1rVE: goto W2fDJ; KT8a9: goto T3nHU; goto yJCcg; ZIg50: $gd_ver = 1; goto IC7Is; FJql5: $ver_info = gd_info(); goto t0fRw; IC7Is: return 1; goto KT8a9; dkvxl: aJDg7: goto U0Kg1; efkKN: return 1; goto qDta4; Zu3ZL: return; goto p4r6K; qDta4: Dq_En: goto Hbafm; wy33Y: WgTkk: goto csojR; iOYvp: if (!function_exists("\x67\144\x5f\151\156\146\x6f")) { goto aJDg7; } goto FJql5; SdXYG: } public static function superman_wxpay_build($params, $module) { goto stkYy; Gaoqh: $paylog = array("\x75\156\151\141\143\x69\144" => $wxapp_uniacid, "\141\143\x69\144" => $wxapp_uniacid, "\164\171\x70\145" => "\167\145\x63\150\x61\164", "\157\160\145\156\151\x64" => $params["\165\x73\x65\x72"], "\x6d\157\144\x75\154\x65" => $module["\156\x61\x6d\x65"], "\x74\x69\144" => $params["\164\151\x64"], "\x75\x6e\151\x6f\156\164\x69\x64" => $uniontid, "\146\145\145" => floatval($params["\146\145\x65"]), "\x63\141\162\x64\x5f\x66\145\x65" => floatval($params["\146\x65\145"]), "\163\x74\141\x74\x75\163" => "\60", "\151\163\x5f\x75\x73\x65\x63\141\x72\144" => "\60", "\x74\141\147" => iserializer(array("\141\x63\x69\x64" => $_W["\x61\143\x69\144"], "\x75\151\x64" => $_W["\155\x65\x6d\x62\145\x72"]["\x75\x69\x64"]))); goto epmvQ; vfG31: if (!(!empty($paylog) && empty($paylog["\165\x6e\151\157\x6e\x74\x69\144"]))) { goto EwbC9; } goto I3G67; b2s3T: if (!(!empty($paylog) && $paylog["\x73\164\141\164\165\163"] != "\x30")) { goto ZSTqI; } goto Xpanh; FQH4T: $result = wechat_build($data, $wechat_payment); goto Hh3Go; F8bH6: WeUtility::logging("\146\x61\164\141\154", "\x5b\x73\x75\160\x65\162\x6d\141\156\137\167\x78\x70\x61\171\137\x62\165\x69\154\x64\135\40\146\x61\x69\x6c\145\x64\x2c\40\x72\x65\163\x75\154\x74\x3d" . var_export($result, true) . "\x2c\x20\144\141\x74\x61\x3d" . var_export($data, true) . "\54\40\167\x65\143\x68\141\164\x3d" . var_export($wechat_payment, true)); goto rU27U; ukOJQ: $paylog["\165\x6e\x69\157\x6e\x74\151\x64"] = $uniontid; goto Bi3qY; HW8QQ: $moduleid = empty($module["\x6d\x69\144"]) ? "\60\x30\x30\60\x30\x30" : sprintf("\x25\x30\x36\x64", $module["\155\x69\x64"]); goto scKk3; LOnTv: $paylog = pdo_get("\x63\157\162\145\x5f\160\x61\171\x6c\157\x67", array("\x75\156\x69\x61\143\x69\144" => $wxapp_uniacid, "\155\x6f\144\165\x6c\x65" => $module["\x6e\141\155\145"], "\x74\151\144" => $params["\x74\151\x64"])); goto nBoUh; nBoUh: if (!empty($paylog)) { goto Hzghe; } goto Gaoqh; dbpmp: load()->model("\x70\141\x79\x6d\x65\x6e\x74"); goto aTmAd; hpbiY: if (!(empty($params) || !array_key_exists($module["\156\x61\155\x65"], $moduels))) { goto svuV6; } goto aNNR2; ljemi: ZSTqI: goto vfG31; rU27U: fiBho: goto R6Ibu; aNNR2: return error(1, "\xe6\xa8\241\xe5\x9d\227\xe4\270\215\345\xad\x98\xe5\x9c\xa8"); goto GIRP6; iQ376: $setting = uni_setting($wxapp_uniacid, array("\160\141\171\155\x65\156\x74")); goto pBlVN; pBlVN: $wechat_payment = array("\x61\x70\160\x69\x64" => $params["\x61\160\160\x69\x64"], "\163\x69\147\x6e\x6b\145\x79" => $setting["\x70\141\171\x6d\145\156\x74"]["\x77\x65\x63\x68\x61\x74"]["\163\151\x67\x6e\x6b\x65\x79"], "\x6d\143\150\151\x64" => $setting["\x70\x61\x79\155\145\x6e\x74"]["\167\x65\143\150\141\164"]["\155\143\x68\x69\144"], "\x76\x65\162\x73\151\x6f\156" => 2); goto FQH4T; qbELa: Hzghe: goto b2s3T; GIRP6: svuV6: goto HW8QQ; M6s5k: $data = array("\164\x69\x64" => $paylog["\x74\x69\x64"], "\146\145\x65" => $paylog["\143\141\162\144\x5f\x66\x65\x65"], "\165\x73\x65\162" => $paylog["\x6f\160\x65\156\x69\144"], "\165\156\x69\157\x6e\164\x69\144" => $paylog["\165\156\151\157\x6e\164\x69\x64"], "\x74\151\x74\154\145" => $params["\x74\x69\x74\154\x65"]); goto iQ376; R6Ibu: return $result; goto W_3Vb; I3G67: pdo_update("\x63\x6f\x72\x65\137\x70\141\x79\x6c\157\x67", array("\x75\156\151\157\156\x74\x69\144" => $uniontid), array("\160\x6c\151\x64" => $paylog["\160\x6c\x69\x64"])); goto ukOJQ; ye76d: $_W["\x6f\x70\x65\x6e\151\144"] = $paylog["\157\x70\x65\x6e\x69\144"]; goto M6s5k; Hh3Go: if (!is_error($result)) { goto fiBho; } goto F8bH6; epmvQ: pdo_insert("\143\x6f\x72\x65\x5f\x70\141\x79\154\x6f\147", $paylog); goto Gz6fj; ga7Rz: $wxapp_uniacid = $params["\165\156\151\141\143\151\144"]; goto LOnTv; aTmAd: load()->model("\x61\143\x63\157\x75\156\x74"); goto nSjwH; nSjwH: $moduels = uni_modules(); goto hpbiY; Bi3qY: EwbC9: goto ye76d; Gz6fj: $paylog["\160\154\x69\x64"] = pdo_insertid(); goto qbELa; scKk3: $uniontid = date("\x59\155\144\x48\x69\163") . $moduleid . random(8, 1); goto ga7Rz; stkYy: global $_W, $_GPC; goto dbpmp; Xpanh: return error(1, "\350\xbf\231\344\270\252\350\xae\242\345\x8d\x95\xe5\267\262\347\273\217\xe6\x94\257\xe4\xbb\230\xe6\x88\220\345\x8a\237\x2c\40\xe4\270\x8d\xe9\x9c\200\xe8\246\x81\xe9\207\215\345\244\215\xe6\x94\xaf\xe4\xbb\230\56"); goto ljemi; W_3Vb: } public static function get_credit_poster_path($uid, $id, $uniacid) { goto EqmrT; UcauB: $poster_filename = md5("\123\165\160\x65\162\x6d\x61\156\x54\157\165\x70\x69\x61\157\x55\164\151\x6c\72\x63\x72\145\144\151\x74\137\x70\157\x73\164\145\162\72" . $uid . $uniacid) . "\55" . $id . "\56\x70\156\x67"; goto dHmdf; dHmdf: $poster_path = $path . "\57" . $poster_filename; goto w8wU_; lifQ2: mkdirs(MODULE_ROOT . "\57" . $path); goto UcauB; aHavF: $path = "\x64\x61\x74\x61\x2f" . $_W["\x75\x6e\151\141\143\151\144"] . "\57\160\157\x73\164\145\162"; goto lifQ2; w8wU_: return $poster_path; goto g0jKB; EqmrT: global $_W; goto aHavF; g0jKB: } public static function resize_image($img_src, $new_img_path, $new_width, $new_height) { goto JRXet; bcs2t: goto O6fFO; goto u5u_p; GBSfC: ZuxcH: goto NioYi; vBW9l: $new_img = imagecreate($new_width, $new_height); goto HedzN; su8oQ: if (function_exists("\151\x6d\x61\x67\x65\143\157\160\x79\x72\145\163\x61\x6d\x70\x6c\145\144")) { goto A_e5g; } goto vBW9l; jm2ev: imagejpeg($new_img, $new_img_path); goto raMIJ; JRXet: $img_info = @getimagesize($img_src); goto Nkliw; EC9ha: LyOtD: goto btliJ; gfY8c: wZRh6: goto tlCAT; BUGYI: return false; goto GBSfC; Eos5P: iOVXq: goto LmUy7; BOzTP: ijh82: goto bcs2t; k4l87: if (strpos($img_info["\155\x69\155\145"], "\x70\156\x67") !== false) { goto iOVXq; } goto YTbG_; p1n1l: $new_img = imagecreatetruecolor($new_width, $new_height); goto LQ5cZ; h8hkX: BsjKv: goto c1p_p; x3305: O6fFO: goto jyr02; u5u_p: Gevdo: goto g388l; HedzN: imagecopyresized($new_img, $pic_obj, 0, 0, 0, 0, $new_width, $new_height, $pic_width, $pic_height); goto gY_Ex; IC919: switch ($new_type) { case "\152\x70\x67": imagejpeg($new_img, $new_img_path); goto QKhSG; case "\x67\x69\x66": imagegif($new_img, $new_img_path); goto QKhSG; case "\x70\x6e\147": imagepng($new_img, $new_img_path); goto QKhSG; default: imagejpeg($new_img, $new_img_path); } goto P88Os; LmUy7: $pic_obj = imagecreatefrompng($img_src); goto BNEU1; P88Os: VfQVS: goto nd73u; btliJ: if (preg_match("\176\x2e\50\133\136\56\x5d\53\51\x24\176", $new_img_path, $match)) { goto BsjKv; } goto jm2ev; gY_Ex: goto LyOtD; goto zTjBG; W0xf5: if (strpos($img_info["\155\151\x6d\x65"], "\x67\x69\146") !== false) { goto XTDMD; } goto k4l87; wmyPf: imagedestroy($new_img); goto UN7pg; R7qb2: goto VOhCO; goto Eos5P; UN7pg: return true; goto uF07t; tlCAT: imagedestroy($pic_obj); goto wmyPf; nd73u: QKhSG: goto gfY8c; NioYi: if (strpos($img_info["\155\151\x6d\x65"], "\152\x70\x65\147") !== false) { goto Gevdo; } goto W0xf5; Up1b3: $pic_height = imagesy($pic_obj); goto su8oQ; Nkliw: if (!(!$img_info || $new_width < 1 || $new_height < 1 || empty($new_img_path))) { goto ZuxcH; } goto BUGYI; YTbG_: return false; goto R7qb2; fPh7t: XTDMD: goto VY1Ic; raMIJ: goto wZRh6; goto h8hkX; jyr02: $pic_width = imagesx($pic_obj); goto Up1b3; g388l: $pic_obj = imagecreatefromjpeg($img_src); goto x3305; BNEU1: VOhCO: goto sLe12; LQ5cZ: imagecopyresampled($new_img, $pic_obj, 0, 0, 0, 0, $new_width, $new_height, $pic_width, $pic_height); goto EC9ha; c1p_p: $new_type = strtolower($match[1]); goto IC919; sLe12: goto ijh82; goto fPh7t; VY1Ic: $pic_obj = imagecreatefromgif($img_src); goto BOzTP; zTjBG: A_e5g: goto p1n1l; uF07t: } public static function circle_avatar($url, $path = "\x2e\x2f") { goto IerSv; LWhMw: $r = $w / 2; goto we8p8; U_A3A: oLY3B: goto rIzEM; WpXG3: imagepng($newpic, $dest_path); goto HqZFp; G8xpK: vPk7p: goto ODyJG; jxgV3: $y = 0; goto U_A3A; MTmDi: $newpic = imagecreatetruecolor($w, $h); goto KgP4Z; RJawE: $_x = $x - $w / 2; goto dPIBk; cQ4U0: goto g0xYK; goto le0P8; V6xXc: $h = 110; goto nymjR; e4RZ0: imagesavealpha($newpic, true); goto WpXG3; gEEHH: $transparent = imagecolorallocatealpha($newpic, 0, 0, 0, 127); goto LWhMw; scGZy: if ($_x * $_x + $_y * $_y < $r * $r) { goto vPk7p; } goto g6wjp; S8VkH: Wbq7B: goto u58oD; rIzEM: if (!($y < $h)) { goto doYY8; } goto Vp042; le0P8: y0fa7: goto e4RZ0; F8txF: $x++; goto cQ4U0; HqZFp: imagedestroy($newpic); goto zjk3b; nymjR: $original_path = $url; goto Ksi3Z; ODyJG: imagesetpixel($newpic, $x, $y, $c); goto S8VkH; Vp042: $c = imagecolorat($src, $x, $y); goto RJawE; QzDKe: goto Wbq7B; goto G8xpK; g6wjp: imagesetpixel($newpic, $x, $y, $transparent); goto QzDKe; KgP4Z: imagealphablending($newpic, false); goto gEEHH; Kbu0z: doYY8: goto iD9gE; SXJYN: if (!($x < $w)) { goto y0fa7; } goto jxgV3; u58oD: g75k5: goto D2MCf; zjk3b: imagedestroy($src); goto aUab2; Ksi3Z: $dest_path = $path . md5($url) . "\x2e\160\156\147"; goto NPKd1; dPIBk: $_y = $y - $h / 2; goto scGZy; we8p8: $x = 0; goto m9n96; D2MCf: $y++; goto uBKuk; uBKuk: goto oLY3B; goto Kbu0z; aUab2: return $dest_path; goto awkXB; iD9gE: xtiON: goto F8txF; m9n96: g0xYK: goto SXJYN; NPKd1: $src = imagecreatefromstring(file_get_contents($original_path)); goto MTmDi; IerSv: $w = 110; goto V6xXc; awkXB: } public static function resize_img($imgname) { goto H1E0z; l_4CK: return $imgname; goto ZXaTy; okGvw: $dst_im = imagecreatetruecolor($newwidth, $newheight); goto GRkdd; wBPFN: imagejpeg($dst_im, $imgname); goto AiMH3; MC5Cn: imagedestroy($src_im); goto l_4CK; H1E0z: $file = $imgname; goto Zugaw; GRkdd: imagecopyresized($dst_im, $src_im, 0, 0, 0, 0, $newwidth, $newheight, $width, $height); goto wBPFN; cbvo1: $percent = 110 / $width; goto bOGxM; cVpc6: $newheight = $height * $percent; goto iBIbJ; AiMH3: imagedestroy($dst_im); goto MC5Cn; bOGxM: $newwidth = $width * $percent; goto cVpc6; Zugaw: list($width, $height) = getimagesize($file); goto cbvo1; iBIbJ: $src_im = imagecreatefromjpeg($file); goto okGvw; ZXaTy: } public static function getmemberlimits($uid) { goto EFIK2; gJwcu: TGa0e: goto YbR_a; xm8nO: $permission_name = array(); goto Ibbf8; U6g4g: opSPm: goto UMs6D; P0UvK: YItnF: goto qDiUA; mjujf: unset($permission); goto TxI3q; XuPr2: foreach ($user_permissions as $key => &$permission) { goto x1ZYi; E1vm3: TY3A4: goto xJ0bZ; UHN69: $permission["\160\x65\162\x6d\151\x73\x73\151\x6f\156"] = explode("\x7c", $permission["\x70\145\162\155\x69\x73\x73\x69\x6f\156"]); goto w1K0I; w1K0I: foreach ($permission["\x70\145\x72\155\151\163\163\151\x6f\156"] as $k => $val) { goto wfh1I; wfh1I: $permission["\160\x65\162\x6d\151\x73\163\151\157\156"][$val] = $permission_name[$val]; goto yU21M; yU21M: unset($permission["\160\145\162\x6d\x69\163\x73\x69\157\x6e"][$k]); goto x9jl8; x9jl8: nVsPU: goto nyJIm; nyJIm: } goto T3Otm; Eutsn: t0CJu: goto E1vm3; x1ZYi: if (empty($permission["\x70\x65\x72\x6d\151\x73\163\151\x6f\x6e"])) { goto t0CJu; } goto UHN69; T3Otm: YsIlR: goto Eutsn; xJ0bZ: } goto ALxYg; Y2KTR: $current_module_permission = module_permission_fetch($module_name); goto xm8nO; C50Nu: foreach ($current_module_permission as $key => $permission) { $permission_name[$permission["\x70\145\162\155\151\x73\x73\x69\x6f\156"]] = $permission["\x74\x69\x74\x6c\145"]; Kpykh: } goto P0UvK; zm5T9: foreach ($user_permissions as $us) { goto GuMKC; GuMKC: if (!($us["\x75\163\145\162\x5f\151\156\146\x6f"]["\165\x69\x64"] == $uid)) { goto x8cJs; } goto xpKEv; xpKEv: foreach ($us["\160\x65\162\155\151\163\163\151\x6f\156"] as $k => $p) { $menu[] = $k; pYuzx: } goto T832J; h4Uja: x8cJs: goto dvMxp; dvMxp: wHEp7: goto IRuO_; T832J: TW1Lr: goto h4Uja; IRuO_: } goto U6g4g; UMs6D: if (in_array("\170\x69\x61\x6f\146\137\x74\x6f\x75\160\x69\141\x6f\137\143\x6f\x76\x65\x72\137\x67\x69\146\x74", $menu) || $menu[0] == "\141\x6c\x6c") { goto lwouU; } goto VYfeO; VYfeO: return false; goto Ohh9n; Ohh9n: goto TGa0e; goto UX2oM; UX2oM: lwouU: goto xk3Ku; ALxYg: kb3Yq: goto mjujf; kV3Zv: if (empty($user_permissions)) { goto YaInl; } goto XuPr2; qDiUA: aGLeV: goto kV3Zv; EFIK2: $module_name = "\x78\x69\141\157\146\x5f\164\157\x75\x70\151\x61\157"; goto yIqdJ; yIqdJ: $user_permissions = module_clerk_info($module_name); goto Y2KTR; xk3Ku: return true; goto gJwcu; TxI3q: YaInl: goto fRAjm; Ibbf8: if (empty($current_module_permission)) { goto aGLeV; } goto C50Nu; fRAjm: $menu = array(); goto zm5T9; YbR_a: } }