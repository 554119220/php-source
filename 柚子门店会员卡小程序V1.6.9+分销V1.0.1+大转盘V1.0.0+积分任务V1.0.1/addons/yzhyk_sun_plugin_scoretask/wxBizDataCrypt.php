<?php
 goto KChr0; KChr0: include_once "\160\153\x63\x73\x37\105\x6e\143\157\x64\x65\x72\x2e\x70\150\x70"; goto EA06d; EA06d: include_once "\x65\162\x72\157\162\103\x6f\x64\x65\x2e\x70\150\160"; goto zIHpr; zIHpr: class WXBizDataCrypt { private $appid; private $sessionKey; public function WXBizDataCrypt($appid, $sessionKey) { $this->sessionKey = $sessionKey; $this->appid = $appid; } public function decryptData($encryptedData, $iv, &$data) { goto n6H0Q; bWJZI: if (!($dataObj->watermark->appid != $this->appid)) { goto yatzS; } goto NsvJC; Yxhcz: $aesKey = base64_decode($this->sessionKey); goto JooqC; DCb6_: BATul: goto bWJZI; n6H0Q: if (!(strlen($this->sessionKey) != 24)) { goto Zbrf6; } goto qluUV; ZWnta: $aesCipher = base64_decode($encryptedData); goto IOqjC; GWoPC: yatzS: goto b0NnT; NsvJC: return ErrorCode::$IllegalBuffer; goto GWoPC; ZqiW4: OXEq4: goto On9BV; U0piE: return ErrorCode::$IllegalIv; goto ZqiW4; Helgv: if (!($dataObj == NULL)) { goto BATul; } goto Q0Whb; qluUV: return ErrorCode::$IllegalAesKey; goto aZjQ1; Ci_Hj: return ErrorCode::$OK; goto a6_2M; wdQMt: $dataObj = json_decode($result[1]); goto Helgv; Q0Whb: return ErrorCode::$IllegalBuffer; goto DCb6_; IOqjC: $pc = new Prpcrypt($aesKey); goto kOvzX; b0NnT: $data = $result[1]; goto Ci_Hj; JooqC: if (!(strlen($iv) != 24)) { goto OXEq4; } goto U0piE; kOvzX: $result = $pc->decrypt($aesCipher, $aesIV); goto EBFAK; aZjQ1: Zbrf6: goto Yxhcz; teK0C: return $result[0]; goto jIlCJ; EBFAK: if (!($result[0] != 0)) { goto joKGH; } goto teK0C; On9BV: $aesIV = base64_decode($iv); goto ZWnta; jIlCJ: joKGH: goto wdQMt; a6_2M: } }