<?php
 goto qJ6R0; rCLsy: include_once "\x65\x72\162\x6f\162\103\x6f\144\x65\56\160\150\x70"; goto Jk2H6; qJ6R0: include_once "\160\153\143\163\x37\x45\156\x63\157\144\x65\162\x2e\160\150\160"; goto rCLsy; Jk2H6: class WXBizDataCrypt { private $appid; private $sessionKey; public function WXBizDataCrypt($appid, $sessionKey) { $this->sessionKey = $sessionKey; $this->appid = $appid; } public function decryptData($encryptedData, $iv, &$data) { goto WXolk; Rm7Rl: i1Dal: goto Pdps6; wIwe0: return ErrorCode::$OK; goto S_0VQ; mi_es: if (!($result[0] != 0)) { goto nqu8g; } goto LqPZy; GuxFl: $aesIV = base64_decode($iv); goto Z65hd; V6bvb: return ErrorCode::$IllegalAesKey; goto cL_B8; WXolk: if (!(strlen($this->sessionKey) != 24)) { goto I4ZHS; } goto V6bvb; Af57a: nqu8g: goto wIH1T; Z65hd: $aesCipher = base64_decode($encryptedData); goto WdEj7; wIH1T: $dataObj = json_decode($result[1]); goto QMD4z; WdEj7: $pc = new Prpcrypt($aesKey); goto Z7grW; u5f3w: return ErrorCode::$IllegalIv; goto UmUgM; Pdps6: if (!($dataObj->watermark->appid != $this->appid)) { goto BuEvi; } goto N2Qpy; YrPg3: $aesKey = base64_decode($this->sessionKey); goto cj7ev; SFgwt: return ErrorCode::$IllegalBuffer; goto Rm7Rl; sbNQR: $data = $result[1]; goto wIwe0; QMD4z: if (!($dataObj == NULL)) { goto i1Dal; } goto SFgwt; Z7grW: $result = $pc->decrypt($aesCipher, $aesIV); goto mi_es; g3OOS: BuEvi: goto sbNQR; cL_B8: I4ZHS: goto YrPg3; cj7ev: if (!(strlen($iv) != 24)) { goto KUnhF; } goto u5f3w; LqPZy: return $result[0]; goto Af57a; N2Qpy: return ErrorCode::$IllegalBuffer; goto g3OOS; UmUgM: KUnhF: goto GuxFl; S_0VQ: } }