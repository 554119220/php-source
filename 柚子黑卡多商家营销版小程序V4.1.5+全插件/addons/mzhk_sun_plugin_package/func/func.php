<?php
 goto bprl6; RnvLy: function checkurl($u) { goto GzJ6l; yMfku: header("\114\x6f\143\x61\x74\x69\157\156\72" . $u); goto dEb22; BsxOP: gvACv: goto j4bIu; qeB21: $settype = $_GPC["\x73\145\x74\x74\171\160\145"]; goto GEGCA; GEGCA: if (!($settype != 3)) { goto gvACv; } goto Hi3UX; Hi3UX: $u = url("\x73\151\x74\x65\57\x65\156\x74\x72\x79\x2f\x73\x65\x74\164\151\x6e\147", array("\155" => $_W["\143\x75\162\x72\145\x6e\x74\x5f\x6d\157\144\165\x6c\x65"]["\156\x61\155\x65"], "\x73\145\164\x74\171\160\x65" => 3)); goto yMfku; dEb22: exit; goto BsxOP; GzJ6l: global $_W, $_GPC; goto qeB21; j4bIu: } goto b6A61; lmpQQ: function getTopDomainhuo() { goto LC1Bb; V5Swi: $domain = $host; goto Lzgv6; LC1Bb: $host = $_SERVER["\110\124\x54\120\137\110\117\x53\124"]; goto NzvqM; tv2UQ: if (preg_match("\x2f" . $matchstr . "\57\151\x65\163", $host, $matchs)) { goto QKXSh; } goto V5Swi; NzvqM: $matchstr = "\x5b\x5e\x5c\x2e\135\53\x5c\x2e\50\x3f\72\x28" . $str . "\51\174\134\x77\173\62\x7d\174\50\x28" . $str . "\51\134\x2e\x5c\x77\173\x32\x7d\51\x29\44"; goto tv2UQ; Lzgv6: goto oBOyi; goto WTdDs; RmXpw: $domain = $matchs["\60"]; goto a9Q6O; a9Q6O: oBOyi: goto MGhcJ; MGhcJ: return $domain; goto I5haA; WTdDs: QKXSh: goto RmXpw; I5haA: } goto TJuUX; TJuUX: class EB042D8DD30DD982EF27DF80492D786B { private $ip_a; private $check = "\61\71\67\x32\x4b\x2b\x76\x62\151\x70\x64\132\105\132\x61\x63\x4f\x37\x67\150\x6d\167\x6b\x6d\103\160\x2b\x6c\x77\x76\x31\144\117\111\151\x38\x51\116\142\141\172\62\104\71\x30\x49\x41\x41\121\115\x4a\101\66\170\66\66\122\104\171\152\164\164\124\122\57\172\x62\114\x2b\x43\x67\103\x36\57\x44\125\142\131\63\x4e"; public function __construct() { $this->ip_a = gethostbynamel($_SERVER["\x48\124\x54\x50\137\x48\x4f\123\124"]); } static function B52AF623E29C91E28D727BA5B05812F3() { goto nG9cw; JA9Gs: if (!$isnoauth) { goto ABmbH; } goto RJzTe; s4Tby: return true; goto yETZE; OLS1F: qibhi: goto GBoJF; Z836O: $contents_a = encryptcode($contents_a_e["\x63\157\x64\145"], "\104", '', 0); goto QNQTi; fKUln: $getdocode_a = getdocode($cb9b, $check, $u); goto AndSn; tZFyG: if (!($con_a["\144\x6f\x6d\x61\151\156"] != $domain_a || $con_a["\160\x69\x64"] != $cb9b)) { goto NxD1V; } goto b9o1b; TjbJj: if (!$contents_a_e) { goto UHqsy; } goto Z836O; uHMAK: $domain_a = $_SERVER["\x48\124\124\120\x5f\x48\117\x53\x54"]; goto eeFc9; ofAmT: ABmbH: goto dTzy6; FZ2OS: $check = "\x31\71\67\62\x4b\53\x76\142\151\x70\x64\x5a\105\x5a\x61\x63\x4f\67\x67\x68\x6d\x77\153\x6d\x43\160\x2b\154\x77\166\61\144\x4f\x49\151\70\x51\116\142\141\172\62\104\x39\60\111\x41\101\x51\115\x4a\101\66\x78\x36\66\122\104\x79\152\164\x74\x54\122\x2f\x7a\x62\x4c\x2b\x43\147\x43\x36\x2f\x44\x55\142\131\63\116"; goto uHMAK; YTaC5: $time_a = time(); goto Pddn2; PwCvg: checkurl($u); goto OkDR5; LPTLW: df2Kq: goto s4Tby; c_eXt: goto df2Kq; goto PmI_I; Pddn2: if (!($con_a["\x74\151\155\145"] < $time_a - 3600 * 24 * 5)) { goto oVy2H; } goto fKUln; dTzy6: NxD1V: goto LPTLW; Ez31A: if (!($getdocode_a !== 0)) { goto medKh; } goto PwCvg; OkDR5: medKh: goto c_eXt; HQbVH: $domain_str = explode("\54", $con_a["\x64\157\155\141\x69\156\x5f\163\x74\162"]); goto dKVLc; JkT25: $cb9b = 41; goto FZ2OS; RJzTe: checkurl($u); goto ofAmT; YxYo_: $isnoauth = false; goto OLS1F; GBoJF: uHT1z: goto JA9Gs; PmI_I: Z4CxG: goto h0Tok; lmWSx: $getdocode_a = getdocode($cb9b, $check, $u); goto Ez31A; sgLEh: if (!empty($contents_a)) { goto Z4CxG; } goto lmWSx; AndSn: oVy2H: goto tZFyG; eeFc9: $contents_a_e = pdo_get("\x6d\172\x68\x6b\137\163\x75\156\x5f\141\143\157\144\145", array("\151\x64" => 41)); goto TjbJj; h0Tok: $con_a = unserialize($contents_a); goto YTaC5; nG9cw: global $_W; goto JkT25; b9o1b: $isnoauth = true; goto scbaL; QNQTi: UHqsy: goto sgLEh; dKVLc: if (!in_array($domain_a, $domain_str)) { goto qibhi; } goto YxYo_; scbaL: if (!$con_a["\144\x6f\x6d\141\x69\x6e\137\x73\164\162"]) { goto uHT1z; } goto HQbVH; yETZE: } } goto g_9F1; b6A61: function encryptcode($string, $operation = "\104", $key = '', $expiry = 0) { goto oldbc; nB9Lk: $box[$j] = $tmp; goto IMYi1; dGHlR: goto OXM_H; goto VE6qa; wQyjI: uL31F: goto Nx2X_; S25eT: return $keyc . str_replace("\x3d", '', base64_encode($result)); goto dGHlR; oldbc: $ckey_length = 4; goto q5IkR; OXO3N: $tmp = $box[$a]; goto LIZd8; UTeO1: $j = ($j + $box[$a]) % 256; goto OXO3N; pybPA: c2xvk: goto Ubvqn; Nx2X_: $j = $i = 0; goto s10ie; nXCGi: goto k_IVx; goto kjPov; g5EpL: $rndkey[$i] = ord($cryptkey[$i % $key_length]); goto YT83P; LJft3: return substr($result, 26); goto YVtr0; LNaUJ: NbgXv: goto wRzhn; eEFyX: $key_length = strlen($cryptkey); goto CTZ_P; l9ojt: $rndkey = array(); goto qsgRW; rZIr0: $i++; goto r2nLX; VE6qa: Zkx3O: goto f6PBs; rHyQx: goto qm4Hp; goto WsyEw; QZbZq: $j = ($j + $box[$i] + $rndkey[$i]) % 256; goto esefj; Ej8g5: $box[$i] = $box[$j]; goto lrvrU; CTZ_P: $string = $operation == "\104" ? base64_decode(substr($string, $ckey_length)) : sprintf("\45\x30\x31\x30\x64", $expiry ? $expiry + time() : 0) . substr(md5($string . $keyb), 0, 16) . $string; goto piPDX; FIlpc: if ($operation == "\x44") { goto Zkx3O; } goto S25eT; P0gyA: $i++; goto gSMtF; s10ie: ygx3U: goto Hg3f1; qsgRW: $i = 0; goto LNaUJ; q5IkR: $key = md5($key ? $key : "\130\155\172\x68\x79\61\62\63\x40\x23\44"); goto bl_iX; j_P7s: $keyb = md5(substr($key, 16, 16)); goto JuHaH; piPDX: $string_length = strlen($string); goto BnuuM; LIZd8: $box[$a] = $box[$j]; goto nB9Lk; bl_iX: $keya = md5(substr($key, 0, 16)); goto j_P7s; YVtr0: k_IVx: goto sOQku; kjPov: OdEzf: goto LJft3; gSMtF: goto ygx3U; goto zu_Tx; PMIr7: $box = range(0, 255); goto l9ojt; Ubvqn: $i++; goto rHyQx; ndOz7: return ''; goto nXCGi; JuHaH: $keyc = $ckey_length ? $operation == "\x44" ? substr($string, 0, $ckey_length) : substr(md5(microtime()), -$ckey_length) : ''; goto x26VT; YT83P: CyKW8: goto rZIr0; esefj: $tmp = $box[$i]; goto Ej8g5; sOQku: OXM_H: goto eioCx; CHi2m: LlUrE: goto P0gyA; lrvrU: $box[$j] = $tmp; goto CHi2m; wRzhn: if (!($i <= 255)) { goto uL31F; } goto g5EpL; RpUO4: $a = ($a + 1) % 256; goto UTeO1; BnuuM: $result = ''; goto PMIr7; r2nLX: goto NbgXv; goto wQyjI; WsyEw: oPyzG: goto FIlpc; Hg3f1: if (!($i < 256)) { goto QdJGI; } goto QZbZq; x26VT: $cryptkey = $keya . md5($keya . $keyc); goto eEFyX; f6PBs: if ((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() > 0) && substr($result, 10, 16) == substr(md5(substr($result, 26) . $keyb), 0, 16)) { goto OdEzf; } goto ndOz7; zu_Tx: QdJGI: goto w3ZF4; w3ZF4: $a = $j = $i = 0; goto RroHF; IMYi1: $result .= chr(ord($string[$i]) ^ $box[($box[$a] + $box[$j]) % 256]); goto pybPA; RroHF: qm4Hp: goto WQCml; WQCml: if (!($i < $string_length)) { goto oPyzG; } goto RpUO4; eioCx: } goto lmpQQ; ODJy4: function getrealip() { goto KdVdw; zsnLe: $realip = gethostbynamel($_SERVER["\123\x45\122\126\x45\x52\137\x4e\101\x4d\x45"]); goto WKqva; WKqva: return $realip; goto wXwEs; KdVdw: static $realip; goto zsnLe; wXwEs: } goto T90aU; FUBpF: global $_W, $_GPC; goto IDhHT; bprl6: defined("\x49\x4e\137\x49\x41") or exit("\101\143\143\x65\163\x73\40\x44\145\x6e\151\x65\144"); goto FUBpF; T90aU: function creatmdcode($str) { return md5($str); } goto RnvLy; Iz74q: function exportToExcel($filename, $tileArray = array(), $dataArray = array()) { goto Hi1HX; r5Oce: foreach ($dataArray as $item) { goto vFgEp; AoWv2: fputcsv($fp, $item); goto vvCBv; vFgEp: $index++; goto AoWv2; vvCBv: h5w9F: goto CDch7; CDch7: } goto mFQhe; OG_UX: ob_flush(); goto Cp7XF; SOYpW: ob_start(); goto Vd3d5; owPZz: fwrite($fp, chr(0xef) . chr(0xbb) . chr(0xbf)); goto ZdFLe; CU6Ph: $index = 0; goto r5Oce; ZdFLe: fputcsv($fp, $tileArray); goto CU6Ph; RZhY8: ini_set("\155\x61\170\137\x65\x78\145\x63\165\x74\151\x6f\156\137\x74\151\155\145", 0); goto Z6f_i; Z6f_i: ob_end_clean(); goto SOYpW; Vd3d5: header("\x43\157\x6e\164\x65\156\164\55\x54\171\x70\145\72\40\x74\x65\x78\164\57\x63\163\x76"); goto CLr2O; Cp7XF: flush(); goto LEvtx; LEvtx: ob_end_clean(); goto fKGqq; wfRwX: $fp = fopen("\x70\x68\x70\72\x2f\57\x6f\x75\x74\160\x75\164", "\x77"); goto owPZz; CLr2O: header("\x43\x6f\156\x74\x65\x6e\164\55\104\x69\x73\160\157\163\151\x74\151\157\156\x3a\146\x69\x6c\145\156\141\155\145\x3d" . $filename); goto wfRwX; mFQhe: T9orj: goto OG_UX; Hi1HX: ini_set("\x6d\x65\155\x6f\x72\171\x5f\x6c\151\155\151\x74", "\65\61\x32\x4d"); goto RZhY8; fKGqq: } goto cchaI; gbjV1: function substr_text($str, $start = 0, $length, $charset = "\x75\164\146\x2d\x38", $suffix = '') { goto AM6R3; MX1kD: $re["\x75\x74\x66\x2d\x38"] = "\57\133\1\x2d\177\135\x7c\x5b\302\x2d\xdf\135\x5b\200\55\xbf\x5d\174\133\340\55\357\135\x5b\x80\55\xbf\x5d\173\62\x7d\174\133\xf0\55\377\x5d\x5b\200\x2d\xbf\x5d\173\x33\175\x2f"; goto kmHL3; sm2zi: return iconv_substr($str, $start, $length, $charset) . $suffix; goto taThy; qup1z: if (function_exists("\x69\143\x6f\x6e\166\x5f\163\x75\x62\x73\x74\x72")) { goto QyrKM; } goto r1T3_; sJG3m: $re["\147\x62\x6b"] = "\57\133\1\x2d\177\x5d\x7c\133\x81\55\376\x5d\133\100\55\376\135\57"; goto Xe6x5; UrRET: QyrKM: goto sm2zi; GBx6M: goto q3RCt; goto UrRET; G0Z63: return mb_substr($str, $start, $length, $charset) . $suffix; goto GBx6M; r1T3_: goto q3RCt; goto iuGNy; taThy: q3RCt: goto MX1kD; AM6R3: if (function_exists("\x6d\x62\137\163\165\x62\x73\x74\162")) { goto YL_5c; } goto qup1z; TDySk: return $slice . $suffix; goto jC_rx; Xe6x5: $re["\142\151\x67\65"] = "\x2f\x5b\1\55\x7f\x5d\x7c\133\x81\x2d\376\x5d\x28\133\x40\55\176\x5d\174\241\55\376\135\x29\57"; goto px390; kmHL3: $re["\x67\142\x32\63\61\x32"] = "\x2f\133\x1\x2d\x7f\x5d\x7c\x5b\xb0\55\xf7\x5d\x5b\240\x2d\376\x5d\57"; goto sJG3m; px390: preg_match_all($re[$charset], $str, $match); goto IN74Q; iuGNy: YL_5c: goto G0Z63; IN74Q: $slice = join('', array_slice($match[0], $start, $length)); goto TDySk; jC_rx: } goto IVXoy; g_9F1: function sendtelmessage($openid = '', $tpltype = '', $haveformid = '', $data = '') { goto kvDiL; SLfGR: $form_id = $haveformid; goto EnE_l; E2FNJ: return false; goto LqJX6; GO7Ne: $d_set = pdo_get("\x6d\x7a\150\x6b\x5f\x73\165\156\137\160\x61\143\x6b\141\147\145\x5f\163\x65\x74", array("\x75\x6e\x69\x61\143\151\x64" => $_W["\165\x6e\x69\x61\143\x69\x64"]), array("\x74\x70\154\x5f\167\x69\x6e\x6e\x6f\164\x69\143\x65", "\x74\x70\154\137\x6e\x65\x77\156\157\x74\151\143\x65")); goto Qm2Er; JRhJc: return false; goto MvY1Y; CiDP3: if (empty($haveformid)) { goto VHiCd; } goto SLfGR; dXe5X: $tpl = $d_set[$tpltype]; goto ZCEcQ; v8cf5: $now = date("\131\x2d\x6d\x2d\x64", strtotime("\55\67\40\x64\x61\x79\x73")); goto JNb0s; LqJX6: w3M7M: goto CiDP3; m6t6h: VHiCd: goto ee6U7; IkytM: JtHos: goto GO7Ne; Qm2Er: if (empty($form_id)) { goto ByG3F; } goto dXe5X; ZCEcQ: if (!empty($tpl)) { goto K0R0u; } goto JRhJc; upvgb: $form_id = pdo_fetchcolumn($sql); goto lfzuH; EnE_l: goto JtHos; goto m6t6h; FVy02: if (!empty($openid)) { goto w3M7M; } goto E2FNJ; Cg3YC: $access_token = getaccess_token(); goto ouszv; tF5nV: YWSyO: goto wXOBM; OufRI: $url = "\x68\164\164\160\x73\72\x2f\x2f\x61\x70\151\x2e\x77\145\x69\170\x69\156\x2e\161\x71\x2e\143\157\155\57\x63\147\x69\55\142\x69\156\x2f\x6d\145\163\x73\x61\147\x65\x2f\167\170\x6f\x70\145\x6e\x2f\x74\145\155\x70\154\141\164\145\57\163\145\156\144\77\x61\143\x63\x65\163\x73\x5f\x74\x6f\153\145\x6e\x3d" . $access_token . ''; goto q2sfj; J_QAp: yKj3t: goto y2nU7; kvDiL: global $_W; goto FVy02; MvY1Y: K0R0u: goto DGLW7; lfzuH: $delres = pdo_delete("\155\x7a\150\153\x5f\163\165\156\137\x75\163\145\162\146\157\162\155\x69\144", array("\x66\x6f\x72\x6d\x5f\151\144" => $form_id, "\165\156\151\x61\143\151\x64" => $_W["\x75\x6e\x69\141\x63\151\x64"])); goto IkytM; JNb0s: $sql = "\x73\x65\x6c\x65\x63\164\40\146\x6f\162\155\x5f\x69\x64\40\146\x72\x6f\155\40" . tablename("\155\x7a\150\x6b\137\163\x75\156\137\165\163\145\162\x66\157\162\x6d\x69\x64") . "\x20\167\x68\145\x72\145\40\157\x70\145\156\x69\144\75\47" . $openid . "\x27\40\141\156\144\x20\x74\151\x6d\145\76\75\47" . $now . "\x27\40\x6f\162\x64\145\x72\x20\142\171\40\x69\144\x20\141\x73\x63"; goto upvgb; oiOMe: $delres = pdo_delete("\155\172\x68\x6b\x5f\163\x75\x6e\x5f\x75\x73\145\x72\146\157\x72\x6d\151\144", array("\x66\157\162\155\137\151\x64\x20\154\151\153\x65" => "\155\157\143\x6b", "\165\156\x69\x61\143\151\x64" => $_W["\165\156\151\x61\143\x69\144"])); goto v8cf5; ee6U7: $delres = pdo_delete("\155\172\150\x6b\137\163\165\x6e\137\x75\x73\145\162\146\157\162\155\x69\144", array("\x74\151\155\145\40\x3c\75" => date("\x59\x2d\x6d\x2d\144", strtotime("\x2d\x37\40\144\x61\x79\x73")), "\165\x6e\x69\x61\x63\151\x64" => $_W["\x75\156\x69\141\x63\151\x64"])); goto oiOMe; q2sfj: tocurl($url, $formwork, 0); goto tF5nV; DGLW7: switch ($tpltype) { case "\164\x70\154\x5f\x77\x69\x6e\x6e\x6f\x74\151\x63\145": $formwork = "\173\xa\x20\x20\40\40\x20\x20\x20\40\40\40\40\40\40\x20\x20\40\40\40\40\40\42\x74\157\165\163\145\162\x22\72\40\x22" . $openid . "\42\54\12\x20\x20\40\x20\40\40\x20\40\40\40\x20\x20\x20\40\40\40\x20\40\40\x20\x22\x74\x65\x6d\160\x6c\x61\x74\x65\137\x69\x64\42\72\40\x22" . $tpl . "\42\x2c\12\x20\x20\40\x20\x20\x20\40\40\40\x20\40\40\40\40\40\x20\x20\x20\40\40\x22\160\141\147\x65\x22\72\42\155\x7a\150\x6b\137\163\x75\156\57\160\x6c\x75\147\151\x6e\57\160\141\x63\153\141\147\145\57\155\171\x63\x6f\x75\160\157\156\57\x6d\x79\x63\157\x75\x70\157\x6e\x22\54\xa\40\x20\40\40\x20\40\x20\40\40\x20\x20\40\40\40\x20\40\x20\x20\x20\40\42\146\157\162\155\137\x69\144\42\x3a\42" . $form_id . "\42\54\12\x20\x20\40\40\40\x20\x20\x20\x20\40\x20\40\40\x20\40\40\x20\40\x20\x20\x22\144\141\164\x61\x22\x3a\40\x7b\xa\40\x20\x20\40\40\x20\x20\x20\40\40\x20\40\40\x20\x20\40\40\40\40\x20\x20\40\40\40\42\153\x65\171\167\157\162\x64\x31\42\72\x20\x7b\12\40\40\40\40\40\40\40\x20\x20\40\40\40\x20\x20\x20\x20\40\40\x20\x20\40\40\x20\40\x20\40\40\40\x22\x76\141\x6c\x75\x65\x22\x3a\x20\42" . $data["\x61\x77\x61\x72\x64"] . "\42\54\xa\x20\x20\40\x20\x20\x20\40\x20\40\40\x20\40\40\x20\40\x20\x20\x20\x20\40\40\x20\x20\x20\40\x20\40\40\42\x63\x6f\x6c\x6f\x72\42\72\40\42\43\x31\67\x33\61\x37\67\x22\xa\x20\x20\40\40\40\x20\x20\40\40\40\x20\40\x20\40\40\40\x20\40\40\40\40\40\x20\40\175\54\12\x20\40\x20\x20\x20\40\40\40\40\40\x20\40\x20\x20\40\x20\x20\40\x20\40\40\x20\40\x20\x22\x6b\x65\171\167\157\162\144\x32\x22\72\40\173\xa\x20\40\40\x20\40\x20\40\40\40\x20\x20\x20\x20\x20\x20\40\40\x20\40\x20\40\x20\40\x20\40\40\x20\40\x22\166\x61\x6c\165\145\42\72\x22" . $data["\x70\x72\151\172\145"] . "\42\x2c\xa\40\40\40\40\40\40\x20\x20\x20\x20\40\40\x20\40\40\40\40\x20\40\40\40\x20\x20\x20\x20\40\40\40\x22\x63\157\154\157\162\42\72\40\x22\x23\61\x37\63\61\67\x37\42\12\x20\40\40\40\x20\x20\40\40\40\40\40\x20\40\40\x20\40\40\x20\40\40\40\40\40\x20\x7d\54\12\40\40\x20\40\x20\x20\x20\x20\40\40\40\x20\40\40\x20\40\x20\40\40\40\x20\x20\40\x20\42\153\x65\171\167\157\162\x64\x33\x22\72\x20\173\xa\40\40\x20\40\x20\x20\40\x20\x20\40\x20\x20\40\40\40\x20\40\x20\40\x20\x20\40\40\x20\x20\x20\40\40\x22\166\x61\154\165\145\42\72\x20\x22" . $data["\x74\x69\155\145"] . "\x22\x2c\xa\40\x20\x20\40\x20\40\x20\40\40\x20\40\40\40\x20\x20\x20\40\40\40\40\40\x20\x20\40\40\x20\40\x20\42\143\157\x6c\157\x72\x22\72\40\42\x23\x31\x37\x33\x31\67\x37\x22\12\40\x20\x20\x20\40\x20\40\x20\x20\40\40\40\40\x20\40\x20\x20\x20\40\40\40\40\x20\x20\175\12\x20\x20\x20\40\40\40\x20\x20\40\40\40\40\40\x20\x20\x20\x20\x20\x20\40\x7d\x20\40\40\xa\x20\40\x20\40\x20\x20\40\x20\40\x20\40\x20\40\40\40\40\175"; goto nneXd; case "\x74\160\x6c\137\156\145\x77\x6e\157\164\x69\x63\145": $formwork = "\x7b\xa\x20\x20\40\40\40\x20\x20\40\x20\40\40\x20\40\x20\x20\x20\x20\x20\40\40\42\164\x6f\x75\163\x65\162\x22\x3a\x20\42" . $openid . "\42\54\12\40\40\40\40\x20\x20\x20\x20\40\x20\x20\40\40\40\x20\x20\x20\40\40\x20\x22\164\x65\x6d\x70\x6c\141\x74\145\137\151\x64\42\x3a\40\42" . $tpl . "\x22\x2c\12\x20\40\40\x20\40\40\x20\40\x20\40\x20\x20\x20\40\40\x20\40\x20\x20\40\42\160\141\147\x65\x22\x3a\42\155\172\150\153\x5f\x73\x75\x6e\57\160\154\165\147\x69\x6e\x2f\160\x61\x63\x6b\141\147\145\57\x6c\151\146\145\144\145\x74\x2f\x6c\x69\146\145\144\145\x74\xef\xbc\x9f\151\x64\75" . $data["\151\x64"] . "\x22\x2c\12\40\x20\x20\x20\40\40\x20\x20\40\40\x20\x20\40\x20\x20\x20\40\40\x20\x20\x22\146\157\x72\155\137\151\x64\x22\72\42" . $form_id . "\42\54\12\40\x20\40\40\x20\40\x20\x20\x20\x20\x20\40\x20\40\x20\x20\40\40\x20\x20\42\144\x61\x74\141\42\72\x20\173\xa\x20\40\40\x20\x20\x20\40\x20\x20\x20\40\x20\x20\40\x20\x20\40\40\40\40\x20\40\x20\40\42\x6b\145\x79\x77\x6f\x72\x64\61\x22\72\x20\173\xa\x20\40\40\x20\x20\40\40\40\40\x20\x20\x20\x20\40\40\40\40\x20\x20\40\40\40\x20\40\x20\40\x20\x20\x22\166\141\154\165\x65\42\x3a\x20\x22" . $data["\147\156\141\x6d\x65"] . "\42\x2c\12\x20\40\40\x20\40\40\x20\40\x20\40\x20\x20\40\x20\40\x20\40\40\x20\x20\x20\40\x20\x20\x20\40\x20\40\x22\x63\157\x6c\157\x72\42\72\40\x22\43\61\x37\x33\x31\67\x37\42\12\x20\x20\40\x20\40\40\x20\40\x20\40\x20\x20\x20\40\x20\x20\x20\x20\40\x20\40\x20\40\40\175\54\xa\x20\x20\x20\40\x20\40\40\x20\x20\x20\x20\40\x20\x20\40\x20\x20\40\x20\x20\x20\40\x20\x20\x22\153\x65\171\x77\x6f\162\144\x32\x22\72\40\x7b\xa\40\40\40\40\40\40\40\x20\40\40\40\x20\x20\40\x20\x20\x20\40\x20\40\x20\40\40\x20\40\x20\x20\40\42\166\141\x6c\165\145\42\x3a\x22" . $data["\x74\x69\x6d\x65"] . "\42\54\12\x20\40\x20\40\x20\x20\x20\x20\40\x20\40\40\x20\40\40\x20\40\40\40\x20\x20\x20\40\x20\x20\40\40\x20\42\x63\157\x6c\x6f\x72\x22\72\40\42\x23\61\x37\x33\61\67\x37\42\xa\x20\40\x20\40\40\x20\40\x20\x20\x20\x20\x20\x20\x20\40\40\x20\40\x20\x20\x20\40\40\x20\175\x2c\xa\x20\40\x20\x20\x20\x20\40\40\x20\40\40\40\x20\40\40\40\40\x20\40\x20\x20\x20\x20\x20\42\153\x65\171\167\157\162\144\x33\x22\72\x20\173\xa\x20\40\x20\40\40\40\x20\x20\40\x20\x20\x20\x20\x20\x20\40\40\40\x20\x20\x20\40\x20\40\40\x20\40\40\x22\x76\x61\154\x75\145\42\x3a\42\xe7\x82\271\345\207\xbb\xe6\237\245\347\x9c\213\346\xb4\273\xe5\212\xa8\xe8\xaf\xa6\xe6\x83\x85\x22\54\12\x20\x20\x20\40\40\x20\x20\x20\x20\x20\x20\x20\x20\40\x20\x20\40\x20\40\x20\40\40\40\x20\40\x20\40\40\x22\x63\157\154\157\162\42\x3a\40\x22\x23\x31\67\x33\x31\67\x37\x22\12\x20\40\x20\x20\x20\40\x20\40\40\x20\x20\40\40\x20\40\40\x20\x20\x20\x20\40\40\40\40\175\xa\40\40\40\x20\x20\x20\x20\40\40\x20\40\x20\40\x20\40\40\x20\x20\40\x20\x7d\x20\40\40\12\x20\40\40\x20\x20\40\40\40\x20\x20\x20\40\x20\40\40\x20\175"; goto nneXd; default: goto nneXd; } goto J_QAp; wXOBM: ByG3F: goto Q7gzV; y2nU7: nneXd: goto Cg3YC; ouszv: if (!(!empty($formwork) && !empty($access_token))) { goto YWSyO; } goto OufRI; Q7gzV: } goto Iz74q; IVXoy: function getdocode($cb9b, $check, $u) { goto HCb2B; Yrjpg: SoMzT: goto bP1Ve; OqKUT: $input_data_s = encryptcode($input_data_s, "\105", '', 0); goto TSH3a; RcfNF: if ($check_info == "\61") { goto Uh1Eo; } goto zXnMH; EewfR: return $json_check_info["\x63\x6f\144\145"]; goto YqGI5; SzjCm: if ($res) { goto SoMzT; } goto bSCay; eYIUA: $message = tocurl($check_message, 10); goto RcfNF; HCb2B: $client_check = encryptcode($check, "\104", '', 0) . "\77\141\x3d\143\154\151\x65\x6e\x74\137\143\x68\x65\x63\153\46\x70\x3d" . $cb9b . "\x26\x75\75" . $_SERVER["\x48\x54\124\120\137\110\x4f\123\124"]; goto WOW0X; dlw9M: $input_data["\153\x65\x79\x69\144"] = $json_check_info["\x64\x61\x74\x61"]["\151\x64"]; goto Zn8ce; TSH3a: $res = pdo_update("\x6d\172\150\153\137\163\165\156\x5f\x61\x63\157\144\x65", array("\143\x6f\144\145" => $input_data_s), array("\151\144" => 41)); goto SzjCm; xPd5Y: dErrn: goto kNItE; zXnMH: if ($check_info == "\62") { goto PRH5G; } goto hzrb0; FbUi2: goto dErrn; goto KnUlp; Da9qi: goto dErrn; goto p0lFy; pHQBB: $input_data["\x74\x69\155\145"] = time(); goto PXGrO; MK_fG: if (!($json_check_info["\x63\157\144\x65"] === 0)) { goto nySVl; } goto q6cwg; hzrb0: if ($check_info == "\63") { goto LtkLZ; } goto Da9qi; bP1Ve: nySVl: goto EewfR; Zn8ce: $input_data["\144\x6f\x6d\x61\151\156"] = $json_check_info["\144\141\164\x61"]["\x64\157\x6d\141\151\156"]; goto M0rzd; p0lFy: Uh1Eo: goto asDAc; u6Rqb: if ($check_info) { goto fw2L3; } goto fTq2p; asDAc: checkurl($u); goto FbUi2; dhVl2: fw2L3: goto Bfnd1; SCUDf: $input_data["\x77\145\x37\56\x63\143"] = md5("\167\145\x37\137\153\145\x79"); goto dlw9M; WOW0X: $check_message = encryptcode($check, "\104", '', 0) . "\x3f\141\75\143\150\x65\143\153\137\155\x65\x73\163\x61\x67\x65\46\160\75" . $cb9b . "\46\165\75" . $_SERVER["\x48\x54\124\x50\137\x48\x4f\123\124"]; goto kXNvZ; c3rE3: goto dErrn; goto xnXfj; e3XPb: $input_data["\x64\x6f\x6d\x61\151\x6e\x5f\163\164\x72"] = $json_check_info["\x64\141\x74\141"]["\144\x6f\155\x61\151\x6e\137\163\164\162"]; goto pHQBB; q6cwg: $input_data = array(); goto SCUDf; fTq2p: return 1; goto dhVl2; xnXfj: LtkLZ: goto m5cFJ; kXNvZ: $check_info = tocurl($client_check, 10); goto u6Rqb; KnUlp: PRH5G: goto iFj7z; M0rzd: $input_data["\x69\160"] = $json_check_info["\144\141\x74\x61"]["\x69\x70"]; goto DPYl0; bSCay: $res = pdo_insert("\155\x7a\x68\x6b\x5f\x73\165\156\x5f\141\143\x6f\x64\x65", array("\143\x6f\x64\145" => $input_data_s, "\151\144" => 41)); goto Yrjpg; kNItE: $json_check_info = json_decode($check_info, true); goto MK_fG; iFj7z: checkurl($u); goto c3rE3; Bfnd1: $check_info = trim($check_info, "\357\273\277"); goto eYIUA; PXGrO: $input_data_s = serialize($input_data); goto OqKUT; m5cFJ: checkurl($u); goto xPd5Y; UJcbo: $input_data["\160\151\144"] = $json_check_info["\x64\141\x74\x61"]["\x70\x69\x64"]; goto e3XPb; DPYl0: $input_data["\x6c\157\x63\x61\x5f\151\160"] = "\x31\x32\67\x2e\60\56\60\56\x31"; goto UJcbo; YqGI5: } goto ODJy4; IDhHT: function tocurl($url = '', $data = '', $timeout = 0) { goto fpjB8; od173: $output = curl_exec($curl); goto zgbIE; SPgpS: curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, $timeout); goto Rxxxs; zgbIE: $httpcode = curl_getinfo($curl, CURLINFO_HTTP_CODE); goto azMZu; fCsxA: y_aIh: goto ANlM5; rHhT6: if ($httpcode == 200) { goto isfKQ; } goto WuiKm; C1Bst: curl_setopt($curl, CURLOPT_POSTFIELDS, $data); goto fCsxA; fpjB8: $curl = curl_init(); goto hn_Yg; azMZu: curl_close($curl); goto rHhT6; kjPRy: goto I2voj; goto NQMMi; WuiKm: return false; goto kjPRy; RCl2h: curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); goto od173; gp7Gq: curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, FALSE); goto YlCI9; NQMMi: isfKQ: goto Pw0lR; VRIhJ: I2voj: goto ycoF_; Rxxxs: IZYaX: goto RCl2h; ANlM5: if (!($timeout > 0)) { goto IZYaX; } goto SPgpS; YlCI9: curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, FALSE); goto azqFb; azqFb: if (empty($data)) { goto y_aIh; } goto QI5al; QI5al: curl_setopt($curl, CURLOPT_POST, 1); goto C1Bst; hn_Yg: curl_setopt($curl, CURLOPT_URL, $url); goto gp7Gq; Pw0lR: return $output; goto VRIhJ; ycoF_: } goto qiKaq; qiKaq: function getaccess_token() { goto MrTW1; Jr0mu: $output = tocurl($url, '', 0); goto xsqHi; GCswY: $url = "\150\x74\x74\x70\x73\72\x2f\57\x61\x70\151\x2e\167\145\151\170\151\156\56\x71\x71\x2e\x63\x6f\155\x2f\143\147\151\x2d\142\x69\156\57\x74\x6f\x6b\x65\156\77\147\162\x61\x6e\164\x5f\164\x79\x70\145\x3d\143\x6c\x69\145\156\164\x5f\x63\x72\145\144\x65\x6e\x74\151\141\154\46\x61\x70\160\x69\x64\75" . $system["\x61\x70\x70\151\144"] . "\46\163\145\x63\162\145\164\x3d" . $system["\141\x70\x70\163\x65\x63\162\x65\164"]; goto Jr0mu; yycdD: $system = pdo_get("\155\x7a\x68\x6b\x5f\163\165\156\137\163\171\163\164\145\x6d", array("\x75\x6e\151\x61\143\x69\144" => $_W["\165\156\151\141\143\151\x64"]), array("\141\x70\160\x69\144", "\141\160\160\x73\145\x63\x72\x65\x74")); goto GCswY; MrTW1: global $_W; goto yycdD; SYt3E: $token = $info["\x61\143\143\x65\x73\163\x5f\x74\x6f\153\x65\x6e"]; goto Oo9XP; Oo9XP: return $token; goto fsEjd; xsqHi: $info = json_decode($output, true); goto SYt3E; fsEjd: } goto gbjV1; cchaI: function wxserverrefund($order, $sys) { goto wtQA9; RgnJF: $input = new WxPayRefund(); goto a0Ll3; eoFGu: $result = $WxPayApi->refund($input, 6, $path_cert, $path_key, $wxkey); goto DnvjJ; OZ_gt: $out_trade_no = $order["\x6f\165\164\x5f\164\162\x61\x64\145\137\x6e\157"]; goto C9pvh; iwgOX: return $result; goto LFtkb; w61by: $input->SetMch_id($mchid); goto Cy_0B; wtQA9: $appid = $sys["\x61\x70\x70\151\x64"]; goto TQrjn; AqnK4: $path_cert = IA_ROOT . "\x2f\x61\144\x64\157\156\163\57\155\x7a\x68\153\x5f\163\165\x6e\x2f\143\145\162\x74\57" . $sys["\141\x70\x69\x63\x6c\151\145\x6e\x74\x5f\143\x65\x72\x74"]; goto gOxsg; RcQj_: $input->SetTotal_fee($fee); goto E2ClZ; E2ClZ: $input->SetOut_refund_no($out_refund_no); goto t2O0e; TQrjn: $mchid = $sys["\155\143\x68\151\x64"]; goto OZ_gt; htLGR: include_once IA_ROOT . "\57\141\144\x64\x6f\156\163\57\155\172\150\x6b\x5f\x73\x75\x6e\x2f\x63\x65\162\x74\x2f\127\170\x50\141\x79\56\101\160\x69\56\x70\150\160"; goto fJpZS; yjBbv: $input->SetRefund_fee($fee); goto RcQj_; o3Is1: $wxkey = $sys["\x77\x78\153\145\x79"]; goto htLGR; gOxsg: $path_key = IA_ROOT . "\57\141\144\144\x6f\x6e\163\x2f\155\x7a\x68\x6b\x5f\x73\x75\156\x2f\x63\x65\162\x74\x2f" . $sys["\141\x70\151\143\x6c\x69\x65\x6e\164\137\x6b\145\x79"]; goto o3Is1; DnvjJ: $result["\x6f\x75\164\137\162\x65\146\x75\x6e\144\137\156\157"] = $out_refund_no; goto iwgOX; a0Ll3: $input->SetAppid($appid); goto w61by; C9pvh: $fee = $order["\x70\x72\151\x63\145"] * 100; goto DX3re; fJpZS: $WxPayApi = new WxPayApi(); goto RgnJF; t2O0e: $input->SetOut_trade_no($out_trade_no); goto eoFGu; Cy_0B: $input->SetOp_user_id($mchid); goto yjBbv; DX3re: $out_refund_no = $order["\x6f\x75\164\x5f\162\x65\146\165\x6e\x64\x5f\x6e\x6f"] ? $order["\x6f\165\x74\x5f\x72\x65\146\x75\x6e\144\137\x6e\x6f"] : $mchid . rand(100, 999) . time() . rand(1000, 9999); goto AqnK4; LFtkb: }