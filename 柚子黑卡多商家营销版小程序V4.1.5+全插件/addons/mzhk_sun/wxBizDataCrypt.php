<?php
 include_once "\x65\162\x72\157\x72\x43\x6f\x64\x65\56\160\x68\160"; class WXBizDataCrypt { private $appid; private $sessionKey; public function __construct($appid, $sessionKey) { $this->sessionKey = $sessionKey; $this->appid = $appid; } public function decryptData($encryptedData, $iv, &$data) { goto F7_zN; oeOPe: $aesIV = base64_decode($iv); goto uqY0y; VM2lu: O6vwX: goto jCCrc; VKkMU: if (!(strlen($iv) != 24)) { goto Ontfk; } goto ie5YK; Amdwo: return ErrorCode::$IllegalBuffer; goto ha52g; KMKNM: $dataObj = json_decode($result); goto eRAvM; WgonD: return ErrorCode::$IllegalAesKey; goto VM2lu; ha52g: uEl5g: goto p5lSI; F7_zN: if (!(strlen($this->sessionKey) != 24)) { goto O6vwX; } goto WgonD; YficN: if (!($dataObj->watermark->appid != $this->appid)) { goto uEl5g; } goto Amdwo; p5lSI: $data = $result; goto jKOxI; jCCrc: $aesKey = base64_decode($this->sessionKey); goto VKkMU; fD3qg: return ErrorCode::$IllegalBuffer; goto AomS6; lpRAW: $result = openssl_decrypt($aesCipher, "\101\x45\123\x2d\x31\62\x38\55\x43\x42\103", $aesKey, 1, $aesIV); goto KMKNM; uqY0y: $aesCipher = base64_decode($encryptedData); goto lpRAW; XSG6m: Ontfk: goto oeOPe; ie5YK: return ErrorCode::$IllegalIv; goto XSG6m; jKOxI: return ErrorCode::$OK; goto x3aEs; AomS6: NMPC2: goto YficN; eRAvM: if (!($dataObj == NULL)) { goto NMPC2; } goto fD3qg; x3aEs: } }