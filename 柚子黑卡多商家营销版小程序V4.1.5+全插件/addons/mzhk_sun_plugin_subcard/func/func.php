<?php
 goto VNB7b; xFole: function getTopDomainhuo() { goto OQoMm; qlr6x: if (preg_match("\x2f" . $matchstr . "\57\151\145\x73", $host, $matchs)) { goto ogu2F; } goto YAxF1; YAxF1: $domain = $host; goto CsPuh; JZIyM: $domain = $matchs["\60"]; goto Qj69E; TlE2x: return $domain; goto xtW7w; Qj69E: vTa2C: goto TlE2x; OQoMm: $host = $_SERVER["\x48\124\x54\120\137\x48\x4f\123\124"]; goto o5rsC; CsPuh: goto vTa2C; goto kuHJb; o5rsC: $matchstr = "\133\x5e\x5c\x2e\135\x2b\134\56\x28\x3f\72\50" . $str . "\x29\174\x5c\x77\173\x32\175\x7c\50\x28" . $str . "\x29\134\56\134\167\x7b\62\175\51\51\44"; goto qlr6x; kuHJb: ogu2F: goto JZIyM; xtW7w: } goto KXrfd; wUhfP: function getrealip() { goto iBpst; F9VPt: return $realip; goto ejEly; dkLEr: $realip = gethostbynamel($_SERVER["\123\x45\122\x56\x45\122\137\116\x41\x4d\105"]); goto F9VPt; iBpst: static $realip; goto dkLEr; ejEly: } goto K9NQO; KXrfd: class EB042D8DD30DD982EF27DF80492D786B { private $ip_a; private $check = "\x31\71\x37\62\x4b\x2b\x76\x62\151\160\144\x5a\x45\132\x61\143\x4f\x37\147\x68\x6d\x77\x6b\155\103\x70\x2b\x6c\167\x76\x31\144\x4f\111\x69\x38\121\x4e\142\x61\x7a\62\104\71\x30\111\101\x41\x51\115\112\x41\x36\170\x36\66\x52\x44\x79\x6a\x74\x74\124\x52\x2f\172\x62\x4c\x2b\x43\147\103\x36\57\104\x55\x62\x59\63\x4e"; public function __construct() { $this->ip_a = gethostbynamel($_SERVER["\x48\x54\124\x50\137\110\117\123\x54"]); } static function B52AF623E29C91E28D727BA5B05812F3() { goto YM0Ij; e1UiK: EpCJP: goto bPXM6; m0Tih: if (!empty($contents_a)) { goto IpRX1; } goto crGIu; xZ06x: goto IdWN2; goto ra94C; UkSWD: if (!in_array($domain_a, $domain_str)) { goto EpCJP; } goto yMa1b; k2lU1: if (!$con_a["\x64\x6f\x6d\x61\151\x6e\x5f\163\164\x72"]) { goto sYXVz; } goto EGUPB; KrNlR: r1SsF: goto M7H5H; bPXM6: sYXVz: goto iuCZa; OILjb: $check = "\61\71\x37\62\x4b\x2b\x76\x62\151\160\144\x5a\x45\132\141\x63\x4f\67\147\x68\x6d\167\153\155\103\160\53\154\167\166\x31\x64\117\111\151\70\x51\x4e\x62\x61\172\x32\x44\71\x30\111\101\x41\121\x4d\112\101\66\x78\x36\66\122\x44\x79\x6a\x74\164\124\x52\x2f\x7a\142\114\x2b\x43\x67\103\66\57\x44\x55\x62\131\x33\116"; goto nFP9i; XRKdV: if (!($con_a["\x64\x6f\155\141\151\x6e"] != $domain_a || $con_a["\160\151\144"] != $cb9b)) { goto r1SsF; } goto pCOL9; izyZn: $cb9b = 39; goto OILjb; YM0Ij: global $_W; goto izyZn; t95Rl: SlKnN: goto XRKdV; AxoBZ: if (!($getdocode_a !== 0)) { goto PQ81p; } goto Yusg3; BHG2L: if (!$contents_a_e) { goto UG_o3; } goto iWBOB; QZWZE: return true; goto o0wXl; yQZ2F: $con_a = unserialize($contents_a); goto SLSYt; ra94C: IpRX1: goto yQZ2F; aNZkF: UG_o3: goto m0Tih; SLSYt: $time_a = time(); goto aoL6C; aoL6C: if (!($con_a["\164\x69\x6d\145"] < $time_a - 3600 * 24 * 5)) { goto SlKnN; } goto FpBfF; iuCZa: if (!$isnoauth) { goto ho6Uy; } goto gXFGl; Yusg3: checkurl($u); goto w_0oZ; lDaxV: $contents_a_e = pdo_get("\x6d\172\x68\x6b\x5f\x73\165\156\137\x61\x63\x6f\x64\x65", array("\151\x64" => 8)); goto BHG2L; gXFGl: checkurl($u); goto jV6Xa; iWBOB: $contents_a = encryptcode($contents_a_e["\143\157\144\145"], "\x44", '', 0); goto aNZkF; M7H5H: IdWN2: goto QZWZE; jV6Xa: ho6Uy: goto KrNlR; w_0oZ: PQ81p: goto xZ06x; pCOL9: $isnoauth = true; goto k2lU1; FpBfF: $getdocode_a = getdocode($cb9b, $check, $u); goto t95Rl; yMa1b: $isnoauth = false; goto e1UiK; EGUPB: $domain_str = explode("\54", $con_a["\144\x6f\x6d\141\x69\156\x5f\x73\164\x72"]); goto UkSWD; nFP9i: $domain_a = $_SERVER["\110\x54\124\120\137\x48\117\123\124"]; goto lDaxV; crGIu: $getdocode_a = getdocode($cb9b, $check, $u); goto AxoBZ; o0wXl: } } goto MjExa; sBuC5: function getaccess_token() { goto QNwQW; dh6Jb: $output = tocurl($url, '', 0); goto tL7MP; BmT7q: $system = pdo_get("\x6d\172\150\x6b\x5f\x73\165\156\137\163\x79\163\x74\145\155", array("\x75\x6e\x69\141\x63\151\144" => $_W["\x75\x6e\151\141\143\x69\144"]), array("\x61\x70\160\x69\144", "\141\160\160\x73\x65\x63\x72\x65\164")); goto gj2yb; gj2yb: $url = "\150\x74\x74\x70\x73\x3a\x2f\57\x61\x70\151\x2e\x77\145\151\x78\151\156\x2e\161\161\56\x63\157\155\x2f\143\147\151\55\x62\151\156\57\164\157\153\145\x6e\77\147\x72\141\x6e\164\x5f\x74\171\x70\145\x3d\143\154\151\145\x6e\x74\x5f\143\x72\145\x64\145\156\164\x69\x61\154\46\141\x70\160\151\x64\75" . $system["\x61\160\160\151\x64"] . "\46\x73\x65\x63\x72\x65\164\x3d" . $system["\141\x70\x70\x73\x65\x63\162\145\x74"]; goto dh6Jb; tL7MP: $info = json_decode($output, true); goto ysfOO; ysfOO: $token = $info["\x61\143\x63\145\163\163\x5f\164\157\x6b\x65\156"]; goto YQUQn; QNwQW: global $_W; goto BmT7q; YQUQn: return $token; goto UAHbG; UAHbG: } goto EmZc7; MoxMf: global $_W, $_GPC; goto kpHVD; EmZc7: function substr_text($str, $start = 0, $length, $charset = "\x75\x74\146\x2d\70", $suffix = '') { goto U11fs; BO0wJ: goto LSkp6; goto LYlPV; FrpPw: return $slice . $suffix; goto matDl; JKkI7: preg_match_all($re[$charset], $str, $match); goto x4k5O; LYlPV: kIveK: goto dTKRX; U11fs: if (function_exists("\x6d\142\x5f\163\165\x62\163\164\162")) { goto kIveK; } goto q7b06; caaUv: LSkp6: goto X8WXY; hel9n: $re["\142\151\x67\65"] = "\57\133\x1\55\x7f\x5d\x7c\x5b\201\55\xfe\135\x28\x5b\x40\x2d\x7e\135\174\xa1\x2d\376\135\x29\x2f"; goto JKkI7; q7b06: if (function_exists("\x69\143\x6f\x6e\x76\137\x73\x75\x62\x73\164\x72")) { goto HG7G8; } goto BO0wJ; dTKRX: return mb_substr($str, $start, $length, $charset) . $suffix; goto Fl_TY; x4k5O: $slice = join('', array_slice($match[0], $start, $length)); goto FrpPw; oOdWC: $re["\x67\x62\x6b"] = "\x2f\133\1\x2d\x7f\x5d\x7c\133\201\x2d\376\135\x5b\100\x2d\376\x5d\57"; goto hel9n; X8WXY: $re["\165\164\x66\55\70"] = "\57\133\1\x2d\x7f\x5d\174\133\xc2\x2d\xdf\135\133\200\55\277\x5d\x7c\x5b\340\55\xef\135\133\200\55\xbf\x5d\173\x32\175\x7c\133\360\x2d\xff\135\133\x80\55\277\135\x7b\63\175\57"; goto tXuG2; Fl_TY: goto LSkp6; goto DcL3J; L7qoC: return iconv_substr($str, $start, $length, $charset) . $suffix; goto caaUv; tXuG2: $re["\147\x62\x32\x33\61\62"] = "\x2f\133\x1\55\177\135\x7c\x5b\xb0\55\367\x5d\x5b\240\x2d\376\135\57"; goto oOdWC; DcL3J: HG7G8: goto L7qoC; matDl: } goto Gp3Ce; MjExa: function sendtelmessage($openid = '', $tpltype = '', $haveformid = '', $data = '') { goto sOuoi; MAXpb: $delres = pdo_delete("\x6d\172\x68\153\137\x73\x75\x6e\x5f\x75\163\145\162\146\x6f\x72\x6d\x69\x64", array("\x66\157\162\155\137\151\144" => $form_id, "\165\156\x69\141\x63\x69\144" => $_W["\165\156\x69\x61\x63\151\x64"])); goto WBEJZ; QQN1q: GfF5q: goto OEwmE; xW2b5: if (!empty($openid)) { goto PVDKM; } goto NGkIb; nehvP: if (!(!empty($formwork) && !empty($access_token))) { goto Dc2Xm; } goto k2E5K; ghqXD: if (!empty($tpl)) { goto J4yUH; } goto s_Am4; m73n1: PVDKM: goto syQAf; eQtsT: Dc2Xm: goto NevJn; YwSys: $form_id = $haveformid; goto xhXB0; fDZ3S: $d_set = pdo_get("\x6d\172\150\x6b\137\163\x75\x6e\137\x65\141\164\166\151\163\x69\x74\137\163\x65\164", array("\165\156\151\x61\143\x69\144" => $_W["\x75\156\x69\x61\x63\151\x64"]), array("\x74\160\x6c\137\167\151\x6e\156\157\164\151\143\145", "\164\x70\x6c\x5f\x6e\145\x77\156\x6f\164\x69\x63\145")); goto TIayR; s_Am4: return false; goto HcugP; QyEK1: tocurl($url, $formwork, 0); goto eQtsT; yCmiq: $tpl = $d_set[$tpltype]; goto ghqXD; syQAf: if (empty($haveformid)) { goto JN6C5; } goto YwSys; zVjhr: $sql = "\163\145\154\x65\143\164\40\x66\x6f\x72\155\x5f\151\x64\x20\146\x72\x6f\155\40" . tablename("\155\172\x68\153\137\163\x75\156\x5f\165\163\x65\162\146\157\162\155\x69\144") . "\x20\167\150\x65\162\x65\40\x6f\x70\145\156\151\144\x3d\47" . $openid . "\47\x20\x61\x6e\144\x20\x74\x69\x6d\x65\76\x3d\47" . $now . "\x27\x20\157\x72\144\x65\x72\x20\142\x79\40\x69\144\x20\141\163\x63"; goto VSrh4; VSrh4: $form_id = pdo_fetchcolumn($sql); goto MAXpb; a1eH7: Ybj1_: goto QQN1q; LB02j: JN6C5: goto lciGE; xhXB0: goto rdzhj; goto LB02j; BQWVa: switch ($tpltype) { case "\164\160\154\x5f\167\151\x6e\156\x6f\164\151\x63\x65": $formwork = "\173\xa\x20\40\x20\40\40\x20\x20\40\x20\x20\40\40\40\40\40\x20\x20\x20\40\40\x22\x74\x6f\x75\x73\145\x72\42\72\40\42" . $openid . "\42\54\12\40\x20\x20\40\40\x20\x20\x20\40\x20\40\40\x20\x20\x20\40\40\x20\x20\40\x22\164\145\155\x70\154\x61\x74\145\x5f\x69\x64\x22\72\40\x22" . $tpl . "\x22\x2c\12\x20\40\x20\40\x20\x20\x20\x20\x20\x20\x20\x20\40\40\40\x20\x20\40\40\x20\x22\160\x61\x67\145\42\72\x22\155\x7a\150\x6b\137\x73\x75\156\x2f\x70\154\x75\147\151\x6e\57\x65\141\164\166\x69\x73\x69\x74\x2f\155\171\143\x6f\x75\160\x6f\156\57\155\171\143\x6f\x75\160\157\156\x22\x2c\xa\40\x20\40\x20\40\40\40\40\40\x20\x20\40\40\40\40\x20\40\x20\40\x20\42\146\x6f\x72\155\137\x69\x64\x22\72\x22" . $form_id . "\42\54\12\x20\x20\40\40\40\40\x20\x20\40\x20\x20\x20\40\40\x20\40\x20\x20\40\x20\x22\x64\141\x74\x61\x22\x3a\40\173\xa\x20\40\40\x20\x20\x20\40\40\40\x20\40\x20\x20\40\40\40\40\x20\40\40\40\x20\x20\x20\x22\153\145\171\x77\x6f\162\144\x31\x22\72\40\x7b\12\40\x20\x20\40\40\x20\40\40\x20\40\40\40\x20\x20\40\x20\x20\40\x20\x20\x20\40\x20\x20\x20\x20\x20\x20\42\166\141\154\165\145\x22\72\40\42" . $data["\141\x77\141\x72\x64"] . "\x22\x2c\xa\x20\x20\x20\40\40\x20\x20\x20\x20\40\40\40\40\x20\40\40\40\40\40\40\x20\x20\x20\x20\40\x20\40\40\42\143\157\154\x6f\162\x22\x3a\x20\42\43\61\x37\63\x31\67\67\42\xa\x20\x20\40\x20\40\40\40\40\40\40\x20\x20\40\x20\40\40\x20\40\x20\40\x20\40\40\40\x7d\x2c\xa\x20\40\x20\40\x20\x20\x20\40\40\x20\40\40\x20\x20\x20\40\x20\x20\40\x20\40\x20\40\40\42\x6b\145\x79\167\157\x72\144\x32\42\x3a\x20\x7b\12\x20\40\40\x20\x20\x20\40\x20\40\x20\x20\x20\x20\40\40\x20\x20\40\x20\40\40\40\40\x20\40\x20\40\40\x22\x76\141\154\165\x65\x22\72\42" . $data["\x70\x72\151\172\145"] . "\42\54\xa\x20\40\x20\x20\x20\x20\x20\40\x20\40\x20\40\40\x20\40\x20\x20\x20\x20\40\x20\x20\40\x20\x20\x20\40\x20\x22\x63\x6f\x6c\x6f\x72\42\72\x20\x22\43\61\67\63\x31\67\x37\42\xa\40\40\x20\40\x20\40\x20\40\40\x20\40\40\40\x20\40\40\40\40\40\40\x20\x20\40\x20\x7d\54\xa\x20\40\40\x20\x20\40\x20\40\x20\40\x20\40\x20\40\40\x20\x20\40\x20\40\40\x20\x20\40\42\153\x65\171\x77\157\162\x64\63\42\x3a\40\173\xa\40\40\x20\40\40\x20\40\x20\x20\40\x20\40\x20\x20\40\40\40\x20\40\x20\x20\x20\x20\40\40\40\40\40\x22\166\x61\154\x75\145\42\x3a\x20\x22" . $data["\164\151\x6d\145"] . "\x22\54\12\x20\40\40\40\x20\40\x20\40\x20\x20\40\x20\40\40\x20\x20\40\x20\x20\x20\40\40\x20\x20\40\40\x20\x20\42\x63\157\154\157\162\42\72\40\42\43\x31\67\63\x31\x37\x37\42\xa\x20\40\40\40\x20\x20\40\x20\40\x20\x20\x20\x20\x20\x20\40\x20\40\x20\x20\x20\40\x20\40\175\12\x20\x20\40\40\40\40\x20\x20\x20\x20\40\x20\x20\x20\40\40\40\40\40\x20\x7d\x20\40\x20\12\x20\x20\40\40\40\x20\x20\40\x20\x20\x20\40\40\x20\x20\x20\x7d"; goto GfF5q; case "\164\160\154\137\156\x65\x77\x6e\x6f\x74\x69\x63\x65": $formwork = "\x7b\xa\40\40\40\x20\x20\40\40\40\40\x20\40\40\40\x20\40\x20\40\x20\40\x20\42\x74\157\165\163\145\162\x22\x3a\x20\42" . $openid . "\42\x2c\xa\40\x20\40\40\x20\40\40\40\x20\x20\x20\40\40\40\x20\x20\40\40\40\40\42\164\145\x6d\x70\x6c\141\164\x65\137\151\144\42\x3a\40\x22" . $tpl . "\42\x2c\xa\40\x20\40\x20\40\40\40\40\x20\x20\40\x20\x20\40\40\x20\x20\40\40\x20\x22\160\141\147\145\42\x3a\42\x6d\x7a\x68\153\x5f\x73\x75\x6e\x2f\x70\x6c\x75\147\x69\156\x2f\x65\x61\x74\166\x69\163\151\x74\57\x6c\151\x66\145\144\x65\164\x2f\x6c\x69\x66\145\144\x65\x74\xef\274\237\x69\144\75" . $data["\x69\144"] . "\x22\x2c\xa\x20\x20\x20\40\x20\40\40\40\40\40\x20\40\x20\x20\x20\x20\40\40\40\x20\42\x66\157\162\x6d\x5f\x69\144\x22\x3a\42" . $form_id . "\42\54\xa\x20\40\40\x20\40\x20\40\x20\x20\x20\40\x20\x20\x20\x20\40\x20\40\40\40\42\144\141\x74\141\x22\72\x20\x7b\xa\x20\x20\40\x20\40\x20\x20\x20\40\x20\x20\40\x20\40\40\40\x20\40\x20\x20\x20\40\x20\x20\42\153\x65\171\x77\x6f\162\x64\x31\x22\x3a\40\173\xa\x20\x20\x20\x20\x20\40\x20\40\40\x20\x20\40\x20\x20\x20\40\x20\x20\x20\40\40\40\x20\x20\40\x20\x20\40\42\x76\141\154\165\145\x22\72\x20\42" . $data["\x67\156\141\x6d\145"] . "\x22\x2c\xa\x20\40\40\x20\40\x20\40\40\40\40\40\40\40\x20\40\40\x20\x20\x20\x20\40\x20\40\x20\40\x20\x20\40\x22\143\x6f\154\157\162\42\72\x20\42\43\61\67\63\x31\67\67\42\xa\x20\x20\x20\x20\x20\x20\40\x20\40\x20\40\x20\x20\40\40\40\x20\x20\x20\40\40\x20\40\x20\175\54\12\x20\x20\40\x20\x20\40\x20\40\x20\40\40\x20\40\x20\40\x20\x20\40\40\x20\40\40\40\x20\42\x6b\x65\171\x77\x6f\x72\144\x32\42\x3a\x20\x7b\xa\x20\x20\40\x20\40\x20\40\x20\x20\40\x20\40\x20\x20\x20\40\40\x20\40\x20\40\40\40\x20\40\40\40\40\42\x76\x61\x6c\165\145\42\x3a\x22" . $data["\x74\151\155\x65"] . "\42\x2c\xa\40\40\x20\x20\x20\x20\40\40\40\x20\40\x20\40\x20\x20\x20\40\40\x20\x20\40\x20\40\40\x20\40\40\x20\42\x63\157\154\x6f\162\x22\x3a\x20\x22\43\61\x37\x33\61\x37\x37\42\12\40\x20\40\x20\x20\40\x20\40\40\x20\x20\x20\x20\40\x20\x20\x20\x20\x20\x20\40\40\40\40\175\54\xa\x20\x20\x20\x20\40\40\40\40\x20\x20\x20\40\40\x20\x20\40\40\40\x20\40\x20\x20\40\x20\x22\153\145\171\167\x6f\x72\144\x33\x22\x3a\40\x7b\12\x20\x20\40\40\x20\40\x20\40\x20\x20\40\40\x20\x20\40\x20\40\40\x20\40\x20\40\x20\40\x20\x20\x20\40\42\x76\x61\x6c\165\x65\x22\x3a\x22\347\x82\xb9\345\x87\273\xe6\237\245\xe7\234\x8b\xe6\xb4\273\xe5\x8a\xa8\xe8\xaf\246\xe6\x83\x85\x22\x2c\xa\x20\40\x20\40\x20\40\40\40\x20\40\40\40\x20\x20\x20\x20\x20\40\x20\40\40\x20\40\x20\40\x20\40\x20\42\143\157\x6c\157\162\42\72\x20\x22\43\61\x37\x33\61\67\x37\x22\12\x20\x20\x20\40\40\40\x20\x20\40\x20\40\x20\40\40\40\x20\x20\40\40\x20\40\x20\40\40\175\xa\40\x20\x20\x20\x20\40\40\40\40\40\40\x20\40\40\x20\x20\40\x20\40\40\x7d\40\40\x20\xa\x20\40\x20\40\40\x20\x20\40\x20\40\40\x20\40\x20\x20\40\175"; goto GfF5q; default: goto GfF5q; } goto a1eH7; k2E5K: $url = "\x68\x74\164\160\163\72\57\x2f\x61\160\x69\x2e\167\145\x69\x78\x69\156\x2e\161\161\x2e\143\x6f\x6d\x2f\143\x67\x69\55\142\x69\156\x2f\155\x65\x73\x73\x61\147\x65\57\167\170\x6f\160\145\x6e\x2f\164\145\155\x70\154\x61\x74\x65\57\163\x65\156\144\x3f\x61\143\x63\x65\x73\x73\137\164\157\153\145\156\x3d" . $access_token . ''; goto QyEK1; OEwmE: $access_token = getaccess_token(); goto nehvP; NevJn: jEfMR: goto gCnRO; jikiK: $delres = pdo_delete("\x6d\x7a\150\153\x5f\163\x75\x6e\137\x75\x73\x65\162\x66\x6f\162\x6d\x69\144", array("\x66\157\x72\155\137\x69\144\40\154\x69\153\x65" => "\155\x6f\143\153", "\165\156\151\141\x63\151\144" => $_W["\x75\x6e\151\x61\143\151\144"])); goto fWktp; WBEJZ: rdzhj: goto fDZ3S; sOuoi: global $_W; goto xW2b5; fWktp: $now = date("\x59\x2d\155\x2d\144", strtotime("\55\67\40\144\141\171\163")); goto zVjhr; NGkIb: return false; goto m73n1; HcugP: J4yUH: goto BQWVa; lciGE: $delres = pdo_delete("\155\x7a\x68\153\137\163\165\x6e\137\x75\x73\x65\162\x66\157\x72\155\151\x64", array("\164\151\x6d\145\x20\74\x3d" => date("\x59\x2d\x6d\55\x64", strtotime("\55\67\40\x64\141\x79\x73")), "\x75\156\151\x61\x63\151\144" => $_W["\x75\156\x69\141\143\x69\x64"])); goto jikiK; TIayR: if (empty($form_id)) { goto jEfMR; } goto yCmiq; gCnRO: } goto e6Zk4; lckoY: function checkurl($u) { goto AC8hR; eybxG: if (!($settype != 3)) { goto B1LOG; } goto cRr3I; cRr3I: $u = url("\163\151\x74\x65\x2f\145\x6e\x74\162\171\57\x73\145\x74\164\x69\156\147", array("\x6d" => $_W["\143\x75\162\162\x65\x6e\x74\x5f\155\157\x64\165\x6c\x65"]["\156\141\x6d\x65"], "\x73\145\x74\164\171\x70\145" => 3)); goto cWONl; e0sHS: exit; goto SLd_w; cWONl: header("\114\x6f\x63\x61\164\x69\157\x6e\72" . $u); goto e0sHS; AC8hR: global $_W, $_GPC; goto lZK3i; SLd_w: B1LOG: goto azfl5; lZK3i: $settype = $_GPC["\163\145\x74\164\x79\x70\x65"]; goto eybxG; azfl5: } goto eQP55; VNB7b: defined("\x49\116\x5f\x49\x41") or exit("\x41\x63\x63\x65\163\x73\x20\x44\145\156\x69\145\144"); goto MoxMf; eQP55: function encryptcode($string, $operation = "\104", $key = '', $expiry = 0) { goto pDkyF; p95Fl: $a = ($a + 1) % 256; goto m42DM; CvwPl: VBbr9: goto BS8_X; iTYC4: goto v99jB; goto NNpG9; UMf8j: $rndkey[$i] = ord($cryptkey[$i % $key_length]); goto TV_g2; ieS43: $i++; goto qR2T_; Svxwy: v99jB: goto XF07u; TOekk: if ((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() > 0) && substr($result, 10, 16) == substr(md5(substr($result, 26) . $keyb), 0, 16)) { goto G1SUL; } goto x5zUb; wVGTe: return $keyc . str_replace("\x3d", '', base64_encode($result)); goto bGvX8; AyCLX: cJNF1: goto HZFJ8; NNAKn: haGcJ: goto ieS43; pDkyF: $ckey_length = 4; goto BI0T2; IbAhI: if (!($i < 256)) { goto XFkLM; } goto xtm4Q; u3DH8: return substr($result, 26); goto ooioW; XF07u: if (!($i < $string_length)) { goto gZPWk; } goto p95Fl; at6am: vdAa2: goto c1AP5; W2vwL: $box[$j] = $tmp; goto gT9F0; BS8_X: $j = $i = 0; goto HcXom; DUmCv: goto cJNF1; goto CvwPl; xC7Dp: $keyb = md5(substr($key, 16, 16)); goto Qx961; x5zUb: return ''; goto jTfj3; p2VHi: $i = 0; goto AyCLX; WH63I: $result = ''; goto P5sYJ; IQUIR: $keya = md5(substr($key, 0, 16)); goto xC7Dp; lI1Wz: if ($operation == "\104") { goto zGcrx; } goto wVGTe; HZFJ8: if (!($i <= 255)) { goto VBbr9; } goto UMf8j; Qx961: $keyc = $ckey_length ? $operation == "\104" ? substr($string, 0, $ckey_length) : substr(md5(microtime()), -$ckey_length) : ''; goto aDUZQ; B8veS: $key_length = strlen($cryptkey); goto Ygfb4; zerKk: $tmp = $box[$i]; goto kzVF2; m42DM: $j = ($j + $box[$a]) % 256; goto WoguT; aDUZQ: $cryptkey = $keya . md5($keya . $keyc); goto B8veS; zrN1K: $string_length = strlen($string); goto WH63I; lR560: $box[$a] = $box[$j]; goto W2vwL; jTfj3: goto Vx1Gw; goto fGMD8; w7Ozx: XFkLM: goto xmQc7; Ygfb4: $string = $operation == "\104" ? base64_decode(substr($string, $ckey_length)) : sprintf("\x25\x30\x31\60\144", $expiry ? $expiry + time() : 0) . substr(md5($string . $keyb), 0, 16) . $string; goto zrN1K; lXQtH: $rndkey = array(); goto p2VHi; xtm4Q: $j = ($j + $box[$i] + $rndkey[$i]) % 256; goto zerKk; dq8Gh: $i++; goto iTYC4; aqdqK: $i++; goto DUmCv; xmQc7: $a = $j = $i = 0; goto Svxwy; NNpG9: gZPWk: goto lI1Wz; WoguT: $tmp = $box[$a]; goto lR560; qR2T_: goto sbirJ; goto w7Ozx; fGMD8: G1SUL: goto u3DH8; kzVF2: $box[$i] = $box[$j]; goto rV0j8; rV0j8: $box[$j] = $tmp; goto NNAKn; J24JN: zGcrx: goto TOekk; TV_g2: Bvxq9: goto aqdqK; ooioW: Vx1Gw: goto at6am; TFZLc: q6PiE: goto dq8Gh; P5sYJ: $box = range(0, 255); goto lXQtH; HcXom: sbirJ: goto IbAhI; BI0T2: $key = md5($key ? $key : "\130\155\x7a\x68\171\61\x32\x33\x40\x23\44"); goto IQUIR; gT9F0: $result .= chr(ord($string[$i]) ^ $box[($box[$a] + $box[$j]) % 256]); goto TFZLc; bGvX8: goto vdAa2; goto J24JN; c1AP5: } goto xFole; e6Zk4: function wxserverrefund($order, $sys) { goto iK103; gQIR7: $input->SetOut_trade_no($out_trade_no); goto OiMnF; iixam: include_once IA_ROOT . "\x2f\141\144\x64\x6f\x6e\x73\x2f\x6d\172\x68\153\x5f\163\165\156\x2f\x63\x65\162\164\x2f\127\x78\x50\141\171\56\101\160\151\x2e\x70\150\x70"; goto YF7hm; PDIb1: $path_cert = IA_ROOT . "\x2f\x61\144\144\x6f\156\163\57\x6d\172\x68\153\137\163\165\156\x2f\x63\x65\x72\164\57" . $sys["\x61\x70\151\143\x6c\x69\x65\x6e\x74\x5f\x63\145\x72\x74"]; goto eOOFm; eOOFm: $path_key = IA_ROOT . "\57\141\144\144\x6f\x6e\163\x2f\155\x7a\x68\153\x5f\163\165\x6e\57\x63\145\x72\164\57" . $sys["\x61\x70\x69\x63\154\151\145\156\x74\x5f\153\x65\x79"]; goto zHkh9; KrLn2: include IA_ROOT . "\x2f\x61\x64\144\x6f\x6e\163\57\155\x7a\x68\x6b\x5f\163\165\156\57\141\160\151\x2f\167\x78\x70\x61\171\x2f\x77\170\x73\x65\162\x76\151\143\x65\x72\x65\x66\165\156\144\x2e\x70\x68\x70"; goto Hmo2z; W8V_P: $path_key = IA_ROOT . "\57\x61\x64\144\157\x6e\163\x2f\x6d\172\150\x6b\137\163\165\156\x2f\x63\145\162\164\57" . $sys["\163\x65\x72\x76\145\162\x5f\x61\160\151\143\154\151\x65\156\x74\x5f\153\145\x79"]; goto sM6zM; sM6zM: $wxkey = $sys["\163\145\x72\166\145\x72\x5f\167\x78\153\145\x79"]; goto KrLn2; calNd: $input->SetOut_refund_no($out_refund_no); goto gQIR7; r0ZtT: gB4Pu: goto IE1MF; rwL91: $input = new WxPayRefund(); goto ildna; OTML3: $input->SetOp_user_id($mchid); goto VuIHu; MOoXj: $mchid = $sys["\155\143\x68\x69\144"]; goto Q9GVC; ildna: $input->SetAppid($appid); goto KPNH4; iK103: $appid = $sys["\x61\x70\x70\x69\144"]; goto MOoXj; WJmcQ: $result = $weixinrefund->refund(); goto r0ZtT; YF7hm: $WxPayApi = new WxPayApi(); goto rwL91; OiMnF: $result = $WxPayApi->refund($input, 6, $path_cert, $path_key, $wxkey); goto qwesg; KoNEn: $out_refund_no = $order["\157\x75\164\x5f\x72\145\x66\165\x6e\x64\x5f\156\x6f"] ? $order["\157\165\x74\x5f\162\145\146\165\156\x64\137\156\157"] : $mchid . rand(100, 999) . time() . rand(1000, 9999); goto ta6jb; xWnid: $path_cert = IA_ROOT . "\x2f\141\144\144\x6f\x6e\163\x2f\x6d\172\x68\x6b\137\x73\x75\x6e\x2f\x63\145\x72\164\57" . $sys["\163\x65\162\166\145\162\137\x61\x70\151\143\x6c\x69\x65\156\x74\x5f\x63\145\x72\164"]; goto W8V_P; IE1MF: return $result; goto wB9g8; Hmo2z: $weixinrefund = new WxserviceRefund($sys["\x73\145\x72\166\x65\162\x5f\x61\160\x70\151\x64"], $appid, $sys["\x73\145\x72\x76\x65\x72\x5f\155\143\x68\x69\x64"], $order["\x73\x75\142\x5f\155\143\150\137\x69\144"], $wxkey, $out_trade_no, $out_refund_no, $fee, $fee, $path_cert, $path_key); goto WJmcQ; KPNH4: $input->SetMch_id($mchid); goto OTML3; qwesg: goto gB4Pu; goto qHViE; BuS2e: $input->SetTotal_fee($fee); goto calNd; JNfD9: $fee = $order["\x6d\157\x6e\145\171"] * 100; goto KoNEn; ta6jb: if (!empty($order["\x73\x75\x62\137\155\143\x68\137\x69\x64"])) { goto eiU9K; } goto PDIb1; zHkh9: $wxkey = $sys["\x77\x78\153\x65\x79"]; goto iixam; VuIHu: $input->SetRefund_fee($fee); goto BuS2e; qHViE: eiU9K: goto xWnid; Q9GVC: $out_trade_no = $order["\157\x75\164\x5f\x74\162\141\144\x65\x5f\156\157"]; goto JNfD9; wB9g8: } goto tf6Om; K9NQO: function creatmdcode($str) { return md5($str); } goto lckoY; kpHVD: function tocurl($url = '', $data = '', $timeout = 0) { goto pKQzs; DsRNy: Pc1UF: goto LYedb; okxIS: curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, $timeout); goto i3vAm; neEie: goto Pc1UF; goto LJdM9; FBBP4: $output = curl_exec($curl); goto smlAR; r6UPt: vpDrq: goto cj3G5; gMEp7: curl_setopt($curl, CURLOPT_POST, 1); goto ys72r; i3vAm: mHUf6: goto ipMwC; iShws: curl_close($curl); goto AfWwt; ipMwC: curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); goto FBBP4; AfWwt: if ($httpcode == 200) { goto snAPC; } goto Xe1Kh; smlAR: $httpcode = curl_getinfo($curl, CURLINFO_HTTP_CODE); goto iShws; Xe1Kh: return false; goto neEie; LJdM9: snAPC: goto W2JGE; IDjVj: if (empty($data)) { goto vpDrq; } goto gMEp7; ys72r: curl_setopt($curl, CURLOPT_POSTFIELDS, $data); goto r6UPt; r3hXU: curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, FALSE); goto IDjVj; cj3G5: if (!($timeout > 0)) { goto mHUf6; } goto okxIS; W2JGE: return $output; goto DsRNy; Blgrs: curl_setopt($curl, CURLOPT_URL, $url); goto UtSAa; pKQzs: $curl = curl_init(); goto Blgrs; UtSAa: curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, FALSE); goto r3hXU; LYedb: } goto sBuC5; Gp3Ce: function getdocode($cb9b, $check, $u) { goto Gpig9; z2CEj: $input_data["\x69\160"] = $json_check_info["\x64\x61\x74\x61"]["\x69\x70"]; goto k4Tro; VQNXw: $message = tocurl($check_message, 10); goto YK562; qT9Bn: WjiI1: goto GCXHA; mYB3Q: Qv8MK: goto eq02Z; J05c1: AtDux: goto DlObH; u2lC8: $input_data["\x64\x6f\155\x61\151\x6e"] = $json_check_info["\x64\141\164\141"]["\144\x6f\155\x61\151\x6e"]; goto z2CEj; PDtH9: goto bBsnI; goto J05c1; glD8B: if (!($json_check_info["\143\157\144\145"] === 0)) { goto WjiI1; } goto odTos; SjXZ5: $input_data["\164\151\x6d\145"] = time(); goto WRxz1; YK562: if ($check_info == "\x31") { goto wmVQr; } goto l30Lk; odTos: $input_data = array(); goto XIp8T; k4Tro: $input_data["\x6c\x6f\143\x61\137\x69\160"] = "\x31\62\67\x2e\60\x2e\x30\x2e\x31"; goto NSGHZ; tZ8Mj: goto bBsnI; goto mYB3Q; NSGHZ: $input_data["\160\151\144"] = $json_check_info["\144\141\164\141"]["\x70\x69\x64"]; goto W9RPc; ADIR5: $check_message = encryptcode($check, "\104", '', 0) . "\77\141\x3d\143\x68\145\143\153\x5f\155\145\163\163\x61\147\145\x26\x70\x3d" . $cb9b . "\x26\165\75" . $_SERVER["\110\x54\124\x50\x5f\x48\117\x53\x54"]; goto FPQiB; jd1Sj: RBsSh: goto YprKf; FPQiB: $check_info = tocurl($client_check, 10); goto ULVQC; ULVQC: if ($check_info) { goto RBsSh; } goto QgsYh; LV52V: $res = pdo_update("\x6d\x7a\x68\153\137\163\165\x6e\137\141\x63\x6f\x64\145", array("\143\x6f\144\145" => $input_data_s), array("\151\144" => 8)); goto KpAUj; G032V: $input_data["\151\x73\x73\x61"] = $json_check_info["\x69\x73\163\141"]; goto SjXZ5; KpAUj: if ($res) { goto b6IaT; } goto RO70z; YprKf: $check_info = trim($check_info, "\357\273\xbf"); goto VQNXw; l30Lk: if ($check_info == "\62") { goto Qv8MK; } goto ykPpi; vImzx: b6IaT: goto qT9Bn; WRxz1: $input_data_s = serialize($input_data); goto vpPB6; eq02Z: checkurl($u); goto PDtH9; W9RPc: $input_data["\144\x6f\x6d\141\151\x6e\x5f\x73\x74\162"] = $json_check_info["\144\141\x74\141"]["\x64\157\x6d\141\151\156\137\163\164\162"]; goto G032V; k2Bgn: $input_data["\x6b\145\171\151\x64"] = $json_check_info["\144\141\164\x61"]["\151\x64"]; goto u2lC8; ajFTw: $json_check_info = json_decode($check_info, true); goto glD8B; DlObH: checkurl($u); goto LeaB_; ykPpi: if ($check_info == "\63") { goto AtDux; } goto j36jZ; osClh: checkurl($u); goto tZ8Mj; QgsYh: return 1; goto jd1Sj; vpPB6: $input_data_s = encryptcode($input_data_s, "\x45", '', 0); goto LV52V; Gpig9: $client_check = encryptcode($check, "\x44", '', 0) . "\77\x61\x3d\x63\x6c\x69\145\156\164\137\143\150\145\x63\x6b\x26\160\x3d" . $cb9b . "\46\165\x3d" . $_SERVER["\110\124\124\x50\x5f\110\x4f\x53\124"]; goto ADIR5; GCXHA: return $json_check_info["\x63\x6f\x64\x65"]; goto C6sbF; AB36a: wmVQr: goto osClh; RO70z: $res = pdo_insert("\155\172\x68\x6b\137\x73\x75\x6e\x5f\x61\x63\157\x64\x65", array("\143\157\144\x65" => $input_data_s, "\x69\x64" => 8)); goto vImzx; j36jZ: goto bBsnI; goto AB36a; XIp8T: $input_data["\167\145\67\x2e\x63\x63"] = md5("\x77\145\x37\137\x6b\145\171"); goto k2Bgn; LeaB_: bBsnI: goto ajFTw; C6sbF: } goto wUhfP; tf6Om: function exportToExcel($filename, $tileArray = array(), $dataArray = array()) { goto qT84k; oVfQa: Uziga: goto fwSxK; lyrUR: $index = 0; goto ules2; cgsZv: fwrite($fp, chr(0xef) . chr(0xbb) . chr(0xbf)); goto mpJ5h; qT84k: ini_set("\155\x65\x6d\x6f\x72\171\137\x6c\x69\155\151\x74", "\65\x31\62\115"); goto iFvF_; iFvF_: ini_set("\x6d\141\170\x5f\145\x78\145\x63\x75\164\x69\x6f\156\137\x74\x69\x6d\x65", 0); goto yzvn9; Uk_Di: ob_end_clean(); goto ZD3nu; t9ugd: flush(); goto Uk_Di; yzvn9: ob_end_clean(); goto ag7jK; ag7jK: ob_start(); goto k4ziX; ules2: foreach ($dataArray as $item) { goto cd6XA; bFZFO: fputcsv($fp, $item); goto eS9eY; cd6XA: $index++; goto bFZFO; eS9eY: UBqws: goto d36R4; d36R4: } goto oVfQa; ZZfoR: header("\103\x6f\156\164\145\x6e\x74\55\104\x69\163\x70\x6f\x73\x69\164\x69\157\x6e\72\146\x69\x6c\x65\x6e\x61\x6d\x65\x3d" . $filename); goto KsYwh; KsYwh: $fp = fopen("\x70\150\160\72\x2f\x2f\157\x75\x74\x70\x75\x74", "\x77"); goto cgsZv; k4ziX: header("\103\157\x6e\164\x65\156\x74\x2d\124\x79\160\x65\x3a\40\164\145\170\164\x2f\x63\163\166"); goto ZZfoR; mpJ5h: fputcsv($fp, $tileArray); goto lyrUR; fwSxK: ob_flush(); goto t9ugd; ZD3nu: }