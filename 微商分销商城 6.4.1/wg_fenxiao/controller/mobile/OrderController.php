<?php
 class OrderController extends MobileBaseController { public static $BLACK = array(); public $test = 0; private $zhekou = 10; public function ajaxPay() { goto Kv99r; NTYP6: YhDkN: goto zRKLr; me9DP: paizF: goto SsHbx; vX62l: $ids = array_unique($ids); goto YS_1z; BPIy_: goto tgY16; goto T_EQr; AfKQF: $parent3 = $parent3_info["\151\144"]; goto LxxrN; s850s: $ids = $goods_info = $goods_ids = []; goto mbJP5; NwZch: $order_id = (int) $this->GPC["\157\x72\144\145\162\x5f\x69\x64"]; goto OjJth; quFj8: if ($order_id) { goto tU2IR; } goto yTyOi; B44Zi: YrwZq: goto kldQs; EHvd_: if (!$ids) { goto Nbkj4; } goto vX62l; LSf1q: q7baf: goto uPZJp; kQ1oJ: foreach ($pay_info as $detail) { goto mL3dE; YtOpJ: $this->ajaxReturn(502, ''); goto fXMPJ; hleri: U9NFp: goto SWxFj; SUyl0: $goods_ids[$goods_id . "\x5f" . $type] = ["\x69\x64" => $goods_id, "\141\x6d\157\165\156\x74" => $amount, "\164\x79\x70\x65" => $type]; goto SuSIN; fXMPJ: zYHs3: goto SUyl0; HMPa9: if (!(!$goods_id || $amount <= 0 || !$type)) { goto zYHs3; } goto YtOpJ; mL3dE: list($goods_id, $amount, $type) = explode("\137", $detail); goto zII03; UGFRT: $amount = (int) $amount; goto hfHM4; zII03: $goods_id = (int) $goods_id; goto UGFRT; hfHM4: $type = (int) $type; goto HMPa9; SuSIN: $ids[] = $goods_id; goto hleri; SWxFj: } goto b6d70; MbQXv: if ($goods_types) { goto fw1Ks; } goto LeB86; CTDHH: if ($order_info) { goto lq7Mc; } goto t4pt5; kp6Ho: $this->ajaxReturn($result["\143\157\144\145"], ''); goto vDXp0; ANKpi: $this->ajaxReturn(501, "\xe8\xaf\xb7\xe6\202\250\xe5\x85\210\346\xb7\273\xe5\x8a\240\346\224\xb6\350\264\247\xe5\x9c\xb0\345\235\200"); goto g5UiN; vDXp0: goto q7baf; goto pfBw8; u7gdp: $order_info = $this->OrderModel->getOne(["\151\x64" => $order_id, "\155\x65\155\142\145\x72\151\x64" => $this->uid]); goto CTDHH; FXClc: $pay_info = explode("\x2c", $pay_info); goto x2mLo; SsHbx: $this->ajaxReturn(0, $result["\157\x72\144\x65\162\x5f\151\x64"]); goto oeIEy; ivQxV: if (!(count($pay_info) != count($goods_ids))) { goto d_DgY; } goto cTOk1; t4pt5: $this->ajaxReturn(409, "\350\256\242\345\x8d\x95\344\270\215\345\xad\230\xe5\x9c\xa8"); goto EdQY0; OjJth: $pay_info = trim($this->GPC["\160\x61\x79\x5f\x69\x6e\146\157"]); goto DGZDW; f25xC: $goods_types1 = $this->arrayIndex($goods_types, "\x69\x64"); goto EHvd_; Dn874: p0gDK: goto xfG6t; XPdFO: $money = $amount = $jifen = $postage = $all = 0; goto snGLc; LEEDl: if (!$parent1_info["\151\163\141\x67\x65\x6e\164"]) { goto YrwZq; } goto pRSYR; qqTxd: $this->ajaxReturn(500, "\346\x94\xaf\xe4\273\x98\345\x8f\x82\xe6\x95\xb0\351\x94\231\350\257\xaf"); goto rFliX; aCw3V: $data["\167\x71\x70\x61\171"] = $this->site->configs["\x63\157\156\x66\x69\147"]["\x77\161\160\141\171"]; goto A0wW9; xIu7C: Nbkj4: goto xhjXA; xhjXA: $where = ["\163\x74\x61\162\x74\40\x3c" => time(), "\145\x6e\144\40\76" => time(), "\147\x6f\x6f\144\163\137\151\x64" => $ids, "\164\171\x70\x65" => 1]; goto JUqmO; f8SFe: if (!(!$this->checkPayConfig() && !$this->test)) { goto ao0jf; } goto qqTxd; xmGVC: foreach ($order_detail as $value) { $pay_str .= $value["\x67\157\x6f\144\163\137\x69\x64"] . "\x5f" . $value["\x61\155\x6f\165\x6e\164"] . "\x5f" . $value["\x74\x79\x70\x65\137\151\x64"] . "\x2c"; DI9AT: } goto cqZvu; Jgq8h: if ($order_id) { goto cTGtG; } goto ZPkXY; BhSnh: $goods_types = $this->GoodsTypeModel->getList(["\147\x6f\157\x64\163\137\x69\144" => $ids, "\144\x65\x6c" => 0], "\x2a"); goto MbQXv; wHlcP: if ($result["\x63\157\x64\x65"] == 0) { goto vpwQB; } goto gJBNc; BVvkY: $address_id = (int) $this->GPC["\141\144\144\x72\145\x73\x73\x5f\x69\144"]; goto NwZch; h8WSW: d52rP: goto FXClc; Kv99r: if ($this->uid) { goto A4p3t; } goto c72ob; obQMG: y9tjt: goto k7T7r; zH2qx: if (!($parent1_info && $level > 0 && !$order_id)) { goto p0gDK; } goto LEEDl; EdQY0: lq7Mc: goto kIBIq; T_EQr: tU2IR: goto GP5DZ; Ttg0L: d_DgY: goto BhSnh; QcOkV: if ($data["\x77\x71\x70\141\171"]) { goto paizF; } goto DDNnf; BeTJr: $money = $order_data["\x6f\162\x64\x65\x72\x70\x72\151\x63\x65"]; goto Vkz7D; AZSUV: $this->OrderModel->commit(); goto BeTJr; EhR8E: I7GSl: goto WqQdo; x2mLo: if (!$pay_info) { goto I7GSl; } goto kQ1oJ; Gp9ve: $pay_info = rtrim($pay_str, "\54"); goto OM778; GP5DZ: $result = $this->updateOrder($order_data, $goods_ids, $order_id); goto aTnmV; pfBw8: vpwQB: goto AZSUV; a4kXL: $this->ajaxReturn(408, "\350\256\242\345\x8d\x95\xe4\270\x8d\345\255\230\xe5\234\xa8"); goto obQMG; DDNnf: $params = $this->getPayParams($order_data, $this->userInfo["\x6f\160\x65\x6e\x69\x64"]); goto hB7Kf; w9mol: $order_data = ["\x77\x65\151\x64" => $this->W["\x75\x6e\151\141\143\x69\x64"], "\155\145\x6d\142\x65\x72\x69\x64" => $this->uid, "\x6f\162\144\145\x72\163\156" => $this->getOrderId(), "\x74\x6f\x74\x61\x6c" => $amount, "\157\162\x64\x65\x72\160\x72\x69\143\x65" => number_format($all + $postage, 2, "\x2e", ''), "\x79\165\x6e\146\x65\x69" => $postage, "\x61\x64\144\x72\x65\163\163\151\144" => $address_id, "\162\145\155\141\162\153" => trim($this->GPC["\162\x65\x6d\141\x72\x6b"]), "\163\164\x61\164\x75\163" => 0, "\x63\x72\x65\x61\x74\x65\164\x69\x6d\x65" => time(), "\x70\x61\162\x65\156\x74\61" => $parent1, "\160\x61\x72\145\x6e\x74\62" => $parent2, "\x70\141\x72\x65\x6e\x74\x33" => $parent3, "\152\x69\146\145\x6e" => $jifen]; goto bVYuB; rgJMU: $parent2 = $parent2_info["\151\144"]; goto InstO; g5UiN: yGZrk: goto Jgq8h; mbJP5: if ($pay_info) { goto d52rP; } goto GMDpM; JUqmO: $zhekou = $this->GouModel->getList($where, ["\x2a"]); goto jqFXz; YS_1z: $goods_info = $this->GoodsModel->getList(["\x69\x64" => $ids, "\163\x74\141\x74\x75\x73" => 1], ["\x69\144", "\x67\x6f\157\x64\163\x6e\141\155\145", "\155\x61\162\x6b\x65\x74\160\162\x69\x63\145", "\164\150\165\155\x62", "\163\x65\x6c\154\x5f\164\x6f\164\x61\x6c", "\x74\x6f\164\141\x6c", "\x71\165\x61\x6e\x67\x75\157\171\157\x75\x66\x65\x69", "\147\x6f\x6f\x64\x73\164\x79\x70\145", "\x67\x6f\157\x64\163\x70\141\x73\163\x74\x79\160\x65"]); goto RoBUx; AIsuf: t1OJX: goto Dn874; Dzzob: if (!$parent2_info["\x69\163\141\x67\145\x6e\x74"]) { goto C_n3F; } goto rgJMU; hmikf: $level = $this->site->configs["\x63\x6f\156\146\151\147"]["\154\145\x76\145\154"]; goto aCw3V; fPcuL: fw1Ks: goto f25xC; OM778: q9byi: goto NqL55; HZp6y: goto Fs_VI; goto h8WSW; yTyOi: $result = $this->addOrder($order_data, $goods_ids, $zhekou); goto BPIy_; A0wW9: $this->zhekou = $this->userInfo["\x7a\150\145\153\x6f\x75"]; goto f8SFe; NqL55: $address_info = $this->AddressModel->getOne(["\151\x64" => $address_id, "\x75\151\144" => $this->uid], "\x69\144"); goto s850s; WqQdo: Fs_VI: goto ivQxV; c72ob: $this->ajaxReturn(400, "\xe8\257\xb7\xe6\x82\250\xe5\x9c\250\xe5\276\256\344\xbf\xa1\347\253\xaf\347\x99\273\345\xbd\x95"); goto Ihuk0; pRSYR: $parent1 = $parent1_info["\151\x64"]; goto B44Zi; DGZDW: if (!$order_id) { goto q9byi; } goto u7gdp; aTnmV: tgY16: goto wHlcP; oeIEy: rR46H: goto LSf1q; WEv9y: foreach ($goods_ids as &$value) { goto YQRN8; x3qiL: goto LgMR3; goto tKqbO; wAm0_: $all += $value["\x61\155\157\165\x6e\x74"] * $value["\164\171\160\145\x5f\151\x6e\x66\x6f"]["\x6d\141\162\153\x65\x74\x70\162\151\143\145"] * $value["\x7a\x68\145\x6b\157\165"] / 10; goto DGWrM; tKqbO: wb7Zt: goto W3iaU; vq10A: $this->ajaxReturn(505, "\351\x83\xa8\xe5\210\x86\xe5\x95\206\345\223\201\345\261\236\xe6\200\xa7\xe4\xb8\x8d\345\xad\230\xe5\x9c\xa8"); goto JTRPB; h3NMC: $value["\x74\x79\160\145\x5f\x69\156\x66\x6f"] = $goods_types1[$value["\x74\x79\160\145"]]; goto q3MKo; JTRPB: OVScr: goto h3NMC; vHDwp: if (!($value["\141\x6d\x6f\165\x6e\x74"] + $value["\164\x79\x70\x65\x5f\x69\x6e\146\x6f"]["\141\x6d\157\x75\156\164\137\x73\x65\154\154"] > $value["\164\x79\x70\x65\137\151\156\146\x6f"]["\141\155\x6f\x75\156\164\x5f\164\157\164\141\x6c"])) { goto hF_wB; } goto VIl1z; W3iaU: $value["\172\150\x65\x6b\157\165"] = $zhekou[$value["\151\144"]]["\172\x68\x65\x6b\x6f\x75"] && $zhekou[$value["\x69\x64"]]["\172\150\145\x6b\x6f\165"] > 0 ? $zhekou[$value["\151\x64"]]["\x7a\150\145\x6b\157\x75"] : 10; goto cgppf; zvow1: t5gC7: goto DfrHX; psCsk: if ($value["\x74\171\160\145"] && $goods_types1[$value["\164\x79\x70\x65"]]) { goto qr5aB; } goto M2dDp; cO7bE: if (!($value["\x67\157\x6f\144\x73\137\x69\156\x66\x6f"]["\161\x75\141\x6e\147\x75\157\171\x6f\x75\x66\x65\x69"] > 0)) { goto j145d; } goto WuzeD; pqnSN: J8vg3: goto Va9hH; z6t5s: hF_wB: goto MfDXB; cgppf: LgMR3: goto wAm0_; RrxyN: goto enMBi; goto zvow1; aRZug: $money += $value["\141\x6d\157\x75\x6e\164"] * $value["\x74\171\x70\145\x5f\x69\x6e\146\157"]["\x6d\x61\162\153\145\164\160\162\x69\x63\x65"]; goto UUP0r; gVnx_: j145d: goto psCsk; YQRN8: if ($goods_info[$value["\x69\x64"]]) { goto t5gC7; } goto R7a_V; DfrHX: $value["\147\x6f\157\x64\x73\137\151\156\x66\157"] = $goods_info[$value["\x69\144"]]; goto aokzP; R_C_I: if (!($value["\x74\x79\160\145"] != $goods_types1[$value["\164\x79\160\145"]]["\151\144"])) { goto OVScr; } goto vq10A; oJbNY: D_Ytf: goto cO7bE; R7a_V: $this->ajaxReturn(508, "\xe9\203\250\xe5\210\x86\xe5\225\x86\345\223\201\344\270\x8d\345\xad\230\345\x9c\xa8\174" . $value["\151\144"]); goto RrxyN; oU4dT: $value["\x7a\150\145\x6b\x6f\x75"] = $this->zhekou; goto x3qiL; TZi1U: qr5aB: goto R_C_I; WuzeD: $postage = $value["\x67\x6f\157\x64\163\x5f\151\x6e\x66\157"]["\x71\165\x61\156\147\x75\157\x79\x6f\x75\x66\x65\151"] > $postage ? $value["\x67\157\157\x64\x73\137\x69\156\x66\157"]["\x71\165\141\156\x67\x75\157\171\157\165\146\x65\x69"] : $postage; goto gVnx_; aokzP: if (!($value["\147\157\x6f\x64\x73\137\x69\x6e\146\157"]["\x67\157\157\x64\163\x74\x79\160\145"] == 0)) { goto D_Ytf; } goto jdEY0; MfDXB: $jifen += $value["\141\x6d\157\x75\156\x74"] * $value["\164\x79\160\x65\x5f\x69\156\x66\x6f"]["\x6a\x69\x66\145\156"]; goto gyUnd; q3MKo: kaUKm: goto vHDwp; DGWrM: enMBi: goto pqnSN; QycmV: goto kaUKm; goto TZi1U; VIl1z: $this->ajaxReturn(507, "\xe9\x83\250\345\x88\206\xe5\225\206\345\x93\201\xe5\267\262\xe7\xbb\x8f\xe5\215\x96\xe5\256\214\x7c" . $value["\x69\144"]); goto z6t5s; gyUnd: $amount += $value["\x61\155\x6f\x75\x6e\164"]; goto aRZug; UUP0r: if ($zhekou[$value["\151\144"]]) { goto wb7Zt; } goto oU4dT; M2dDp: $this->ajaxReturn(506, "\xe9\203\xa8\xe5\x88\x86\xe5\x95\206\345\x93\x81\345\xb1\236\346\x80\247\xe4\270\x8d\345\xad\x98\xe5\x9c\xa8"); goto QycmV; jdEY0: $address_need = true; goto oJbNY; Va9hH: } goto NTYP6; X7va9: if (!($parent3_info["\151\x73\x61\147\x65\156\x74"] && $level > 2)) { goto kEIaf; } goto AfKQF; cTOk1: $this->ajaxReturn(504, "\xe9\x83\xa8\345\x88\206\xe5\x95\206\345\223\x81\344\270\215\xe5\255\x98\345\234\xa8"); goto Ttg0L; kldQs: $parent2_info = $this->MemberModel->getOne(["\151\144" => $parent1_info["\160\x61\162\145\156\164\137\x69\144"]], ["\151\144", "\x69\163\x61\x67\x65\x6e\x74", "\x70\x61\162\145\x6e\164\137\x69\144"]); goto U1t0h; Vkz7D: $money = $money * 100; goto Y2atq; LeB86: $this->ajaxReturn(509, "\xe5\225\x86\345\x93\201\xe5\261\236\346\200\247\344\xb8\x8d\xe5\255\230\xe5\x9c\xa8"); goto fPcuL; LFOdr: $parent1_info = $this->MemberModel->getOne(["\151\144" => $this->userInfo["\x70\141\x72\145\x6e\164\x5f\x69\x64"]], ["\151\x64", "\x69\x73\x61\147\145\156\x74", "\x70\x61\162\x65\156\x74\x5f\151\144"]); goto zH2qx; xoRM8: goto rR46H; goto me9DP; zRKLr: if (!(!$address_info && $address_need)) { goto yGZrk; } goto ANKpi; LxxrN: kEIaf: goto AIsuf; XjEB5: if ($order_detail) { goto y9tjt; } goto a4kXL; cqZvu: aDig2: goto Gp9ve; b6d70: GpEg6: goto EhR8E; Y2atq: $order_data["\x6d\x6f\x6e\x65\x79"] = $money; goto QcOkV; jqFXz: $zhekou = $this->arrayIndex($zhekou, "\x67\157\157\x64\x73\x5f\x69\144"); goto XPdFO; hB7Kf: $this->ajaxReturn($params["\x63\x6f\144\145"], $params["\x6d\163\x67"], $params["\144\x61\x74\x61"]); goto xoRM8; Ihuk0: A4p3t: goto hmikf; kIBIq: $order_detail = $this->OrderDetailModel->getList(["\157\162\144\x65\x72\137\x69\x64" => $order_id], ["\147\x6f\157\144\x73\137\x69\x64", "\x61\155\x6f\x75\x6e\x74", "\164\x79\x70\145\x5f\151\144"]); goto XjEB5; ZPkXY: $parent1 = $parent2 = $parent3 = 0; goto LFOdr; InstO: C_n3F: goto SzKi2; bVYuB: $this->OrderModel->begin(); goto quFj8; GMDpM: $this->ajaxReturn(503, ''); goto HZp6y; RoBUx: $goods_info = $this->arrayIndex($goods_info, "\151\x64"); goto xIu7C; SzKi2: $parent3_info = $this->MemberModel->getOne(["\151\x64" => $parent2_info["\160\141\162\145\156\x74\137\151\144"]], ["\x69\144", "\x69\x73\141\147\x65\156\164", "\160\x61\x72\145\156\164\x5f\x69\144"]); goto X7va9; U1t0h: if (!($parent2_info && $level > 1)) { goto t1OJX; } goto Dzzob; xfG6t: cTGtG: goto w9mol; gJBNc: $this->OrderModel->rollback(); goto kp6Ho; snGLc: $address_need = false; goto WEv9y; k7T7r: $pay_str = ''; goto xmGVC; rFliX: ao0jf: goto BVvkY; uPZJp: } public function result() { goto sVrYL; xqSnL: $params["\x75\163\x65\x72"] = $this->W["\x66\x61\x6e\163"]["\x66\x72\x6f\x6d\137\165\x73\x65\162"]; goto YY153; l5G_1: $params["\x6f\x72\x64\145\162\x73\x6e"] = $order["\x6f\x72\144\145\162\163\156"]; goto v25H2; ZNVRX: $this->display(); goto Gqg3w; sY6_p: $params["\x74\151\144"] = $order["\x6f\162\144\145\162\x73\x6e"]; goto xqSnL; YY153: $params["\146\x65\x65"] = $order["\157\x72\144\145\162\160\162\x69\143\x65"]; goto BD8kw; sVrYL: $order_id = $_GET["\x6f\x72\x64\x65\162\137\151\144"]; goto rRIRN; rRIRN: $order = $this->OrderModel->getOne(["\151\x64" => $order_id]); goto sY6_p; BD8kw: $params["\164\151\x74\154\145"] = "\345\225\206\345\223\201\xe4\273\x98\xe6\xac\xbe"; goto l5G_1; v25H2: $this->assign(["\160\x61\x72\141\155\163" => $params]); goto ZNVRX; Gqg3w: } public function addOrder($order, $goods_info, $zhekous) { goto Oao5B; ARXh5: MCy2r: goto c6106; c6106: foreach ($goods_info as $item) { goto sxi1t; iexGb: mpMI8: goto EkMH6; sxi1t: if ($zhekous[$item["\x69\x64"]]) { goto NiEHA; } goto m1IZK; BBFvy: oCb2Y: goto nRzyq; O2XYN: goto oCb2Y; goto V4ikT; R3DQh: s02PN: goto iexGb; nRzyq: $detail = ["\x6f\x72\144\x65\162\137\151\144" => $order_id, "\147\x6f\x6f\144\x73\137\x69\144" => $item["\x69\144"], "\x61\x6d\157\x75\156\x74" => $item["\x61\x6d\157\x75\x6e\164"], "\164\151\x74\x6c\145" => $item["\x67\x6f\157\x64\163\137\151\156\146\157"]["\x67\x6f\x6f\144\x73\x6e\x61\x6d\x65"], "\160\x72\x69\143\145" => number_format($item["\164\171\160\145\x5f\x69\x6e\x66\157"]["\155\x61\162\x6b\145\164\160\x72\x69\143\x65"] * $zhekou / 10, 2, "\56", ''), "\164\150\x75\x6d\142" => $item["\x67\x6f\x6f\144\163\x5f\x69\x6e\x66\157"]["\x74\x68\165\x6d\x62"], "\164\x79\160\x65\x5f\x69\144" => $item["\x74\171\x70\x65"], "\164\x79\160\145\x5f\164\x69\164\x6c\145" => $item["\164\171\160\145\x5f\x69\156\146\157"]["\164\x69\164\x6c\145"], "\x67\157\157\x64\x73\164\171\x70\145" => $item["\x67\x6f\x6f\144\163\x5f\x69\156\x66\157"]["\x67\x6f\157\144\163\164\x79\x70\x65"], "\147\x6f\157\x64\163\x70\141\163\x73\164\x79\x70\145" => $item["\x67\157\x6f\144\x73\137\151\x6e\146\x6f"]["\x67\157\x6f\144\x73\x70\x61\163\x73\164\171\160\x65"]]; goto JGAmL; JGAmL: $detail_id = $this->OrderDetailModel->add($detail); goto xueHY; JuCaz: return ["\x63\x6f\144\145" => 102]; goto R3DQh; xueHY: if ($detail_id) { goto s02PN; } goto JuCaz; m1IZK: $zhekou = $this->zhekou; goto O2XYN; W2zQo: $zhekou = $zhekous[$item["\x69\x64"]]["\172\150\145\153\x6f\165"] && $zhekous[$item["\151\x64"]]["\x7a\x68\145\x6b\157\165"] > 0 ? $zhekous[$item["\151\144"]]["\x7a\150\x65\x6b\x6f\165"] : 10; goto BBFvy; V4ikT: NiEHA: goto W2zQo; EkMH6: } goto tGK5k; tGK5k: LA1v5: goto bnB38; HXlcN: if ($order_id) { goto MCy2r; } goto WNl3Q; WNl3Q: return ["\x63\157\144\145" => 101]; goto ARXh5; bnB38: return ["\143\157\144\x65" => 0, "\157\x72\144\145\x72\137\x69\x64" => $order_id]; goto GZEiT; Oao5B: $order_id = $this->OrderModel->add($order); goto HXlcN; GZEiT: } public function updateOrder($order, $goods_info, $order_id) { goto JhAgT; mPp9m: if ($update) { goto acwkH; } goto vQLj5; JhAgT: $update = $this->OrderModel->update(["\151\144" => $order_id], ["\x6f\x72\x64\x65\x72\x73\x6e" => $order["\x6f\162\x64\145\162\x73\x6e"], "\x6f\x72\144\145\162\x70\162\x69\143\145" => $order["\x6f\x72\x64\x65\x72\x70\162\151\143\145"], "\x79\x75\156\x66\x65\151" => $order["\x79\165\x6e\146\145\151"], "\141\144\144\162\x65\x73\163\x69\x64" => $order["\141\x64\144\x72\145\x73\x73\151\x64"], "\x72\x65\155\141\x72\x6b" => $order["\162\145\x6d\141\x72\x6b"]]); goto mPp9m; S99tE: return ["\143\157\x64\x65" => 0, "\157\x72\x64\x65\162\137\x69\144" => $order_id]; goto c3lS1; vQLj5: return ["\x63\x6f\x64\145" => 103]; goto VYaNw; VYaNw: acwkH: goto S99tE; c3lS1: } private function getOrderId() { $randNo = sprintf("\45\x30\x34\144", rand(1, 1000)); return date("\x59\155\144\x48\x69\163") . $randNo; } private function checkPayConfig() { goto pVB8S; jCo8u: ld4AM: goto ftcBA; j5nPs: if (!(!$_W["\141\x63\143\x6f\165\x6e\164"]["\x6b\x65\171"] || !$setting["\160\141\x79\155\145\156\x74"]["\x77\145\143\150\141\164"]["\155\143\150\x69\144"] || !$setting["\160\x61\171\155\145\156\x74"]["\x77\x65\143\x68\x61\164"]["\x73\x69\x67\156\x6b\145\171"])) { goto ld4AM; } goto cED9j; cED9j: return false; goto jCo8u; f3VOd: $setting = uni_setting($this->W["\165\x6e\x69\141\143\x69\144"]); goto j5nPs; ftcBA: return true; goto mtMXM; pVB8S: global $_W; goto f3VOd; mtMXM: } private function getPayParams($order_info, $openid) { goto DeXkd; Hlmmz: $input->SetOpenid($openid); goto qawvb; Q1WYq: require_once dirname(__FILE__) . "\57\56\56\57\56\x2e\57\x6c\x69\x62\57\167\170\x70\141\x79\x2f\154\x69\x62\57\x57\170\x50\x61\171\x2e\x41\160\151\x2e\x70\x68\160"; goto O5zX5; xVy2Q: $_W["\155\x6f\144\165\x6c\x65\137\163\x65\164\164\x69\x6e\x67"]["\x70\x61\x79"]["\x6d\143\150\151\144"] = $setting["\160\x61\171\155\x65\x6e\x74"]["\167\145\x63\150\x61\164"]["\155\x63\x68\x69\144"]; goto N2cXC; N2cXC: $_W["\155\x6f\144\x75\x6c\145\137\163\145\164\164\151\x6e\x67"]["\x70\141\171"]["\153\x65\171"] = $setting["\160\x61\x79\x6d\x65\x6e\164"]["\x77\145\143\x68\x61\164"]["\x73\x69\147\156\153\x65\x79"]; goto Z60Z9; z3F0x: if ($order["\143\157\144\x65"] == 0) { goto u12cQ; } goto i00ou; DeXkd: global $_W, $_GPC; goto Q1WYq; RyhsT: $input->SetBody($title); goto wwxcb; Z60Z9: $order = WxPayApi::unifiedOrder($input); goto z3F0x; qawvb: $setting = uni_setting($this->W["\165\156\151\141\x63\x69\x64"]); goto FfPD6; pu84i: $input->SetOut_trade_no($order_info["\x6f\x72\144\x65\x72\x73\x6e"]); goto lIGcJ; i00ou: return ["\143\x6f\x64\145" => $order["\x63\157\144\x65"], "\155\x73\147" => $order["\155\163\x67"]]; goto yH0Dc; lIGcJ: $input->SetTotal_fee($order_info["\155\x6f\x6e\145\171"]); goto C_XhP; C_XhP: $input->SetTime_start(date("\131\x6d\144\110\151\x73")); goto NPUOi; QKXIH: $input->SetTrade_type("\x4a\x53\x41\120\x49"); goto Hlmmz; UgXYd: require_once dirname(__FILE__) . "\57\x2e\x2e\x2f\56\56\x2f\154\x69\x62\57\167\170\x70\x61\x79\x2f\x65\x78\x61\155\x70\x6c\x65\57\127\170\x50\x61\x79\56\x4a\163\101\x70\x69\x50\x61\171\x2e\x70\150\x70"; goto AFfQv; pk7X5: return ["\143\x6f\x64\x65" => 0, "\x64\141\x74\141" => $tools->GetJsApiParameters($order["\x64\141\x74\141"])]; goto xPLxG; JGHgS: u12cQ: goto pk7X5; NPUOi: $input->SetTime_expire(date("\x59\155\x64\110\x69\x73", time() + 600)); goto Q1MSh; xPLxG: ASaOA: goto HnYVy; nfh3A: require_once dirname(__FILE__) . "\x2f\x2e\56\x2f\56\x2e\x2f\x6c\x69\142\57\167\x78\160\141\171\x2f\x6c\151\142\x2f\127\170\120\x61\171\56\x41\x70\x69\x2e\160\x68\160"; goto i8aUb; FIdJN: $title = "\345\276\xae\344\xbf\xa1\346\x94\257\xe4\273\230"; goto d3Njn; d3Njn: $input = new WxPayUnifiedOrder(); goto RyhsT; yH0Dc: goto ASaOA; goto JGHgS; i8aUb: require_once dirname(__FILE__) . "\57\x2e\x2e\x2f\x2e\56\57\x6c\151\x62\x2f\x77\170\160\141\171\x2f\145\170\141\x6d\160\154\x65\57\x57\170\x50\x61\171\56\x4a\x73\101\x70\151\120\x61\x79\56\160\x68\x70"; goto FIdJN; FfPD6: $_W["\x6d\x6f\144\165\x6c\145\137\163\145\164\x74\151\x6e\147"]["\x70\x61\171"]["\x61\x70\x70\x69\x64"] = $_W["\x61\x63\x63\157\165\x6e\164"]["\x6b\145\171"]; goto xVy2Q; n96rn: $tools = new JsApiPay(); goto nfh3A; wwxcb: $input->SetAttach("\167\147\137\146\145\x6e\170\x69\141\157\174{$_W["\165\x6e\x69\141\143\151\144"]}"); goto pu84i; O5zX5: require_once dirname(__FILE__) . "\57\x2e\56\x2f\x2e\56\x2f\x6c\151\142\x2f\167\170\x70\x61\171\x2f\154\151\142\57\x57\170\x50\141\x79\56\x4e\157\x74\x69\x66\x79\56\160\x68\160"; goto UgXYd; AFfQv: $notifyUrl = $_W["\x73\151\x74\x65\162\157\x6f\x74"] . "\x2f\141\144\144\157\156\x73\57\x77\x67\137\x66\x65\156\x78\151\141\157\57\156\157\x74\x69\146\171\x2e\x70\x68\x70"; goto n96rn; Q1MSh: $input->SetNotify_url($notifyUrl); goto QKXIH; HnYVy: } protected function getYongJinBiLi($userInfo) { goto y5E4o; MLXos: $arr["\x65\x72\152\151\x79\157\x6e\x67\152\151\x6e"] = $this->module["\x63\x6f\156\146\x69\147"]["\x65\162\152\x69\171\x6f\x6e\x67\152\151\156"]; goto MY9XR; m8T1r: $arr["\171\151\x6a\x69\x79\157\x6e\x67\x6a\x69\156"] = $this->module["\x63\157\x6e\146\151\147"]["\x79\151\152\151\x79\x6f\x6e\147\x6a\x69\x6e"]; goto MLXos; MY9XR: $arr["\163\141\156\152\151\171\157\156\x67\152\151\x6e"] = $this->module["\x63\x6f\x6e\146\151\x67"]["\x73\x61\x6e\x6a\x69\171\157\x6e\x67\152\x69\156"]; goto ArJXW; y5E4o: if (!($userInfo["\x69\163\x61\147\145\156\x74"] == 0 || $userInfo["\141\x67\x65\x6e\x74\154\145\x76\x65\154"] == 0)) { goto inKhO; } goto m8T1r; Gyrjy: inKhO: goto aKPLY; aKPLY: return $this->MemberLevelModel->getOne(["\x6c\145\166\145\x6c" => $userInfo["\x61\x67\145\x6e\164\154\145\x76\x65\x6c"], "\167\145\x69\x64" => $userInfo["\167\145\x69\144"]], ["\x79\151\x6a\151\x79\x6f\156\x67\152\151\x6e", "\145\x72\152\151\x79\x6f\156\147\x6a\x69\156", "\x73\x61\156\x6a\151\x79\157\x6e\147\152\x69\156"]); goto TxJJK; ArJXW: return $arr; goto Gyrjy; TxJJK: } }